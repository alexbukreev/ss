const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-qPDQHoxk.js","assets/pdf-lib-F-JeKLTy.js","assets/vendor-react-CbJ0mb0J.js","assets/vendor-ui-BEmGJf5A.js"])))=>i.map(i=>d[i]);
import{r as x,j as o,k as Tt,R as Lt,C as Oe,m as It,n as At,X as Bt,S as Ut,L as Ft,T as _t,p as $t,q as Ot}from"./vendor-react-CbJ0mb0J.js";import{S as Dt,R as De,I as Ht,T as He,a as Vt,b as Ve,c as Ge,P as Gt,C as We,V as Wt,L as Xe,d as qe,e as Xt,f as qt,g as Ye,h as Yt,i as Qt,O as Qe,j as Zt,k as Ze,l as Jt,m as Je,D as Ke,n as Kt,o as et,p as tt,q as es,r as ts,s as ss}from"./vendor-ui-BEmGJf5A.js";import"./pdf-lib-F-JeKLTy.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();function ge(e){const r=document.documentElement,t=window.matchMedia("(prefers-color-scheme: dark)").matches,s=e==="dark"||e==="system"&&t;r.classList.toggle("dark",s)}function rs(){x.useEffect(()=>{const e=localStorage.getItem("theme")??"system";ge(e);const r=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>{const n=localStorage.getItem("theme")??"system";n==="system"&&ge(n)};r.addEventListener("change",t);const s=n=>{if(n.key==="theme"){const i=n.newValue??"system";ge(i)}};return window.addEventListener("storage",s),()=>{r.removeEventListener("change",t),window.removeEventListener("storage",s)}},[])}function st(e){var r,t,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(r=0;r<n;r++)e[r]&&(t=st(e[r]))&&(s&&(s+=" "),s+=t)}else for(t in e)e[t]&&(s&&(s+=" "),s+=t);return s}function rt(){for(var e,r,t=0,s="",n=arguments.length;t<n;t++)(e=arguments[t])&&(r=st(e))&&(s&&(s+=" "),s+=r);return s}const Ee=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Te=rt,ot=(e,r)=>t=>{var s;if(r?.variants==null)return Te(e,t?.class,t?.className);const{variants:n,defaultVariants:i}=r,l=Object.keys(n).map(a=>{const c=t?.[a],m=i?.[a];if(c===null)return null;const p=Ee(c)||Ee(m);return n[a][p]}),u=t&&Object.entries(t).reduce((a,c)=>{let[m,p]=c;return p===void 0||(a[m]=p),a},{}),d=r==null||(s=r.compoundVariants)===null||s===void 0?void 0:s.reduce((a,c)=>{let{class:m,className:p,...C}=c;return Object.entries(C).every(j=>{let[R,N]=j;return Array.isArray(N)?N.includes({...i,...u}[R]):{...i,...u}[R]===N})?[...a,m,p]:a},[]);return Te(e,l,d,t?.class,t?.className)},je="-",os=e=>{const r=as(e),{conflictingClassGroups:t,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:l=>{const u=l.split(je);return u[0]===""&&u.length!==1&&u.shift(),nt(u,r)||ns(l)},getConflictingClassGroupIds:(l,u)=>{const d=t[l]||[];return u&&s[l]?[...d,...s[l]]:d}}},nt=(e,r)=>{if(e.length===0)return r.classGroupId;const t=e[0],s=r.nextPart.get(t),n=s?nt(e.slice(1),s):void 0;if(n)return n;if(r.validators.length===0)return;const i=e.join(je);return r.validators.find(({validator:l})=>l(i))?.classGroupId},Le=/^\[(.+)\]$/,ns=e=>{if(Le.test(e)){const r=Le.exec(e)[1],t=r?.substring(0,r.indexOf(":"));if(t)return"arbitrary.."+t}},as=e=>{const{theme:r,classGroups:t}=e,s={nextPart:new Map,validators:[]};for(const n in t)ye(t[n],s,n,r);return s},ye=(e,r,t,s)=>{e.forEach(n=>{if(typeof n=="string"){const i=n===""?r:Ie(r,n);i.classGroupId=t;return}if(typeof n=="function"){if(is(n)){ye(n(s),r,t,s);return}r.validators.push({validator:n,classGroupId:t});return}Object.entries(n).forEach(([i,l])=>{ye(l,Ie(r,i),t,s)})})},Ie=(e,r)=>{let t=e;return r.split(je).forEach(s=>{t.nextPart.has(s)||t.nextPart.set(s,{nextPart:new Map,validators:[]}),t=t.nextPart.get(s)}),t},is=e=>e.isThemeGetter,ls=e=>{if(e<1)return{get:()=>{},set:()=>{}};let r=0,t=new Map,s=new Map;const n=(i,l)=>{t.set(i,l),r++,r>e&&(r=0,s=t,t=new Map)};return{get(i){let l=t.get(i);if(l!==void 0)return l;if((l=s.get(i))!==void 0)return n(i,l),l},set(i,l){t.has(i)?t.set(i,l):n(i,l)}}},we="!",ve=":",cs=ve.length,ds=e=>{const{prefix:r,experimentalParseClassName:t}=e;let s=n=>{const i=[];let l=0,u=0,d=0,a;for(let j=0;j<n.length;j++){let R=n[j];if(l===0&&u===0){if(R===ve){i.push(n.slice(d,j)),d=j+cs;continue}if(R==="/"){a=j;continue}}R==="["?l++:R==="]"?l--:R==="("?u++:R===")"&&u--}const c=i.length===0?n:n.substring(d),m=us(c),p=m!==c,C=a&&a>d?a-d:void 0;return{modifiers:i,hasImportantModifier:p,baseClassName:m,maybePostfixModifierPosition:C}};if(r){const n=r+ve,i=s;s=l=>l.startsWith(n)?i(l.substring(n.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:l,maybePostfixModifierPosition:void 0}}if(t){const n=s;s=i=>t({className:i,parseClassName:n})}return s},us=e=>e.endsWith(we)?e.substring(0,e.length-1):e.startsWith(we)?e.substring(1):e,ms=e=>{const r=Object.fromEntries(e.orderSensitiveModifiers.map(s=>[s,!0]));return s=>{if(s.length<=1)return s;const n=[];let i=[];return s.forEach(l=>{l[0]==="["||r[l]?(n.push(...i.sort(),l),i=[]):i.push(l)}),n.push(...i.sort()),n}},fs=e=>({cache:ls(e.cacheSize),parseClassName:ds(e),sortModifiers:ms(e),...os(e)}),ps=/\s+/,gs=(e,r)=>{const{parseClassName:t,getClassGroupId:s,getConflictingClassGroupIds:n,sortModifiers:i}=r,l=[],u=e.trim().split(ps);let d="";for(let a=u.length-1;a>=0;a-=1){const c=u[a],{isExternal:m,modifiers:p,hasImportantModifier:C,baseClassName:j,maybePostfixModifierPosition:R}=t(c);if(m){d=c+(d.length>0?" "+d:d);continue}let N=!!R,I=s(N?j.substring(0,R):j);if(!I){if(!N){d=c+(d.length>0?" "+d:d);continue}if(I=s(j),!I){d=c+(d.length>0?" "+d:d);continue}N=!1}const E=i(p).join(":"),v=C?E+we:E,w=v+I;if(l.includes(w))continue;l.push(w);const L=n(I,N);for(let P=0;P<L.length;++P){const F=L[P];l.push(v+F)}d=c+(d.length>0?" "+d:d)}return d};function hs(){let e=0,r,t,s="";for(;e<arguments.length;)(r=arguments[e++])&&(t=at(r))&&(s&&(s+=" "),s+=t);return s}const at=e=>{if(typeof e=="string")return e;let r,t="";for(let s=0;s<e.length;s++)e[s]&&(r=at(e[s]))&&(t&&(t+=" "),t+=r);return t};function xs(e,...r){let t,s,n,i=l;function l(d){const a=r.reduce((c,m)=>m(c),e());return t=fs(a),s=t.cache.get,n=t.cache.set,i=u,u(d)}function u(d){const a=s(d);if(a)return a;const c=gs(d,t);return n(d,c),c}return function(){return i(hs.apply(null,arguments))}}const $=e=>{const r=t=>t[e]||[];return r.isThemeGetter=!0,r},it=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,lt=/^\((?:(\w[\w-]*):)?(.+)\)$/i,bs=/^\d+\/\d+$/,ys=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ws=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,vs=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,ks=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,js=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Z=e=>bs.test(e),S=e=>!!e&&!Number.isNaN(Number(e)),Y=e=>!!e&&Number.isInteger(Number(e)),he=e=>e.endsWith("%")&&S(e.slice(0,-1)),q=e=>ys.test(e),Ns=()=>!0,Cs=e=>ws.test(e)&&!vs.test(e),ct=()=>!1,Ss=e=>ks.test(e),Rs=e=>js.test(e),Ps=e=>!b(e)&&!y(e),zs=e=>K(e,mt,ct),b=e=>it.test(e),Q=e=>K(e,ft,Cs),xe=e=>K(e,Is,S),Ae=e=>K(e,dt,ct),Ms=e=>K(e,ut,Rs),ce=e=>K(e,pt,Ss),y=e=>lt.test(e),se=e=>ee(e,ft),Es=e=>ee(e,As),Be=e=>ee(e,dt),Ts=e=>ee(e,mt),Ls=e=>ee(e,ut),de=e=>ee(e,pt,!0),K=(e,r,t)=>{const s=it.exec(e);return s?s[1]?r(s[1]):t(s[2]):!1},ee=(e,r,t=!1)=>{const s=lt.exec(e);return s?s[1]?r(s[1]):t:!1},dt=e=>e==="position"||e==="percentage",ut=e=>e==="image"||e==="url",mt=e=>e==="length"||e==="size"||e==="bg-size",ft=e=>e==="length",Is=e=>e==="number",As=e=>e==="family-name",pt=e=>e==="shadow",Bs=()=>{const e=$("color"),r=$("font"),t=$("text"),s=$("font-weight"),n=$("tracking"),i=$("leading"),l=$("breakpoint"),u=$("container"),d=$("spacing"),a=$("radius"),c=$("shadow"),m=$("inset-shadow"),p=$("text-shadow"),C=$("drop-shadow"),j=$("blur"),R=$("perspective"),N=$("aspect"),I=$("ease"),E=$("animate"),v=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],L=()=>[...w(),y,b],P=()=>["auto","hidden","clip","visible","scroll"],F=()=>["auto","contain","none"],h=()=>[y,b,d],z=()=>[Z,"full","auto",...h()],T=()=>[Y,"none","subgrid",y,b],D=()=>["auto",{span:["full",Y,y,b]},Y,y,b],B=()=>[Y,"auto",y,b],f=()=>["auto","min","max","fr",y,b],g=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],_=()=>["start","end","center","stretch","center-safe","end-safe"],U=()=>["auto",...h()],V=()=>[Z,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...h()],k=()=>[e,y,b],te=()=>[...w(),Be,Ae,{position:[y,b]}],re=()=>["no-repeat",{repeat:["","x","y","space","round"]}],oe=()=>["auto","cover","contain",Ts,zs,{size:[y,b]}],fe=()=>[he,se,Q],H=()=>["","none","full",a,y,b],W=()=>["",S,se,Q],ne=()=>["solid","dashed","dotted","double"],ze=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],O=()=>[S,he,Be,Ae],Me=()=>["","none",j,y,b],ae=()=>["none",S,y,b],ie=()=>["none",S,y,b],pe=()=>[S,y,b],le=()=>[Z,"full",...h()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[q],breakpoint:[q],color:[Ns],container:[q],"drop-shadow":[q],ease:["in","out","in-out"],font:[Ps],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[q],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[q],shadow:[q],spacing:["px",S],text:[q],"text-shadow":[q],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Z,b,y,N]}],container:["container"],columns:[{columns:[S,b,y,u]}],"break-after":[{"break-after":v()}],"break-before":[{"break-before":v()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:L()}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:F()}],"overscroll-x":[{"overscroll-x":F()}],"overscroll-y":[{"overscroll-y":F()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:z()}],"inset-x":[{"inset-x":z()}],"inset-y":[{"inset-y":z()}],start:[{start:z()}],end:[{end:z()}],top:[{top:z()}],right:[{right:z()}],bottom:[{bottom:z()}],left:[{left:z()}],visibility:["visible","invisible","collapse"],z:[{z:[Y,"auto",y,b]}],basis:[{basis:[Z,"full","auto",u,...h()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[S,Z,"auto","initial","none",b]}],grow:[{grow:["",S,y,b]}],shrink:[{shrink:["",S,y,b]}],order:[{order:[Y,"first","last","none",y,b]}],"grid-cols":[{"grid-cols":T()}],"col-start-end":[{col:D()}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":T()}],"row-start-end":[{row:D()}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":f()}],"auto-rows":[{"auto-rows":f()}],gap:[{gap:h()}],"gap-x":[{"gap-x":h()}],"gap-y":[{"gap-y":h()}],"justify-content":[{justify:[...g(),"normal"]}],"justify-items":[{"justify-items":[..._(),"normal"]}],"justify-self":[{"justify-self":["auto",..._()]}],"align-content":[{content:["normal",...g()]}],"align-items":[{items:[..._(),{baseline:["","last"]}]}],"align-self":[{self:["auto",..._(),{baseline:["","last"]}]}],"place-content":[{"place-content":g()}],"place-items":[{"place-items":[..._(),"baseline"]}],"place-self":[{"place-self":["auto",..._()]}],p:[{p:h()}],px:[{px:h()}],py:[{py:h()}],ps:[{ps:h()}],pe:[{pe:h()}],pt:[{pt:h()}],pr:[{pr:h()}],pb:[{pb:h()}],pl:[{pl:h()}],m:[{m:U()}],mx:[{mx:U()}],my:[{my:U()}],ms:[{ms:U()}],me:[{me:U()}],mt:[{mt:U()}],mr:[{mr:U()}],mb:[{mb:U()}],ml:[{ml:U()}],"space-x":[{"space-x":h()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":h()}],"space-y-reverse":["space-y-reverse"],size:[{size:V()}],w:[{w:[u,"screen",...V()]}],"min-w":[{"min-w":[u,"screen","none",...V()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[l]},...V()]}],h:[{h:["screen","lh",...V()]}],"min-h":[{"min-h":["screen","lh","none",...V()]}],"max-h":[{"max-h":["screen","lh",...V()]}],"font-size":[{text:["base",t,se,Q]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,y,xe]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",he,b]}],"font-family":[{font:[Es,b,r]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,y,b]}],"line-clamp":[{"line-clamp":[S,"none",y,xe]}],leading:[{leading:[i,...h()]}],"list-image":[{"list-image":["none",y,b]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",y,b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:k()}],"text-color":[{text:k()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ne(),"wavy"]}],"text-decoration-thickness":[{decoration:[S,"from-font","auto",y,Q]}],"text-decoration-color":[{decoration:k()}],"underline-offset":[{"underline-offset":[S,"auto",y,b]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:h()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",y,b]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",y,b]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:te()}],"bg-repeat":[{bg:re()}],"bg-size":[{bg:oe()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Y,y,b],radial:["",y,b],conic:[Y,y,b]},Ls,Ms]}],"bg-color":[{bg:k()}],"gradient-from-pos":[{from:fe()}],"gradient-via-pos":[{via:fe()}],"gradient-to-pos":[{to:fe()}],"gradient-from":[{from:k()}],"gradient-via":[{via:k()}],"gradient-to":[{to:k()}],rounded:[{rounded:H()}],"rounded-s":[{"rounded-s":H()}],"rounded-e":[{"rounded-e":H()}],"rounded-t":[{"rounded-t":H()}],"rounded-r":[{"rounded-r":H()}],"rounded-b":[{"rounded-b":H()}],"rounded-l":[{"rounded-l":H()}],"rounded-ss":[{"rounded-ss":H()}],"rounded-se":[{"rounded-se":H()}],"rounded-ee":[{"rounded-ee":H()}],"rounded-es":[{"rounded-es":H()}],"rounded-tl":[{"rounded-tl":H()}],"rounded-tr":[{"rounded-tr":H()}],"rounded-br":[{"rounded-br":H()}],"rounded-bl":[{"rounded-bl":H()}],"border-w":[{border:W()}],"border-w-x":[{"border-x":W()}],"border-w-y":[{"border-y":W()}],"border-w-s":[{"border-s":W()}],"border-w-e":[{"border-e":W()}],"border-w-t":[{"border-t":W()}],"border-w-r":[{"border-r":W()}],"border-w-b":[{"border-b":W()}],"border-w-l":[{"border-l":W()}],"divide-x":[{"divide-x":W()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":W()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ne(),"hidden","none"]}],"divide-style":[{divide:[...ne(),"hidden","none"]}],"border-color":[{border:k()}],"border-color-x":[{"border-x":k()}],"border-color-y":[{"border-y":k()}],"border-color-s":[{"border-s":k()}],"border-color-e":[{"border-e":k()}],"border-color-t":[{"border-t":k()}],"border-color-r":[{"border-r":k()}],"border-color-b":[{"border-b":k()}],"border-color-l":[{"border-l":k()}],"divide-color":[{divide:k()}],"outline-style":[{outline:[...ne(),"none","hidden"]}],"outline-offset":[{"outline-offset":[S,y,b]}],"outline-w":[{outline:["",S,se,Q]}],"outline-color":[{outline:k()}],shadow:[{shadow:["","none",c,de,ce]}],"shadow-color":[{shadow:k()}],"inset-shadow":[{"inset-shadow":["none",m,de,ce]}],"inset-shadow-color":[{"inset-shadow":k()}],"ring-w":[{ring:W()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:k()}],"ring-offset-w":[{"ring-offset":[S,Q]}],"ring-offset-color":[{"ring-offset":k()}],"inset-ring-w":[{"inset-ring":W()}],"inset-ring-color":[{"inset-ring":k()}],"text-shadow":[{"text-shadow":["none",p,de,ce]}],"text-shadow-color":[{"text-shadow":k()}],opacity:[{opacity:[S,y,b]}],"mix-blend":[{"mix-blend":[...ze(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ze()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[S]}],"mask-image-linear-from-pos":[{"mask-linear-from":O()}],"mask-image-linear-to-pos":[{"mask-linear-to":O()}],"mask-image-linear-from-color":[{"mask-linear-from":k()}],"mask-image-linear-to-color":[{"mask-linear-to":k()}],"mask-image-t-from-pos":[{"mask-t-from":O()}],"mask-image-t-to-pos":[{"mask-t-to":O()}],"mask-image-t-from-color":[{"mask-t-from":k()}],"mask-image-t-to-color":[{"mask-t-to":k()}],"mask-image-r-from-pos":[{"mask-r-from":O()}],"mask-image-r-to-pos":[{"mask-r-to":O()}],"mask-image-r-from-color":[{"mask-r-from":k()}],"mask-image-r-to-color":[{"mask-r-to":k()}],"mask-image-b-from-pos":[{"mask-b-from":O()}],"mask-image-b-to-pos":[{"mask-b-to":O()}],"mask-image-b-from-color":[{"mask-b-from":k()}],"mask-image-b-to-color":[{"mask-b-to":k()}],"mask-image-l-from-pos":[{"mask-l-from":O()}],"mask-image-l-to-pos":[{"mask-l-to":O()}],"mask-image-l-from-color":[{"mask-l-from":k()}],"mask-image-l-to-color":[{"mask-l-to":k()}],"mask-image-x-from-pos":[{"mask-x-from":O()}],"mask-image-x-to-pos":[{"mask-x-to":O()}],"mask-image-x-from-color":[{"mask-x-from":k()}],"mask-image-x-to-color":[{"mask-x-to":k()}],"mask-image-y-from-pos":[{"mask-y-from":O()}],"mask-image-y-to-pos":[{"mask-y-to":O()}],"mask-image-y-from-color":[{"mask-y-from":k()}],"mask-image-y-to-color":[{"mask-y-to":k()}],"mask-image-radial":[{"mask-radial":[y,b]}],"mask-image-radial-from-pos":[{"mask-radial-from":O()}],"mask-image-radial-to-pos":[{"mask-radial-to":O()}],"mask-image-radial-from-color":[{"mask-radial-from":k()}],"mask-image-radial-to-color":[{"mask-radial-to":k()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[S]}],"mask-image-conic-from-pos":[{"mask-conic-from":O()}],"mask-image-conic-to-pos":[{"mask-conic-to":O()}],"mask-image-conic-from-color":[{"mask-conic-from":k()}],"mask-image-conic-to-color":[{"mask-conic-to":k()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:te()}],"mask-repeat":[{mask:re()}],"mask-size":[{mask:oe()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",y,b]}],filter:[{filter:["","none",y,b]}],blur:[{blur:Me()}],brightness:[{brightness:[S,y,b]}],contrast:[{contrast:[S,y,b]}],"drop-shadow":[{"drop-shadow":["","none",C,de,ce]}],"drop-shadow-color":[{"drop-shadow":k()}],grayscale:[{grayscale:["",S,y,b]}],"hue-rotate":[{"hue-rotate":[S,y,b]}],invert:[{invert:["",S,y,b]}],saturate:[{saturate:[S,y,b]}],sepia:[{sepia:["",S,y,b]}],"backdrop-filter":[{"backdrop-filter":["","none",y,b]}],"backdrop-blur":[{"backdrop-blur":Me()}],"backdrop-brightness":[{"backdrop-brightness":[S,y,b]}],"backdrop-contrast":[{"backdrop-contrast":[S,y,b]}],"backdrop-grayscale":[{"backdrop-grayscale":["",S,y,b]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[S,y,b]}],"backdrop-invert":[{"backdrop-invert":["",S,y,b]}],"backdrop-opacity":[{"backdrop-opacity":[S,y,b]}],"backdrop-saturate":[{"backdrop-saturate":[S,y,b]}],"backdrop-sepia":[{"backdrop-sepia":["",S,y,b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":h()}],"border-spacing-x":[{"border-spacing-x":h()}],"border-spacing-y":[{"border-spacing-y":h()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",y,b]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[S,"initial",y,b]}],ease:[{ease:["linear","initial",I,y,b]}],delay:[{delay:[S,y,b]}],animate:[{animate:["none",E,y,b]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[R,y,b]}],"perspective-origin":[{"perspective-origin":L()}],rotate:[{rotate:ae()}],"rotate-x":[{"rotate-x":ae()}],"rotate-y":[{"rotate-y":ae()}],"rotate-z":[{"rotate-z":ae()}],scale:[{scale:ie()}],"scale-x":[{"scale-x":ie()}],"scale-y":[{"scale-y":ie()}],"scale-z":[{"scale-z":ie()}],"scale-3d":["scale-3d"],skew:[{skew:pe()}],"skew-x":[{"skew-x":pe()}],"skew-y":[{"skew-y":pe()}],transform:[{transform:[y,b,"","none","gpu","cpu"]}],"transform-origin":[{origin:L()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:le()}],"translate-x":[{"translate-x":le()}],"translate-y":[{"translate-y":le()}],"translate-z":[{"translate-z":le()}],"translate-none":["translate-none"],accent:[{accent:k()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:k()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",y,b]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":h()}],"scroll-mx":[{"scroll-mx":h()}],"scroll-my":[{"scroll-my":h()}],"scroll-ms":[{"scroll-ms":h()}],"scroll-me":[{"scroll-me":h()}],"scroll-mt":[{"scroll-mt":h()}],"scroll-mr":[{"scroll-mr":h()}],"scroll-mb":[{"scroll-mb":h()}],"scroll-ml":[{"scroll-ml":h()}],"scroll-p":[{"scroll-p":h()}],"scroll-px":[{"scroll-px":h()}],"scroll-py":[{"scroll-py":h()}],"scroll-ps":[{"scroll-ps":h()}],"scroll-pe":[{"scroll-pe":h()}],"scroll-pt":[{"scroll-pt":h()}],"scroll-pr":[{"scroll-pr":h()}],"scroll-pb":[{"scroll-pb":h()}],"scroll-pl":[{"scroll-pl":h()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",y,b]}],fill:[{fill:["none",...k()]}],"stroke-w":[{stroke:[S,se,Q,xe]}],stroke:[{stroke:["none",...k()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Us=xs(Bs);function A(...e){return Us(rt(e))}const Fs=ot("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),G=x.forwardRef(({className:e,variant:r,size:t,asChild:s=!1,...n},i)=>{const l=s?Dt:"button";return o.jsx(l,{className:A(Fs({variant:r,size:t,className:e})),ref:i,...n})});G.displayName="Button";const _s=/^(image\/(jpeg|png|webp|gif|avif|bmp|tiff))$/i;function $s(e){return _s.test(e.type)}function Os(e,r=36){const t=[];for(const s of e)if($s(s)){if(t.length>=r)break;t.push({id:crypto.randomUUID(),url:URL.createObjectURL(s),name:s.name,size:s.size,type:s.type})}return t}function Ue(e){for(const r of e)try{URL.revokeObjectURL(r.url)}catch{}}const Ds=16,X=2050,Hs=800,Vs=.8,Gs="contain",Ws="left",Xs="top",J={scale:1,tx:0,ty:0},be=(e,r,t)=>Math.max(r,Math.min(t,e));function qs(e){return new Promise((r,t)=>{const s=new Image;s.onload=()=>r({w:s.naturalWidth,h:s.naturalHeight}),s.onerror=t,s.src=e})}function Ys(e,r,t,s,n,i){const l=t/e,u=t/r,d=Math.min(l,u),a=e*d,c=r*d,m=0,p=0,C=(m-(t-a)/2)/t*100,j=(p-(t-c)/2)/t*100;return{tx:Math.max(-100,Math.min(100,C)),ty:Math.max(-100,Math.min(100,j))}}const M=Tt((e,r)=>({photos:[],max:Ds,captions:{},transforms:{},layersByPhoto:{},setCaption:(t,s)=>e(n=>({captions:s.trim()?{...n.captions,[t]:s}:(()=>{const{[t]:i,...l}=n.captions;return l})()})),setTransform:(t,s)=>e(n=>{const i=n.transforms[t]??J,l={scale:be(s.scale??i.scale,.5,4),tx:be(s.tx??i.tx,-100,100),ty:be(s.ty??i.ty,-100,100)};return{transforms:{...n.transforms,[t]:l}}}),resetTransform:t=>e(s=>{const{[t]:n,...i}=s.transforms;return{transforms:i}}),add:t=>{if(!t?.length)return;const{photos:s,max:n}=r(),i=Math.max(0,n-s.length);if(!i)return;const l=t.slice(0,i);e({photos:[...s,...l]});for(const u of l)(async()=>{try{const{w:d,h:a}=await qs(u.url),{tx:c,ty:m}=Ys(d,a,X,Gs,Ws,Xs);r().setTransform(u.id,{tx:c,ty:m})}catch{}})()},clear:()=>{const t=r().photos;t.length&&Ue(t),e({photos:[],captions:{},transforms:{},layersByPhoto:{}})},remove:t=>e(s=>{const n=s.photos.findIndex(c=>c.id===t);if(n===-1)return null;Ue([s.photos[n]]);const{[t]:i,...l}=s.captions,{[t]:u,...d}=s.transforms,a={...s.layersByPhoto};return delete a[t],{photos:s.photos.filter(c=>c.id!==t),captions:l,transforms:d,layersByPhoto:a}}),addTextLayer:(t,s={})=>{const n=crypto.randomUUID();return e(i=>{const l=i.layersByPhoto[t]??[],u=l.length?Math.max(...l.map(c=>c.z))+1:1,d={...s};delete d.id,delete d.type,delete d.z;const a={id:n,type:"text",x:40,y:X-140,rotation:0,scaleX:1,scaleY:1,visible:!0,z:u,text:"New text",fontFamily:"system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial",fontSize:36,fontStyle:"",fill:"#111",align:"left",verticalAlign:"top",padding:0,lineHeight:1.25,...d};return{layersByPhoto:{...i.layersByPhoto,[t]:[...l,a]}}}),n},updateLayer:(t,s,n)=>e(i=>{const l=i.layersByPhoto[t]??[],u=l.findIndex(p=>p.id===s);if(u===-1)return null;const d=l[u],a={...n};delete a.id,delete a.type;const c={...d,...a},m=[...l];return m[u]=c,{layersByPhoto:{...i.layersByPhoto,[t]:m}}}),removeLayer:(t,s)=>e(n=>{const i=n.layersByPhoto[t]??[],l=i.filter(u=>u.id!==s);return l===i?null:{layersByPhoto:{...n.layersByPhoto,[t]:l}}}),bringToFront:(t,s)=>e(n=>{const i=n.layersByPhoto[t]??[];if(!i.length)return null;const l=Math.max(...i.map(d=>d.z)),u=i.map(d=>d.id===s?{...d,z:l+1}:d);return{layersByPhoto:{...n.layersByPhoto,[t]:u}}}),sendToBack:(t,s)=>e(n=>{const i=n.layersByPhoto[t]??[];if(!i.length)return null;const l=Math.min(...i.map(d=>d.z)),u=i.map(d=>d.id===s?{...d,z:l-1}:d);return{layersByPhoto:{...n.layersByPhoto,[t]:u}}}),setLayersOrder:(t,s)=>e(n=>{const i=n.layersByPhoto[t]??[];if(!i.length)return null;const l=new Map(i.map(a=>[a.id,a])),u=[];let d=1;for(const a of s){const c=l.get(a);c&&u.push({...c,z:d++})}for(const a of i)s.includes(a.id)||u.push({...a,z:d++});return{layersByPhoto:{...n.layersByPhoto,[t]:u}}})}));function Qs(e){const r=e.replace(/^\uFEFF/,"").replace(/\r\n?/g,`
`).split(`
`).filter(Boolean);if(!r.length)return{rows:[],hasRelative:!1};const t=r[0].toLowerCase(),s=t.includes(";")&&!t.includes(",")?";":",",n=[],i=new RegExp(`\\s*(?:"([^"]*)"|([^${s}\\n]*))\\s*(?:${s}|$)`,"g");for(const u of r){const d=[];i.lastIndex=0;let a,c=0;for(;(a=i.exec(u))&&c++<1e3;){const C=(a[1]??a[2]??"").trim();if(d.push(C),a.index+a[0].length>=u.length)break}if(!d.length)continue;const m=(d[0]??"").trim();if(!m)continue;const p=(d[1]??"").trim()||void 0;n.push({url:m,caption:p})}n.length&&n[0].url.trim().toLowerCase()==="url"&&n.shift();const l=n.some(u=>Zs(u.url));return{rows:n,hasRelative:l}}function gt(e){return/^https?:\/\//i.test(e)}function ht(e){return/^data:/i.test(e)}function Zs(e){return!(gt(e)||ht(e)||/^blob:/.test(e))}function Js(){const e=x.useRef(null),r=Lt.useRef(null),t=M(m=>m.photos),s=M(m=>m.max),n=M(m=>m.add),i=M(m=>m.clear),l=Math.max(0,s-t.length),u=x.useCallback(m=>{if(!m?.length)return;const p=Array.from(m).slice(0,l),C=Os(p,l);n(C)},[n,l]),d=x.useCallback(m=>{u(m.target.files),m.target.value=""},[u]);async function a(m){const p=m.target.files?.[0];if(!p)return;const C=await p.text();m.target.value="";const{rows:j,hasRelative:R}=Qs(C);if(j.length){if(R){alert("В этом CSV есть относительные пути. В текущей сборке локальная папка не поддерживается. Пожалуйста, используйте полные URL (http/https) или добавьте изображения кнопкой “Choose images”.");return}await c(j)}}async function c(m,p){const C=M.getState().add,j=M.getState().setCaption,R=[];let N=0,I=0;for(const E of m)try{let v=null,w="image";if(gt(E.url)){const F=await fetch(E.url,{mode:"cors"});if(!F.ok)throw new Error(`HTTP ${F.status}`);v=await F.blob(),w=E.url.split("/").pop()||w}else if(ht(E.url))v=await(await fetch(E.url)).blob(),w="data.png";else throw new Error("Relative paths are disabled in this build");const L=URL.createObjectURL(v),P=crypto.randomUUID();R.push({id:P,url:L,name:w,cap:E.caption}),N++}catch(v){console.warn("CSV import skip:",E.url,v),I++}C(R.map(({id:E,url:v,name:w})=>({id:E,url:v,name:w})));for(const E of R)E.cap&&j(E.id,E.cap);I&&alert(`CSV import: added ${N}, skipped ${I}`)}return o.jsx("section",{className:"mt-4 space-y-4",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"text-sm opacity-80",children:["Cards: ",o.jsx("b",{children:t.length})," / ",s]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{ref:e,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:d}),o.jsx("input",{ref:r,type:"file",accept:".csv,text/csv",className:"hidden",onChange:a}),o.jsx("button",{onClick:()=>r.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Import CSV"}),o.jsx("button",{onClick:()=>e.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Choose images"}),o.jsx(G,{variant:"destructive",onClick:i,disabled:!t.length,children:"Clear"})]})]})})}const Ks="modulepreload",er=function(e){return"/ss/"+e},Fe={},tr=function(r,t,s){let n=Promise.resolve();if(t&&t.length>0){let d=function(a){return Promise.all(a.map(c=>Promise.resolve(c).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");n=d(t.map(a=>{if(a=er(a),a in Fe)return;Fe[a]=!0;const c=a.endsWith(".css"),m=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${m}`))return;const p=document.createElement("link");if(p.rel=c?"stylesheet":Ks,c||(p.as="script"),p.crossOrigin="",p.href=a,u&&p.setAttribute("nonce",u),document.head.appendChild(p),c)return new Promise((C,j)=>{p.addEventListener("load",C),p.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${a}`)))})}))}function i(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return n.then(l=>{for(const u of l||[])u.status==="rejected"&&i(u.reason);return r().catch(i)})},xt=x.forwardRef(({className:e,...r},t)=>o.jsx("div",{ref:t,className:A("rounded-xl border bg-card text-card-foreground shadow",e),...r}));xt.displayName="Card";const sr=x.forwardRef(({className:e,...r},t)=>o.jsx("div",{ref:t,className:A("flex flex-col space-y-1.5 p-6",e),...r}));sr.displayName="CardHeader";const rr=x.forwardRef(({className:e,...r},t)=>o.jsx("div",{ref:t,className:A("font-semibold leading-none tracking-tight",e),...r}));rr.displayName="CardTitle";const or=x.forwardRef(({className:e,...r},t)=>o.jsx("div",{ref:t,className:A("text-sm text-muted-foreground",e),...r}));or.displayName="CardDescription";const nr=x.forwardRef(({className:e,...r},t)=>o.jsx("div",{ref:t,className:A("p-6 pt-0",e),...r}));nr.displayName="CardContent";const ar=x.forwardRef(({className:e,...r},t)=>o.jsx("div",{ref:t,className:A("flex items-center p-6 pt-0",e),...r}));ar.displayName="CardFooter";const bt=x.forwardRef(({className:e,value:r,...t},s)=>o.jsx(De,{ref:s,className:A("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...t,children:o.jsx(Ht,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})}));bt.displayName=De.displayName;const ir=Yt,lr=Qt,yt=x.forwardRef(({className:e,children:r,...t},s)=>o.jsxs(He,{ref:s,className:A("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...t,children:[r,o.jsx(Vt,{asChild:!0,children:o.jsx(Oe,{className:"h-4 w-4 opacity-50"})})]}));yt.displayName=He.displayName;const wt=x.forwardRef(({className:e,...r},t)=>o.jsx(Ve,{ref:t,className:A("flex cursor-default items-center justify-center py-1",e),...r,children:o.jsx(It,{className:"h-4 w-4"})}));wt.displayName=Ve.displayName;const vt=x.forwardRef(({className:e,...r},t)=>o.jsx(Ge,{ref:t,className:A("flex cursor-default items-center justify-center py-1",e),...r,children:o.jsx(Oe,{className:"h-4 w-4"})}));vt.displayName=Ge.displayName;const kt=x.forwardRef(({className:e,children:r,position:t="popper",...s},n)=>o.jsx(Gt,{children:o.jsxs(We,{ref:n,className:A("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...s,children:[o.jsx(wt,{}),o.jsx(Wt,{className:A("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),o.jsx(vt,{})]})}));kt.displayName=We.displayName;const cr=x.forwardRef(({className:e,...r},t)=>o.jsx(Xe,{ref:t,className:A("px-2 py-1.5 text-sm font-semibold",e),...r}));cr.displayName=Xe.displayName;const ke=x.forwardRef(({className:e,children:r,...t},s)=>o.jsxs(qe,{ref:s,className:A("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[o.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(Xt,{children:o.jsx(At,{className:"h-4 w-4"})})}),o.jsx(qt,{children:r})]}));ke.displayName=qe.displayName;const dr=x.forwardRef(({className:e,...r},t)=>o.jsx(Ye,{ref:t,className:A("-mx-1 my-1 h-px bg-muted",e),...r}));dr.displayName=Ye.displayName;function jt(e,r,t){if(!r?.length)return;const s=[...r].sort((n,i)=>n.z-i.z);for(const n of s)if(n.visible!==!1&&n.type==="text"){ur(e,n);continue}}function ur(e,r){e.save(),e.translate(r.x,r.y),r.rotation&&e.rotate(r.rotation*Math.PI/180);const t=r.fontFamily||"system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial",s=Math.max(1,Math.round(r.fontSize||16)),n=r.fontStyle||"",i=[];n.includes("italic")&&i.push("italic"),n.includes("bold")&&i.push("bold"),i.push(`${s}px`),i.push(t),e.font=i.join(" "),e.fillStyle=r.fill||"#111",e.textBaseline="top";const l=Math.max(0,r.padding??0),u=Math.max(0,(r.width??0)-l*2),d=r.align||"left",a=mr(e,r.text??"",u>0?u:void 0);let c=l;const m=r.lineHeight??1.25,p=Math.round(s*m);for(const C of a)d==="center"?(e.textAlign="center",e.fillText(C,l+(u>0?u/2:0),c)):d==="right"?(e.textAlign="right",e.fillText(C,l+(u>0?u:0),c)):(e.textAlign="left",e.fillText(C,l,c)),c+=p;e.restore()}function mr(e,r,t){const s=[];if(!r)return s;const n=r.replace(/\r\n?/g,`
`).split(`
`);for(const i of n){if(!t||t<=0){s.push(i);continue}const l=i.split(/\s+/);let u="";for(const d of l){const a=u?u+" "+d:d;if(e.measureText(a).width<=t)u=a;else if(u&&s.push(u),e.measureText(d).width>t){let c="";for(const m of d){const p=c+m;e.measureText(p).width<=t?c=p:(c&&s.push(c),c=m)}u=c}else u=d}s.push(u)}return s}async function Nt(e){return new Promise((r,t)=>{const s=new Image;s.onload=()=>r(s),s.onerror=n=>t(n),s.src=e})}function fr(e,r="card"){return(e.replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||r).slice(0,100)}function pr(e,r){const t=document.createElement("a"),s=URL.createObjectURL(e);t.href=s,t.download=r,document.body.appendChild(t),t.click(),t.remove(),URL.revokeObjectURL(s)}async function gr(e,r,t={}){const s=t.size??Hs,n=t.baseSize??X,i=await zt(e,r,{size:n,bg:t.bg,captionBg:t.captionBg,textColor:t.textColor,transform:t.transform,layers:t.layers});try{const l=await Nt(i),u=document.createElement("canvas");u.width=s,u.height=s;const d=u.getContext("2d");if(!d)throw new Error("No 2D context");d.imageSmoothingQuality="high",d.drawImage(l,0,0,s,s);const a=await new Promise((c,m)=>u.toBlob(p=>p?c(p):m(new Error("toBlob failed")),"image/png"));return URL.createObjectURL(a)}finally{URL.revokeObjectURL(i)}}function Ct(e,r,t){if(e.measureText(r).width<=t)return r;let s=r;for(;s.length>0&&e.measureText(s+"…").width>t;)s=s.slice(0,-1);return s+"…"}function St(e,r,t){const s=r.replace(/\r\n?/g,`
`).split(`
`),n=[];for(const i of s){const l=i.split(/\s+/);let u="";for(const d of l){const a=u?u+" "+d:d;if(e.measureText(a).width<=t)u=a;else if(u&&n.push(u),e.measureText(d).width>t){let c="";for(const m of d){const p=c+m;e.measureText(p).width<=t?c=p:(n.push(c),c=m)}u=c}else u=d}n.push(u)}return n}const hr=.06,xr=72,br=.22,yr=.34;function Rt(e){const r=Math.max(xr,Math.round(e*hr)),t=Math.round(r*br),s=Math.round(r*yr),n=Math.round(s*1.25);return{minBarH:r,pad:t,fontSize:s,lineHeight:n}}async function Pt(e,r,t={}){const s=t.size??X,n=t.bg??"transparent",i=t.captionBg??"rgba(255,255,255,0.82)",l=t.textColor??"#111",u=t.transform??J,d=document.createElement("canvas");d.width=s,d.height=s;const a=d.getContext("2d");if(!a)throw new Error("No 2D context");n!=="transparent"&&(a.fillStyle=n,a.fillRect(0,0,s,s));const c=await Nt(e.url),m=s/c.width,p=s/c.height,j=Math.min(m,p)*u.scale,R=Math.round(c.width*j),N=Math.round(c.height*j),I=Math.round((s-R)/2+u.tx/100*s),E=Math.round((s-N)/2+u.ty/100*s);a.imageSmoothingQuality="high",a.drawImage(c,I,E,R,N);const{minBarH:v,pad:w,fontSize:L,lineHeight:P}=Rt(s);if(r&&r.trim()){a.font=`${L}px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial`,a.fillStyle=l,a.textBaseline="top";const h=s-w*2;if(r.includes(`
`)||a.measureText(r).width>h){const T=St(a,r,h),D=Math.max(P,T.length*P),B=Math.max(v,w+D+w);a.fillStyle=i,a.fillRect(0,s-B,s,B),a.fillStyle=l;let f=s-B+w;for(const g of T)a.fillText(g,w,f,h),f+=P}else{const T=v;a.fillStyle=i,a.fillRect(0,s-T,s,T);const D=Ct(a,r,h);a.fillStyle=l,a.textBaseline="middle",a.fillText(D,w,s-T/2)}}jt(a,t.layers);const F=await new Promise((h,z)=>d.toBlob(T=>T?h(T):z(new Error("toBlob failed")),"image/png"));pr(F,`${fr(r||"card")}.png`)}async function zt(e,r,t={}){const s=t.size??X,n=t.bg??"transparent",i=t.captionBg??"rgba(255,255,255,0.82)",l=t.textColor??"#111",u=t.transform??J,d=document.createElement("canvas");d.width=s,d.height=s;const a=d.getContext("2d");if(!a)throw new Error("No 2D context");n!=="transparent"&&(a.fillStyle=n,a.fillRect(0,0,s,s));const c=await async function(z){return new Promise((T,D)=>{const B=new Image;B.onload=()=>T(B),B.onerror=f=>D(f),B.src=z})}(e.url),m=s/c.width,p=s/c.height,j=Math.min(m,p)*u.scale,R=Math.round(c.width*j),N=Math.round(c.height*j),I=Math.round((s-R)/2+u.tx/100*s),E=Math.round((s-N)/2+u.ty/100*s);a.imageSmoothingQuality="high",a.drawImage(c,I,E,R,N);const{minBarH:v,pad:w,fontSize:L,lineHeight:P}=Rt(s);if(r&&r.trim()){a.font=`${L}px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial`,a.fillStyle=l,a.textBaseline="top";const h=s-w*2;if(r.includes(`
`)||a.measureText(r).width>h){const T=St(a,r,h),D=Math.max(P,T.length*P),B=Math.max(v,w+D+w);a.fillStyle=i,a.fillRect(0,s-B,s,B),a.fillStyle=l;let f=s-B+w;for(const g of T)a.fillText(g,w,f,h),f+=P}else{const T=v;a.fillStyle=i,a.fillRect(0,s-T,s,T);const D=Ct(a,r,h);a.fillStyle=l,a.textBaseline="middle",a.fillText(D,w,s-T/2)}}jt(a,t.layers);const F=await new Promise((h,z)=>d.toBlob(T=>T?h(T):z(new Error("toBlob failed")),"image/png"));return URL.createObjectURL(F)}const Mt=Kt,wr=Zt,Et=x.forwardRef(({className:e,...r},t)=>o.jsx(Qe,{ref:t,className:A("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r}));Et.displayName=Qe.displayName;const Ne=x.forwardRef(({className:e,children:r,...t},s)=>o.jsxs(wr,{children:[o.jsx(Et,{}),o.jsxs(Ze,{ref:s,className:A("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[r,o.jsxs(Jt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[o.jsx(Bt,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ne.displayName=Ze.displayName;const Ce=({className:e,...r})=>o.jsx("div",{className:A("flex flex-col space-y-1.5 text-center sm:text-left",e),...r});Ce.displayName="DialogHeader";const Se=({className:e,...r})=>o.jsx("div",{className:A("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...r});Se.displayName="DialogFooter";const Re=x.forwardRef(({className:e,...r},t)=>o.jsx(Je,{ref:t,className:A("text-lg font-semibold leading-none tracking-tight",e),...r}));Re.displayName=Je.displayName;const Pe=x.forwardRef(({className:e,...r},t)=>o.jsx(Ke,{ref:t,className:A("text-sm text-muted-foreground",e),...r}));Pe.displayName=Ke.displayName;const vr=ot("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ue=x.forwardRef(({className:e,...r},t)=>o.jsx(et,{ref:t,className:A(vr(),e),...r}));ue.displayName=et.displayName;const me=x.forwardRef(({className:e,...r},t)=>o.jsxs(tt,{ref:t,className:A("relative flex w-full touch-none select-none items-center",e),...r,children:[o.jsx(es,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:o.jsx(ts,{className:"absolute h-full bg-primary"})}),o.jsx(ss,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));me.displayName=tt.displayName;function _e({className:e,...r}){return o.jsx("textarea",{"data-slot":"textarea",className:A("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...r})}const kr=[];function jr({photoId:e,size:r,selectedId:t,onSelect:s}){const n=window.devicePixelRatio||1,i=M(c=>c.layersByPhoto[e]??kr,Object.is),l=M(c=>c.updateLayer),u=x.useRef(null),d=x.useRef(null);x.useEffect(()=>{const c=u.current,m=d.current;c&&m&&t&&(c.nodes([m]),c.getLayer()?.batchDraw())},[t]);const a=r/X;return o.jsx(Ut,{width:r,height:r,pixelRatio:n,listening:!0,style:{width:"100%",height:"100%"},onMouseDown:c=>{c.target===c.target.getStage()&&s(null)},onTouchStart:c=>{c.target===c.target.getStage()&&s(null)},children:o.jsxs(Ft,{children:[i.slice().sort((c,m)=>c.z-m.z).map(c=>{if(c.type!=="text")return null;const m=c,C=t===m.id?d:void 0,j=m.x*a,R=m.y*a,N=(m.fontSize??16)*a,I=m.width?m.width*a:void 0,E=(m.padding??0)*a;return o.jsx(_t,{ref:C,draggable:!0,x:j,y:R,text:m.text,fontFamily:m.fontFamily,fontSize:N,fontStyle:m.fontStyle,fill:m.fill,width:I,align:m.align,lineHeight:m.lineHeight??1.25,padding:E,rotation:m.rotation,scaleX:1,scaleY:1,visible:m.visible,perfectDrawEnabled:!1,onTransform:v=>{const w=v.target,L=typeof w.scaleX=="function"?w.scaleX():1,P=typeof w.width=="function"?w.width():void 0;P!==void 0&&L&&L!==1&&(w.width(Math.max(4,Math.round(P*L))),typeof w.scaleX=="function"&&w.scaleX(1),typeof w.scaleY=="function"&&w.scaleY(1),w.getLayer()?.batchDraw())},onMouseDown:()=>s(m.id),onTap:()=>s(m.id),onDragEnd:v=>{l(e,m.id,{x:v.target.x()/a,y:v.target.y()/a})},onTransformEnd:v=>{const w=v.target,L=typeof w.scaleX=="function"?w.scaleX():1,P=typeof w.width=="function"?w.width():void 0,F=w.x(),h=w.y(),z={x:F/a,y:h/a,rotation:w.rotation(),scaleX:1,scaleY:1,width:P!==void 0?Math.max(4,Math.round(P*L/a)):void 0};typeof w.scaleX=="function"&&w.scaleX(1),typeof w.scaleY=="function"&&w.scaleY(1),l(e,m.id,z)}},m.id)}),t&&o.jsx($t,{ref:u,rotateEnabled:!0,enabledAnchors:["middle-left","middle-right","top-center","bottom-center","top-left","top-right","bottom-left","bottom-right"],borderStroke:"#fff",anchorStroke:"#fff",anchorFill:"#111",anchorSize:7,keepRatio:!1,centeredScaling:!1,boundBoxFunc:(c,m)=>{const C=Math.max(6,m.width),j=Math.max(6,m.height);return{...m,width:C,height:j}}})]})})}const Nr=[];function Cr({open:e,onOpenChange:r,photo:t}){const s=M(f=>f.addTextLayer),n=M(f=>f.captions),i=M(f=>f.setCaption),l=M(f=>f.transforms[t.id]??J),u=M(f=>f.setTransform),[d,a]=x.useState(n[t.id]??""),[c,m]=x.useState(l),[p,C]=x.useState(null),j=M(f=>f.updateLayer),R=M(f=>f.removeLayer),N=M(f=>f.bringToFront),I=M(f=>f.sendToBack),E=M(f=>f.layersByPhoto[t.id]??Nr,Object.is);x.useEffect(()=>{e&&(a(n[t.id]??""),m(l))},[e,n,t.id,l]);const[v,w]=x.useState(null);x.useEffect(()=>{if(!e)return;let f=!1;const g=new Image;return g.onload=()=>{f||w({w:g.naturalWidth,h:g.naturalHeight})},g.src=t.url,()=>{f=!0}},[e,t.url]);const L=x.useRef(null),[P,F]=x.useState(0),h=x.useCallback(()=>{const f=L.current;if(!f)return;const g=Math.round(f.clientWidth);g&&F(g)},[]);x.useEffect(()=>{const f=L.current;if(!f)return;const g=new ResizeObserver(()=>h());return g.observe(f),h(),()=>g.disconnect()},[h]),x.useEffect(()=>{e&&(requestAnimationFrame(h),setTimeout(h,50))},[e,h]);const z=x.useMemo(()=>{if(!v||!P)return null;const f=P,g=f/v.w,_=f/v.h,V=Math.min(g,_)*c.scale,k=Math.round(v.w*V),te=Math.round(v.h*V),re=Math.round((f-k)/2+c.tx/100*f),oe=Math.round((f-te)/2+c.ty/100*f);return{dw:k,dh:te,dx:re,dy:oe}},[v,P,c.scale,c.tx,c.ty]),T=x.useRef(null),D=x.useRef(null);x.useEffect(()=>{const f=document.createElement("div");return f.style.position="absolute",f.style.visibility="hidden",f.style.zIndex="-1",f.style.top="0",f.style.left="-99999px",f.style.whiteSpace="pre-wrap",f.style.overflowWrap="break-word",document.body.appendChild(f),D.current=f,()=>{document.body.removeChild(f),D.current=null}},[]);const B=x.useCallback(()=>{const f=T.current,g=D.current;if(!f||!g)return;const _=getComputedStyle(f);g.style.font=_.font,g.style.letterSpacing=_.letterSpacing,g.style.lineHeight=_.lineHeight,g.style.padding=_.padding,g.style.border=_.border,g.style.boxSizing=_.boxSizing,g.style.width=f.clientWidth+"px",g.textContent=(d??"")+`
`;const U=g.scrollHeight;f.style.height="auto",f.style.height=U+"px"},[d]);return x.useLayoutEffect(()=>{B()},[d,e,B]),o.jsx(Mt,{open:e,onOpenChange:r,children:o.jsxs(Ne,{"aria-describedby":void 0,className:`
          max-w-[min(96vw,52rem)]
          max-h-[96vh]
          p-2
          overflow-hidden
          flex flex-col
        `,onOpenAutoFocus:()=>{requestAnimationFrame(()=>{B(),setTimeout(B,50),h();const f=T.current;if(f){f.focus({preventScroll:!0});const g=f.value.length;try{f.setSelectionRange(g,g)}catch{}}})},children:[o.jsxs(Ce,{className:"shrink-0",children:[o.jsx(Re,{children:"Edit card"}),o.jsx(Pe,{className:"sr-only",children:"Adjust zoom and position of the photo and edit the caption."})]}),o.jsx("div",{className:"flex-1 overflow-auto",children:o.jsxs("div",{className:"grid gap-4",children:[o.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:o.jsxs("div",{ref:L,className:"relative aspect-square overflow-hidden rounded-xl",children:[z?o.jsx("img",{src:t.url,alt:t.name,className:"absolute top-0 left-0 select-none pointer-events-none",style:{width:`${z.dw}px`,height:`${z.dh}px`,maxWidth:"none",transform:`translate3d(${z.dx}px, ${z.dy}px, 0)`},draggable:!1}):o.jsx("img",{src:t.url,alt:t.name,className:"h-full w-full object-contain will-change-transform select-none",style:{transform:`translate(${c.tx}%, ${c.ty}%) scale(${c.scale})`,transformOrigin:"center"},draggable:!1}),P>0&&o.jsx("div",{className:"absolute inset-0 pointer-events-auto",children:o.jsx(jr,{photoId:t.id,size:P,selectedId:p,onSelect:C})}),o.jsx("div",{className:"absolute inset-x-0 bottom-0",children:o.jsx("div",{className:"relative bg-background/80 backdrop-blur-sm px-2 pt-1 pb-2",children:o.jsx(_e,{ref:T,value:d,onChange:f=>a(f.target.value),onInput:B,rows:1,className:`
                        pointer-events-auto w-full resize-none overflow-hidden
                        bg-transparent border-0 outline-none
                        focus-visible:ring-0 focus-visible:outline-none
                        p-0 text-xs leading-snug min-h-0
                      `,placeholder:"Type caption…","aria-label":"Caption",autoComplete:"off",autoCorrect:"off",spellCheck:!1})})})]})}),p&&(()=>{const f=E.find(g=>g.id===p&&g.type==="text");return f?o.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[o.jsx("label",{className:"text-xs opacity-70",children:"Text"}),o.jsx(_e,{value:f.text,onChange:g=>j(t.id,f.id,{text:g.target.value}),rows:3,className:"resize-y"}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("label",{className:"text-xs opacity-70",children:"Size"}),o.jsx("input",{type:"number",min:8,max:240,step:1,value:f.fontSize??36,onChange:g=>j(t.id,f.id,{fontSize:Number(g.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),o.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${f.fontStyle?.includes("bold")?"bg-foreground/10":""}`,onClick:()=>{const g=f.fontStyle?.includes("bold"),U=`${f.fontStyle?.includes("italic")?"italic":""} ${g?"":"bold"}`.trim();j(t.id,f.id,{fontStyle:U})},children:"Bold"}),o.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${f.fontStyle?.includes("italic")?"bg-foreground/10":""}`,onClick:()=>{const g=f.fontStyle?.includes("bold"),U=`${f.fontStyle?.includes("italic")?"":"italic"} ${g?"bold":""}`.trim();j(t.id,f.id,{fontStyle:U})},children:"Italic"}),o.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Color"}),o.jsx("input",{type:"color",value:f.fill??"#111111",onChange:g=>j(t.id,f.id,{fill:g.target.value}),className:"h-8 w-10 cursor-pointer"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("label",{className:"text-xs opacity-70",children:"Align"}),["left","center","right"].map(g=>o.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${f.align===g?"bg-foreground/10":""}`,onClick:()=>j(t.id,f.id,{align:g}),children:g},g)),o.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Wrap width"}),o.jsx("input",{type:"number",min:0,max:X,step:10,value:f.width??0,onChange:g=>j(t.id,f.id,{width:Number(g.target.value)||void 0}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0 disables wrapping"}),o.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Padding"}),o.jsx("input",{type:"number",min:0,max:200,step:1,value:f.padding??0,onChange:g=>j(t.id,f.id,{padding:Number(g.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),o.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Line height"}),o.jsx("input",{type:"number",min:.8,max:2,step:.05,value:f.lineHeight??1.25,onChange:g=>j(t.id,f.id,{lineHeight:Number(g.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"})]})]}):null})(),o.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:o.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[o.jsx(G,{variant:"secondary",disabled:!p,onClick:()=>{if(!p)return;const g=(M.getState().layersByPhoto[t.id]??[]).find(V=>V.id===p);if(!g)return;const U=((g.rotation??0)-90)%360;j(t.id,p,{rotation:U<0?U+360:U})},children:"Rotate −90°"}),o.jsx(G,{variant:"secondary",disabled:!p,onClick:()=>{if(!p)return;const g=(M.getState().layersByPhoto[t.id]??[]).find(V=>V.id===p);if(!g)return;const U=((g.rotation??0)+90)%360;j(t.id,p,{rotation:U})},children:"Rotate +90°"}),o.jsx(G,{variant:"secondary",disabled:!p,onClick:()=>p&&N(t.id,p),children:"Bring to front"}),o.jsx(G,{variant:"secondary",disabled:!p,onClick:()=>p&&I(t.id,p),children:"Send to back"}),o.jsx(G,{variant:"destructive",disabled:!p,onClick:()=>{p&&(R(t.id,p),C(null))},children:"Delete layer"})]})}),o.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:o.jsxs("div",{className:"grid gap-3",children:[o.jsxs("div",{className:"grid gap-1.5",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx(ue,{children:"Zoom"}),o.jsxs("span",{className:"tabular-nums opacity-70",children:[c.scale.toFixed(2),"×"]})]}),o.jsx(me,{value:[c.scale],min:1,max:3,step:.01,onValueChange:([f])=>m(g=>({...g,scale:f}))})]}),o.jsxs("div",{className:"grid gap-1.5",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx(ue,{children:"Horizontal"}),o.jsxs("span",{className:"tabular-nums opacity-70",children:[c.tx.toFixed(0),"%"]})]}),o.jsx(me,{value:[c.tx],min:-100,max:100,step:.1,onValueChange:([f])=>m(g=>({...g,tx:f}))})]}),o.jsxs("div",{className:"grid gap-1.5",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx(ue,{children:"Vertical"}),o.jsxs("span",{className:"tabular-nums opacity-70",children:[c.ty.toFixed(0),"%"]})]}),o.jsx(me,{value:[c.ty],min:-100,max:100,step:.1,onValueChange:([f])=>m(g=>({...g,ty:f}))})]})]})})]})}),o.jsxs(Se,{className:"shrink-0 space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx(G,{variant:"ghost",onClick:()=>m(J),children:"Reset image"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(G,{variant:"secondary",onClick:()=>r(!1),children:"Cancel"}),o.jsx(G,{onClick:()=>{i(t.id,d),u(t.id,c),r(!1)},children:"Save"})]})]}),o.jsx("div",{children:o.jsx(G,{variant:"secondary",onClick:()=>{const f=s(t.id,{text:"New text",fontSize:48,fontFamily:"system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial",fill:"#fff",x:40,y:40,align:"left"});C(f)},children:"Add text layer"})})]})]})})}function Sr({open:e,onOpenChange:r,photo:t,caption:s,transform:n,onEdit:i}){const[l,u]=x.useState(null),[d,a]=x.useState(!1),c=M(m=>m.layersByPhoto);return x.useEffect(()=>{let m=null,p=!1;if(!e){m&&URL.revokeObjectURL(m),u(null);return}return a(!0),(async()=>{const C=await zt(t,s,{size:X,transform:n,layers:c[t.id]});if(p){URL.revokeObjectURL(C);return}m&&URL.revokeObjectURL(m),u(C),m=C,a(!1)})(),()=>{p=!0,m&&URL.revokeObjectURL(m)}},[e,t.id,t.url,s,n.scale,n.tx,n.ty,c[t.id]]),o.jsx(Mt,{open:e,onOpenChange:r,children:o.jsxs(Ne,{"aria-describedby":void 0,className:`
            max-w-[min(96vw,52rem)]
            max-h-[96vh]
            p-2
            overflow-hidden
          `,children:[o.jsxs(Ce,{className:"shrink-0",children:[o.jsx(Re,{children:"Preview"}),o.jsx(Pe,{className:"sr-only",children:"Full-size preview of the card. You can export PNG or switch to editing."})]}),o.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:o.jsxs("div",{className:"relative aspect-square overflow-hidden rounded-xl",children:[l?o.jsx("img",{src:l,alt:t.name,className:"absolute inset-0 m-auto max-w-full max-h-full w-auto h-auto object-contain"}):o.jsx("div",{className:"h-24"}),o.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${d?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!d,children:o.jsx("div",{className:"h-7 w-7 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]})}),o.jsxs(Se,{className:"mt-2 gap-2",children:[o.jsx(G,{variant:"secondary",onClick:()=>{r(!1),i()},children:"Edit"}),o.jsx(G,{onClick:()=>Pt(t,s,{size:X,transform:n,layers:c[t.id]}),children:"Save PNG"})]})]})})}function Rr({photo:e}){const r=M(v=>v.captions),t=M(v=>v.remove),s=M(v=>v.transforms[e.id]??J),n=M(v=>v.layersByPhoto),[i,l]=x.useState(!1),[u,d]=x.useState(!1),a=(r[e.id]??"").trim(),c=x.useRef(null),[m,p]=x.useState(0);x.useEffect(()=>{const v=c.current;if(!v)return;const w=()=>p(v.clientWidth);w();const L=new ResizeObserver(w);return L.observe(v),()=>L.disconnect()},[]);const[C,j]=x.useState(null),[R,N]=x.useState(!0),I=x.useRef(0);x.useEffect(()=>{let v=!1,w=null;const L=++I.current;return(async()=>{if(!m)return;N(!0);const F=window.devicePixelRatio||1,h=Math.max(384,Math.min(1024,Math.round(m*F))),z=await gr(e,a,{size:h,transform:s,layers:n[e.id]});if(v||I.current!==L){URL.revokeObjectURL(z);return}w&&URL.revokeObjectURL(w),j(z),w=z,N(!1)})(),()=>{v=!0,w&&URL.revokeObjectURL(w)}},[m,e.url,a,s.scale,s.tx,s.ty,n[e.id]]);const E=x.useCallback(async()=>{await Pt(e,a,{size:X,transform:s,layers:n[e.id]})},[e,a,s,n]);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"overflow-hidden rounded-xl border border-foreground/15 bg-foreground/[0.02]",children:[o.jsxs("div",{ref:c,onClick:()=>d(!0),className:"relative aspect-square w-full overflow-hidden cursor-zoom-in",children:[o.jsx("button",{"aria-label":"Remove image",title:"Remove",onClick:v=>{v.stopPropagation(),t(e.id)},className:"absolute right-1 top-1 z-10 rounded-md bg-background/80 px-1.5 py-0.5 text-[11px] shadow hover:bg-background",children:"×"}),C?o.jsx("img",{src:C,alt:e.name,className:"h-full w-full object-cover"}):o.jsx("div",{className:"h-full w-full bg-foreground/[0.06]"}),o.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${R?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!R,children:o.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]}),o.jsxs("div",{className:"flex items-center justify-between gap-2 border-t bg-background/70 px-2 py-1.5 supports-[backdrop-filter]:bg-background/60",children:[o.jsx("button",{"aria-label":"Edit card",title:"Edit",onClick:v=>{v.stopPropagation(),l(!0)},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Edit"}),o.jsx("button",{"aria-label":"Save PNG",title:"Save PNG",onClick:v=>{v.stopPropagation(),E()},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Save PNG"})]})]}),o.jsx(Sr,{open:u,onOpenChange:d,photo:e,caption:a,transform:s,onEdit:()=>l(!0)}),o.jsx(Cr,{open:i,onOpenChange:l,photo:e})]})}function $e(e){const r=e/1e3;return r<60?`${r.toFixed(1)}s`:`${Math.floor(r/60)}m ${(r%60).toFixed(0)}s`}function Pr(){const e=M(N=>N.photos),r=M(N=>N.captions),t=M(N=>N.transforms),[s,n]=x.useState(!1),[i,l]=x.useState(null),u=x.useRef(!1),[d,a]=x.useState("jpeg"),[c,m]=x.useState(Vs*100),p=M(N=>N.layersByPhoto),C=i?.pct??0,j=x.useMemo(()=>{if(!i)return"";const N=i.etaMs??0;return`Rendering ${i.done}/${i.total} • ${C}% • elapsed ${$e(i.elapsedMs)}${i.done<i.total?` • ETA ${$e(N)}`:""}`},[i,C]);x.useEffect(()=>{i&&i.done>=i.total&&l(null)},[i]);const R=x.useCallback(async()=>{if(!(!e.length||u.current)){u.current=!0;try{n(!0),l({done:0,total:e.length,elapsedMs:0,pct:0});const{exportCardsToPdf:N}=await tr(async()=>{const{exportCardsToPdf:I}=await import("./pdf-qPDQHoxk.js");return{exportCardsToPdf:I}},__vite__mapDeps([0,1,2,3]));await N(e,r,t,{size:X,format:d,quality:Math.min(.95,Math.max(.5,c/100)),onProgress:I=>l(I)},p)}finally{n(!1),u.current=!1}}},[e,r,t,d,c,p]);return o.jsxs("section",{className:"space-y-3",children:[o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:e.map(N=>o.jsx(Rr,{photo:N},N.id))}),e.length>0&&o.jsxs(xt,{className:"p-4",children:[o.jsx("div",{className:"mb-3 text-sm font-medium",children:"Export the collection to PDF"}),i&&o.jsxs(o.Fragment,{children:[o.jsx(bt,{value:C,className:"mb-1 h-2"}),o.jsx("div",{className:"mb-3 text-xs opacity-70",children:j})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"opacity-70",children:"Format"}),o.jsxs(ir,{value:d,onValueChange:N=>a(N),children:[o.jsx(yt,{className:"w-28 h-8",children:o.jsx(lr,{placeholder:"Format"})}),o.jsxs(kt,{children:[o.jsx(ke,{value:"jpeg",children:"JPEG (small)"}),o.jsx(ke,{value:"png",children:"PNG (lossless)"})]})]})]}),d==="jpeg"&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"opacity-70",children:"Quality"}),o.jsx("input",{type:"range",min:50,max:95,step:5,value:c,onChange:N=>m(Number(N.target.value))}),o.jsxs("span",{className:"tabular-nums",children:[c,"%"]})]}),o.jsx("div",{className:"grow"}),o.jsx(G,{type:"button",size:"sm",onClick:R,disabled:!e.length||s,children:s?"Exporting…":"Export PDF"})]})]})]})}function zr(){return rs(),o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"sticky top-0 z-10 w-full py-3 text-center text-3xl font-bold bg-background border-b border-gray-300",children:"Story Squares v1.0"}),o.jsxs("main",{className:"mx-auto max-w-screen-md px-4 space-y-5",children:[o.jsx(Js,{}),o.jsx(Pr,{})]})]})}Ot.createRoot(document.getElementById("root")).render(o.jsx(x.StrictMode,{children:o.jsx(zr,{})}));export{X as C,J as D,Vs as P,jt as d};
