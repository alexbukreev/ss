const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-DTZ1VRQY.js","assets/jspdf-Cpx4AXLL.js","assets/vendor-react-CkEsgLSR.js","assets/vendor-ui-BqtEeXaX.js"])))=>i.map(i=>d[i]);
import{r as j,j as A,k as _o,m as ko,n as qe,C as Co,p as Fi,q as Ui,S as Wi,L as qi,t as _r,I as Eo,T as Yi,v as Gi,X as Vi,w as So,R as Tt,a as Re}from"./vendor-react-CkEsgLSR.js";import{S as $i,R as Ro,I as Hi,T as Ao,a as Zi,b as No,c as Io,P as Xi,C as To,V as Ki,L as Do,d as zo,e as Ji,f as Qi,g as jo,h as ts,i as es,O as Lo,j as ns,k as Mo,l as rs,m as Bo,D as Po,n as os,o as Oo,p as Fo,q as is,r as ss,s as as,t as ls}from"./vendor-ui-BqtEeXaX.js";import{_ as cs}from"./jspdf-Cpx4AXLL.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();if(typeof window<"u"){const t=n=>{const e=n?.reason&&(n.reason.message||String(n.reason))||"Unknown async error";console.error("Unhandled promise rejection:",n?.reason),setTimeout(()=>alert(`Error: ${e}`),0)};window.addEventListener("unhandledrejection",t)}function pn(t){const n=document.documentElement,e=window.matchMedia("(prefers-color-scheme: dark)").matches,r=t==="dark"||t==="system"&&e;n.classList.toggle("dark",r)}function ds(){j.useEffect(()=>{const t=localStorage.getItem("theme")??"system";pn(t);const n=window.matchMedia("(prefers-color-scheme: dark)"),e=()=>{const i=localStorage.getItem("theme")??"system";i==="system"&&pn(i)};n.addEventListener("change",e);const r=i=>{if(i.key==="theme"){const o=i.newValue??"system";pn(o)}};return window.addEventListener("storage",r),()=>{n.removeEventListener("change",e),window.removeEventListener("storage",r)}},[])}function Uo(t){var n,e,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(e=Uo(t[n]))&&(r&&(r+=" "),r+=e)}else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Wo(){for(var t,n,e=0,r="",i=arguments.length;e<i;e++)(t=arguments[e])&&(n=Uo(t))&&(r&&(r+=" "),r+=n);return r}const kr=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Cr=Wo,qo=(t,n)=>e=>{var r;if(n?.variants==null)return Cr(t,e?.class,e?.className);const{variants:i,defaultVariants:o}=n,a=Object.keys(i).map(u=>{const c=e?.[u],g=o?.[u];if(c===null)return null;const m=kr(c)||kr(g);return i[u][m]}),s=e&&Object.entries(e).reduce((u,c)=>{let[g,m]=c;return m===void 0||(u[g]=m),u},{}),l=n==null||(r=n.compoundVariants)===null||r===void 0?void 0:r.reduce((u,c)=>{let{class:g,className:m,...d}=c;return Object.entries(d).every(y=>{let[f,v]=y;return Array.isArray(v)?v.includes({...o,...s}[f]):{...o,...s}[f]===v})?[...u,g,m]:u},[]);return Cr(t,a,l,e?.class,e?.className)},nr="-",us=t=>{const n=hs(t),{conflictingClassGroups:e,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const s=a.split(nr);return s[0]===""&&s.length!==1&&s.shift(),Yo(s,n)||fs(a)},getConflictingClassGroupIds:(a,s)=>{const l=e[a]||[];return s&&r[a]?[...l,...r[a]]:l}}},Yo=(t,n)=>{if(t.length===0)return n.classGroupId;const e=t[0],r=n.nextPart.get(e),i=r?Yo(t.slice(1),r):void 0;if(i)return i;if(n.validators.length===0)return;const o=t.join(nr);return n.validators.find(({validator:a})=>a(o))?.classGroupId},Er=/^\[(.+)\]$/,fs=t=>{if(Er.test(t)){const n=Er.exec(t)[1],e=n?.substring(0,n.indexOf(":"));if(e)return"arbitrary.."+e}},hs=t=>{const{theme:n,classGroups:e}=t,r={nextPart:new Map,validators:[]};for(const i in e)Hn(e[i],r,i,n);return r},Hn=(t,n,e,r)=>{t.forEach(i=>{if(typeof i=="string"){const o=i===""?n:Sr(n,i);o.classGroupId=e;return}if(typeof i=="function"){if(ps(i)){Hn(i(r),n,e,r);return}n.validators.push({validator:i,classGroupId:e});return}Object.entries(i).forEach(([o,a])=>{Hn(a,Sr(n,o),e,r)})})},Sr=(t,n)=>{let e=t;return n.split(nr).forEach(r=>{e.nextPart.has(r)||e.nextPart.set(r,{nextPart:new Map,validators:[]}),e=e.nextPart.get(r)}),e},ps=t=>t.isThemeGetter,ms=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,e=new Map,r=new Map;const i=(o,a)=>{e.set(o,a),n++,n>t&&(n=0,r=e,e=new Map)};return{get(o){let a=e.get(o);if(a!==void 0)return a;if((a=r.get(o))!==void 0)return i(o,a),a},set(o,a){e.has(o)?e.set(o,a):i(o,a)}}},Zn="!",Xn=":",gs=Xn.length,bs=t=>{const{prefix:n,experimentalParseClassName:e}=t;let r=i=>{const o=[];let a=0,s=0,l=0,u;for(let y=0;y<i.length;y++){let f=i[y];if(a===0&&s===0){if(f===Xn){o.push(i.slice(l,y)),l=y+gs;continue}if(f==="/"){u=y;continue}}f==="["?a++:f==="]"?a--:f==="("?s++:f===")"&&s--}const c=o.length===0?i:i.substring(l),g=ys(c),m=g!==c,d=u&&u>l?u-l:void 0;return{modifiers:o,hasImportantModifier:m,baseClassName:g,maybePostfixModifierPosition:d}};if(n){const i=n+Xn,o=r;r=a=>a.startsWith(i)?o(a.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(e){const i=r;r=o=>e({className:o,parseClassName:i})}return r},ys=t=>t.endsWith(Zn)?t.substring(0,t.length-1):t.startsWith(Zn)?t.substring(1):t,vs=t=>{const n=Object.fromEntries(t.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const i=[];let o=[];return r.forEach(a=>{a[0]==="["||n[a]?(i.push(...o.sort(),a),o=[]):o.push(a)}),i.push(...o.sort()),i}},ws=t=>({cache:ms(t.cacheSize),parseClassName:bs(t),sortModifiers:vs(t),...us(t)}),xs=/\s+/,_s=(t,n)=>{const{parseClassName:e,getClassGroupId:r,getConflictingClassGroupIds:i,sortModifiers:o}=n,a=[],s=t.trim().split(xs);let l="";for(let u=s.length-1;u>=0;u-=1){const c=s[u],{isExternal:g,modifiers:m,hasImportantModifier:d,baseClassName:y,maybePostfixModifierPosition:f}=e(c);if(g){l=c+(l.length>0?" "+l:l);continue}let v=!!f,b=r(v?y.substring(0,f):y);if(!b){if(!v){l=c+(l.length>0?" "+l:l);continue}if(b=r(y),!b){l=c+(l.length>0?" "+l:l);continue}v=!1}const w=o(m).join(":"),x=d?w+Zn:w,_=x+b;if(a.includes(_))continue;a.push(_);const E=i(b,v);for(let N=0;N<E.length;++N){const T=E[N];a.push(x+T)}l=c+(l.length>0?" "+l:l)}return l};function ks(){let t=0,n,e,r="";for(;t<arguments.length;)(n=arguments[t++])&&(e=Go(n))&&(r&&(r+=" "),r+=e);return r}const Go=t=>{if(typeof t=="string")return t;let n,e="";for(let r=0;r<t.length;r++)t[r]&&(n=Go(t[r]))&&(e&&(e+=" "),e+=n);return e};function Cs(t,...n){let e,r,i,o=a;function a(l){const u=n.reduce((c,g)=>g(c),t());return e=ws(u),r=e.cache.get,i=e.cache.set,o=s,s(l)}function s(l){const u=r(l);if(u)return u;const c=_s(l,e);return i(l,c),c}return function(){return o(ks.apply(null,arguments))}}const Ct=t=>{const n=e=>e[t]||[];return n.isThemeGetter=!0,n},Vo=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,$o=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Es=/^\d+\/\d+$/,Ss=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Rs=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,As=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Ns=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Is=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,de=t=>Es.test(t),ft=t=>!!t&&!Number.isNaN(Number(t)),Qt=t=>!!t&&Number.isInteger(Number(t)),mn=t=>t.endsWith("%")&&ft(t.slice(0,-1)),Vt=t=>Ss.test(t),Ts=()=>!0,Ds=t=>Rs.test(t)&&!As.test(t),Ho=()=>!1,zs=t=>Ns.test(t),js=t=>Is.test(t),Ls=t=>!st(t)&&!at(t),Ms=t=>be(t,Ko,Ho),st=t=>Vo.test(t),ie=t=>be(t,Jo,Ds),gn=t=>be(t,Us,ft),Rr=t=>be(t,Zo,Ho),Bs=t=>be(t,Xo,js),Ye=t=>be(t,Qo,zs),at=t=>$o.test(t),Ee=t=>ye(t,Jo),Ps=t=>ye(t,Ws),Ar=t=>ye(t,Zo),Os=t=>ye(t,Ko),Fs=t=>ye(t,Xo),Ge=t=>ye(t,Qo,!0),be=(t,n,e)=>{const r=Vo.exec(t);return r?r[1]?n(r[1]):e(r[2]):!1},ye=(t,n,e=!1)=>{const r=$o.exec(t);return r?r[1]?n(r[1]):e:!1},Zo=t=>t==="position"||t==="percentage",Xo=t=>t==="image"||t==="url",Ko=t=>t==="length"||t==="size"||t==="bg-size",Jo=t=>t==="length",Us=t=>t==="number",Ws=t=>t==="family-name",Qo=t=>t==="shadow",qs=()=>{const t=Ct("color"),n=Ct("font"),e=Ct("text"),r=Ct("font-weight"),i=Ct("tracking"),o=Ct("leading"),a=Ct("breakpoint"),s=Ct("container"),l=Ct("spacing"),u=Ct("radius"),c=Ct("shadow"),g=Ct("inset-shadow"),m=Ct("text-shadow"),d=Ct("drop-shadow"),y=Ct("blur"),f=Ct("perspective"),v=Ct("aspect"),b=Ct("ease"),w=Ct("animate"),x=()=>["auto","avoid","all","avoid-page","page","left","right","column"],_=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],E=()=>[..._(),at,st],N=()=>["auto","hidden","clip","visible","scroll"],T=()=>["auto","contain","none"],R=()=>[at,st,l],z=()=>[de,"full","auto",...R()],F=()=>[Qt,"none","subgrid",at,st],Y=()=>["auto",{span:["full",Qt,at,st]},Qt,at,st],C=()=>[Qt,"auto",at,st],k=()=>["auto","min","max","fr",at,st],p=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],q=()=>["start","end","center","stretch","center-safe","end-safe"],L=()=>["auto",...R()],D=()=>[de,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...R()],G=()=>[t,at,st],M=()=>[..._(),Ar,Rr,{position:[at,st]}],W=()=>["no-repeat",{repeat:["","x","y","space","round"]}],B=()=>["auto","cover","contain",Os,Ms,{size:[at,st]}],P=()=>[mn,Ee,ie],Q=()=>["","none","full",u,at,st],K=()=>["",ft,Ee,ie],Z=()=>["solid","dashed","dotted","double"],ct=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],it=()=>[ft,mn,Ar,Rr],nt=()=>["","none",y,at,st],rt=()=>["none",ft,at,st],J=()=>["none",ft,at,st],ut=()=>[ft,at,st],ht=()=>[de,"full",...R()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Vt],breakpoint:[Vt],color:[Ts],container:[Vt],"drop-shadow":[Vt],ease:["in","out","in-out"],font:[Ls],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Vt],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Vt],shadow:[Vt],spacing:["px",ft],text:[Vt],"text-shadow":[Vt],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",de,st,at,v]}],container:["container"],columns:[{columns:[ft,st,at,s]}],"break-after":[{"break-after":x()}],"break-before":[{"break-before":x()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:E()}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:z()}],"inset-x":[{"inset-x":z()}],"inset-y":[{"inset-y":z()}],start:[{start:z()}],end:[{end:z()}],top:[{top:z()}],right:[{right:z()}],bottom:[{bottom:z()}],left:[{left:z()}],visibility:["visible","invisible","collapse"],z:[{z:[Qt,"auto",at,st]}],basis:[{basis:[de,"full","auto",s,...R()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ft,de,"auto","initial","none",st]}],grow:[{grow:["",ft,at,st]}],shrink:[{shrink:["",ft,at,st]}],order:[{order:[Qt,"first","last","none",at,st]}],"grid-cols":[{"grid-cols":F()}],"col-start-end":[{col:Y()}],"col-start":[{"col-start":C()}],"col-end":[{"col-end":C()}],"grid-rows":[{"grid-rows":F()}],"row-start-end":[{row:Y()}],"row-start":[{"row-start":C()}],"row-end":[{"row-end":C()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":k()}],"auto-rows":[{"auto-rows":k()}],gap:[{gap:R()}],"gap-x":[{"gap-x":R()}],"gap-y":[{"gap-y":R()}],"justify-content":[{justify:[...p(),"normal"]}],"justify-items":[{"justify-items":[...q(),"normal"]}],"justify-self":[{"justify-self":["auto",...q()]}],"align-content":[{content:["normal",...p()]}],"align-items":[{items:[...q(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...q(),{baseline:["","last"]}]}],"place-content":[{"place-content":p()}],"place-items":[{"place-items":[...q(),"baseline"]}],"place-self":[{"place-self":["auto",...q()]}],p:[{p:R()}],px:[{px:R()}],py:[{py:R()}],ps:[{ps:R()}],pe:[{pe:R()}],pt:[{pt:R()}],pr:[{pr:R()}],pb:[{pb:R()}],pl:[{pl:R()}],m:[{m:L()}],mx:[{mx:L()}],my:[{my:L()}],ms:[{ms:L()}],me:[{me:L()}],mt:[{mt:L()}],mr:[{mr:L()}],mb:[{mb:L()}],ml:[{ml:L()}],"space-x":[{"space-x":R()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":R()}],"space-y-reverse":["space-y-reverse"],size:[{size:D()}],w:[{w:[s,"screen",...D()]}],"min-w":[{"min-w":[s,"screen","none",...D()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[a]},...D()]}],h:[{h:["screen","lh",...D()]}],"min-h":[{"min-h":["screen","lh","none",...D()]}],"max-h":[{"max-h":["screen","lh",...D()]}],"font-size":[{text:["base",e,Ee,ie]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,at,gn]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",mn,st]}],"font-family":[{font:[Ps,st,n]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,at,st]}],"line-clamp":[{"line-clamp":[ft,"none",at,gn]}],leading:[{leading:[o,...R()]}],"list-image":[{"list-image":["none",at,st]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",at,st]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:G()}],"text-color":[{text:G()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:[ft,"from-font","auto",at,ie]}],"text-decoration-color":[{decoration:G()}],"underline-offset":[{"underline-offset":[ft,"auto",at,st]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",at,st]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",at,st]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:M()}],"bg-repeat":[{bg:W()}],"bg-size":[{bg:B()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Qt,at,st],radial:["",at,st],conic:[Qt,at,st]},Fs,Bs]}],"bg-color":[{bg:G()}],"gradient-from-pos":[{from:P()}],"gradient-via-pos":[{via:P()}],"gradient-to-pos":[{to:P()}],"gradient-from":[{from:G()}],"gradient-via":[{via:G()}],"gradient-to":[{to:G()}],rounded:[{rounded:Q()}],"rounded-s":[{"rounded-s":Q()}],"rounded-e":[{"rounded-e":Q()}],"rounded-t":[{"rounded-t":Q()}],"rounded-r":[{"rounded-r":Q()}],"rounded-b":[{"rounded-b":Q()}],"rounded-l":[{"rounded-l":Q()}],"rounded-ss":[{"rounded-ss":Q()}],"rounded-se":[{"rounded-se":Q()}],"rounded-ee":[{"rounded-ee":Q()}],"rounded-es":[{"rounded-es":Q()}],"rounded-tl":[{"rounded-tl":Q()}],"rounded-tr":[{"rounded-tr":Q()}],"rounded-br":[{"rounded-br":Q()}],"rounded-bl":[{"rounded-bl":Q()}],"border-w":[{border:K()}],"border-w-x":[{"border-x":K()}],"border-w-y":[{"border-y":K()}],"border-w-s":[{"border-s":K()}],"border-w-e":[{"border-e":K()}],"border-w-t":[{"border-t":K()}],"border-w-r":[{"border-r":K()}],"border-w-b":[{"border-b":K()}],"border-w-l":[{"border-l":K()}],"divide-x":[{"divide-x":K()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":K()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Z(),"hidden","none"]}],"divide-style":[{divide:[...Z(),"hidden","none"]}],"border-color":[{border:G()}],"border-color-x":[{"border-x":G()}],"border-color-y":[{"border-y":G()}],"border-color-s":[{"border-s":G()}],"border-color-e":[{"border-e":G()}],"border-color-t":[{"border-t":G()}],"border-color-r":[{"border-r":G()}],"border-color-b":[{"border-b":G()}],"border-color-l":[{"border-l":G()}],"divide-color":[{divide:G()}],"outline-style":[{outline:[...Z(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ft,at,st]}],"outline-w":[{outline:["",ft,Ee,ie]}],"outline-color":[{outline:G()}],shadow:[{shadow:["","none",c,Ge,Ye]}],"shadow-color":[{shadow:G()}],"inset-shadow":[{"inset-shadow":["none",g,Ge,Ye]}],"inset-shadow-color":[{"inset-shadow":G()}],"ring-w":[{ring:K()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:G()}],"ring-offset-w":[{"ring-offset":[ft,ie]}],"ring-offset-color":[{"ring-offset":G()}],"inset-ring-w":[{"inset-ring":K()}],"inset-ring-color":[{"inset-ring":G()}],"text-shadow":[{"text-shadow":["none",m,Ge,Ye]}],"text-shadow-color":[{"text-shadow":G()}],opacity:[{opacity:[ft,at,st]}],"mix-blend":[{"mix-blend":[...ct(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ct()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ft]}],"mask-image-linear-from-pos":[{"mask-linear-from":it()}],"mask-image-linear-to-pos":[{"mask-linear-to":it()}],"mask-image-linear-from-color":[{"mask-linear-from":G()}],"mask-image-linear-to-color":[{"mask-linear-to":G()}],"mask-image-t-from-pos":[{"mask-t-from":it()}],"mask-image-t-to-pos":[{"mask-t-to":it()}],"mask-image-t-from-color":[{"mask-t-from":G()}],"mask-image-t-to-color":[{"mask-t-to":G()}],"mask-image-r-from-pos":[{"mask-r-from":it()}],"mask-image-r-to-pos":[{"mask-r-to":it()}],"mask-image-r-from-color":[{"mask-r-from":G()}],"mask-image-r-to-color":[{"mask-r-to":G()}],"mask-image-b-from-pos":[{"mask-b-from":it()}],"mask-image-b-to-pos":[{"mask-b-to":it()}],"mask-image-b-from-color":[{"mask-b-from":G()}],"mask-image-b-to-color":[{"mask-b-to":G()}],"mask-image-l-from-pos":[{"mask-l-from":it()}],"mask-image-l-to-pos":[{"mask-l-to":it()}],"mask-image-l-from-color":[{"mask-l-from":G()}],"mask-image-l-to-color":[{"mask-l-to":G()}],"mask-image-x-from-pos":[{"mask-x-from":it()}],"mask-image-x-to-pos":[{"mask-x-to":it()}],"mask-image-x-from-color":[{"mask-x-from":G()}],"mask-image-x-to-color":[{"mask-x-to":G()}],"mask-image-y-from-pos":[{"mask-y-from":it()}],"mask-image-y-to-pos":[{"mask-y-to":it()}],"mask-image-y-from-color":[{"mask-y-from":G()}],"mask-image-y-to-color":[{"mask-y-to":G()}],"mask-image-radial":[{"mask-radial":[at,st]}],"mask-image-radial-from-pos":[{"mask-radial-from":it()}],"mask-image-radial-to-pos":[{"mask-radial-to":it()}],"mask-image-radial-from-color":[{"mask-radial-from":G()}],"mask-image-radial-to-color":[{"mask-radial-to":G()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":_()}],"mask-image-conic-pos":[{"mask-conic":[ft]}],"mask-image-conic-from-pos":[{"mask-conic-from":it()}],"mask-image-conic-to-pos":[{"mask-conic-to":it()}],"mask-image-conic-from-color":[{"mask-conic-from":G()}],"mask-image-conic-to-color":[{"mask-conic-to":G()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:M()}],"mask-repeat":[{mask:W()}],"mask-size":[{mask:B()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",at,st]}],filter:[{filter:["","none",at,st]}],blur:[{blur:nt()}],brightness:[{brightness:[ft,at,st]}],contrast:[{contrast:[ft,at,st]}],"drop-shadow":[{"drop-shadow":["","none",d,Ge,Ye]}],"drop-shadow-color":[{"drop-shadow":G()}],grayscale:[{grayscale:["",ft,at,st]}],"hue-rotate":[{"hue-rotate":[ft,at,st]}],invert:[{invert:["",ft,at,st]}],saturate:[{saturate:[ft,at,st]}],sepia:[{sepia:["",ft,at,st]}],"backdrop-filter":[{"backdrop-filter":["","none",at,st]}],"backdrop-blur":[{"backdrop-blur":nt()}],"backdrop-brightness":[{"backdrop-brightness":[ft,at,st]}],"backdrop-contrast":[{"backdrop-contrast":[ft,at,st]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ft,at,st]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ft,at,st]}],"backdrop-invert":[{"backdrop-invert":["",ft,at,st]}],"backdrop-opacity":[{"backdrop-opacity":[ft,at,st]}],"backdrop-saturate":[{"backdrop-saturate":[ft,at,st]}],"backdrop-sepia":[{"backdrop-sepia":["",ft,at,st]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":R()}],"border-spacing-x":[{"border-spacing-x":R()}],"border-spacing-y":[{"border-spacing-y":R()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",at,st]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ft,"initial",at,st]}],ease:[{ease:["linear","initial",b,at,st]}],delay:[{delay:[ft,at,st]}],animate:[{animate:["none",w,at,st]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[f,at,st]}],"perspective-origin":[{"perspective-origin":E()}],rotate:[{rotate:rt()}],"rotate-x":[{"rotate-x":rt()}],"rotate-y":[{"rotate-y":rt()}],"rotate-z":[{"rotate-z":rt()}],scale:[{scale:J()}],"scale-x":[{"scale-x":J()}],"scale-y":[{"scale-y":J()}],"scale-z":[{"scale-z":J()}],"scale-3d":["scale-3d"],skew:[{skew:ut()}],"skew-x":[{"skew-x":ut()}],"skew-y":[{"skew-y":ut()}],transform:[{transform:[at,st,"","none","gpu","cpu"]}],"transform-origin":[{origin:E()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ht()}],"translate-x":[{"translate-x":ht()}],"translate-y":[{"translate-y":ht()}],"translate-z":[{"translate-z":ht()}],"translate-none":["translate-none"],accent:[{accent:G()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:G()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",at,st]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",at,st]}],fill:[{fill:["none",...G()]}],"stroke-w":[{stroke:[ft,Ee,ie,gn]}],stroke:[{stroke:["none",...G()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Ys=Cs(qs);function yt(...t){return Ys(Wo(t))}const Gs=qo("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),_t=j.forwardRef(({className:t,variant:n,size:e,asChild:r=!1,...i},o)=>{const a=r?$i:"button";return A.jsx(a,{className:yt(Gs({variant:n,size:e,className:t})),ref:o,...i})});_t.displayName="Button";const Vs=/^(image\/(jpeg|png|webp|gif|avif|bmp|tiff))$/i;function $s(t){return Vs.test(t.type)}function Hs(t,n=36){const e=[];for(const r of t)if($s(r)){if(e.length>=n)break;e.push({id:crypto.randomUUID(),url:URL.createObjectURL(r),name:r.name,size:r.size,type:r.type})}return e}function Nr(t){for(const n of t)try{URL.revokeObjectURL(n.url)}catch{}}let Wt=null;function Ve(){if(!Wt)throw new Error("ConfigController: not initialized. Call Config.init().")}function Ir(t){if(t.MAX_CARDS!=null&&(!Number.isInteger(t.MAX_CARDS)||t.MAX_CARDS<=0))throw new Error("MAX_CARDS must be a positive integer.");if(t.CARD_EXPORT_SIZE!=null&&(!Number.isInteger(t.CARD_EXPORT_SIZE)||t.CARD_EXPORT_SIZE<=0))throw new Error("CARD_EXPORT_SIZE must be a positive integer.");if(t.PREVIEW_EXACT_SIZE!=null&&(!Number.isInteger(t.PREVIEW_EXACT_SIZE)||t.PREVIEW_EXACT_SIZE<=0))throw new Error("PREVIEW_EXACT_SIZE must be a positive integer.");if(t.PREVIEW_FAST_SIZE!=null&&(!Number.isInteger(t.PREVIEW_FAST_SIZE)||t.PREVIEW_FAST_SIZE<=0))throw new Error("PREVIEW_FAST_SIZE must be a positive integer.");if(t.PDF_JPEG_QUALITY!=null&&(t.PDF_JPEG_QUALITY<0||t.PDF_JPEG_QUALITY>1))throw new Error("PDF_JPEG_QUALITY must be within [0..1].");if(t.IMAGE_FIT_MODE!=null&&t.IMAGE_FIT_MODE!=="cover"&&t.IMAGE_FIT_MODE!=="contain")throw new Error("IMAGE_FIT_MODE must be 'cover' or 'contain'.");if(t.INITIAL_ALIGN_X!=null&&!["center","left","right"].includes(t.INITIAL_ALIGN_X))throw new Error("INITIAL_ALIGN_X must be 'center' | 'left' | 'right'.");if(t.INITIAL_ALIGN_Y!=null&&!["center","top","bottom"].includes(t.INITIAL_ALIGN_Y))throw new Error("INITIAL_ALIGN_Y must be 'center' | 'top' | 'bottom'.");if(t.FONT_CATALOG!=null&&!Array.isArray(t.FONT_CATALOG))throw new Error("FONT_CATALOG must be an array.");if(t.DEFAULT_CARD_LAYERS!=null&&!Array.isArray(t.DEFAULT_CARD_LAYERS))throw new Error("DEFAULT_CARD_LAYERS must be an array.");if(t.DEFAULTS!=null&&(typeof t.DEFAULTS!="object"||Array.isArray(t.DEFAULTS)))throw new Error("DEFAULTS must be an object.");if(t.NEAR_SQUARE_TOLERANCE!=null&&(t.NEAR_SQUARE_TOLERANCE<0||t.NEAR_SQUARE_TOLERANCE>.5))throw new Error("NEAR_SQUARE_TOLERANCE must be within [0..0.5].");if(t.NEAR_SQUARE_SCALE!=null&&(t.NEAR_SQUARE_SCALE<=0||t.NEAR_SQUARE_SCALE>1))throw new Error("NEAR_SQUARE_SCALE must be within (0..1].");if(t.LAYER_PROFILES!=null){if(typeof t.LAYER_PROFILES!="object"||Array.isArray(t.LAYER_PROFILES))throw new Error("LAYER_PROFILES must be an object.");for(const[n,e]of Object.entries(t.LAYER_PROFILES)){if(e==null||typeof e!="object"||Array.isArray(e))throw new Error(`LAYER_PROFILES['${n}'] must be an object.`);if(e.on!=null&&typeof e.on!="boolean")throw new Error(`LAYER_PROFILES['${n}'].on must be boolean if provided.`);if(e.landscape!=null&&!Array.isArray(e.landscape))throw new Error(`LAYER_PROFILES['${n}'].landscape must be an array if provided.`);if(e.portrait!=null&&!Array.isArray(e.portrait))throw new Error(`LAYER_PROFILES['${n}'].portrait must be an array if provided.`);if(e.square!=null&&!Array.isArray(e.square))throw new Error(`LAYER_PROFILES['${n}'].square must be an array if provided.`)}}}const bt={init(t){Wt=Object.freeze({...t})},get(){return Ve(),Wt},update(t){return Ve(),Ir(t),Wt=Object.freeze({...Wt,...t}),Wt},loadFromJson(t){Ve();const n=t;return Ir(n),Wt=Object.freeze({...Wt,...n}),Wt},toJson(){return Ve(),{...Wt}},async loadFromUrl(t){const n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error(`Config.loadFromUrl failed: ${n.status}`);const e=await n.json(),{schemaVersion:r,...i}=e??{};return this.loadFromJson(i)}};bt.init({});const Zs="/ss/configs/default.json";await bt.loadFromUrl(Zs);const ti=bt.get().MAX_CARDS,It=bt.get().CARD_EXPORT_SIZE,Ke=bt.get().PREVIEW_EXACT_SIZE,Xs=bt.get().PREVIEW_FAST_SIZE,Ks=bt.get().PDF_JPEG_QUALITY,Tr=bt.get().IMAGE_FIT_MODE,Js=bt.get().INITIAL_ALIGN_X,Qs=bt.get().INITIAL_ALIGN_Y,ei=bt.get().FONT_CATALOG;bt.get().NEAR_SQUARE_TOLERANCE;bt.get().NEAR_SQUARE_SCALE;bt.get().DEFAULTS;bt.get().DEFAULT_CARD_LAYERS;var ue={},bn,Dr;function ta(){return Dr||(Dr=1,bn=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),bn}var yn={},te={},zr;function se(){if(zr)return te;zr=1;let t;const n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return te.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17},te.getSymbolTotalCodewords=function(r){return n[r]},te.getBCHDigit=function(e){let r=0;for(;e!==0;)r++,e>>>=1;return r},te.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');t=r},te.isKanjiModeEnabled=function(){return typeof t<"u"},te.toSJIS=function(r){return t(r)},te}var vn={},jr;function rr(){return jr||(jr=1,function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function n(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}t.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},t.from=function(r,i){if(t.isValid(r))return r;try{return n(r)}catch{return i}}}(vn)),vn}var wn,Lr;function ea(){if(Lr)return wn;Lr=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(n){const e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let r=0;r<e;r++)this.putBit((n>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}},wn=t,wn}var xn,Mr;function na(){if(Mr)return xn;Mr=1;function t(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}return t.prototype.set=function(n,e,r,i){const o=n*this.size+e;this.data[o]=r,i&&(this.reservedBit[o]=!0)},t.prototype.get=function(n,e){return this.data[n*this.size+e]},t.prototype.xor=function(n,e,r){this.data[n*this.size+e]^=r},t.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]},xn=t,xn}var _n={},Br;function ra(){return Br||(Br=1,function(t){const n=se().getSymbolSize;t.getRowColCoords=function(r){if(r===1)return[];const i=Math.floor(r/7)+2,o=n(r),a=o===145?26:Math.ceil((o-13)/(2*i-2))*2,s=[o-7];for(let l=1;l<i-1;l++)s[l]=s[l-1]-a;return s.push(6),s.reverse()},t.getPositions=function(r){const i=[],o=t.getRowColCoords(r),a=o.length;for(let s=0;s<a;s++)for(let l=0;l<a;l++)s===0&&l===0||s===0&&l===a-1||s===a-1&&l===0||i.push([o[s],o[l]]);return i}}(_n)),_n}var kn={},Pr;function oa(){if(Pr)return kn;Pr=1;const t=se().getSymbolSize,n=7;return kn.getPositions=function(r){const i=t(r);return[[0,0],[i-n,0],[0,i-n]]},kn}var Cn={},Or;function ia(){return Or||(Or=1,function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n={N1:3,N2:3,N3:40,N4:10};t.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},t.from=function(i){return t.isValid(i)?parseInt(i,10):void 0},t.getPenaltyN1=function(i){const o=i.size;let a=0,s=0,l=0,u=null,c=null;for(let g=0;g<o;g++){s=l=0,u=c=null;for(let m=0;m<o;m++){let d=i.get(g,m);d===u?s++:(s>=5&&(a+=n.N1+(s-5)),u=d,s=1),d=i.get(m,g),d===c?l++:(l>=5&&(a+=n.N1+(l-5)),c=d,l=1)}s>=5&&(a+=n.N1+(s-5)),l>=5&&(a+=n.N1+(l-5))}return a},t.getPenaltyN2=function(i){const o=i.size;let a=0;for(let s=0;s<o-1;s++)for(let l=0;l<o-1;l++){const u=i.get(s,l)+i.get(s,l+1)+i.get(s+1,l)+i.get(s+1,l+1);(u===4||u===0)&&a++}return a*n.N2},t.getPenaltyN3=function(i){const o=i.size;let a=0,s=0,l=0;for(let u=0;u<o;u++){s=l=0;for(let c=0;c<o;c++)s=s<<1&2047|i.get(u,c),c>=10&&(s===1488||s===93)&&a++,l=l<<1&2047|i.get(c,u),c>=10&&(l===1488||l===93)&&a++}return a*n.N3},t.getPenaltyN4=function(i){let o=0;const a=i.data.length;for(let l=0;l<a;l++)o+=i.data[l];return Math.abs(Math.ceil(o*100/a/5)-10)*n.N4};function e(r,i,o){switch(r){case t.Patterns.PATTERN000:return(i+o)%2===0;case t.Patterns.PATTERN001:return i%2===0;case t.Patterns.PATTERN010:return o%3===0;case t.Patterns.PATTERN011:return(i+o)%3===0;case t.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(o/3))%2===0;case t.Patterns.PATTERN101:return i*o%2+i*o%3===0;case t.Patterns.PATTERN110:return(i*o%2+i*o%3)%2===0;case t.Patterns.PATTERN111:return(i*o%3+(i+o)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}t.applyMask=function(i,o){const a=o.size;for(let s=0;s<a;s++)for(let l=0;l<a;l++)o.isReserved(l,s)||o.xor(l,s,e(i,l,s))},t.getBestMask=function(i,o){const a=Object.keys(t.Patterns).length;let s=0,l=1/0;for(let u=0;u<a;u++){o(u),t.applyMask(u,i);const c=t.getPenaltyN1(i)+t.getPenaltyN2(i)+t.getPenaltyN3(i)+t.getPenaltyN4(i);t.applyMask(u,i),c<l&&(l=c,s=u)}return s}}(Cn)),Cn}var $e={},Fr;function ni(){if(Fr)return $e;Fr=1;const t=rr(),n=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],e=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return $e.getBlocksCount=function(i,o){switch(o){case t.L:return n[(i-1)*4+0];case t.M:return n[(i-1)*4+1];case t.Q:return n[(i-1)*4+2];case t.H:return n[(i-1)*4+3];default:return}},$e.getTotalCodewordsCount=function(i,o){switch(o){case t.L:return e[(i-1)*4+0];case t.M:return e[(i-1)*4+1];case t.Q:return e[(i-1)*4+2];case t.H:return e[(i-1)*4+3];default:return}},$e}var En={},Se={},Ur;function sa(){if(Ur)return Se;Ur=1;const t=new Uint8Array(512),n=new Uint8Array(256);return function(){let r=1;for(let i=0;i<255;i++)t[i]=r,n[r]=i,r<<=1,r&256&&(r^=285);for(let i=255;i<512;i++)t[i]=t[i-255]}(),Se.log=function(r){if(r<1)throw new Error("log("+r+")");return n[r]},Se.exp=function(r){return t[r]},Se.mul=function(r,i){return r===0||i===0?0:t[n[r]+n[i]]},Se}var Wr;function aa(){return Wr||(Wr=1,function(t){const n=sa();t.mul=function(r,i){const o=new Uint8Array(r.length+i.length-1);for(let a=0;a<r.length;a++)for(let s=0;s<i.length;s++)o[a+s]^=n.mul(r[a],i[s]);return o},t.mod=function(r,i){let o=new Uint8Array(r);for(;o.length-i.length>=0;){const a=o[0];for(let l=0;l<i.length;l++)o[l]^=n.mul(i[l],a);let s=0;for(;s<o.length&&o[s]===0;)s++;o=o.slice(s)}return o},t.generateECPolynomial=function(r){let i=new Uint8Array([1]);for(let o=0;o<r;o++)i=t.mul(i,new Uint8Array([1,n.exp(o)]));return i}}(En)),En}var Sn,qr;function la(){if(qr)return Sn;qr=1;const t=aa();function n(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}return n.prototype.initialize=function(r){this.degree=r,this.genPoly=t.generateECPolynomial(this.degree)},n.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const i=new Uint8Array(r.length+this.degree);i.set(r);const o=t.mod(i,this.genPoly),a=this.degree-o.length;if(a>0){const s=new Uint8Array(this.degree);return s.set(o,a),s}return o},Sn=n,Sn}var Rn={},An={},Nn={},Yr;function ri(){return Yr||(Yr=1,Nn.isValid=function(n){return!isNaN(n)&&n>=1&&n<=40}),Nn}var Ut={},Gr;function oi(){if(Gr)return Ut;Gr=1;const t="[0-9]+",n="[A-Z $%*+\\-./:]+";let e="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";e=e.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+e+`)(?:.|[\r
]))+`;Ut.KANJI=new RegExp(e,"g"),Ut.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Ut.BYTE=new RegExp(r,"g"),Ut.NUMERIC=new RegExp(t,"g"),Ut.ALPHANUMERIC=new RegExp(n,"g");const i=new RegExp("^"+e+"$"),o=new RegExp("^"+t+"$"),a=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Ut.testKanji=function(l){return i.test(l)},Ut.testNumeric=function(l){return o.test(l)},Ut.testAlphanumeric=function(l){return a.test(l)},Ut}var Vr;function ae(){return Vr||(Vr=1,function(t){const n=ri(),e=oi();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(o,a){if(!o.ccBits)throw new Error("Invalid mode: "+o);if(!n.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?o.ccBits[0]:a<27?o.ccBits[1]:o.ccBits[2]},t.getBestModeForData=function(o){return e.testNumeric(o)?t.NUMERIC:e.testAlphanumeric(o)?t.ALPHANUMERIC:e.testKanji(o)?t.KANJI:t.BYTE},t.toString=function(o){if(o&&o.id)return o.id;throw new Error("Invalid mode")},t.isValid=function(o){return o&&o.bit&&o.ccBits};function r(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+i)}}t.from=function(o,a){if(t.isValid(o))return o;try{return r(o)}catch{return a}}}(An)),An}var $r;function ca(){return $r||($r=1,function(t){const n=se(),e=ni(),r=rr(),i=ae(),o=ri(),a=7973,s=n.getBCHDigit(a);function l(m,d,y){for(let f=1;f<=40;f++)if(d<=t.getCapacity(f,y,m))return f}function u(m,d){return i.getCharCountIndicator(m,d)+4}function c(m,d){let y=0;return m.forEach(function(f){const v=u(f.mode,d);y+=v+f.getBitsLength()}),y}function g(m,d){for(let y=1;y<=40;y++)if(c(m,y)<=t.getCapacity(y,d,i.MIXED))return y}t.from=function(d,y){return o.isValid(d)?parseInt(d,10):y},t.getCapacity=function(d,y,f){if(!o.isValid(d))throw new Error("Invalid QR Code version");typeof f>"u"&&(f=i.BYTE);const v=n.getSymbolTotalCodewords(d),b=e.getTotalCodewordsCount(d,y),w=(v-b)*8;if(f===i.MIXED)return w;const x=w-u(f,d);switch(f){case i.NUMERIC:return Math.floor(x/10*3);case i.ALPHANUMERIC:return Math.floor(x/11*2);case i.KANJI:return Math.floor(x/13);case i.BYTE:default:return Math.floor(x/8)}},t.getBestVersionForData=function(d,y){let f;const v=r.from(y,r.M);if(Array.isArray(d)){if(d.length>1)return g(d,v);if(d.length===0)return 1;f=d[0]}else f=d;return l(f.mode,f.getLength(),v)},t.getEncodedBits=function(d){if(!o.isValid(d)||d<7)throw new Error("Invalid QR Code version");let y=d<<12;for(;n.getBCHDigit(y)-s>=0;)y^=a<<n.getBCHDigit(y)-s;return d<<12|y}}(Rn)),Rn}var In={},Hr;function da(){if(Hr)return In;Hr=1;const t=se(),n=1335,e=21522,r=t.getBCHDigit(n);return In.getEncodedBits=function(o,a){const s=o.bit<<3|a;let l=s<<10;for(;t.getBCHDigit(l)-r>=0;)l^=n<<t.getBCHDigit(l)-r;return(s<<10|l)^e},In}var Tn={},Dn,Zr;function ua(){if(Zr)return Dn;Zr=1;const t=ae();function n(e){this.mode=t.NUMERIC,this.data=e.toString()}return n.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let i,o,a;for(i=0;i+3<=this.data.length;i+=3)o=this.data.substr(i,3),a=parseInt(o,10),r.put(a,10);const s=this.data.length-i;s>0&&(o=this.data.substr(i),a=parseInt(o,10),r.put(a,s*3+1))},Dn=n,Dn}var zn,Xr;function fa(){if(Xr)return zn;Xr=1;const t=ae(),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function e(r){this.mode=t.ALPHANUMERIC,this.data=r}return e.getBitsLength=function(i){return 11*Math.floor(i/2)+6*(i%2)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(i){let o;for(o=0;o+2<=this.data.length;o+=2){let a=n.indexOf(this.data[o])*45;a+=n.indexOf(this.data[o+1]),i.put(a,11)}this.data.length%2&&i.put(n.indexOf(this.data[o]),6)},zn=e,zn}var jn,Kr;function ha(){if(Kr)return jn;Kr=1;const t=ae();function n(e){this.mode=t.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}return n.getBitsLength=function(r){return r*8},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(e){for(let r=0,i=this.data.length;r<i;r++)e.put(this.data[r],8)},jn=n,jn}var Ln,Jr;function pa(){if(Jr)return Ln;Jr=1;const t=ae(),n=se();function e(r){this.mode=t.KANJI,this.data=r}return e.getBitsLength=function(i){return i*13},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(r){let i;for(i=0;i<this.data.length;i++){let o=n.toSJIS(this.data[i]);if(o>=33088&&o<=40956)o-=33088;else if(o>=57408&&o<=60351)o-=49472;else throw new Error("Invalid SJIS character: "+this.data[i]+`
Make sure your charset is UTF-8`);o=(o>>>8&255)*192+(o&255),r.put(o,13)}},Ln=e,Ln}var Mn={exports:{}},Qr;function ma(){return Qr||(Qr=1,function(t){var n={single_source_shortest_paths:function(e,r,i){var o={},a={};a[r]=0;var s=n.PriorityQueue.make();s.push(r,0);for(var l,u,c,g,m,d,y,f,v;!s.empty();){l=s.pop(),u=l.value,g=l.cost,m=e[u]||{};for(c in m)m.hasOwnProperty(c)&&(d=m[c],y=g+d,f=a[c],v=typeof a[c]>"u",(v||f>y)&&(a[c]=y,s.push(c,y),o[c]=u))}if(typeof i<"u"&&typeof a[i]>"u"){var b=["Could not find a path from ",r," to ",i,"."].join("");throw new Error(b)}return o},extract_shortest_path_from_predecessor_list:function(e,r){for(var i=[],o=r;o;)i.push(o),e[o],o=e[o];return i.reverse(),i},find_path:function(e,r,i){var o=n.single_source_shortest_paths(e,r,i);return n.extract_shortest_path_from_predecessor_list(o,i)},PriorityQueue:{make:function(e){var r=n.PriorityQueue,i={},o;e=e||{};for(o in r)r.hasOwnProperty(o)&&(i[o]=r[o]);return i.queue=[],i.sorter=e.sorter||r.default_sorter,i},default_sorter:function(e,r){return e.cost-r.cost},push:function(e,r){var i={value:e,cost:r};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=n}(Mn)),Mn.exports}var to;function ga(){return to||(to=1,function(t){const n=ae(),e=ua(),r=fa(),i=ha(),o=pa(),a=oi(),s=se(),l=ma();function u(b){return unescape(encodeURIComponent(b)).length}function c(b,w,x){const _=[];let E;for(;(E=b.exec(x))!==null;)_.push({data:E[0],index:E.index,mode:w,length:E[0].length});return _}function g(b){const w=c(a.NUMERIC,n.NUMERIC,b),x=c(a.ALPHANUMERIC,n.ALPHANUMERIC,b);let _,E;return s.isKanjiModeEnabled()?(_=c(a.BYTE,n.BYTE,b),E=c(a.KANJI,n.KANJI,b)):(_=c(a.BYTE_KANJI,n.BYTE,b),E=[]),w.concat(x,_,E).sort(function(T,R){return T.index-R.index}).map(function(T){return{data:T.data,mode:T.mode,length:T.length}})}function m(b,w){switch(w){case n.NUMERIC:return e.getBitsLength(b);case n.ALPHANUMERIC:return r.getBitsLength(b);case n.KANJI:return o.getBitsLength(b);case n.BYTE:return i.getBitsLength(b)}}function d(b){return b.reduce(function(w,x){const _=w.length-1>=0?w[w.length-1]:null;return _&&_.mode===x.mode?(w[w.length-1].data+=x.data,w):(w.push(x),w)},[])}function y(b){const w=[];for(let x=0;x<b.length;x++){const _=b[x];switch(_.mode){case n.NUMERIC:w.push([_,{data:_.data,mode:n.ALPHANUMERIC,length:_.length},{data:_.data,mode:n.BYTE,length:_.length}]);break;case n.ALPHANUMERIC:w.push([_,{data:_.data,mode:n.BYTE,length:_.length}]);break;case n.KANJI:w.push([_,{data:_.data,mode:n.BYTE,length:u(_.data)}]);break;case n.BYTE:w.push([{data:_.data,mode:n.BYTE,length:u(_.data)}])}}return w}function f(b,w){const x={},_={start:{}};let E=["start"];for(let N=0;N<b.length;N++){const T=b[N],R=[];for(let z=0;z<T.length;z++){const F=T[z],Y=""+N+z;R.push(Y),x[Y]={node:F,lastCount:0},_[Y]={};for(let C=0;C<E.length;C++){const k=E[C];x[k]&&x[k].node.mode===F.mode?(_[k][Y]=m(x[k].lastCount+F.length,F.mode)-m(x[k].lastCount,F.mode),x[k].lastCount+=F.length):(x[k]&&(x[k].lastCount=F.length),_[k][Y]=m(F.length,F.mode)+4+n.getCharCountIndicator(F.mode,w))}}E=R}for(let N=0;N<E.length;N++)_[E[N]].end=0;return{map:_,table:x}}function v(b,w){let x;const _=n.getBestModeForData(b);if(x=n.from(w,_),x!==n.BYTE&&x.bit<_.bit)throw new Error('"'+b+'" cannot be encoded with mode '+n.toString(x)+`.
 Suggested mode is: `+n.toString(_));switch(x===n.KANJI&&!s.isKanjiModeEnabled()&&(x=n.BYTE),x){case n.NUMERIC:return new e(b);case n.ALPHANUMERIC:return new r(b);case n.KANJI:return new o(b);case n.BYTE:return new i(b)}}t.fromArray=function(w){return w.reduce(function(x,_){return typeof _=="string"?x.push(v(_,null)):_.data&&x.push(v(_.data,_.mode)),x},[])},t.fromString=function(w,x){const _=g(w,s.isKanjiModeEnabled()),E=y(_),N=f(E,x),T=l.find_path(N.map,"start","end"),R=[];for(let z=1;z<T.length-1;z++)R.push(N.table[T[z]].node);return t.fromArray(d(R))},t.rawSplit=function(w){return t.fromArray(g(w,s.isKanjiModeEnabled()))}}(Tn)),Tn}var eo;function ba(){if(eo)return yn;eo=1;const t=se(),n=rr(),e=ea(),r=na(),i=ra(),o=oa(),a=ia(),s=ni(),l=la(),u=ca(),c=da(),g=ae(),m=ga();function d(N,T){const R=N.size,z=o.getPositions(T);for(let F=0;F<z.length;F++){const Y=z[F][0],C=z[F][1];for(let k=-1;k<=7;k++)if(!(Y+k<=-1||R<=Y+k))for(let p=-1;p<=7;p++)C+p<=-1||R<=C+p||(k>=0&&k<=6&&(p===0||p===6)||p>=0&&p<=6&&(k===0||k===6)||k>=2&&k<=4&&p>=2&&p<=4?N.set(Y+k,C+p,!0,!0):N.set(Y+k,C+p,!1,!0))}}function y(N){const T=N.size;for(let R=8;R<T-8;R++){const z=R%2===0;N.set(R,6,z,!0),N.set(6,R,z,!0)}}function f(N,T){const R=i.getPositions(T);for(let z=0;z<R.length;z++){const F=R[z][0],Y=R[z][1];for(let C=-2;C<=2;C++)for(let k=-2;k<=2;k++)C===-2||C===2||k===-2||k===2||C===0&&k===0?N.set(F+C,Y+k,!0,!0):N.set(F+C,Y+k,!1,!0)}}function v(N,T){const R=N.size,z=u.getEncodedBits(T);let F,Y,C;for(let k=0;k<18;k++)F=Math.floor(k/3),Y=k%3+R-8-3,C=(z>>k&1)===1,N.set(F,Y,C,!0),N.set(Y,F,C,!0)}function b(N,T,R){const z=N.size,F=c.getEncodedBits(T,R);let Y,C;for(Y=0;Y<15;Y++)C=(F>>Y&1)===1,Y<6?N.set(Y,8,C,!0):Y<8?N.set(Y+1,8,C,!0):N.set(z-15+Y,8,C,!0),Y<8?N.set(8,z-Y-1,C,!0):Y<9?N.set(8,15-Y-1+1,C,!0):N.set(8,15-Y-1,C,!0);N.set(z-8,8,1,!0)}function w(N,T){const R=N.size;let z=-1,F=R-1,Y=7,C=0;for(let k=R-1;k>0;k-=2)for(k===6&&k--;;){for(let p=0;p<2;p++)if(!N.isReserved(F,k-p)){let q=!1;C<T.length&&(q=(T[C]>>>Y&1)===1),N.set(F,k-p,q),Y--,Y===-1&&(C++,Y=7)}if(F+=z,F<0||R<=F){F-=z,z=-z;break}}}function x(N,T,R){const z=new e;R.forEach(function(p){z.put(p.mode.bit,4),z.put(p.getLength(),g.getCharCountIndicator(p.mode,N)),p.write(z)});const F=t.getSymbolTotalCodewords(N),Y=s.getTotalCodewordsCount(N,T),C=(F-Y)*8;for(z.getLengthInBits()+4<=C&&z.put(0,4);z.getLengthInBits()%8!==0;)z.putBit(0);const k=(C-z.getLengthInBits())/8;for(let p=0;p<k;p++)z.put(p%2?17:236,8);return _(z,N,T)}function _(N,T,R){const z=t.getSymbolTotalCodewords(T),F=s.getTotalCodewordsCount(T,R),Y=z-F,C=s.getBlocksCount(T,R),k=z%C,p=C-k,q=Math.floor(z/C),L=Math.floor(Y/C),D=L+1,G=q-L,M=new l(G);let W=0;const B=new Array(C),P=new Array(C);let Q=0;const K=new Uint8Array(N.buffer);for(let rt=0;rt<C;rt++){const J=rt<p?L:D;B[rt]=K.slice(W,W+J),P[rt]=M.encode(B[rt]),W+=J,Q=Math.max(Q,J)}const Z=new Uint8Array(z);let ct=0,it,nt;for(it=0;it<Q;it++)for(nt=0;nt<C;nt++)it<B[nt].length&&(Z[ct++]=B[nt][it]);for(it=0;it<G;it++)for(nt=0;nt<C;nt++)Z[ct++]=P[nt][it];return Z}function E(N,T,R,z){let F;if(Array.isArray(N))F=m.fromArray(N);else if(typeof N=="string"){let q=T;if(!q){const L=m.rawSplit(N);q=u.getBestVersionForData(L,R)}F=m.fromString(N,q||40)}else throw new Error("Invalid data");const Y=u.getBestVersionForData(F,R);if(!Y)throw new Error("The amount of data is too big to be stored in a QR Code");if(!T)T=Y;else if(T<Y)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+Y+`.
`);const C=x(T,R,F),k=t.getSymbolSize(T),p=new r(k);return d(p,T),y(p),f(p,T),b(p,R,0),T>=7&&v(p,T),w(p,C),isNaN(z)&&(z=a.getBestMask(p,b.bind(null,p,R))),a.applyMask(z,p),b(p,R,z),{modules:p,version:T,errorCorrectionLevel:R,maskPattern:z,segments:F}}return yn.create=function(T,R){if(typeof T>"u"||T==="")throw new Error("No input text");let z=n.M,F,Y;return typeof R<"u"&&(z=n.from(R.errorCorrectionLevel,n.M),F=u.from(R.version),Y=a.from(R.maskPattern),R.toSJISFunc&&t.setToSJISFunction(R.toSJISFunc)),E(T,F,z,Y)},yn}var Bn={},Pn={},no;function ii(){return no||(no=1,function(t){function n(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let r=e.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+e);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(o){return[o,o]}))),r.length===6&&r.push("F","F");const i=parseInt(r.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+r.slice(0,6).join("")}}t.getOptions=function(r){r||(r={}),r.color||(r.color={});const i=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,o=r.width&&r.width>=21?r.width:void 0,a=r.scale||4;return{width:o,scale:o?4:a,margin:i,color:{dark:n(r.color.dark||"#000000ff"),light:n(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},t.getScale=function(r,i){return i.width&&i.width>=r+i.margin*2?i.width/(r+i.margin*2):i.scale},t.getImageWidth=function(r,i){const o=t.getScale(r,i);return Math.floor((r+i.margin*2)*o)},t.qrToImageData=function(r,i,o){const a=i.modules.size,s=i.modules.data,l=t.getScale(a,o),u=Math.floor((a+o.margin*2)*l),c=o.margin*l,g=[o.color.light,o.color.dark];for(let m=0;m<u;m++)for(let d=0;d<u;d++){let y=(m*u+d)*4,f=o.color.light;if(m>=c&&d>=c&&m<u-c&&d<u-c){const v=Math.floor((m-c)/l),b=Math.floor((d-c)/l);f=g[s[v*a+b]?1:0]}r[y++]=f.r,r[y++]=f.g,r[y++]=f.b,r[y]=f.a}}}(Pn)),Pn}var ro;function ya(){return ro||(ro=1,function(t){const n=ii();function e(i,o,a){i.clearRect(0,0,o.width,o.height),o.style||(o.style={}),o.height=a,o.width=a,o.style.height=a+"px",o.style.width=a+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(o,a,s){let l=s,u=a;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),a||(u=r()),l=n.getOptions(l);const c=n.getImageWidth(o.modules.size,l),g=u.getContext("2d"),m=g.createImageData(c,c);return n.qrToImageData(m.data,o,l),e(g,u,c),g.putImageData(m,0,0),u},t.renderToDataURL=function(o,a,s){let l=s;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),l||(l={});const u=t.render(o,a,l),c=l.type||"image/png",g=l.rendererOpts||{};return u.toDataURL(c,g.quality)}}(Bn)),Bn}var On={},oo;function va(){if(oo)return On;oo=1;const t=ii();function n(i,o){const a=i.a/255,s=o+'="'+i.hex+'"';return a<1?s+" "+o+'-opacity="'+a.toFixed(2).slice(1)+'"':s}function e(i,o,a){let s=i+o;return typeof a<"u"&&(s+=" "+a),s}function r(i,o,a){let s="",l=0,u=!1,c=0;for(let g=0;g<i.length;g++){const m=Math.floor(g%o),d=Math.floor(g/o);!m&&!u&&(u=!0),i[g]?(c++,g>0&&m>0&&i[g-1]||(s+=u?e("M",m+a,.5+d+a):e("m",l,0),l=0,u=!1),m+1<o&&i[g+1]||(s+=e("h",c),c=0)):l++}return s}return On.render=function(o,a,s){const l=t.getOptions(a),u=o.modules.size,c=o.modules.data,g=u+l.margin*2,m=l.color.light.a?"<path "+n(l.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",d="<path "+n(l.color.dark,"stroke")+' d="'+r(c,u,l.margin)+'"/>',y='viewBox="0 0 '+g+" "+g+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+y+' shape-rendering="crispEdges">'+m+d+`</svg>
`;return typeof s=="function"&&s(null,v),v},On}var io;function wa(){if(io)return ue;io=1;const t=ta(),n=ba(),e=ya(),r=va();function i(o,a,s,l,u){const c=[].slice.call(arguments,1),g=c.length,m=typeof c[g-1]=="function";if(!m&&!t())throw new Error("Callback required as last argument");if(m){if(g<2)throw new Error("Too few arguments provided");g===2?(u=s,s=a,a=l=void 0):g===3&&(a.getContext&&typeof u>"u"?(u=l,l=void 0):(u=l,l=s,s=a,a=void 0))}else{if(g<1)throw new Error("Too few arguments provided");return g===1?(s=a,a=l=void 0):g===2&&!a.getContext&&(l=s,s=a,a=void 0),new Promise(function(d,y){try{const f=n.create(s,l);d(o(f,a,l))}catch(f){y(f)}})}try{const d=n.create(s,l);u(null,o(d,a,l))}catch(d){u(d)}}return ue.create=n.create,ue.toCanvas=i.bind(null,e.render),ue.toDataURL=i.bind(null,e.renderToDataURL),ue.toString=i.bind(null,function(o,a,s){return r.render(o,s)}),ue}var xa=wa();const _a=_o(xa);async function De(t,n=512,e=1){const r={errorCorrectionLevel:"M",type:"image/png",margin:e,width:n,color:{dark:"#000000",light:"#ffffff"}};return _a.toDataURL(t,r)}const tn=(()=>{const t=bt.get().DEFAULTS?.BACKGROUND;return{color:typeof t?.color=="string"?t.color:"#ffffff",alpha:Math.max(0,Math.min(1,typeof t?.alpha=="number"?t.alpha:1))}})(),ge={scale:1,tx:0,ty:0},Fn=(t,n,e)=>Math.max(n,Math.min(e,t)),$t=(t,n)=>typeof t=="number"?t:n;function ka(t){return new Promise((n,e)=>{const r=new Image;r.onload=()=>n({w:r.naturalWidth,h:r.naturalHeight}),r.onerror=e,r.src=t})}function Ca(t,n,e,r,i,o,a=1){const s=e/t,l=e/n,u=Math.min(s,l)*a,c=t*u,g=n*u,m=i==="left"?0:i==="right"?e-c:(e-c)/2,d=o==="top"?0:o==="bottom"?e-g:(e-g)/2,y=(m-(e-c)/2)/e*100,f=(d-(e-g)/2)/e*100;return{tx:Math.max(-100,Math.min(100,y)),ty:Math.max(-100,Math.min(100,f))}}const gt=ko((t,n)=>({photos:[],max:ti,fitModeByPhoto:{},setFitMode:(e,r)=>t(i=>({fitModeByPhoto:{...i.fitModeByPhoto,[e]:r}})),transforms:{},layersByPhoto:{},cardBackground:{},setCardBackground:(e,r)=>t(i=>{const o=i.cardBackground[e]??tn,a={color:r.color??o.color,alpha:Math.max(0,Math.min(1,r.alpha??o.alpha))};return{cardBackground:{...i.cardBackground,[e]:a}}}),setTransform:(e,r)=>t(i=>{const o=i.transforms[e]??ge,a={scale:Fn(r.scale??o.scale,.5,4),...r.scaleAbs!=null?{scaleAbs:Math.max(1e-4,r.scaleAbs)}:o.scaleAbs!=null?{scaleAbs:o.scaleAbs}:{},tx:Fn(r.tx??o.tx,-100,100),ty:Fn(r.ty??o.ty,-100,100)};return{transforms:{...i.transforms,[e]:a}}}),resetTransform:e=>t(r=>{const{[e]:i,...o}=r.transforms;return{transforms:o}}),add:(e,r)=>{if(!e?.length)return;const{photos:i,max:o}=n(),a=Math.max(0,o-i.length);if(a<=0){alert(`Достигнут лимит коллекции: ${o} карточек.`);return}let s=e;if(e.length>a&&(alert(`Можно добавить только ${a} из ${e.length} — лимит коллекции ${o}.`),s=e.slice(0,a)),t({photos:[...i,...s]}),r?.skipInit)return;r?.skipInit||t(u=>{const c={...u.fitModeByPhoto};for(const g of s)c[g.id]==null&&(c[g.id]=Tr);return{fitModeByPhoto:c}});const l=bt.get().DEFAULT_CARD_LAYERS??[];if(l.length){for(const u of s)for(const c of l)if(c?.type==="text"){const g=$t(c.y,It-140);n().addTextLayer(u.id,{x:typeof c.x=="number"?c.x:40,y:g,text:typeof c.text=="string"?c.text:void 0,fontFamily:typeof c.fontFamily=="string"?c.fontFamily:void 0,fontSize:typeof c.fontSize=="number"?c.fontSize:void 0,fontStyle:typeof c.fontStyle=="string"?c.fontStyle:void 0,fill:typeof c.fill=="string"?c.fill:void 0,align:["left","center","right"].includes(c.align)?c.align:void 0,lineHeight:typeof c.lineHeight=="number"?c.lineHeight:void 0,letterSpacing:typeof c.letterSpacing=="number"?c.letterSpacing:void 0,width:typeof c.width=="number"?c.width:void 0,rotation:typeof c.rotation=="number"?c.rotation:void 0,name:typeof c.name=="string"?c.name:void 0})}else if(c?.type==="rect"){const g=$t(c.y,40);n().addRectLayer(u.id,{x:typeof c.x=="number"?c.x:40,y:g,width:typeof c.width=="number"?c.width:void 0,height:typeof c.height=="number"?c.height:void 0,fill:typeof c.fill=="string"?c.fill:void 0,stroke:typeof c.stroke=="string"?c.stroke:void 0,strokeWidth:typeof c.strokeWidth=="number"?c.strokeWidth:void 0,cornerRadius:typeof c.cornerRadius=="number"?c.cornerRadius:void 0,opacity:typeof c.opacity=="number"?c.opacity:void 0,rotation:typeof c.rotation=="number"?c.rotation:void 0,name:typeof c.name=="string"?c.name:void 0})}else if(c?.type==="qr"){const g=$t(c.y,40),m=Math.max(1,Math.round(typeof c.size=="number"?c.size:512));(async()=>{const d=await n().addQrLayer(u.id,typeof c.text=="string"?c.text:"",m);n().updateLayer(u.id,d,{x:typeof c.x=="number"?c.x:40,y:g,name:typeof c.name=="string"?c.name:void 0})})()}}for(const u of s)(async()=>{try{const{w:c,h:g}=await ka(u.url),m=bt.get(),d=Math.max(0,Number(m.NEAR_SQUARE_TOLERANCE??0)),y=Number(m.NEAR_SQUARE_SCALE??1),f=It,v=f/c,b=f/g,w=Math.min(v,b),x=Math.max(v,b),_=Tr==="contain",E=c/g,N=Math.abs(E-1)<=d;let T=1;_?T=N?y:1:T=x/w;const{tx:R,ty:z}=Ca(c,g,f,"contain",Js,Qs,T);n().setTransform(u.id,{tx:R,ty:z,scale:Math.max(.5,Math.min(4,ge.scale*T))});const F=bt.get().LAYER_PROFILES?.orientation;if(F&&F.on!==!1){let Y;E>1+d?Y="landscape":E<1-d?Y="portrait":Y="square";const C=Y==="landscape"?F.landscape??[]:Y==="portrait"?F.portrait??[]:F.square??[];for(const k of C)if(!(!k||typeof k!="object")){if(k.type==="text"){const p=$t(k.y,It-140);n().addTextLayer(u.id,{x:typeof k.x=="number"?k.x:40,y:p,text:typeof k.text=="string"?k.text:void 0,fontFamily:typeof k.fontFamily=="string"?k.fontFamily:void 0,fontSize:typeof k.fontSize=="number"?k.fontSize:void 0,fontStyle:typeof k.fontStyle=="string"?k.fontStyle:void 0,fill:typeof k.fill=="string"?k.fill:void 0,align:["left","center","right"].includes(k.align)?k.align:void 0,lineHeight:typeof k.lineHeight=="number"?k.lineHeight:void 0,letterSpacing:typeof k.letterSpacing=="number"?k.letterSpacing:void 0,width:typeof k.width=="number"?k.width:void 0,rotation:typeof k.rotation=="number"?k.rotation:void 0,name:typeof k.name=="string"?k.name:void 0})}else if(k.type==="rect"){const p=$t(k.y,40);n().addRectLayer(u.id,{x:typeof k.x=="number"?k.x:40,y:p,width:typeof k.width=="number"?k.width:void 0,height:typeof k.height=="number"?k.height:void 0,fill:typeof k.fill=="string"?k.fill:void 0,stroke:typeof k.stroke=="string"?k.stroke:void 0,strokeWidth:typeof k.strokeWidth=="number"?k.strokeWidth:void 0,cornerRadius:typeof k.cornerRadius=="number"?k.cornerRadius:void 0,opacity:typeof k.opacity=="number"?k.opacity:void 0,rotation:typeof k.rotation=="number"?k.rotation:void 0,name:typeof k.name=="string"?k.name:void 0})}else if(k.type==="qr"){const p=$t(k.y,40),q=Math.max(1,Math.round(typeof k.size=="number"?k.size:512)),L=await n().addQrLayer(u.id,typeof k.text=="string"?k.text:"",q);n().updateLayer(u.id,L,{x:typeof k.x=="number"?k.x:40,y:p,rotation:typeof k.rotation=="number"?k.rotation:void 0,name:typeof k.name=="string"?k.name:void 0})}}}}catch{}})()},clear:()=>{const e=n().photos;e.length&&Nr(e),t({photos:[],transforms:{},layersByPhoto:{},cardBackground:{},fitModeByPhoto:{}})},remove:e=>t(r=>{const i=r.photos.findIndex(u=>u.id===e);if(i===-1)return null;Nr([r.photos[i]]);const{[e]:o,...a}=r.transforms,s={...r.layersByPhoto};delete s[e];const l={...r.fitModeByPhoto};return delete l[e],{photos:r.photos.filter(u=>u.id!==e),transforms:a,layersByPhoto:s,fitModeByPhoto:l}}),addTextLayer:(e,r={})=>{const i=crypto.randomUUID();return t(o=>{const a=o.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const u=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=bt.get().DEFAULTS?.TEXT??{},g=$t(c.y,It-140),m=u??g,d={id:i,type:"text",x:typeof c.x=="number"?c.x:40,y:m,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,text:typeof c.text=="string"?c.text:"New text",fontFamily:typeof c.fontFamily=="string"?c.fontFamily:"Georgia, serif",fontSize:typeof c.fontSize=="number"?c.fontSize:36,fontStyle:typeof c.fontStyle=="string"?c.fontStyle:"",fill:typeof c.fill=="string"?c.fill:"#111",align:["left","center","right"].includes(c.align)?c.align:"left",verticalAlign:["top","middle","bottom"].includes(c.verticalAlign)?c.verticalAlign:"top",padding:typeof c.padding=="number"?c.padding:0,lineHeight:typeof c.lineHeight=="number"?c.lineHeight:1.25,letterSpacing:typeof c.letterSpacing=="number"?c.letterSpacing:0,width:typeof c.width=="number"?c.width:void 0,...l};return{layersByPhoto:{...o.layersByPhoto,[e]:[...a,d]}}}),i},addRectLayer:(e,r={})=>{const i=crypto.randomUUID();return t(o=>{const a=o.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const u=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=bt.get().DEFAULTS?.RECT??{},g=$t(c.y,40),m=u??g,d={id:i,type:"rect",x:typeof c.x=="number"?c.x:40,y:m,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,width:typeof c.width=="number"?c.width:600,height:typeof c.height=="number"?c.height:300,fill:typeof c.fill=="string"?c.fill:"#ffffff",stroke:typeof c.stroke=="string"?c.stroke:void 0,strokeWidth:typeof c.strokeWidth=="number"?c.strokeWidth:0,cornerRadius:typeof c.cornerRadius=="number"?c.cornerRadius:0,opacity:typeof c.opacity=="number"?c.opacity:1,...l};return{layersByPhoto:{...o.layersByPhoto,[e]:[...a,d]}}}),i},addImageLayer:(e,r={})=>{const i=crypto.randomUUID();return t(o=>{const a=o.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const u=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=bt.get().DEFAULTS?.IMAGE??{},g=$t(c.y,40),m=u??g,d={id:i,type:"image",x:typeof c.x=="number"?c.x:40,y:m,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,src:"",w:typeof c.w=="number"?c.w:void 0,h:typeof c.h=="number"?c.h:void 0,...l};return{layersByPhoto:{...o.layersByPhoto,[e]:[...a,d]}}}),i},addQrLayer:async(e,r,i=512)=>{const o=bt.get().DEFAULTS?.QR??{},a=Math.max(1,Math.round(typeof i=="number"?i:o.size??512)),s=await De(r,a,1);return n().addImageLayer(e,{src:s,x:typeof o.x=="number"?o.x:40,y:typeof o.y=="number"?o.y:40,w:a,h:a,qrText:r})},updateQrLayer:async(e,r,i)=>{const a=n().layersByPhoto[e]??[],s=a.findIndex(m=>m.id===r&&m.type==="image");if(s===-1)return;const l=a[s];if(!l.qrText&&!i.text)return;const u=i.text??l.qrText??"",c=Math.max(1,Math.round(i.size??l.w??l.h??512)),g=await De(u,c,1);n().updateLayer(e,r,{src:g,w:c,h:c,...u?{qrText:u}:{}})},updateLayer:(e,r,i)=>t(o=>{const a=o.layersByPhoto[e]??[],s=a.findIndex(m=>m.id===r);if(s===-1)return null;const l=a[s],u={...i};delete u.id,delete u.type;const c={...l,...u},g=[...a];return g[s]=c,{layersByPhoto:{...o.layersByPhoto,[e]:g}}}),removeLayer:(e,r)=>t(i=>{const o=i.layersByPhoto[e]??[],a=o.filter(s=>s.id!==r);return a===o?null:{layersByPhoto:{...i.layersByPhoto,[e]:a}}}),bringToFront:(e,r)=>t(i=>{const o=i.layersByPhoto[e]??[];if(!o.length)return null;const a=Math.max(...o.map(l=>l.z)),s=o.map(l=>l.id===r?{...l,z:a+1}:l);return{layersByPhoto:{...i.layersByPhoto,[e]:s}}}),sendToBack:(e,r)=>t(i=>{const o=i.layersByPhoto[e]??[];if(!o.length)return null;const a=Math.min(...o.map(l=>l.z)),s=o.map(l=>l.id===r?{...l,z:a-1}:l);return{layersByPhoto:{...i.layersByPhoto,[e]:s}}}),setLayersOrder:(e,r)=>t(i=>{const o=i.layersByPhoto[e]??[];if(!o.length)return null;const a=new Map(o.map(u=>[u.id,u])),s=[];let l=1;for(const u of r){const c=a.get(u);c&&s.push({...c,z:l++})}for(const u of o)r.includes(u.id)||s.push({...u,z:l++});return{layersByPhoto:{...i.layersByPhoto,[e]:s}}}),reorderPhotos:e=>t(r=>{if(!Array.isArray(e)||!e.length)return null;const i=new Map(r.photos.map(a=>[a.id,a])),o=e.map(a=>i.get(a)).filter(Boolean);for(const a of r.photos)e.includes(a.id)||o.push(a);return{photos:o}})}));function Ea(t){const n=t.replace(/^\uFEFF/,"").replace(/\r\n?/g,`
`).split(`
`).filter(Boolean);if(!n.length)return{rows:[],hasRelative:!1};const e=n[0].toLowerCase(),r=e.includes(";")&&!e.includes(",")?";":",",i=new RegExp(`\\s*(?:"([^"]*)"|([^${r}\\n]*))\\s*(?:${r}|$)`,"g");function o(u){const c=u.toLowerCase();switch(c){case"fontsize":return"fontSize";case"fontstyle":return"fontStyle";case"lineheight":return"lineHeight";case"letterspacing":return"letterSpacing";default:return c}}let a=null;{const u=n[0].toLowerCase();if(/\burl\b/.test(u)){i.lastIndex=0;const c=[];let g;for(;g=i.exec(n[0]);){const m=g[1]??g[2]??"",d=(g[1]?m.replace(/""/g,'"'):m).trim();if(d&&c.push(d),g.index+g[0].length>=n[0].length)break}c.map(m=>m.toLowerCase()).includes("url")&&(a=c)}}const s=[];for(let u=0;u<n.length;u++){const c=n[u];if(!c.trim()||u===0&&a)continue;const g=[];i.lastIndex=0;let m,d=0;for(;(m=i.exec(c))&&d++<1e3;){const w=m[1]??m[2]??"",x=(m[1]?w.replace(/""/g,'"'):w).trim();if(g.push(x),m.index+m[0].length>=c.length)break}if(!g.length)continue;if(!a){const w=(g[0]??"").trim();if(!w)continue;const x=(g[1]??"").trim()||void 0;s.push({url:w,caption:x});continue}const y={};a.forEach((w,x)=>y[w.trim().toLowerCase()]=g[x]??"");const f=(y.url??"").trim();if(!f)continue;const v=(y.caption??"").trim()||void 0,b={};for(const[w,x]of Object.entries(y)){const _=x?.trim(),E=/^layer_([^_]+)_(.+)$/i.exec(w.trim());if(E&&_){const N=`layer_${E[1]}`.toLowerCase(),T=o(E[2]);b[N]||(b[N]={}),b[N][T]=_}}s.push({url:f,caption:v,layers:Object.keys(b).length?b:void 0})}const l=s.some(u=>Sa(u.url));return{rows:s,hasRelative:l}}function si(t){return/^https?:\/\//i.test(t)}function ai(t){return/^data:/i.test(t)}function Sa(t){return!(si(t)||ai(t)||/^blob:/.test(t))}function He(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Un={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var so;function Ra(){return so||(so=1,function(t,n){(function(e){t.exports=e()})(function(){return function e(r,i,o){function a(u,c){if(!i[u]){if(!r[u]){var g=typeof He=="function"&&He;if(!c&&g)return g(u,!0);if(s)return s(u,!0);var m=new Error("Cannot find module '"+u+"'");throw m.code="MODULE_NOT_FOUND",m}var d=i[u]={exports:{}};r[u][0].call(d.exports,function(y){var f=r[u][1][y];return a(f||y)},d,d.exports,e,r,i,o)}return i[u].exports}for(var s=typeof He=="function"&&He,l=0;l<o.length;l++)a(o[l]);return a}({1:[function(e,r,i){var o=e("./utils"),a=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var u,c,g,m,d,y,f,v=[],b=0,w=l.length,x=w,_=o.getTypeOf(l)!=="string";b<l.length;)x=w-b,g=_?(u=l[b++],c=b<w?l[b++]:0,b<w?l[b++]:0):(u=l.charCodeAt(b++),c=b<w?l.charCodeAt(b++):0,b<w?l.charCodeAt(b++):0),m=u>>2,d=(3&u)<<4|c>>4,y=1<x?(15&c)<<2|g>>6:64,f=2<x?63&g:64,v.push(s.charAt(m)+s.charAt(d)+s.charAt(y)+s.charAt(f));return v.join("")},i.decode=function(l){var u,c,g,m,d,y,f=0,v=0,b="data:";if(l.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var w,x=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&x--,l.charAt(l.length-2)===s.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=a.uint8array?new Uint8Array(0|x):new Array(0|x);f<l.length;)u=s.indexOf(l.charAt(f++))<<2|(m=s.indexOf(l.charAt(f++)))>>4,c=(15&m)<<4|(d=s.indexOf(l.charAt(f++)))>>2,g=(3&d)<<6|(y=s.indexOf(l.charAt(f++))),w[v++]=u,d!==64&&(w[v++]=c),y!==64&&(w[v++]=g);return w}},{"./support":30,"./utils":32}],2:[function(e,r,i){var o=e("./external"),a=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function u(c,g,m,d,y){this.compressedSize=c,this.uncompressedSize=g,this.crc32=m,this.compression=d,this.compressedContent=y}u.prototype={getContentWorker:function(){var c=new a(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),g=this;return c.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new a(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,g,m){return c.pipe(new s).pipe(new l("uncompressedSize")).pipe(g.compressWorker(m)).pipe(new l("compressedSize")).withStreamInfo("compression",g)},r.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,i){var o=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,i){var o=e("./utils"),a=function(){for(var s,l=[],u=0;u<256;u++){s=u;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;l[u]=s}return l}();r.exports=function(s,l){return s!==void 0&&s.length?o.getTypeOf(s)!=="string"?function(u,c,g,m){var d=a,y=m+g;u^=-1;for(var f=m;f<y;f++)u=u>>>8^d[255&(u^c[f])];return-1^u}(0|l,s,s.length,0):function(u,c,g,m){var d=a,y=m+g;u^=-1;for(var f=m;f<y;f++)u=u>>>8^d[255&(u^c.charCodeAt(f))];return-1^u}(0|l,s,s.length,0):0}},{"./utils":32}],5:[function(e,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,r,i){var o=null;o=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:o}},{lie:37}],7:[function(e,r,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=e("pako"),s=e("./utils"),l=e("./stream/GenericWorker"),u=o?"uint8array":"array";function c(g,m){l.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=m,this.meta={}}i.magic="\b\0",s.inherits(c,l),c.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(u,g.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(m){g.push({data:m,meta:g.meta})}},i.compressWorker=function(g){return new c("Deflate",g)},i.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,i){function o(d,y){var f,v="";for(f=0;f<y;f++)v+=String.fromCharCode(255&d),d>>>=8;return v}function a(d,y,f,v,b,w){var x,_,E=d.file,N=d.compression,T=w!==u.utf8encode,R=s.transformTo("string",w(E.name)),z=s.transformTo("string",u.utf8encode(E.name)),F=E.comment,Y=s.transformTo("string",w(F)),C=s.transformTo("string",u.utf8encode(F)),k=z.length!==E.name.length,p=C.length!==F.length,q="",L="",D="",G=E.dir,M=E.date,W={crc32:0,compressedSize:0,uncompressedSize:0};y&&!f||(W.crc32=d.crc32,W.compressedSize=d.compressedSize,W.uncompressedSize=d.uncompressedSize);var B=0;y&&(B|=8),T||!k&&!p||(B|=2048);var P=0,Q=0;G&&(P|=16),b==="UNIX"?(Q=798,P|=function(Z,ct){var it=Z;return Z||(it=ct?16893:33204),(65535&it)<<16}(E.unixPermissions,G)):(Q=20,P|=function(Z){return 63&(Z||0)}(E.dosPermissions)),x=M.getUTCHours(),x<<=6,x|=M.getUTCMinutes(),x<<=5,x|=M.getUTCSeconds()/2,_=M.getUTCFullYear()-1980,_<<=4,_|=M.getUTCMonth()+1,_<<=5,_|=M.getUTCDate(),k&&(L=o(1,1)+o(c(R),4)+z,q+="up"+o(L.length,2)+L),p&&(D=o(1,1)+o(c(Y),4)+C,q+="uc"+o(D.length,2)+D);var K="";return K+=`
\0`,K+=o(B,2),K+=N.magic,K+=o(x,2),K+=o(_,2),K+=o(W.crc32,4),K+=o(W.compressedSize,4),K+=o(W.uncompressedSize,4),K+=o(R.length,2),K+=o(q.length,2),{fileRecord:g.LOCAL_FILE_HEADER+K+R+q,dirRecord:g.CENTRAL_FILE_HEADER+o(Q,2)+K+o(Y.length,2)+"\0\0\0\0"+o(P,4)+o(v,4)+R+q+Y}}var s=e("../utils"),l=e("../stream/GenericWorker"),u=e("../utf8"),c=e("../crc32"),g=e("../signature");function m(d,y,f,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=f,this.encodeFileName=v,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(m,l),m.prototype.push=function(d){var y=d.meta.percent||0,f=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,l.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:f?(y+100*(f-v-1))/f:100}}))},m.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var y=this.streamFiles&&!d.file.dir;if(y){var f=a(d,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(d){this.accumulate=!1;var y=this.streamFiles&&!d.file.dir,f=a(d,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),y)this.push({data:function(v){return g.DATA_DESCRIPTOR+o(v.crc32,4)+o(v.compressedSize,4)+o(v.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var d=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var f=this.bytesWritten-d,v=function(b,w,x,_,E){var N=s.transformTo("string",E(_));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(b,2)+o(b,2)+o(w,4)+o(x,4)+o(N.length,2)+N}(this.dirRecords.length,f,d,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(d){this._sources.push(d);var y=this;return d.on("data",function(f){y.processChunk(f)}),d.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),d.on("error",function(f){y.error(f)}),this},m.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(d){var y=this._sources;if(!l.prototype.error.call(this,d))return!1;for(var f=0;f<y.length;f++)try{y[f].error(d)}catch{}return!0},m.prototype.lock=function(){l.prototype.lock.call(this);for(var d=this._sources,y=0;y<d.length;y++)d[y].lock()},r.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,i){var o=e("../compressions"),a=e("./ZipFileWorker");i.generateWorker=function(s,l,u){var c=new a(l.streamFiles,u,l.platform,l.encodeFileName),g=0;try{s.forEach(function(m,d){g++;var y=function(w,x){var _=w||x,E=o[_];if(!E)throw new Error(_+" is not a valid compression method !");return E}(d.options.compression,l.compression),f=d.options.compressionOptions||l.compressionOptions||{},v=d.dir,b=d.date;d._compressWorker(y,f).withStreamInfo("file",{name:m,dir:v,date:b,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(c)}),c.entriesCount=g}catch(m){c.error(m)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,i){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new o;for(var s in this)typeof this[s]!="function"&&(a[s]=this[s]);return a}}(o.prototype=e("./object")).loadAsync=e("./load"),o.support=e("./support"),o.defaults=e("./defaults"),o.version="3.10.1",o.loadAsync=function(a,s){return new o().loadAsync(a,s)},o.external=e("./external"),r.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,i){var o=e("./utils"),a=e("./external"),s=e("./utf8"),l=e("./zipEntries"),u=e("./stream/Crc32Probe"),c=e("./nodejsUtils");function g(m){return new a.Promise(function(d,y){var f=m.decompressed.getContentWorker().pipe(new u);f.on("error",function(v){y(v)}).on("end",function(){f.streamInfo.crc32!==m.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}r.exports=function(m,d){var y=this;return d=o.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),c.isNode&&c.isStream(m)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",m,!0,d.optimizedBinaryString,d.base64).then(function(f){var v=new l(d);return v.load(f),v}).then(function(f){var v=[a.Promise.resolve(f)],b=f.files;if(d.checkCRC32)for(var w=0;w<b.length;w++)v.push(g(b[w]));return a.Promise.all(v)}).then(function(f){for(var v=f.shift(),b=v.files,w=0;w<b.length;w++){var x=b[w],_=x.fileNameStr,E=o.resolve(x.fileNameStr);y.file(E,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:d.createFolders}),x.dir||(y.file(E).unsafeOriginalName=_)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,i){var o=e("../utils"),a=e("../stream/GenericWorker");function s(l,u){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}o.inherits(s,a),s.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,i){var o=e("readable-stream").Readable;function a(s,l,u){o.call(this,l),this._helper=s;var c=this;s.on("data",function(g,m){c.push(g)||c._helper.pause(),u&&u(m)}).on("error",function(g){c.emit("error",g)}).on("end",function(){c.push(null)})}e("../utils").inherits(a,o),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,a);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,a)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var a=new Buffer(o);return a.fill(0),a},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(e,r,i){function o(E,N,T){var R,z=s.getTypeOf(N),F=s.extend(T||{},c);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(E=b(E)),F.createFolders&&(R=v(E))&&w.call(this,R,!0);var Y=z==="string"&&F.binary===!1&&F.base64===!1;T&&T.binary!==void 0||(F.binary=!Y),(N instanceof g&&N.uncompressedSize===0||F.dir||!N||N.length===0)&&(F.base64=!1,F.binary=!0,N="",F.compression="STORE",z="string");var C=null;C=N instanceof g||N instanceof l?N:y.isNode&&y.isStream(N)?new f(E,N):s.prepareContent(E,N,F.binary,F.optimizedBinaryString,F.base64);var k=new m(E,C,F);this.files[E]=k}var a=e("./utf8"),s=e("./utils"),l=e("./stream/GenericWorker"),u=e("./stream/StreamHelper"),c=e("./defaults"),g=e("./compressedObject"),m=e("./zipObject"),d=e("./generate"),y=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),v=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var N=E.lastIndexOf("/");return 0<N?E.substring(0,N):""},b=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},w=function(E,N){return N=N!==void 0?N:c.createFolders,E=b(E),this.files[E]||o.call(this,E,null,{dir:!0,createFolders:N}),this.files[E]};function x(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var N,T,R;for(N in this.files)R=this.files[N],(T=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&E(T,R)},filter:function(E){var N=[];return this.forEach(function(T,R){E(T,R)&&N.push(R)}),N},file:function(E,N,T){if(arguments.length!==1)return E=this.root+E,o.call(this,E,N,T),this;if(x(E)){var R=E;return this.filter(function(F,Y){return!Y.dir&&R.test(F)})}var z=this.files[this.root+E];return z&&!z.dir?z:null},folder:function(E){if(!E)return this;if(x(E))return this.filter(function(z,F){return F.dir&&E.test(z)});var N=this.root+E,T=w.call(this,N),R=this.clone();return R.root=T.name,R},remove:function(E){E=this.root+E;var N=this.files[E];if(N||(E.slice(-1)!=="/"&&(E+="/"),N=this.files[E]),N&&!N.dir)delete this.files[E];else for(var T=this.filter(function(z,F){return F.name.slice(0,E.length)===E}),R=0;R<T.length;R++)delete this.files[T[R].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var N,T={};try{if((T=s.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=T.type.toLowerCase(),T.compression=T.compression.toUpperCase(),T.type==="binarystring"&&(T.type="string"),!T.type)throw new Error("No output type specified.");s.checkSupport(T.type),T.platform!=="darwin"&&T.platform!=="freebsd"&&T.platform!=="linux"&&T.platform!=="sunos"||(T.platform="UNIX"),T.platform==="win32"&&(T.platform="DOS");var R=T.comment||this.comment||"";N=d.generateWorker(this,T,R)}catch(z){(N=new l("error")).error(z)}return new u(N,T.type||"string",T.mimeType)},generateAsync:function(E,N){return this.generateInternalStream(E).accumulate(N)},generateNodeStream:function(E,N){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(N)}};r.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,i){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,i){var o=e("./DataReader");function a(s){o.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}e("../utils").inherits(a,o),a.prototype.byteAt=function(s){return this.data[this.zero+s]},a.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),u=s.charCodeAt(1),c=s.charCodeAt(2),g=s.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===l&&this.data[m+1]===u&&this.data[m+2]===c&&this.data[m+3]===g)return m-this.zero;return-1},a.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),u=s.charCodeAt(1),c=s.charCodeAt(2),g=s.charCodeAt(3),m=this.readData(4);return l===m[0]&&u===m[1]&&c===m[2]&&g===m[3]},a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,r,i){var o=e("../utils");function a(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var l,u=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=s,u},readString:function(s){return o.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},r.exports=a},{"../utils":32}],19:[function(e,r,i){var o=e("./Uint8ArrayReader");function a(s){o.call(this,s)}e("../utils").inherits(a,o),a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,i){var o=e("./DataReader");function a(s){o.call(this,s)}e("../utils").inherits(a,o),a.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},a.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},a.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,r,i){var o=e("./ArrayReader");function a(s){o.call(this,s)}e("../utils").inherits(a,o),a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,i){var o=e("../utils"),a=e("../support"),s=e("./ArrayReader"),l=e("./StringReader"),u=e("./NodeBufferReader"),c=e("./Uint8ArrayReader");r.exports=function(g){var m=o.getTypeOf(g);return o.checkSupport(m),m!=="string"||a.uint8array?m==="nodebuffer"?new u(g):a.uint8array?new c(o.transformTo("uint8array",g)):new s(o.transformTo("array",g)):new l(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,i){var o=e("./GenericWorker"),a=e("../utils");function s(l){o.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(s,o),s.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,i){var o=e("./GenericWorker"),a=e("../crc32");function s(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,o),s.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,i){var o=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}o.inherits(s,a),s.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,i){var o=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){u.dataIsReady=!0,u.data=c,u.max=c&&c.length||0,u.type=o.getTypeOf(c),u.isPaused||u._tickAndRepeat()},function(c){u.error(c)})}o.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,i){function o(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,s){return this._listeners[a].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,s){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,s)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var s=this;return a.on("data",function(l){s.processChunk(l)}),a.on("end",function(){s.end()}),a.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,s){return this.extraStreamInfo[a]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=o},{}],29:[function(e,r,i){var o=e("../utils"),a=e("./ConvertWorker"),s=e("./GenericWorker"),l=e("../base64"),u=e("../support"),c=e("../external"),g=null;if(u.nodestream)try{g=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(y,f){return new c.Promise(function(v,b){var w=[],x=y._internalType,_=y._outputType,E=y._mimeType;y.on("data",function(N,T){w.push(N),f&&f(T)}).on("error",function(N){w=[],b(N)}).on("end",function(){try{var N=function(T,R,z){switch(T){case"blob":return o.newBlob(o.transformTo("arraybuffer",R),z);case"base64":return l.encode(R);default:return o.transformTo(T,R)}}(_,function(T,R){var z,F=0,Y=null,C=0;for(z=0;z<R.length;z++)C+=R[z].length;switch(T){case"string":return R.join("");case"array":return Array.prototype.concat.apply([],R);case"uint8array":for(Y=new Uint8Array(C),z=0;z<R.length;z++)Y.set(R[z],F),F+=R[z].length;return Y;case"nodebuffer":return Buffer.concat(R);default:throw new Error("concat : unsupported type '"+T+"'")}}(x,w),E);v(N)}catch(T){b(T)}w=[]}).resume()})}function d(y,f,v){var b=f;switch(f){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=f,this._mimeType=v,o.checkSupport(b),this._worker=y.pipe(new a(b)),y.lock()}catch(w){this._worker=new s("error"),this._worker.error(w)}}d.prototype={accumulate:function(y){return m(this,y)},on:function(y,f){var v=this;return y==="data"?this._worker.on(y,function(b){f.call(v,b.data,b.meta)}):this._worker.on(y,function(){o.delay(f,arguments,v)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var o=new ArrayBuffer(0);try{i.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(o),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,i){for(var o=e("./utils"),a=e("./support"),s=e("./nodejsUtils"),l=e("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;u[254]=u[254]=1;function g(){l.call(this,"utf-8 decode"),this.leftOver=null}function m(){l.call(this,"utf-8 encode")}i.utf8encode=function(d){return a.nodebuffer?s.newBufferFrom(d,"utf-8"):function(y){var f,v,b,w,x,_=y.length,E=0;for(w=0;w<_;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<_&&(64512&(b=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),w++),E+=v<128?1:v<2048?2:v<65536?3:4;for(f=a.uint8array?new Uint8Array(E):new Array(E),w=x=0;x<E;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<_&&(64512&(b=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),w++),v<128?f[x++]=v:(v<2048?f[x++]=192|v>>>6:(v<65536?f[x++]=224|v>>>12:(f[x++]=240|v>>>18,f[x++]=128|v>>>12&63),f[x++]=128|v>>>6&63),f[x++]=128|63&v);return f}(d)},i.utf8decode=function(d){return a.nodebuffer?o.transformTo("nodebuffer",d).toString("utf-8"):function(y){var f,v,b,w,x=y.length,_=new Array(2*x);for(f=v=0;f<x;)if((b=y[f++])<128)_[v++]=b;else if(4<(w=u[b]))_[v++]=65533,f+=w-1;else{for(b&=w===2?31:w===3?15:7;1<w&&f<x;)b=b<<6|63&y[f++],w--;1<w?_[v++]=65533:b<65536?_[v++]=b:(b-=65536,_[v++]=55296|b>>10&1023,_[v++]=56320|1023&b)}return _.length!==v&&(_.subarray?_=_.subarray(0,v):_.length=v),o.applyFromCharCode(_)}(d=o.transformTo(a.uint8array?"uint8array":"array",d))},o.inherits(g,l),g.prototype.processChunk=function(d){var y=o.transformTo(a.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var f=y;(y=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),y.set(f,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(w,x){var _;for((x=x||w.length)>w.length&&(x=w.length),_=x-1;0<=_&&(192&w[_])==128;)_--;return _<0||_===0?x:_+u[w[_]]>x?_:x}(y),b=y;v!==y.length&&(a.uint8array?(b=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(b=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:i.utf8decode(b),meta:d.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=g,o.inherits(m,l),m.prototype.processChunk=function(d){this.push({data:i.utf8encode(d.data),meta:d.meta})},i.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,i){var o=e("./support"),a=e("./base64"),s=e("./nodejsUtils"),l=e("./external");function u(f){return f}function c(f,v){for(var b=0;b<f.length;++b)v[b]=255&f.charCodeAt(b);return v}e("setimmediate"),i.newBlob=function(f,v){i.checkSupport("blob");try{return new Blob([f],{type:v})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(f),b.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(f,v,b){var w=[],x=0,_=f.length;if(_<=b)return String.fromCharCode.apply(null,f);for(;x<_;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,f.slice(x,Math.min(x+b,_)))):w.push(String.fromCharCode.apply(null,f.subarray(x,Math.min(x+b,_)))),x+=b;return w.join("")},stringifyByChar:function(f){for(var v="",b=0;b<f.length;b++)v+=String.fromCharCode(f[b]);return v},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function m(f){var v=65536,b=i.getTypeOf(f),w=!0;if(b==="uint8array"?w=g.applyCanBeUsed.uint8array:b==="nodebuffer"&&(w=g.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return g.stringifyByChunk(f,b,v)}catch{v=Math.floor(v/2)}return g.stringifyByChar(f)}function d(f,v){for(var b=0;b<f.length;b++)v[b]=f[b];return v}i.applyFromCharCode=m;var y={};y.string={string:u,array:function(f){return c(f,new Array(f.length))},arraybuffer:function(f){return y.string.uint8array(f).buffer},uint8array:function(f){return c(f,new Uint8Array(f.length))},nodebuffer:function(f){return c(f,s.allocBuffer(f.length))}},y.array={string:m,array:u,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(f)}},y.arraybuffer={string:function(f){return m(new Uint8Array(f))},array:function(f){return d(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:u,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(new Uint8Array(f))}},y.uint8array={string:m,array:function(f){return d(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:u,nodebuffer:function(f){return s.newBufferFrom(f)}},y.nodebuffer={string:m,array:function(f){return d(f,new Array(f.length))},arraybuffer:function(f){return y.nodebuffer.uint8array(f).buffer},uint8array:function(f){return d(f,new Uint8Array(f.length))},nodebuffer:u},i.transformTo=function(f,v){if(v=v||"",!f)return v;i.checkSupport(f);var b=i.getTypeOf(v);return y[b][f](v)},i.resolve=function(f){for(var v=f.split("/"),b=[],w=0;w<v.length;w++){var x=v[w];x==="."||x===""&&w!==0&&w!==v.length-1||(x===".."?b.pop():b.push(x))}return b.join("/")},i.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":o.nodebuffer&&s.isBuffer(f)?"nodebuffer":o.uint8array&&f instanceof Uint8Array?"uint8array":o.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(f){if(!o[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(f){var v,b,w="";for(b=0;b<(f||"").length;b++)w+="\\x"+((v=f.charCodeAt(b))<16?"0":"")+v.toString(16).toUpperCase();return w},i.delay=function(f,v,b){setImmediate(function(){f.apply(b||null,v||[])})},i.inherits=function(f,v){function b(){}b.prototype=v.prototype,f.prototype=new b},i.extend=function(){var f,v,b={};for(f=0;f<arguments.length;f++)for(v in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],v)&&b[v]===void 0&&(b[v]=arguments[f][v]);return b},i.prepareContent=function(f,v,b,w,x){return l.Promise.resolve(v).then(function(_){return o.blob&&(_ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(_))!==-1)&&typeof FileReader<"u"?new l.Promise(function(E,N){var T=new FileReader;T.onload=function(R){E(R.target.result)},T.onerror=function(R){N(R.target.error)},T.readAsArrayBuffer(_)}):_}).then(function(_){var E=i.getTypeOf(_);return E?(E==="arraybuffer"?_=i.transformTo("uint8array",_):E==="string"&&(x?_=a.decode(_):b&&w!==!0&&(_=function(N){return c(N,o.uint8array?new Uint8Array(N.length):new Array(N.length))}(_))),_):l.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,i){var o=e("./reader/readerFor"),a=e("./utils"),s=e("./signature"),l=e("./zipEntry"),u=e("./support");function c(g){this.files=[],this.loadOptions=g}c.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(m)+", expected "+a.pretty(g)+")")}},isSignature:function(g,m){var d=this.reader.index;this.reader.setIndex(g);var y=this.reader.readString(4)===m;return this.reader.setIndex(d),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),m=u.uint8array?"uint8array":"array",d=a.transformTo(m,g);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,m,d,y=this.zip64EndOfCentralSize-44;0<y;)g=this.reader.readInt(2),m=this.reader.readInt(4),d=this.reader.readData(m),this.zip64ExtensibleData[g]={id:g,length:m,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,m;for(g=0;g<this.files.length;g++)m=this.files[g],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(g=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var m=g;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var y=m-d;if(0<y)this.isSignature(m,s.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(g){this.reader=o(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,i){var o=e("./reader/readerFor"),a=e("./utils"),s=e("./compressedObject"),l=e("./crc32"),u=e("./utf8"),c=e("./compressions"),g=e("./support");function m(d,y){this.options=d,this.loadOptions=y}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var y,f;if(d.skip(22),this.fileNameLength=d.readInt(2),f=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var b in c)if(Object.prototype.hasOwnProperty.call(c,b)&&c[b].magic===v)return c[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,y,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var y=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(y),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=o(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var y,f,v,b=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<b;)y=d.readInt(2),f=d.readInt(2),v=d.readData(f),this.extraFields[y]={id:y,length:f,value:v};d.setIndex(b)},handleUTF8:function(){var d=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var f=a.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var b=a.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var y=o(d.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:u.utf8decode(y.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var y=o(d.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:u.utf8decode(y.readData(d.length-5))}return null}},r.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,i){function o(y,f,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=f,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),l=e("./utf8"),u=e("./compressedObject"),c=e("./stream/GenericWorker");o.prototype={internalStream:function(y){var f=null,v="string";try{if(!y)throw new Error("No output type specified.");var b=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),f=this._decompressWorker();var w=!this._dataBinary;w&&!b&&(f=f.pipe(new l.Utf8EncodeWorker)),!w&&b&&(f=f.pipe(new l.Utf8DecodeWorker))}catch(x){(f=new c("error")).error(x)}return new a(f,v,"")},async:function(y,f){return this.internalStream(y).accumulate(f)},nodeStream:function(y,f){return this.internalStream(y||"nodebuffer").toNodejsStream(f)},_compressWorker:function(y,f){if(this._data instanceof u&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(v,y,f)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof c?this._data:new s(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<g.length;d++)o.prototype[g[d]]=m;r.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,i){(function(o){var a,s,l=o.MutationObserver||o.WebKitMutationObserver;if(l){var u=0,c=new l(y),g=o.document.createTextNode("");c.observe(g,{characterData:!0}),a=function(){g.data=u=++u%2}}else if(o.setImmediate||o.MessageChannel===void 0)a="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var f=o.document.createElement("script");f.onreadystatechange=function(){y(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},o.document.documentElement.appendChild(f)}:function(){setTimeout(y,0)};else{var m=new o.MessageChannel;m.port1.onmessage=y,a=function(){m.port2.postMessage(0)}}var d=[];function y(){var f,v;s=!0;for(var b=d.length;b;){for(v=d,d=[],f=-1;++f<b;)v[f]();b=d.length}s=!1}r.exports=function(f){d.push(f)!==1||s||a()}}).call(this,typeof qe<"u"?qe:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,i){var o=e("immediate");function a(){}var s={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];function g(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,b!==a&&f(this,b)}function m(b,w,x){this.promise=b,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function d(b,w,x){o(function(){var _;try{_=w(x)}catch(E){return s.reject(b,E)}_===b?s.reject(b,new TypeError("Cannot resolve promise with itself")):s.resolve(b,_)})}function y(b){var w=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof w=="function")return function(){w.apply(b,arguments)}}function f(b,w){var x=!1;function _(T){x||(x=!0,s.reject(b,T))}function E(T){x||(x=!0,s.resolve(b,T))}var N=v(function(){w(E,_)});N.status==="error"&&_(N.value)}function v(b,w){var x={};try{x.value=b(w),x.status="success"}catch(_){x.status="error",x.value=_}return x}(r.exports=g).prototype.finally=function(b){if(typeof b!="function")return this;var w=this.constructor;return this.then(function(x){return w.resolve(b()).then(function(){return x})},function(x){return w.resolve(b()).then(function(){throw x})})},g.prototype.catch=function(b){return this.then(null,b)},g.prototype.then=function(b,w){if(typeof b!="function"&&this.state===u||typeof w!="function"&&this.state===l)return this;var x=new this.constructor(a);return this.state!==c?d(x,this.state===u?b:w,this.outcome):this.queue.push(new m(x,b,w)),x},m.prototype.callFulfilled=function(b){s.resolve(this.promise,b)},m.prototype.otherCallFulfilled=function(b){d(this.promise,this.onFulfilled,b)},m.prototype.callRejected=function(b){s.reject(this.promise,b)},m.prototype.otherCallRejected=function(b){d(this.promise,this.onRejected,b)},s.resolve=function(b,w){var x=v(y,w);if(x.status==="error")return s.reject(b,x.value);var _=x.value;if(_)f(b,_);else{b.state=u,b.outcome=w;for(var E=-1,N=b.queue.length;++E<N;)b.queue[E].callFulfilled(w)}return b},s.reject=function(b,w){b.state=l,b.outcome=w;for(var x=-1,_=b.queue.length;++x<_;)b.queue[x].callRejected(w);return b},g.resolve=function(b){return b instanceof this?b:s.resolve(new this(a),b)},g.reject=function(b){var w=new this(a);return s.reject(w,b)},g.all=function(b){var w=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=b.length,_=!1;if(!x)return this.resolve([]);for(var E=new Array(x),N=0,T=-1,R=new this(a);++T<x;)z(b[T],T);return R;function z(F,Y){w.resolve(F).then(function(C){E[Y]=C,++N!==x||_||(_=!0,s.resolve(R,E))},function(C){_||(_=!0,s.reject(R,C))})}},g.race=function(b){var w=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=b.length,_=!1;if(!x)return this.resolve([]);for(var E=-1,N=new this(a);++E<x;)T=b[E],w.resolve(T).then(function(R){_||(_=!0,s.resolve(N,R))},function(R){_||(_=!0,s.reject(N,R))});var T;return N}},{immediate:36}],38:[function(e,r,i){var o={};(0,e("./lib/utils/common").assign)(o,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,i){var o=e("./zlib/deflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/messages"),u=e("./zlib/zstream"),c=Object.prototype.toString,g=0,m=-1,d=0,y=8;function f(b){if(!(this instanceof f))return new f(b);this.options=a.assign({level:m,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},b||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var x=o.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(x!==g)throw new Error(l[x]);if(w.header&&o.deflateSetHeader(this.strm,w.header),w.dictionary){var _;if(_=typeof w.dictionary=="string"?s.string2buf(w.dictionary):c.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(x=o.deflateSetDictionary(this.strm,_))!==g)throw new Error(l[x]);this._dict_set=!0}}function v(b,w){var x=new f(w);if(x.push(b,!0),x.err)throw x.msg||l[x.err];return x.result}f.prototype.push=function(b,w){var x,_,E=this.strm,N=this.options.chunkSize;if(this.ended)return!1;_=w===~~w?w:w===!0?4:0,typeof b=="string"?E.input=s.string2buf(b):c.call(b)==="[object ArrayBuffer]"?E.input=new Uint8Array(b):E.input=b,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new a.Buf8(N),E.next_out=0,E.avail_out=N),(x=o.deflate(E,_))!==1&&x!==g)return this.onEnd(x),!(this.ended=!0);E.avail_out!==0&&(E.avail_in!==0||_!==4&&_!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(a.shrinkBuf(E.output,E.next_out))):this.onData(a.shrinkBuf(E.output,E.next_out)))}while((0<E.avail_in||E.avail_out===0)&&x!==1);return _===4?(x=o.deflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===g):_!==2||(this.onEnd(g),!(E.avail_out=0))},f.prototype.onData=function(b){this.chunks.push(b)},f.prototype.onEnd=function(b){b===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},i.Deflate=f,i.deflate=v,i.deflateRaw=function(b,w){return(w=w||{}).raw=!0,v(b,w)},i.gzip=function(b,w){return(w=w||{}).gzip=!0,v(b,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,i){var o=e("./zlib/inflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/constants"),u=e("./zlib/messages"),c=e("./zlib/zstream"),g=e("./zlib/gzheader"),m=Object.prototype.toString;function d(f){if(!(this instanceof d))return new d(f);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},f||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||f&&f.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var b=o.inflateInit2(this.strm,v.windowBits);if(b!==l.Z_OK)throw new Error(u[b]);this.header=new g,o.inflateGetHeader(this.strm,this.header)}function y(f,v){var b=new d(v);if(b.push(f,!0),b.err)throw b.msg||u[b.err];return b.result}d.prototype.push=function(f,v){var b,w,x,_,E,N,T=this.strm,R=this.options.chunkSize,z=this.options.dictionary,F=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?T.input=s.binstring2buf(f):m.call(f)==="[object ArrayBuffer]"?T.input=new Uint8Array(f):T.input=f,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new a.Buf8(R),T.next_out=0,T.avail_out=R),(b=o.inflate(T,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&z&&(N=typeof z=="string"?s.string2buf(z):m.call(z)==="[object ArrayBuffer]"?new Uint8Array(z):z,b=o.inflateSetDictionary(this.strm,N)),b===l.Z_BUF_ERROR&&F===!0&&(b=l.Z_OK,F=!1),b!==l.Z_STREAM_END&&b!==l.Z_OK)return this.onEnd(b),!(this.ended=!0);T.next_out&&(T.avail_out!==0&&b!==l.Z_STREAM_END&&(T.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=s.utf8border(T.output,T.next_out),_=T.next_out-x,E=s.buf2string(T.output,x),T.next_out=_,T.avail_out=R-_,_&&a.arraySet(T.output,T.output,x,_,0),this.onData(E)):this.onData(a.shrinkBuf(T.output,T.next_out)))),T.avail_in===0&&T.avail_out===0&&(F=!0)}while((0<T.avail_in||T.avail_out===0)&&b!==l.Z_STREAM_END);return b===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(b=o.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(T.avail_out=0))},d.prototype.onData=function(f){this.chunks.push(f)},d.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},i.Inflate=d,i.inflate=y,i.inflateRaw=function(f,v){return(v=v||{}).raw=!0,y(f,v)},i.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var g in c)c.hasOwnProperty(g)&&(l[g]=c[g])}}return l},i.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var a={arraySet:function(l,u,c,g,m){if(u.subarray&&l.subarray)l.set(u.subarray(c,c+g),m);else for(var d=0;d<g;d++)l[m+d]=u[c+d]},flattenChunks:function(l){var u,c,g,m,d,y;for(u=g=0,c=l.length;u<c;u++)g+=l[u].length;for(y=new Uint8Array(g),u=m=0,c=l.length;u<c;u++)d=l[u],y.set(d,m),m+=d.length;return y}},s={arraySet:function(l,u,c,g,m){for(var d=0;d<g;d++)l[m+d]=u[c+d]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,s))},i.setTyped(o)},{}],42:[function(e,r,i){var o=e("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new o.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function c(g,m){if(m<65537&&(g.subarray&&s||!g.subarray&&a))return String.fromCharCode.apply(null,o.shrinkBuf(g,m));for(var d="",y=0;y<m;y++)d+=String.fromCharCode(g[y]);return d}l[254]=l[254]=1,i.string2buf=function(g){var m,d,y,f,v,b=g.length,w=0;for(f=0;f<b;f++)(64512&(d=g.charCodeAt(f)))==55296&&f+1<b&&(64512&(y=g.charCodeAt(f+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),f++),w+=d<128?1:d<2048?2:d<65536?3:4;for(m=new o.Buf8(w),f=v=0;v<w;f++)(64512&(d=g.charCodeAt(f)))==55296&&f+1<b&&(64512&(y=g.charCodeAt(f+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),f++),d<128?m[v++]=d:(d<2048?m[v++]=192|d>>>6:(d<65536?m[v++]=224|d>>>12:(m[v++]=240|d>>>18,m[v++]=128|d>>>12&63),m[v++]=128|d>>>6&63),m[v++]=128|63&d);return m},i.buf2binstring=function(g){return c(g,g.length)},i.binstring2buf=function(g){for(var m=new o.Buf8(g.length),d=0,y=m.length;d<y;d++)m[d]=g.charCodeAt(d);return m},i.buf2string=function(g,m){var d,y,f,v,b=m||g.length,w=new Array(2*b);for(d=y=0;d<b;)if((f=g[d++])<128)w[y++]=f;else if(4<(v=l[f]))w[y++]=65533,d+=v-1;else{for(f&=v===2?31:v===3?15:7;1<v&&d<b;)f=f<<6|63&g[d++],v--;1<v?w[y++]=65533:f<65536?w[y++]=f:(f-=65536,w[y++]=55296|f>>10&1023,w[y++]=56320|1023&f)}return c(w,y)},i.utf8border=function(g,m){var d;for((m=m||g.length)>g.length&&(m=g.length),d=m-1;0<=d&&(192&g[d])==128;)d--;return d<0||d===0?m:d+l[g[d]]>m?d:m}},{"./common":41}],43:[function(e,r,i){r.exports=function(o,a,s,l){for(var u=65535&o|0,c=o>>>16&65535|0,g=0;s!==0;){for(s-=g=2e3<s?2e3:s;c=c+(u=u+a[l++]|0)|0,--g;);u%=65521,c%=65521}return u|c<<16|0}},{}],44:[function(e,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,i){var o=function(){for(var a,s=[],l=0;l<256;l++){a=l;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;s[l]=a}return s}();r.exports=function(a,s,l,u){var c=o,g=u+l;a^=-1;for(var m=u;m<g;m++)a=a>>>8^c[255&(a^s[m])];return-1^a}},{}],46:[function(e,r,i){var o,a=e("../utils/common"),s=e("./trees"),l=e("./adler32"),u=e("./crc32"),c=e("./messages"),g=0,m=4,d=0,y=-2,f=-1,v=4,b=2,w=8,x=9,_=286,E=30,N=19,T=2*_+1,R=15,z=3,F=258,Y=F+z+1,C=42,k=113,p=1,q=2,L=3,D=4;function G(h,$){return h.msg=c[$],$}function M(h){return(h<<1)-(4<h?9:0)}function W(h){for(var $=h.length;0<=--$;)h[$]=0}function B(h){var $=h.state,V=$.pending;V>h.avail_out&&(V=h.avail_out),V!==0&&(a.arraySet(h.output,$.pending_buf,$.pending_out,V,h.next_out),h.next_out+=V,$.pending_out+=V,h.total_out+=V,h.avail_out-=V,$.pending-=V,$.pending===0&&($.pending_out=0))}function P(h,$){s._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,$),h.block_start=h.strstart,B(h.strm)}function Q(h,$){h.pending_buf[h.pending++]=$}function K(h,$){h.pending_buf[h.pending++]=$>>>8&255,h.pending_buf[h.pending++]=255&$}function Z(h,$){var V,I,S=h.max_chain_length,O=h.strstart,H=h.prev_length,X=h.nice_match,U=h.strstart>h.w_size-Y?h.strstart-(h.w_size-Y):0,tt=h.window,ot=h.w_mask,et=h.prev,lt=h.strstart+F,pt=tt[O+H-1],dt=tt[O+H];h.prev_length>=h.good_match&&(S>>=2),X>h.lookahead&&(X=h.lookahead);do if(tt[(V=$)+H]===dt&&tt[V+H-1]===pt&&tt[V]===tt[O]&&tt[++V]===tt[O+1]){O+=2,V++;do;while(tt[++O]===tt[++V]&&tt[++O]===tt[++V]&&tt[++O]===tt[++V]&&tt[++O]===tt[++V]&&tt[++O]===tt[++V]&&tt[++O]===tt[++V]&&tt[++O]===tt[++V]&&tt[++O]===tt[++V]&&O<lt);if(I=F-(lt-O),O=lt-F,H<I){if(h.match_start=$,X<=(H=I))break;pt=tt[O+H-1],dt=tt[O+H]}}while(($=et[$&ot])>U&&--S!=0);return H<=h.lookahead?H:h.lookahead}function ct(h){var $,V,I,S,O,H,X,U,tt,ot,et=h.w_size;do{if(S=h.window_size-h.lookahead-h.strstart,h.strstart>=et+(et-Y)){for(a.arraySet(h.window,h.window,et,et,0),h.match_start-=et,h.strstart-=et,h.block_start-=et,$=V=h.hash_size;I=h.head[--$],h.head[$]=et<=I?I-et:0,--V;);for($=V=et;I=h.prev[--$],h.prev[$]=et<=I?I-et:0,--V;);S+=et}if(h.strm.avail_in===0)break;if(H=h.strm,X=h.window,U=h.strstart+h.lookahead,tt=S,ot=void 0,ot=H.avail_in,tt<ot&&(ot=tt),V=ot===0?0:(H.avail_in-=ot,a.arraySet(X,H.input,H.next_in,ot,U),H.state.wrap===1?H.adler=l(H.adler,X,ot,U):H.state.wrap===2&&(H.adler=u(H.adler,X,ot,U)),H.next_in+=ot,H.total_in+=ot,ot),h.lookahead+=V,h.lookahead+h.insert>=z)for(O=h.strstart-h.insert,h.ins_h=h.window[O],h.ins_h=(h.ins_h<<h.hash_shift^h.window[O+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[O+z-1])&h.hash_mask,h.prev[O&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=O,O++,h.insert--,!(h.lookahead+h.insert<z)););}while(h.lookahead<Y&&h.strm.avail_in!==0)}function it(h,$){for(var V,I;;){if(h.lookahead<Y){if(ct(h),h.lookahead<Y&&$===g)return p;if(h.lookahead===0)break}if(V=0,h.lookahead>=z&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+z-1])&h.hash_mask,V=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),V!==0&&h.strstart-V<=h.w_size-Y&&(h.match_length=Z(h,V)),h.match_length>=z)if(I=s._tr_tally(h,h.strstart-h.match_start,h.match_length-z),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=z){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+z-1])&h.hash_mask,V=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else I=s._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(I&&(P(h,!1),h.strm.avail_out===0))return p}return h.insert=h.strstart<z-1?h.strstart:z-1,$===m?(P(h,!0),h.strm.avail_out===0?L:D):h.last_lit&&(P(h,!1),h.strm.avail_out===0)?p:q}function nt(h,$){for(var V,I,S;;){if(h.lookahead<Y){if(ct(h),h.lookahead<Y&&$===g)return p;if(h.lookahead===0)break}if(V=0,h.lookahead>=z&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+z-1])&h.hash_mask,V=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=z-1,V!==0&&h.prev_length<h.max_lazy_match&&h.strstart-V<=h.w_size-Y&&(h.match_length=Z(h,V),h.match_length<=5&&(h.strategy===1||h.match_length===z&&4096<h.strstart-h.match_start)&&(h.match_length=z-1)),h.prev_length>=z&&h.match_length<=h.prev_length){for(S=h.strstart+h.lookahead-z,I=s._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-z),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=S&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+z-1])&h.hash_mask,V=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=z-1,h.strstart++,I&&(P(h,!1),h.strm.avail_out===0))return p}else if(h.match_available){if((I=s._tr_tally(h,0,h.window[h.strstart-1]))&&P(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return p}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(I=s._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<z-1?h.strstart:z-1,$===m?(P(h,!0),h.strm.avail_out===0?L:D):h.last_lit&&(P(h,!1),h.strm.avail_out===0)?p:q}function rt(h,$,V,I,S){this.good_length=h,this.max_lazy=$,this.nice_length=V,this.max_chain=I,this.func=S}function J(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*T),this.dyn_dtree=new a.Buf16(2*(2*E+1)),this.bl_tree=new a.Buf16(2*(2*N+1)),W(this.dyn_ltree),W(this.dyn_dtree),W(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(R+1),this.heap=new a.Buf16(2*_+1),W(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*_+1),W(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ut(h){var $;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=b,($=h.state).pending=0,$.pending_out=0,$.wrap<0&&($.wrap=-$.wrap),$.status=$.wrap?C:k,h.adler=$.wrap===2?0:1,$.last_flush=g,s._tr_init($),d):G(h,y)}function ht(h){var $=ut(h);return $===d&&function(V){V.window_size=2*V.w_size,W(V.head),V.max_lazy_match=o[V.level].max_lazy,V.good_match=o[V.level].good_length,V.nice_match=o[V.level].nice_length,V.max_chain_length=o[V.level].max_chain,V.strstart=0,V.block_start=0,V.lookahead=0,V.insert=0,V.match_length=V.prev_length=z-1,V.match_available=0,V.ins_h=0}(h.state),$}function wt(h,$,V,I,S,O){if(!h)return y;var H=1;if($===f&&($=6),I<0?(H=0,I=-I):15<I&&(H=2,I-=16),S<1||x<S||V!==w||I<8||15<I||$<0||9<$||O<0||v<O)return G(h,y);I===8&&(I=9);var X=new J;return(h.state=X).strm=h,X.wrap=H,X.gzhead=null,X.w_bits=I,X.w_size=1<<X.w_bits,X.w_mask=X.w_size-1,X.hash_bits=S+7,X.hash_size=1<<X.hash_bits,X.hash_mask=X.hash_size-1,X.hash_shift=~~((X.hash_bits+z-1)/z),X.window=new a.Buf8(2*X.w_size),X.head=new a.Buf16(X.hash_size),X.prev=new a.Buf16(X.w_size),X.lit_bufsize=1<<S+6,X.pending_buf_size=4*X.lit_bufsize,X.pending_buf=new a.Buf8(X.pending_buf_size),X.d_buf=1*X.lit_bufsize,X.l_buf=3*X.lit_bufsize,X.level=$,X.strategy=O,X.method=V,ht(h)}o=[new rt(0,0,0,0,function(h,$){var V=65535;for(V>h.pending_buf_size-5&&(V=h.pending_buf_size-5);;){if(h.lookahead<=1){if(ct(h),h.lookahead===0&&$===g)return p;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var I=h.block_start+V;if((h.strstart===0||h.strstart>=I)&&(h.lookahead=h.strstart-I,h.strstart=I,P(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-Y&&(P(h,!1),h.strm.avail_out===0))return p}return h.insert=0,$===m?(P(h,!0),h.strm.avail_out===0?L:D):(h.strstart>h.block_start&&(P(h,!1),h.strm.avail_out),p)}),new rt(4,4,8,4,it),new rt(4,5,16,8,it),new rt(4,6,32,32,it),new rt(4,4,16,16,nt),new rt(8,16,32,32,nt),new rt(8,16,128,128,nt),new rt(8,32,128,256,nt),new rt(32,128,258,1024,nt),new rt(32,258,258,4096,nt)],i.deflateInit=function(h,$){return wt(h,$,w,15,8,0)},i.deflateInit2=wt,i.deflateReset=ht,i.deflateResetKeep=ut,i.deflateSetHeader=function(h,$){return h&&h.state?h.state.wrap!==2?y:(h.state.gzhead=$,d):y},i.deflate=function(h,$){var V,I,S,O;if(!h||!h.state||5<$||$<0)return h?G(h,y):y;if(I=h.state,!h.output||!h.input&&h.avail_in!==0||I.status===666&&$!==m)return G(h,h.avail_out===0?-5:y);if(I.strm=h,V=I.last_flush,I.last_flush=$,I.status===C)if(I.wrap===2)h.adler=0,Q(I,31),Q(I,139),Q(I,8),I.gzhead?(Q(I,(I.gzhead.text?1:0)+(I.gzhead.hcrc?2:0)+(I.gzhead.extra?4:0)+(I.gzhead.name?8:0)+(I.gzhead.comment?16:0)),Q(I,255&I.gzhead.time),Q(I,I.gzhead.time>>8&255),Q(I,I.gzhead.time>>16&255),Q(I,I.gzhead.time>>24&255),Q(I,I.level===9?2:2<=I.strategy||I.level<2?4:0),Q(I,255&I.gzhead.os),I.gzhead.extra&&I.gzhead.extra.length&&(Q(I,255&I.gzhead.extra.length),Q(I,I.gzhead.extra.length>>8&255)),I.gzhead.hcrc&&(h.adler=u(h.adler,I.pending_buf,I.pending,0)),I.gzindex=0,I.status=69):(Q(I,0),Q(I,0),Q(I,0),Q(I,0),Q(I,0),Q(I,I.level===9?2:2<=I.strategy||I.level<2?4:0),Q(I,3),I.status=k);else{var H=w+(I.w_bits-8<<4)<<8;H|=(2<=I.strategy||I.level<2?0:I.level<6?1:I.level===6?2:3)<<6,I.strstart!==0&&(H|=32),H+=31-H%31,I.status=k,K(I,H),I.strstart!==0&&(K(I,h.adler>>>16),K(I,65535&h.adler)),h.adler=1}if(I.status===69)if(I.gzhead.extra){for(S=I.pending;I.gzindex<(65535&I.gzhead.extra.length)&&(I.pending!==I.pending_buf_size||(I.gzhead.hcrc&&I.pending>S&&(h.adler=u(h.adler,I.pending_buf,I.pending-S,S)),B(h),S=I.pending,I.pending!==I.pending_buf_size));)Q(I,255&I.gzhead.extra[I.gzindex]),I.gzindex++;I.gzhead.hcrc&&I.pending>S&&(h.adler=u(h.adler,I.pending_buf,I.pending-S,S)),I.gzindex===I.gzhead.extra.length&&(I.gzindex=0,I.status=73)}else I.status=73;if(I.status===73)if(I.gzhead.name){S=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>S&&(h.adler=u(h.adler,I.pending_buf,I.pending-S,S)),B(h),S=I.pending,I.pending===I.pending_buf_size)){O=1;break}O=I.gzindex<I.gzhead.name.length?255&I.gzhead.name.charCodeAt(I.gzindex++):0,Q(I,O)}while(O!==0);I.gzhead.hcrc&&I.pending>S&&(h.adler=u(h.adler,I.pending_buf,I.pending-S,S)),O===0&&(I.gzindex=0,I.status=91)}else I.status=91;if(I.status===91)if(I.gzhead.comment){S=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>S&&(h.adler=u(h.adler,I.pending_buf,I.pending-S,S)),B(h),S=I.pending,I.pending===I.pending_buf_size)){O=1;break}O=I.gzindex<I.gzhead.comment.length?255&I.gzhead.comment.charCodeAt(I.gzindex++):0,Q(I,O)}while(O!==0);I.gzhead.hcrc&&I.pending>S&&(h.adler=u(h.adler,I.pending_buf,I.pending-S,S)),O===0&&(I.status=103)}else I.status=103;if(I.status===103&&(I.gzhead.hcrc?(I.pending+2>I.pending_buf_size&&B(h),I.pending+2<=I.pending_buf_size&&(Q(I,255&h.adler),Q(I,h.adler>>8&255),h.adler=0,I.status=k)):I.status=k),I.pending!==0){if(B(h),h.avail_out===0)return I.last_flush=-1,d}else if(h.avail_in===0&&M($)<=M(V)&&$!==m)return G(h,-5);if(I.status===666&&h.avail_in!==0)return G(h,-5);if(h.avail_in!==0||I.lookahead!==0||$!==g&&I.status!==666){var X=I.strategy===2?function(U,tt){for(var ot;;){if(U.lookahead===0&&(ct(U),U.lookahead===0)){if(tt===g)return p;break}if(U.match_length=0,ot=s._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++,ot&&(P(U,!1),U.strm.avail_out===0))return p}return U.insert=0,tt===m?(P(U,!0),U.strm.avail_out===0?L:D):U.last_lit&&(P(U,!1),U.strm.avail_out===0)?p:q}(I,$):I.strategy===3?function(U,tt){for(var ot,et,lt,pt,dt=U.window;;){if(U.lookahead<=F){if(ct(U),U.lookahead<=F&&tt===g)return p;if(U.lookahead===0)break}if(U.match_length=0,U.lookahead>=z&&0<U.strstart&&(et=dt[lt=U.strstart-1])===dt[++lt]&&et===dt[++lt]&&et===dt[++lt]){pt=U.strstart+F;do;while(et===dt[++lt]&&et===dt[++lt]&&et===dt[++lt]&&et===dt[++lt]&&et===dt[++lt]&&et===dt[++lt]&&et===dt[++lt]&&et===dt[++lt]&&lt<pt);U.match_length=F-(pt-lt),U.match_length>U.lookahead&&(U.match_length=U.lookahead)}if(U.match_length>=z?(ot=s._tr_tally(U,1,U.match_length-z),U.lookahead-=U.match_length,U.strstart+=U.match_length,U.match_length=0):(ot=s._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++),ot&&(P(U,!1),U.strm.avail_out===0))return p}return U.insert=0,tt===m?(P(U,!0),U.strm.avail_out===0?L:D):U.last_lit&&(P(U,!1),U.strm.avail_out===0)?p:q}(I,$):o[I.level].func(I,$);if(X!==L&&X!==D||(I.status=666),X===p||X===L)return h.avail_out===0&&(I.last_flush=-1),d;if(X===q&&($===1?s._tr_align(I):$!==5&&(s._tr_stored_block(I,0,0,!1),$===3&&(W(I.head),I.lookahead===0&&(I.strstart=0,I.block_start=0,I.insert=0))),B(h),h.avail_out===0))return I.last_flush=-1,d}return $!==m?d:I.wrap<=0?1:(I.wrap===2?(Q(I,255&h.adler),Q(I,h.adler>>8&255),Q(I,h.adler>>16&255),Q(I,h.adler>>24&255),Q(I,255&h.total_in),Q(I,h.total_in>>8&255),Q(I,h.total_in>>16&255),Q(I,h.total_in>>24&255)):(K(I,h.adler>>>16),K(I,65535&h.adler)),B(h),0<I.wrap&&(I.wrap=-I.wrap),I.pending!==0?d:1)},i.deflateEnd=function(h){var $;return h&&h.state?($=h.state.status)!==C&&$!==69&&$!==73&&$!==91&&$!==103&&$!==k&&$!==666?G(h,y):(h.state=null,$===k?G(h,-3):d):y},i.deflateSetDictionary=function(h,$){var V,I,S,O,H,X,U,tt,ot=$.length;if(!h||!h.state||(O=(V=h.state).wrap)===2||O===1&&V.status!==C||V.lookahead)return y;for(O===1&&(h.adler=l(h.adler,$,ot,0)),V.wrap=0,ot>=V.w_size&&(O===0&&(W(V.head),V.strstart=0,V.block_start=0,V.insert=0),tt=new a.Buf8(V.w_size),a.arraySet(tt,$,ot-V.w_size,V.w_size,0),$=tt,ot=V.w_size),H=h.avail_in,X=h.next_in,U=h.input,h.avail_in=ot,h.next_in=0,h.input=$,ct(V);V.lookahead>=z;){for(I=V.strstart,S=V.lookahead-(z-1);V.ins_h=(V.ins_h<<V.hash_shift^V.window[I+z-1])&V.hash_mask,V.prev[I&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=I,I++,--S;);V.strstart=I,V.lookahead=z-1,ct(V)}return V.strstart+=V.lookahead,V.block_start=V.strstart,V.insert=V.lookahead,V.lookahead=0,V.match_length=V.prev_length=z-1,V.match_available=0,h.next_in=X,h.input=U,h.avail_in=H,V.wrap=O,d},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,i){r.exports=function(o,a){var s,l,u,c,g,m,d,y,f,v,b,w,x,_,E,N,T,R,z,F,Y,C,k,p,q;s=o.state,l=o.next_in,p=o.input,u=l+(o.avail_in-5),c=o.next_out,q=o.output,g=c-(a-o.avail_out),m=c+(o.avail_out-257),d=s.dmax,y=s.wsize,f=s.whave,v=s.wnext,b=s.window,w=s.hold,x=s.bits,_=s.lencode,E=s.distcode,N=(1<<s.lenbits)-1,T=(1<<s.distbits)-1;t:do{x<15&&(w+=p[l++]<<x,x+=8,w+=p[l++]<<x,x+=8),R=_[w&N];e:for(;;){if(w>>>=z=R>>>24,x-=z,(z=R>>>16&255)===0)q[c++]=65535&R;else{if(!(16&z)){if((64&z)==0){R=_[(65535&R)+(w&(1<<z)-1)];continue e}if(32&z){s.mode=12;break t}o.msg="invalid literal/length code",s.mode=30;break t}F=65535&R,(z&=15)&&(x<z&&(w+=p[l++]<<x,x+=8),F+=w&(1<<z)-1,w>>>=z,x-=z),x<15&&(w+=p[l++]<<x,x+=8,w+=p[l++]<<x,x+=8),R=E[w&T];n:for(;;){if(w>>>=z=R>>>24,x-=z,!(16&(z=R>>>16&255))){if((64&z)==0){R=E[(65535&R)+(w&(1<<z)-1)];continue n}o.msg="invalid distance code",s.mode=30;break t}if(Y=65535&R,x<(z&=15)&&(w+=p[l++]<<x,(x+=8)<z&&(w+=p[l++]<<x,x+=8)),d<(Y+=w&(1<<z)-1)){o.msg="invalid distance too far back",s.mode=30;break t}if(w>>>=z,x-=z,(z=c-g)<Y){if(f<(z=Y-z)&&s.sane){o.msg="invalid distance too far back",s.mode=30;break t}if(k=b,(C=0)===v){if(C+=y-z,z<F){for(F-=z;q[c++]=b[C++],--z;);C=c-Y,k=q}}else if(v<z){if(C+=y+v-z,(z-=v)<F){for(F-=z;q[c++]=b[C++],--z;);if(C=0,v<F){for(F-=z=v;q[c++]=b[C++],--z;);C=c-Y,k=q}}}else if(C+=v-z,z<F){for(F-=z;q[c++]=b[C++],--z;);C=c-Y,k=q}for(;2<F;)q[c++]=k[C++],q[c++]=k[C++],q[c++]=k[C++],F-=3;F&&(q[c++]=k[C++],1<F&&(q[c++]=k[C++]))}else{for(C=c-Y;q[c++]=q[C++],q[c++]=q[C++],q[c++]=q[C++],2<(F-=3););F&&(q[c++]=q[C++],1<F&&(q[c++]=q[C++]))}break}}break}}while(l<u&&c<m);l-=F=x>>3,w&=(1<<(x-=F<<3))-1,o.next_in=l,o.next_out=c,o.avail_in=l<u?u-l+5:5-(l-u),o.avail_out=c<m?m-c+257:257-(c-m),s.hold=w,s.bits=x}},{}],49:[function(e,r,i){var o=e("../utils/common"),a=e("./adler32"),s=e("./crc32"),l=e("./inffast"),u=e("./inftrees"),c=1,g=2,m=0,d=-2,y=1,f=852,v=592;function b(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(C){var k;return C&&C.state?(k=C.state,C.total_in=C.total_out=k.total=0,C.msg="",k.wrap&&(C.adler=1&k.wrap),k.mode=y,k.last=0,k.havedict=0,k.dmax=32768,k.head=null,k.hold=0,k.bits=0,k.lencode=k.lendyn=new o.Buf32(f),k.distcode=k.distdyn=new o.Buf32(v),k.sane=1,k.back=-1,m):d}function _(C){var k;return C&&C.state?((k=C.state).wsize=0,k.whave=0,k.wnext=0,x(C)):d}function E(C,k){var p,q;return C&&C.state?(q=C.state,k<0?(p=0,k=-k):(p=1+(k>>4),k<48&&(k&=15)),k&&(k<8||15<k)?d:(q.window!==null&&q.wbits!==k&&(q.window=null),q.wrap=p,q.wbits=k,_(C))):d}function N(C,k){var p,q;return C?(q=new w,(C.state=q).window=null,(p=E(C,k))!==m&&(C.state=null),p):d}var T,R,z=!0;function F(C){if(z){var k;for(T=new o.Buf32(512),R=new o.Buf32(32),k=0;k<144;)C.lens[k++]=8;for(;k<256;)C.lens[k++]=9;for(;k<280;)C.lens[k++]=7;for(;k<288;)C.lens[k++]=8;for(u(c,C.lens,0,288,T,0,C.work,{bits:9}),k=0;k<32;)C.lens[k++]=5;u(g,C.lens,0,32,R,0,C.work,{bits:5}),z=!1}C.lencode=T,C.lenbits=9,C.distcode=R,C.distbits=5}function Y(C,k,p,q){var L,D=C.state;return D.window===null&&(D.wsize=1<<D.wbits,D.wnext=0,D.whave=0,D.window=new o.Buf8(D.wsize)),q>=D.wsize?(o.arraySet(D.window,k,p-D.wsize,D.wsize,0),D.wnext=0,D.whave=D.wsize):(q<(L=D.wsize-D.wnext)&&(L=q),o.arraySet(D.window,k,p-q,L,D.wnext),(q-=L)?(o.arraySet(D.window,k,p-q,q,0),D.wnext=q,D.whave=D.wsize):(D.wnext+=L,D.wnext===D.wsize&&(D.wnext=0),D.whave<D.wsize&&(D.whave+=L))),0}i.inflateReset=_,i.inflateReset2=E,i.inflateResetKeep=x,i.inflateInit=function(C){return N(C,15)},i.inflateInit2=N,i.inflate=function(C,k){var p,q,L,D,G,M,W,B,P,Q,K,Z,ct,it,nt,rt,J,ut,ht,wt,h,$,V,I,S=0,O=new o.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return d;(p=C.state).mode===12&&(p.mode=13),G=C.next_out,L=C.output,W=C.avail_out,D=C.next_in,q=C.input,M=C.avail_in,B=p.hold,P=p.bits,Q=M,K=W,$=m;t:for(;;)switch(p.mode){case y:if(p.wrap===0){p.mode=13;break}for(;P<16;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}if(2&p.wrap&&B===35615){O[p.check=0]=255&B,O[1]=B>>>8&255,p.check=s(p.check,O,2,0),P=B=0,p.mode=2;break}if(p.flags=0,p.head&&(p.head.done=!1),!(1&p.wrap)||(((255&B)<<8)+(B>>8))%31){C.msg="incorrect header check",p.mode=30;break}if((15&B)!=8){C.msg="unknown compression method",p.mode=30;break}if(P-=4,h=8+(15&(B>>>=4)),p.wbits===0)p.wbits=h;else if(h>p.wbits){C.msg="invalid window size",p.mode=30;break}p.dmax=1<<h,C.adler=p.check=1,p.mode=512&B?10:12,P=B=0;break;case 2:for(;P<16;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}if(p.flags=B,(255&p.flags)!=8){C.msg="unknown compression method",p.mode=30;break}if(57344&p.flags){C.msg="unknown header flags set",p.mode=30;break}p.head&&(p.head.text=B>>8&1),512&p.flags&&(O[0]=255&B,O[1]=B>>>8&255,p.check=s(p.check,O,2,0)),P=B=0,p.mode=3;case 3:for(;P<32;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}p.head&&(p.head.time=B),512&p.flags&&(O[0]=255&B,O[1]=B>>>8&255,O[2]=B>>>16&255,O[3]=B>>>24&255,p.check=s(p.check,O,4,0)),P=B=0,p.mode=4;case 4:for(;P<16;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}p.head&&(p.head.xflags=255&B,p.head.os=B>>8),512&p.flags&&(O[0]=255&B,O[1]=B>>>8&255,p.check=s(p.check,O,2,0)),P=B=0,p.mode=5;case 5:if(1024&p.flags){for(;P<16;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}p.length=B,p.head&&(p.head.extra_len=B),512&p.flags&&(O[0]=255&B,O[1]=B>>>8&255,p.check=s(p.check,O,2,0)),P=B=0}else p.head&&(p.head.extra=null);p.mode=6;case 6:if(1024&p.flags&&(M<(Z=p.length)&&(Z=M),Z&&(p.head&&(h=p.head.extra_len-p.length,p.head.extra||(p.head.extra=new Array(p.head.extra_len)),o.arraySet(p.head.extra,q,D,Z,h)),512&p.flags&&(p.check=s(p.check,q,Z,D)),M-=Z,D+=Z,p.length-=Z),p.length))break t;p.length=0,p.mode=7;case 7:if(2048&p.flags){if(M===0)break t;for(Z=0;h=q[D+Z++],p.head&&h&&p.length<65536&&(p.head.name+=String.fromCharCode(h)),h&&Z<M;);if(512&p.flags&&(p.check=s(p.check,q,Z,D)),M-=Z,D+=Z,h)break t}else p.head&&(p.head.name=null);p.length=0,p.mode=8;case 8:if(4096&p.flags){if(M===0)break t;for(Z=0;h=q[D+Z++],p.head&&h&&p.length<65536&&(p.head.comment+=String.fromCharCode(h)),h&&Z<M;);if(512&p.flags&&(p.check=s(p.check,q,Z,D)),M-=Z,D+=Z,h)break t}else p.head&&(p.head.comment=null);p.mode=9;case 9:if(512&p.flags){for(;P<16;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}if(B!==(65535&p.check)){C.msg="header crc mismatch",p.mode=30;break}P=B=0}p.head&&(p.head.hcrc=p.flags>>9&1,p.head.done=!0),C.adler=p.check=0,p.mode=12;break;case 10:for(;P<32;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}C.adler=p.check=b(B),P=B=0,p.mode=11;case 11:if(p.havedict===0)return C.next_out=G,C.avail_out=W,C.next_in=D,C.avail_in=M,p.hold=B,p.bits=P,2;C.adler=p.check=1,p.mode=12;case 12:if(k===5||k===6)break t;case 13:if(p.last){B>>>=7&P,P-=7&P,p.mode=27;break}for(;P<3;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}switch(p.last=1&B,P-=1,3&(B>>>=1)){case 0:p.mode=14;break;case 1:if(F(p),p.mode=20,k!==6)break;B>>>=2,P-=2;break t;case 2:p.mode=17;break;case 3:C.msg="invalid block type",p.mode=30}B>>>=2,P-=2;break;case 14:for(B>>>=7&P,P-=7&P;P<32;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}if((65535&B)!=(B>>>16^65535)){C.msg="invalid stored block lengths",p.mode=30;break}if(p.length=65535&B,P=B=0,p.mode=15,k===6)break t;case 15:p.mode=16;case 16:if(Z=p.length){if(M<Z&&(Z=M),W<Z&&(Z=W),Z===0)break t;o.arraySet(L,q,D,Z,G),M-=Z,D+=Z,W-=Z,G+=Z,p.length-=Z;break}p.mode=12;break;case 17:for(;P<14;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}if(p.nlen=257+(31&B),B>>>=5,P-=5,p.ndist=1+(31&B),B>>>=5,P-=5,p.ncode=4+(15&B),B>>>=4,P-=4,286<p.nlen||30<p.ndist){C.msg="too many length or distance symbols",p.mode=30;break}p.have=0,p.mode=18;case 18:for(;p.have<p.ncode;){for(;P<3;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}p.lens[H[p.have++]]=7&B,B>>>=3,P-=3}for(;p.have<19;)p.lens[H[p.have++]]=0;if(p.lencode=p.lendyn,p.lenbits=7,V={bits:p.lenbits},$=u(0,p.lens,0,19,p.lencode,0,p.work,V),p.lenbits=V.bits,$){C.msg="invalid code lengths set",p.mode=30;break}p.have=0,p.mode=19;case 19:for(;p.have<p.nlen+p.ndist;){for(;rt=(S=p.lencode[B&(1<<p.lenbits)-1])>>>16&255,J=65535&S,!((nt=S>>>24)<=P);){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}if(J<16)B>>>=nt,P-=nt,p.lens[p.have++]=J;else{if(J===16){for(I=nt+2;P<I;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}if(B>>>=nt,P-=nt,p.have===0){C.msg="invalid bit length repeat",p.mode=30;break}h=p.lens[p.have-1],Z=3+(3&B),B>>>=2,P-=2}else if(J===17){for(I=nt+3;P<I;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}P-=nt,h=0,Z=3+(7&(B>>>=nt)),B>>>=3,P-=3}else{for(I=nt+7;P<I;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}P-=nt,h=0,Z=11+(127&(B>>>=nt)),B>>>=7,P-=7}if(p.have+Z>p.nlen+p.ndist){C.msg="invalid bit length repeat",p.mode=30;break}for(;Z--;)p.lens[p.have++]=h}}if(p.mode===30)break;if(p.lens[256]===0){C.msg="invalid code -- missing end-of-block",p.mode=30;break}if(p.lenbits=9,V={bits:p.lenbits},$=u(c,p.lens,0,p.nlen,p.lencode,0,p.work,V),p.lenbits=V.bits,$){C.msg="invalid literal/lengths set",p.mode=30;break}if(p.distbits=6,p.distcode=p.distdyn,V={bits:p.distbits},$=u(g,p.lens,p.nlen,p.ndist,p.distcode,0,p.work,V),p.distbits=V.bits,$){C.msg="invalid distances set",p.mode=30;break}if(p.mode=20,k===6)break t;case 20:p.mode=21;case 21:if(6<=M&&258<=W){C.next_out=G,C.avail_out=W,C.next_in=D,C.avail_in=M,p.hold=B,p.bits=P,l(C,K),G=C.next_out,L=C.output,W=C.avail_out,D=C.next_in,q=C.input,M=C.avail_in,B=p.hold,P=p.bits,p.mode===12&&(p.back=-1);break}for(p.back=0;rt=(S=p.lencode[B&(1<<p.lenbits)-1])>>>16&255,J=65535&S,!((nt=S>>>24)<=P);){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}if(rt&&(240&rt)==0){for(ut=nt,ht=rt,wt=J;rt=(S=p.lencode[wt+((B&(1<<ut+ht)-1)>>ut)])>>>16&255,J=65535&S,!(ut+(nt=S>>>24)<=P);){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}B>>>=ut,P-=ut,p.back+=ut}if(B>>>=nt,P-=nt,p.back+=nt,p.length=J,rt===0){p.mode=26;break}if(32&rt){p.back=-1,p.mode=12;break}if(64&rt){C.msg="invalid literal/length code",p.mode=30;break}p.extra=15&rt,p.mode=22;case 22:if(p.extra){for(I=p.extra;P<I;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}p.length+=B&(1<<p.extra)-1,B>>>=p.extra,P-=p.extra,p.back+=p.extra}p.was=p.length,p.mode=23;case 23:for(;rt=(S=p.distcode[B&(1<<p.distbits)-1])>>>16&255,J=65535&S,!((nt=S>>>24)<=P);){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}if((240&rt)==0){for(ut=nt,ht=rt,wt=J;rt=(S=p.distcode[wt+((B&(1<<ut+ht)-1)>>ut)])>>>16&255,J=65535&S,!(ut+(nt=S>>>24)<=P);){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}B>>>=ut,P-=ut,p.back+=ut}if(B>>>=nt,P-=nt,p.back+=nt,64&rt){C.msg="invalid distance code",p.mode=30;break}p.offset=J,p.extra=15&rt,p.mode=24;case 24:if(p.extra){for(I=p.extra;P<I;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}p.offset+=B&(1<<p.extra)-1,B>>>=p.extra,P-=p.extra,p.back+=p.extra}if(p.offset>p.dmax){C.msg="invalid distance too far back",p.mode=30;break}p.mode=25;case 25:if(W===0)break t;if(Z=K-W,p.offset>Z){if((Z=p.offset-Z)>p.whave&&p.sane){C.msg="invalid distance too far back",p.mode=30;break}ct=Z>p.wnext?(Z-=p.wnext,p.wsize-Z):p.wnext-Z,Z>p.length&&(Z=p.length),it=p.window}else it=L,ct=G-p.offset,Z=p.length;for(W<Z&&(Z=W),W-=Z,p.length-=Z;L[G++]=it[ct++],--Z;);p.length===0&&(p.mode=21);break;case 26:if(W===0)break t;L[G++]=p.length,W--,p.mode=21;break;case 27:if(p.wrap){for(;P<32;){if(M===0)break t;M--,B|=q[D++]<<P,P+=8}if(K-=W,C.total_out+=K,p.total+=K,K&&(C.adler=p.check=p.flags?s(p.check,L,K,G-K):a(p.check,L,K,G-K)),K=W,(p.flags?B:b(B))!==p.check){C.msg="incorrect data check",p.mode=30;break}P=B=0}p.mode=28;case 28:if(p.wrap&&p.flags){for(;P<32;){if(M===0)break t;M--,B+=q[D++]<<P,P+=8}if(B!==(4294967295&p.total)){C.msg="incorrect length check",p.mode=30;break}P=B=0}p.mode=29;case 29:$=1;break t;case 30:$=-3;break t;case 31:return-4;case 32:default:return d}return C.next_out=G,C.avail_out=W,C.next_in=D,C.avail_in=M,p.hold=B,p.bits=P,(p.wsize||K!==C.avail_out&&p.mode<30&&(p.mode<27||k!==4))&&Y(C,C.output,C.next_out,K-C.avail_out)?(p.mode=31,-4):(Q-=C.avail_in,K-=C.avail_out,C.total_in+=Q,C.total_out+=K,p.total+=K,p.wrap&&K&&(C.adler=p.check=p.flags?s(p.check,L,K,C.next_out-K):a(p.check,L,K,C.next_out-K)),C.data_type=p.bits+(p.last?64:0)+(p.mode===12?128:0)+(p.mode===20||p.mode===15?256:0),(Q==0&&K===0||k===4)&&$===m&&($=-5),$)},i.inflateEnd=function(C){if(!C||!C.state)return d;var k=C.state;return k.window&&(k.window=null),C.state=null,m},i.inflateGetHeader=function(C,k){var p;return C&&C.state?(2&(p=C.state).wrap)==0?d:((p.head=k).done=!1,m):d},i.inflateSetDictionary=function(C,k){var p,q=k.length;return C&&C.state?(p=C.state).wrap!==0&&p.mode!==11?d:p.mode===11&&a(1,k,q,0)!==p.check?-3:Y(C,k,q,q)?(p.mode=31,-4):(p.havedict=1,m):d},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,i){var o=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(c,g,m,d,y,f,v,b){var w,x,_,E,N,T,R,z,F,Y=b.bits,C=0,k=0,p=0,q=0,L=0,D=0,G=0,M=0,W=0,B=0,P=null,Q=0,K=new o.Buf16(16),Z=new o.Buf16(16),ct=null,it=0;for(C=0;C<=15;C++)K[C]=0;for(k=0;k<d;k++)K[g[m+k]]++;for(L=Y,q=15;1<=q&&K[q]===0;q--);if(q<L&&(L=q),q===0)return y[f++]=20971520,y[f++]=20971520,b.bits=1,0;for(p=1;p<q&&K[p]===0;p++);for(L<p&&(L=p),C=M=1;C<=15;C++)if(M<<=1,(M-=K[C])<0)return-1;if(0<M&&(c===0||q!==1))return-1;for(Z[1]=0,C=1;C<15;C++)Z[C+1]=Z[C]+K[C];for(k=0;k<d;k++)g[m+k]!==0&&(v[Z[g[m+k]]++]=k);if(T=c===0?(P=ct=v,19):c===1?(P=a,Q-=257,ct=s,it-=257,256):(P=l,ct=u,-1),C=p,N=f,G=k=B=0,_=-1,E=(W=1<<(D=L))-1,c===1&&852<W||c===2&&592<W)return 1;for(;;){for(R=C-G,F=v[k]<T?(z=0,v[k]):v[k]>T?(z=ct[it+v[k]],P[Q+v[k]]):(z=96,0),w=1<<C-G,p=x=1<<D;y[N+(B>>G)+(x-=w)]=R<<24|z<<16|F|0,x!==0;);for(w=1<<C-1;B&w;)w>>=1;if(w!==0?(B&=w-1,B+=w):B=0,k++,--K[C]==0){if(C===q)break;C=g[m+v[k]]}if(L<C&&(B&E)!==_){for(G===0&&(G=L),N+=p,M=1<<(D=C-G);D+G<q&&!((M-=K[D+G])<=0);)D++,M<<=1;if(W+=1<<D,c===1&&852<W||c===2&&592<W)return 1;y[_=B&E]=L<<24|D<<16|N-f|0}}return B!==0&&(y[N+B]=C-G<<24|64<<16|0),b.bits=L,0}},{"../utils/common":41}],51:[function(e,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,i){var o=e("../utils/common"),a=0,s=1;function l(S){for(var O=S.length;0<=--O;)S[O]=0}var u=0,c=29,g=256,m=g+1+c,d=30,y=19,f=2*m+1,v=15,b=16,w=7,x=256,_=16,E=17,N=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=new Array(2*(m+2));l(Y);var C=new Array(2*d);l(C);var k=new Array(512);l(k);var p=new Array(256);l(p);var q=new Array(c);l(q);var L,D,G,M=new Array(d);function W(S,O,H,X,U){this.static_tree=S,this.extra_bits=O,this.extra_base=H,this.elems=X,this.max_length=U,this.has_stree=S&&S.length}function B(S,O){this.dyn_tree=S,this.max_code=0,this.stat_desc=O}function P(S){return S<256?k[S]:k[256+(S>>>7)]}function Q(S,O){S.pending_buf[S.pending++]=255&O,S.pending_buf[S.pending++]=O>>>8&255}function K(S,O,H){S.bi_valid>b-H?(S.bi_buf|=O<<S.bi_valid&65535,Q(S,S.bi_buf),S.bi_buf=O>>b-S.bi_valid,S.bi_valid+=H-b):(S.bi_buf|=O<<S.bi_valid&65535,S.bi_valid+=H)}function Z(S,O,H){K(S,H[2*O],H[2*O+1])}function ct(S,O){for(var H=0;H|=1&S,S>>>=1,H<<=1,0<--O;);return H>>>1}function it(S,O,H){var X,U,tt=new Array(v+1),ot=0;for(X=1;X<=v;X++)tt[X]=ot=ot+H[X-1]<<1;for(U=0;U<=O;U++){var et=S[2*U+1];et!==0&&(S[2*U]=ct(tt[et]++,et))}}function nt(S){var O;for(O=0;O<m;O++)S.dyn_ltree[2*O]=0;for(O=0;O<d;O++)S.dyn_dtree[2*O]=0;for(O=0;O<y;O++)S.bl_tree[2*O]=0;S.dyn_ltree[2*x]=1,S.opt_len=S.static_len=0,S.last_lit=S.matches=0}function rt(S){8<S.bi_valid?Q(S,S.bi_buf):0<S.bi_valid&&(S.pending_buf[S.pending++]=S.bi_buf),S.bi_buf=0,S.bi_valid=0}function J(S,O,H,X){var U=2*O,tt=2*H;return S[U]<S[tt]||S[U]===S[tt]&&X[O]<=X[H]}function ut(S,O,H){for(var X=S.heap[H],U=H<<1;U<=S.heap_len&&(U<S.heap_len&&J(O,S.heap[U+1],S.heap[U],S.depth)&&U++,!J(O,X,S.heap[U],S.depth));)S.heap[H]=S.heap[U],H=U,U<<=1;S.heap[H]=X}function ht(S,O,H){var X,U,tt,ot,et=0;if(S.last_lit!==0)for(;X=S.pending_buf[S.d_buf+2*et]<<8|S.pending_buf[S.d_buf+2*et+1],U=S.pending_buf[S.l_buf+et],et++,X===0?Z(S,U,O):(Z(S,(tt=p[U])+g+1,O),(ot=T[tt])!==0&&K(S,U-=q[tt],ot),Z(S,tt=P(--X),H),(ot=R[tt])!==0&&K(S,X-=M[tt],ot)),et<S.last_lit;);Z(S,x,O)}function wt(S,O){var H,X,U,tt=O.dyn_tree,ot=O.stat_desc.static_tree,et=O.stat_desc.has_stree,lt=O.stat_desc.elems,pt=-1;for(S.heap_len=0,S.heap_max=f,H=0;H<lt;H++)tt[2*H]!==0?(S.heap[++S.heap_len]=pt=H,S.depth[H]=0):tt[2*H+1]=0;for(;S.heap_len<2;)tt[2*(U=S.heap[++S.heap_len]=pt<2?++pt:0)]=1,S.depth[U]=0,S.opt_len--,et&&(S.static_len-=ot[2*U+1]);for(O.max_code=pt,H=S.heap_len>>1;1<=H;H--)ut(S,tt,H);for(U=lt;H=S.heap[1],S.heap[1]=S.heap[S.heap_len--],ut(S,tt,1),X=S.heap[1],S.heap[--S.heap_max]=H,S.heap[--S.heap_max]=X,tt[2*U]=tt[2*H]+tt[2*X],S.depth[U]=(S.depth[H]>=S.depth[X]?S.depth[H]:S.depth[X])+1,tt[2*H+1]=tt[2*X+1]=U,S.heap[1]=U++,ut(S,tt,1),2<=S.heap_len;);S.heap[--S.heap_max]=S.heap[1],function(dt,St){var Ht,kt,Zt,vt,le,oe,Lt=St.dyn_tree,Fe=St.max_code,Ue=St.stat_desc.static_tree,un=St.stat_desc.has_stree,fn=St.stat_desc.extra_bits,We=St.stat_desc.extra_base,xt=St.stat_desc.max_length,Rt=0;for(vt=0;vt<=v;vt++)dt.bl_count[vt]=0;for(Lt[2*dt.heap[dt.heap_max]+1]=0,Ht=dt.heap_max+1;Ht<f;Ht++)xt<(vt=Lt[2*Lt[2*(kt=dt.heap[Ht])+1]+1]+1)&&(vt=xt,Rt++),Lt[2*kt+1]=vt,Fe<kt||(dt.bl_count[vt]++,le=0,We<=kt&&(le=fn[kt-We]),oe=Lt[2*kt],dt.opt_len+=oe*(vt+le),un&&(dt.static_len+=oe*(Ue[2*kt+1]+le)));if(Rt!==0){do{for(vt=xt-1;dt.bl_count[vt]===0;)vt--;dt.bl_count[vt]--,dt.bl_count[vt+1]+=2,dt.bl_count[xt]--,Rt-=2}while(0<Rt);for(vt=xt;vt!==0;vt--)for(kt=dt.bl_count[vt];kt!==0;)Fe<(Zt=dt.heap[--Ht])||(Lt[2*Zt+1]!==vt&&(dt.opt_len+=(vt-Lt[2*Zt+1])*Lt[2*Zt],Lt[2*Zt+1]=vt),kt--)}}(S,O),it(tt,pt,S.bl_count)}function h(S,O,H){var X,U,tt=-1,ot=O[1],et=0,lt=7,pt=4;for(ot===0&&(lt=138,pt=3),O[2*(H+1)+1]=65535,X=0;X<=H;X++)U=ot,ot=O[2*(X+1)+1],++et<lt&&U===ot||(et<pt?S.bl_tree[2*U]+=et:U!==0?(U!==tt&&S.bl_tree[2*U]++,S.bl_tree[2*_]++):et<=10?S.bl_tree[2*E]++:S.bl_tree[2*N]++,tt=U,pt=(et=0)===ot?(lt=138,3):U===ot?(lt=6,3):(lt=7,4))}function $(S,O,H){var X,U,tt=-1,ot=O[1],et=0,lt=7,pt=4;for(ot===0&&(lt=138,pt=3),X=0;X<=H;X++)if(U=ot,ot=O[2*(X+1)+1],!(++et<lt&&U===ot)){if(et<pt)for(;Z(S,U,S.bl_tree),--et!=0;);else U!==0?(U!==tt&&(Z(S,U,S.bl_tree),et--),Z(S,_,S.bl_tree),K(S,et-3,2)):et<=10?(Z(S,E,S.bl_tree),K(S,et-3,3)):(Z(S,N,S.bl_tree),K(S,et-11,7));tt=U,pt=(et=0)===ot?(lt=138,3):U===ot?(lt=6,3):(lt=7,4)}}l(M);var V=!1;function I(S,O,H,X){K(S,(u<<1)+(X?1:0),3),function(U,tt,ot,et){rt(U),Q(U,ot),Q(U,~ot),o.arraySet(U.pending_buf,U.window,tt,ot,U.pending),U.pending+=ot}(S,O,H)}i._tr_init=function(S){V||(function(){var O,H,X,U,tt,ot=new Array(v+1);for(U=X=0;U<c-1;U++)for(q[U]=X,O=0;O<1<<T[U];O++)p[X++]=U;for(p[X-1]=U,U=tt=0;U<16;U++)for(M[U]=tt,O=0;O<1<<R[U];O++)k[tt++]=U;for(tt>>=7;U<d;U++)for(M[U]=tt<<7,O=0;O<1<<R[U]-7;O++)k[256+tt++]=U;for(H=0;H<=v;H++)ot[H]=0;for(O=0;O<=143;)Y[2*O+1]=8,O++,ot[8]++;for(;O<=255;)Y[2*O+1]=9,O++,ot[9]++;for(;O<=279;)Y[2*O+1]=7,O++,ot[7]++;for(;O<=287;)Y[2*O+1]=8,O++,ot[8]++;for(it(Y,m+1,ot),O=0;O<d;O++)C[2*O+1]=5,C[2*O]=ct(O,5);L=new W(Y,T,g+1,m,v),D=new W(C,R,0,d,v),G=new W(new Array(0),z,0,y,w)}(),V=!0),S.l_desc=new B(S.dyn_ltree,L),S.d_desc=new B(S.dyn_dtree,D),S.bl_desc=new B(S.bl_tree,G),S.bi_buf=0,S.bi_valid=0,nt(S)},i._tr_stored_block=I,i._tr_flush_block=function(S,O,H,X){var U,tt,ot=0;0<S.level?(S.strm.data_type===2&&(S.strm.data_type=function(et){var lt,pt=4093624447;for(lt=0;lt<=31;lt++,pt>>>=1)if(1&pt&&et.dyn_ltree[2*lt]!==0)return a;if(et.dyn_ltree[18]!==0||et.dyn_ltree[20]!==0||et.dyn_ltree[26]!==0)return s;for(lt=32;lt<g;lt++)if(et.dyn_ltree[2*lt]!==0)return s;return a}(S)),wt(S,S.l_desc),wt(S,S.d_desc),ot=function(et){var lt;for(h(et,et.dyn_ltree,et.l_desc.max_code),h(et,et.dyn_dtree,et.d_desc.max_code),wt(et,et.bl_desc),lt=y-1;3<=lt&&et.bl_tree[2*F[lt]+1]===0;lt--);return et.opt_len+=3*(lt+1)+5+5+4,lt}(S),U=S.opt_len+3+7>>>3,(tt=S.static_len+3+7>>>3)<=U&&(U=tt)):U=tt=H+5,H+4<=U&&O!==-1?I(S,O,H,X):S.strategy===4||tt===U?(K(S,2+(X?1:0),3),ht(S,Y,C)):(K(S,4+(X?1:0),3),function(et,lt,pt,dt){var St;for(K(et,lt-257,5),K(et,pt-1,5),K(et,dt-4,4),St=0;St<dt;St++)K(et,et.bl_tree[2*F[St]+1],3);$(et,et.dyn_ltree,lt-1),$(et,et.dyn_dtree,pt-1)}(S,S.l_desc.max_code+1,S.d_desc.max_code+1,ot+1),ht(S,S.dyn_ltree,S.dyn_dtree)),nt(S),X&&rt(S)},i._tr_tally=function(S,O,H){return S.pending_buf[S.d_buf+2*S.last_lit]=O>>>8&255,S.pending_buf[S.d_buf+2*S.last_lit+1]=255&O,S.pending_buf[S.l_buf+S.last_lit]=255&H,S.last_lit++,O===0?S.dyn_ltree[2*H]++:(S.matches++,O--,S.dyn_ltree[2*(p[H]+g+1)]++,S.dyn_dtree[2*P(O)]++),S.last_lit===S.lit_bufsize-1},i._tr_align=function(S){K(S,2,3),Z(S,x,Y),function(O){O.bi_valid===16?(Q(O,O.bi_buf),O.bi_buf=0,O.bi_valid=0):8<=O.bi_valid&&(O.pending_buf[O.pending++]=255&O.bi_buf,O.bi_buf>>=8,O.bi_valid-=8)}(S)}},{"../utils/common":41}],53:[function(e,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,i){(function(o){(function(a,s){if(!a.setImmediate){var l,u,c,g,m=1,d={},y=!1,f=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(_){process.nextTick(function(){w(_)})}:function(){if(a.postMessage&&!a.importScripts){var _=!0,E=a.onmessage;return a.onmessage=function(){_=!1},a.postMessage("","*"),a.onmessage=E,_}}()?(g="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",x,!1):a.attachEvent("onmessage",x),function(_){a.postMessage(g+_,"*")}):a.MessageChannel?((c=new MessageChannel).port1.onmessage=function(_){w(_.data)},function(_){c.port2.postMessage(_)}):f&&"onreadystatechange"in f.createElement("script")?(u=f.documentElement,function(_){var E=f.createElement("script");E.onreadystatechange=function(){w(_),E.onreadystatechange=null,u.removeChild(E),E=null},u.appendChild(E)}):function(_){setTimeout(w,0,_)},v.setImmediate=function(_){typeof _!="function"&&(_=new Function(""+_));for(var E=new Array(arguments.length-1),N=0;N<E.length;N++)E[N]=arguments[N+1];var T={callback:_,args:E};return d[m]=T,l(m),m++},v.clearImmediate=b}function b(_){delete d[_]}function w(_){if(y)setTimeout(w,0,_);else{var E=d[_];if(E){y=!0;try{(function(N){var T=N.callback,R=N.args;switch(R.length){case 0:T();break;case 1:T(R[0]);break;case 2:T(R[0],R[1]);break;case 3:T(R[0],R[1],R[2]);break;default:T.apply(s,R)}})(E)}finally{b(_),y=!1}}}}function x(_){_.source===a&&typeof _.data=="string"&&_.data.indexOf(g)===0&&w(+_.data.slice(g.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof qe<"u"?qe:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(Un)),Un.exports}var Aa=Ra();const or=_o(Aa);function Na(t){const n=t?.toLowerCase()||"";return n.includes("jpeg")?"jpeg":n.includes("png")?"png":n.includes("webp")?"webp":n.includes("gif")?"gif":n.includes("bmp")?"bmp":n.includes("avif")?"avif":"jpg"}async function Ia(t){try{const n=await fetch(t,{cache:"no-store"});if(n.ok){const e=await n.blob();return{blob:e,mime:e.type||"image/jpeg"}}}catch{}try{const n=await Ta(t),{blob:e,mime:r}=await Da(n);return{blob:e,mime:r}}catch{throw new Error("Unable to read image bytes (fetch/canvas failed).")}}function Ta(t){return new Promise((n,e)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>n(r),r.onerror=e,r.src=t})}function Da(t){return new Promise((n,e)=>{const r=Math.max(1,t.naturalWidth||t.width||1),i=Math.max(1,t.naturalHeight||t.height||1),o=document.createElement("canvas");o.width=r,o.height=i;const a=o.getContext("2d");if(!a)return e(new Error("Canvas2D unavailable"));a.drawImage(t,0,0,r,i),o.toBlob(s=>{if(!s)return e(new Error("Canvas toBlob failed (tainted?)"));n({blob:s,mime:s.type||"image/png"})},"image/png",.92)})}async function za(t){const n=t?.imageFormat??"jpeg",e=Math.max(.5,Math.min(.95,t?.quality??.8)),r=gt.getState(),i=r.photos,o=i.length;let a=0;const s=new or,l=s.folder("images");if(!l)throw new Error("ZIP: cannot create images/");const u={schemaVersion:1,createdAt:new Date().toISOString(),appConfigSnapshot:{MAX_CARDS:ti,CARD_EXPORT_SIZE:It,PREVIEW_EXACT_SIZE:Ke,PREVIEW_FAST_SIZE:Xs},images:[],cards:[]};for(let g=0;g<i.length;g++){const m=i[g];let d=null,y="image/jpeg";try{const _=await Ia(m.url);d=_.blob,y=_.mime||y}catch{d=null}if(d){const _=(d.type||"").toLowerCase();if(n==="jpeg"){if(!/jpe?g/.test(_)||e!==.8)try{d=await La(d,e),y="image/jpeg"}catch{}}else if(n==="png"&&!/png/.test(_))try{d=await Ma(d),y="image/png"}catch{}}const f=Na(y),v=`images/${m.id}.${f}`;d?(l.file(`${m.id}.${f}`,d),u.images.push({id:m.id,path:v,mime:y,size:d.size,source:{type:"embedded"}})):u.images.push({id:m.id,path:v,mime:y,source:{type:"url"}});const b=r.transforms[m.id]??{scale:1,tx:0,ty:0},w=r.cardBackground?.[m.id],x=(r.layersByPhoto[m.id]??[]).map(ja);u.cards.push({photoId:m.id,order:g,transform:b,background:w,layers:x}),a++,t?.onProgress?.({done:a,total:o})}return s.file("manifest.json",JSON.stringify(u,null,2)),await s.generateAsync({type:"blob",compression:"DEFLATE"})}function ja(t){if(!t)return t;if(t.type==="image"&&t.qrText){const{src:n,...e}=t;return e}if(t.type==="image"&&typeof t.src=="string"&&t.src.startsWith("data:")){const{src:n,...e}=t;return e}return{...t}}async function li(t){const n=URL.createObjectURL(t);try{return await new Promise((e,r)=>{const i=new Image;i.onload=()=>e(i),i.onerror=r,i.src=n})}finally{URL.revokeObjectURL(n)}}async function La(t,n){const e=await li(t),r=document.createElement("canvas");r.width=Math.max(1,e.naturalWidth||e.width||1),r.height=Math.max(1,e.naturalHeight||e.height||1);const i=r.getContext("2d");if(!i)throw new Error("Canvas2D unavailable");i.drawImage(e,0,0);const o=r.toDataURL("image/jpeg",n);return await(await fetch(o)).blob()}async function Ma(t){const n=await li(t),e=document.createElement("canvas");e.width=Math.max(1,n.naturalWidth||n.width||1),e.height=Math.max(1,n.naturalHeight||n.height||1);const r=e.getContext("2d");if(!r)throw new Error("Canvas2D unavailable");r.drawImage(n,0,0);const i=e.toDataURL("image/png");return await(await fetch(i)).blob()}async function ci(t){const n=[],e=await or.loadAsync(t),r=e.file("manifest.json");if(!r)throw new Error("manifest.json not found in zip");const i=await r.async("string");let o;try{o=JSON.parse(i)}catch{throw new Error("manifest.json is not valid JSON")}if(o.schemaVersion!==1)throw new Error(`Unsupported schemaVersion: ${o.schemaVersion}`);const a=new Map;for(const m of o.images){const d=e.file(m.path);if(!d){n.push(`Image file missing in zip: ${m.path}`);continue}try{const y=await d.async("blob"),f=URL.createObjectURL(y);a.set(m.id,f)}catch{n.push(`Failed to read image: ${m.path}`)}}const s=[],l={},u={},c={},g=[...o.cards].sort((m,d)=>m.order-d.order);for(const m of g){const d=a.get(m.photoId);d?s.push({id:m.photoId,url:d}):(n.push(`Missing image for card photoId=${m.photoId}. Card will appear without photo.`),s.push({id:m.photoId,url:Ba})),l[m.photoId]={...m.transform},m.background&&(c[m.photoId]={...m.background});const y=Array.isArray(m.layers)?m.layers.slice():[];for(const f of y)if(f&&f.type==="image"&&f.qrText&&!f.src){const v=Math.max(1,Math.round(f.w??f.h??512));f.src=await De(f.qrText,v,1),f.w==null&&(f.w=v),f.h==null&&(f.h=v)}u[m.photoId]=y}return gt.setState({photos:s,transforms:l,layersByPhoto:u,cardBackground:c}),{warnings:n}}const Ba="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=",Ae=ko(t=>({busy:!1,busyText:void 0,progress:void 0,setBusy:(n,e,r)=>t({busy:n,busyText:n?e:void 0,progress:n?r:void 0}),start:n=>t({busy:!0,busyText:n??"Loading...",progress:0}),setProgress:(n,e)=>t(r=>({progress:Math.max(0,Math.min(100,n)),busyText:e??r.busyText})),stop:()=>t({busy:!1,busyText:void 0,progress:void 0})}));function Pa(){const t=j.useRef(null),n=j.useRef(null),e=j.useRef(null),r=gt(m=>m.photos),i=gt(m=>m.add),o=gt(m=>m.clear),a=j.useCallback(m=>{if(!m?.length)return;const d=Array.from(m),y=Hs(d);i(y)},[i]),s=j.useCallback(m=>{a(m.target.files),m.target.value=""},[a]);async function l(m){const d=m.target.files?.[0];if(!d)return;const y=await d.text();m.target.value="";const{rows:f,hasRelative:v}=Ea(y);if(!f.length)return;if(v){alert("В этом CSV есть относительные пути. В текущей сборке локальная папка не поддерживается. Пожалуйста, используйте полные URL (http/https) или добавьте изображения кнопкой “Choose images”.");return}const b=Ae.getState();b.start("Importing CSV…");try{await g(f,null)}finally{b.stop()}}function u(m){return new Promise(d=>setTimeout(d,m))}async function c(m,d,y=4e3,f=50){const v=Date.now()+y,b=d.map(w=>w.toLowerCase());for(;Date.now()<v;){const x=gt.getState().layersByPhoto[m]??[],_=new Set(x.map(N=>typeof N?.name=="string"?N.name.toLowerCase():"").filter(Boolean));if(b.filter(N=>!_.has(N)).length===0)return[];await u(f)}return d}async function g(m,d){const y=Ae.getState(),f=gt.getState(),v=f.photos.length,b=f.max,w=Math.max(0,b-v);if(w<=0){alert(`Достигнут лимит коллекции: ${b} карточек.`);return}const x=Math.min(w,m.length);x<m.length&&alert(`Будут импортированы только ${x} из ${m.length} — лимит коллекции ${b}.`);const _=m.slice(0,x),E=[];let N=0,T=0;for(let k=0;k<_.length;k++){const p=_[k];try{let q=null,L="image";if(si(p.url)){const M=await fetch(p.url,{mode:"cors"});if(!M.ok)throw new Error(`HTTP ${M.status}`);q=await M.blob(),L=p.url.split("/").pop()||L}else if(ai(p.url))q=await(await fetch(p.url)).blob(),L="data.png";else throw new Error("Relative paths are disabled in this build");const D=URL.createObjectURL(q),G=crypto.randomUUID();E.push({id:G,url:D,name:L}),N++}catch(q){console.warn("CSV import skip:",p.url,q),T++}y.setProgress(Math.round((k+1)/_.length*100),`Importing CSV… (${k+1}/${_.length})`)}const R=gt.getState().add;R(E);const Y=gt.getState().photos.slice(v).map(k=>k.id),C=_.slice(0,Y.length);for(let k=0;k<C.length;k++){const p=C[k],q=Y[k];if(!p.layers)continue;const L=Object.keys(p.layers).map(B=>B.toLowerCase());(await c(q,L,4e3,50)).length;const G=gt.getState(),M=G.layersByPhoto[q]??[],W=B=>["x","y","w","h","width","height","fontSize","rotation","letterSpacing","lineHeight","padding","opacity","strokeWidth"].includes(B);for(const[B,P]of Object.entries(p.layers)){const Q=String(B).toLowerCase(),K=M.filter(Z=>typeof Z?.name=="string"&&Z.name.toLowerCase()===Q);if(K.length)for(const Z of K)for(const[ct,it]of Object.entries(P)){const nt=ct;if(Z.type==="image"&&Z.qrText!==void 0){if(nt==="text"){await G.updateQrLayer(q,Z.id,{text:it});continue}if(nt==="size"){const J=parseInt(it,10);Number.isNaN(J)||await G.updateQrLayer(q,Z.id,{size:J});continue}}const rt={};if(nt==="text"?rt.text=it:nt==="fill"?rt.fill=it:nt==="align"?rt.align=it:nt==="vertical_align"||nt==="verticalalign"?rt.verticalAlign=it:nt==="fontfamily"||nt==="font_family"?rt.fontFamily=it:(nt==="fontstyle"||nt==="font_style")&&(rt.fontStyle=it),W(nt)){const J=parseFloat(it);Number.isNaN(J)||(rt[nt]=J)}Object.keys(rt).length&&G.updateLayer(q,Z.id,rt)}}y.setProgress(Math.round((k+1)/C.length*100),`Applying CSV overrides… (${k+1}/${C.length})`)}T&&alert(`CSV import: добавлено ${N}, пропущено ${T}`)}return A.jsx("section",{className:"mt-4 space-y-4",children:A.jsxs("div",{className:"flex items-center justify-between gap-2",children:[A.jsxs("div",{className:"text-sm opacity-80",children:["Cards: ",A.jsx("b",{children:r.length})]}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx("input",{ref:t,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:s}),A.jsx("input",{ref:n,type:"file",accept:".csv,text/csv",className:"hidden",onChange:l}),A.jsx("input",{ref:e,type:"file",accept:".zip,application/zip",className:"hidden",onChange:async m=>{const d=m.currentTarget,y=d.files?.[0];if(d.value="",!!y)try{const{warnings:f}=await ci(y);f.length&&alert(`Import finished with warnings:
`+f.join(`
`))}catch(f){setTimeout(()=>{alert(`Cannot open .zip: ${f?.message??String(f)}`)},0)}}}),A.jsx(_t,{variant:"secondary",onClick:()=>e.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Open collection (.zip)"}),A.jsx("button",{onClick:()=>n.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Import CSV"}),A.jsx("button",{onClick:()=>t.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Choose images"}),A.jsx(_t,{variant:"destructive",onClick:o,disabled:!r.length,children:"Clear"})]})]})})}const di=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:yt("rounded-xl border bg-card text-card-foreground shadow",t),...n}));di.displayName="Card";const Oa=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:yt("flex flex-col space-y-1.5 p-6",t),...n}));Oa.displayName="CardHeader";const Fa=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:yt("font-semibold leading-none tracking-tight",t),...n}));Fa.displayName="CardTitle";const Ua=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:yt("text-sm text-muted-foreground",t),...n}));Ua.displayName="CardDescription";const Wa=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:yt("p-6 pt-0",t),...n}));Wa.displayName="CardContent";const qa=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:yt("flex items-center p-6 pt-0",t),...n}));qa.displayName="CardFooter";const ir=j.forwardRef(({className:t,value:n,...e},r)=>A.jsx(Ro,{ref:r,className:yt("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...e,children:A.jsx(Hi,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));ir.displayName=Ro.displayName;const ui=ts,fi=es,sr=j.forwardRef(({className:t,children:n,...e},r)=>A.jsxs(Ao,{ref:r,className:yt("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...e,children:[n,A.jsx(Zi,{asChild:!0,children:A.jsx(Co,{className:"h-4 w-4 opacity-50"})})]}));sr.displayName=Ao.displayName;const hi=j.forwardRef(({className:t,...n},e)=>A.jsx(No,{ref:e,className:yt("flex cursor-default items-center justify-center py-1",t),...n,children:A.jsx(Fi,{className:"h-4 w-4"})}));hi.displayName=No.displayName;const pi=j.forwardRef(({className:t,...n},e)=>A.jsx(Io,{ref:e,className:yt("flex cursor-default items-center justify-center py-1",t),...n,children:A.jsx(Co,{className:"h-4 w-4"})}));pi.displayName=Io.displayName;const ar=j.forwardRef(({className:t,children:n,position:e="popper",...r},i)=>A.jsx(Xi,{children:A.jsxs(To,{ref:i,className:yt("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:e,...r,children:[A.jsx(hi,{}),A.jsx(Ki,{className:yt("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),A.jsx(pi,{})]})}));ar.displayName=To.displayName;const Ya=j.forwardRef(({className:t,...n},e)=>A.jsx(Do,{ref:e,className:yt("px-2 py-1.5 text-sm font-semibold",t),...n}));Ya.displayName=Do.displayName;const pe=j.forwardRef(({className:t,children:n,...e},r)=>A.jsxs(zo,{ref:r,className:yt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e,children:[A.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:A.jsx(Ji,{children:A.jsx(Ui,{className:"h-4 w-4"})})}),A.jsx(Qi,{children:n})]}));pe.displayName=zo.displayName;const Ga=j.forwardRef(({className:t,...n},e)=>A.jsx(jo,{ref:e,className:yt("-mx-1 my-1 h-px bg-muted",t),...n}));Ga.displayName=jo.displayName;const Va=[];function mi(t,n=""){const[e,r]=j.useState(null),[i,o]=j.useState("idle");return j.useEffect(()=>{if(!t){r(null),o("idle");return}let a=!1;const s=new Image;return n&&(s.crossOrigin=n),o("loading"),s.onload=()=>{a||(r(s),o("loaded"))},s.onerror=()=>{a||(r(null),o("failed"))},s.src=t,()=>{a=!0}},[t,n]),[e,i]}function $a({layer:t,k:n,onSelect:e,updateLayer:r,selectedId:i,forwardRef:o,onReady:a}){const[s]=mi(t.src||"","anonymous"),l=i===t.id,u=j.useRef(null),c=l&&o?o:u;j.useEffect(()=>{s&&a?.()},[s]);const g=t.x*n,m=t.y*n,d=s?.naturalWidth??0,y=s?.naturalHeight??0,f=Math.max(1,t.w?t.w*n:d*n||1),v=Math.max(1,t.h?t.h*n:y*n||1);return A.jsx(Eo,{ref:c,draggable:!0,listening:!0,image:s??void 0,x:g,y:m,width:f,height:v,rotation:t.rotation,visible:t.visible,onMouseDown:()=>e(t.id),onTap:()=>e(t.id),onDragEnd:b=>{r(t.photoId,t.id,{x:b.target.x()/n,y:b.target.y()/n})},onTransformEnd:b=>{const w=b.target,x=typeof w.scaleX=="function"?w.scaleX():1,_=typeof w.scaleY=="function"?w.scaleY():1,E=typeof w.width=="function"?w.width():f,N=typeof w.height=="function"?w.height():v,T={x:w.x()/n,y:w.y()/n,rotation:w.rotation(),scaleX:1,scaleY:1,w:Math.max(1,Math.round(E*x/n)),h:Math.max(1,Math.round(N*_/n))};typeof w.scaleX=="function"&&w.scaleX(1),typeof w.scaleY=="function"&&w.scaleY(1),r(t.photoId,t.id,T)}},t.id)}const an=j.forwardRef(function({photoId:n,size:e,selectedId:r,onSelect:i,transformOverride:o,layersOverride:a,backgroundOverride:s,onLayerPatch:l,onTransformPatch:u},c){const m=j.useRef(null),d=gt(M=>M.photos.find(W=>W.id===n)?.url),y=gt(M=>M.transforms[n]??ge),f=gt(M=>M.setTransform),v=o??y,b=gt(M=>M.layersByPhoto[n]??Va,Object.is).map(M=>({...M,photoId:n})),w=(a??b).map(M=>({...M,photoId:n})),x=s||gt(M=>M.cardBackground?.[n]??tn,Object.is),_=gt(M=>M.updateLayer),E=j.useCallback((M,W,B)=>{l?l(W,B):_(M,W,B)},[l,_]),[N,T]=mi(d??"","anonymous"),R=T==="loaded";j.useImperativeHandle(c,()=>({toDataURL:M=>{const W=m.current;if(!W)return null;const B=M&&M>0?M/e:1;return W.toDataURL({pixelRatio:B,mimeType:"image/png"})},isReady:()=>!!m.current&&R}));const z=j.useRef(null),F=j.useRef(null),[Y,C]=j.useState(0),k=e/It,p=j.useMemo(()=>w.find(M=>M.id===r),[w,r]),q=!!(p?.type==="image"&&p?.qrText);j.useLayoutEffect(()=>{const M=z.current,W=F.current;M&&(r&&W?M.nodes([W]):M.nodes([]),M.getLayer()?.batchDraw())},[r,p?.id,w.length,Y]);function L(M,W,B){const P=W/M.width,Q=W/M.height,Z=Math.min(P,Q)*(B?.scale??1),ct=M.width*Z,it=M.height*Z,nt=(W-ct)/2+(B?.tx??0)/100*W,rt=(W-it)/2+(B?.ty??0)/100*W;return{x:nt*k,y:rt*k,width:ct*k,height:it*k}}const D=(M,W,B)=>Math.max(W,Math.min(B,M)),G=j.useCallback(M=>{M.evt.preventDefault();const W=M.evt.deltaY||0;if(!Number.isFinite(W)||W===0)return;const B=Math.pow(1.0015,-W),P=v,Q=D(P.scale*B,.5,4);Q!==P.scale&&(u?u({scale:Q}):f(n,{scale:Q}))},[n,v,u,f]);return A.jsx(Wi,{ref:m,width:e,height:e,pixelRatio:1,listening:!0,style:{width:"100%",height:"100%"},onWheel:G,onMouseDown:M=>{M.target===M.target.getStage()&&i(null)},onTouchStart:M=>{M.target===M.target.getStage()&&i(null)},children:A.jsxs(qi,{children:[A.jsx(_r,{x:0,y:0,width:e,height:e,fill:x.color,opacity:x.alpha,listening:!1}),N?A.jsx(Eo,{image:N,...L(N,It,v),listening:!1}):null,w.slice().sort((M,W)=>M.z-W.z).map(M=>{if(M.type==="text"){const W=M,P=r===W.id?F:void 0,Q=W.x*k,K=W.y*k,Z=(W.fontSize??16)*k,ct=W.width?W.width*k:void 0,it=(W.padding??0)*k,nt=(W.letterSpacing??0)*k;return A.jsx(Yi,{ref:P,draggable:!0,x:Q,y:K,text:W.text,fontFamily:W.fontFamily||"Georgia, serif",fontSize:Z,fontStyle:W.fontStyle,fill:W.fill,width:ct,align:W.align,lineHeight:W.lineHeight??1.25,padding:it,letterSpacing:nt,rotation:W.rotation,scaleX:1,scaleY:1,visible:W.visible,perfectDrawEnabled:!1,onTransform:rt=>{const J=rt.target,ut=typeof J.scaleX=="function"?J.scaleX():1,ht=typeof J.width=="function"?J.width():void 0;ht!==void 0&&ut&&ut!==1&&(J.width(Math.max(4,Math.round(ht*ut))),typeof J.scaleX=="function"&&J.scaleX(1),typeof J.scaleY=="function"&&J.scaleY(1),J.getLayer()?.batchDraw())},onMouseDown:()=>i(W.id),onTap:()=>i(W.id),onDragEnd:rt=>{E(n,W.id,{x:rt.target.x()/k,y:rt.target.y()/k})},onTransformEnd:rt=>{const J=rt.target,ut=typeof J.scaleX=="function"?J.scaleX():1,ht=typeof J.width=="function"?J.width():void 0,wt={x:J.x()/k,y:J.y()/k,rotation:J.rotation(),scaleX:1,scaleY:1,width:ht!==void 0?Math.max(4,Math.round(ht*ut/k)):void 0};typeof J.scaleX=="function"&&J.scaleX(1),typeof J.scaleY=="function"&&J.scaleY(1),E(n,W.id,wt)}},W.id)}if(M.type==="rect"){const W=M,P=r===W.id?F:void 0,Q=W.x*k,K=W.y*k,Z=Math.max(1,(W.width??100)*k),ct=Math.max(1,(W.height??100)*k),it=Math.max(0,(W.strokeWidth??0)*k),nt=Math.max(0,(W.cornerRadius??0)*k);return A.jsx(_r,{ref:P,draggable:!0,x:Q,y:K,width:Z,height:ct,rotation:W.rotation,fill:W.fill??"#ffffff",stroke:W.stroke,strokeWidth:it,cornerRadius:nt,visible:W.visible,opacity:Math.max(0,Math.min(1,W.opacity??1)),onMouseDown:()=>i(W.id),onTap:()=>i(W.id),onDragEnd:rt=>{E(n,W.id,{x:rt.target.x()/k,y:rt.target.y()/k})},onTransformEnd:rt=>{const J=rt.target,ut=typeof J.scaleX=="function"?J.scaleX():1,ht=typeof J.scaleY=="function"?J.scaleY():1,wt=typeof J.width=="function"?J.width():Z,h=typeof J.height=="function"?J.height():ct,$={x:J.x()/k,y:J.y()/k,rotation:J.rotation(),scaleX:1,scaleY:1,width:Math.max(1,Math.round(wt*ut/k)),height:Math.max(1,Math.round(h*ht/k))};typeof J.scaleX=="function"&&J.scaleX(1),typeof J.scaleY=="function"&&J.scaleY(1),E(n,W.id,$)}},W.id)}if(M.type==="image"){const W=r===M.id;return A.jsx($a,{layer:M,k,selectedId:r,onSelect:i,updateLayer:E,forwardRef:W?F:void 0,onReady:()=>C(B=>B+1)},M.id)}return null}),r&&A.jsx(Gi,{ref:z,rotateEnabled:!0,enabledAnchors:["middle-left","middle-right","top-center","bottom-center","top-left","top-right","bottom-left","bottom-right"],borderStroke:"#fff",anchorStroke:"#fff",anchorFill:"#111",anchorSize:7,keepRatio:q,centeredScaling:!1,boundBoxFunc:(M,W)=>{const P=Math.max(6,W.width),Q=Math.max(6,W.height);return{...W,width:P,height:Q}}})]})})}),gi=os,Ha=ns,bi=j.forwardRef(({className:t,...n},e)=>A.jsx(Lo,{ref:e,className:yt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));bi.displayName=Lo.displayName;const lr=j.forwardRef(({className:t,children:n,...e},r)=>A.jsxs(Ha,{children:[A.jsx(bi,{}),A.jsxs(Mo,{ref:r,className:yt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e,children:[n,A.jsxs(rs,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[A.jsx(Vi,{className:"h-4 w-4"}),A.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));lr.displayName=Mo.displayName;const cr=({className:t,...n})=>A.jsx("div",{className:yt("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});cr.displayName="DialogHeader";const dr=({className:t,...n})=>A.jsx("div",{className:yt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});dr.displayName="DialogFooter";const ur=j.forwardRef(({className:t,...n},e)=>A.jsx(Bo,{ref:e,className:yt("text-lg font-semibold leading-none tracking-tight",t),...n}));ur.displayName=Bo.displayName;const yi=j.forwardRef(({className:t,...n},e)=>A.jsx(Po,{ref:e,className:yt("text-sm text-muted-foreground",t),...n}));yi.displayName=Po.displayName;const Za=qo("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),he=j.forwardRef(({className:t,...n},e)=>A.jsx(Oo,{ref:e,className:yt(Za(),t),...n}));he.displayName=Oo.displayName;const Je=j.forwardRef(({className:t,...n},e)=>A.jsxs(Fo,{ref:e,className:yt("relative flex w-full touch-none select-none items-center",t),...n,children:[A.jsx(is,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:A.jsx(ss,{className:"absolute h-full bg-primary"})}),A.jsx(as,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Je.displayName=Fo.displayName;const Wn=new Map;function en(t){const n=t.trim();if(n.startsWith('"')){const e=n.indexOf('"',1);return e>1?n.slice(1,e):n.replace(/["']/g,"")}return n.split(",")[0].replace(/["']/g,"").trim()}function Xa(t){const n=en(t);return ei.find(e=>en(e.family).toLowerCase()===n.toLowerCase())}function Ka(t,n){if(document.getElementById(n))return;const e=document.createElement("link");e.id=n,e.rel="stylesheet",e.href=t;const r=document.createElement("link");r.rel="preconnect",r.href="https://fonts.googleapis.com";const i=document.createElement("link");i.rel="preconnect",i.href="https://fonts.gstatic.com",i.crossOrigin="anonymous",document.head.appendChild(r),document.head.appendChild(i),document.head.appendChild(e)}function Ja(t){const n=en(t);if(Wn.has(n))return Wn.get(n);const e=(async()=>{const r=Xa(t);r&&r.cssHref&&Ka(r.cssHref,`font-css-${r.id}`);try{const i=document;i?.fonts?.ready&&typeof i.fonts.ready.then=="function"&&await i.fonts.ready}catch{}try{document.fonts?.load&&await document.fonts.load(`1em ${en(t)}`)}catch{}})();return Wn.set(n,e),e}const Qa=[],Ze="__none__",Me=bt.get().DEFAULTS,qn=Me.BACKGROUND,ee=Me.TEXT,ne=Me.RECT;Me.IMAGE;const qt=Me.QR;function fe(t){return JSON.parse(JSON.stringify(t))}function tl({layer:t,onPatch:n}){const[e,r]=j.useState(t.qrText??qt.text),[i,o]=j.useState(Math.max(1,Math.round(t.w??t.h??qt.size))),[a,s]=j.useState(!1);return j.useEffect(()=>{r(t.qrText??qt.text),o(Math.max(1,Math.round(t.w??t.h??qt.size)))},[t.id,t.qrText,t.w,t.h]),A.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-foreground/10",children:"QR"}),A.jsx("span",{className:"opacity-70 text-sm",children:"This layer is a QR code"})]}),A.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[A.jsx("label",{className:"text-xs opacity-70",children:"QR text / URL"}),A.jsx("input",{type:"text",value:e,onChange:l=>r(l.target.value),className:"flex-1 min-w-[16rem] rounded border px-2 py-1 text-sm",placeholder:"https://example.com"}),A.jsx("label",{className:"text-xs opacity-70",children:"Size (px)"}),A.jsx("input",{type:"number",min:1,max:It,step:1,value:i,onChange:l=>o(Math.max(1,Number(l.target.value)||1)),className:"w-28 rounded border px-2 py-1 text-sm",title:"QR side size in card pixels"}),A.jsx(_t,{variant:"secondary",disabled:a,onClick:async()=>{const l=e.trim();if(l)try{s(!0);const u=Math.max(1,i),c=await De(l,u);n({qrText:l,w:u,h:u,src:c})}finally{s(!1)}},children:a?"Updating…":"Update QR"})]})]})}function el({open:t,onOpenChange:n,photo:e,canvasRef:r}){const i=gt(L=>L.layersByPhoto[e.id]??Qa,Object.is),o=gt(L=>L.cardBackground?.[e.id]??tn,Object.is),a=gt(L=>L.transforms[e.id]??ge),[s,l]=j.useState([]),[u,c]=j.useState(tn),[g,m]=j.useState(a);j.useEffect(()=>{t&&(l(fe(i)),c(o??qn),m({...a}))},[t,i,o,a]);const[d,y]=j.useState(null);j.useEffect(()=>{if(!d)return;(s??[]).some(D=>D.id===d)||y(null)},[s,d]);const f=j.useRef(null),v=j.useCallback(L=>{if(!d||!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(L.key))return;L.preventDefault();const G=L.altKey?1:L.shiftKey?20:5;let M=0,W=0;L.key==="ArrowLeft"&&(M=-G),L.key==="ArrowRight"&&(M=G),L.key==="ArrowUp"&&(W=-G),L.key==="ArrowDown"&&(W=G),l(B=>{const P=B.findIndex(Z=>Z.id===d);if(P===-1)return B;const Q=B.slice(),K=Q[P];return Q[P]={...K,x:(K.x??0)+M,y:(K.y??0)+W},Q})},[d]),b=j.useRef(null),w=r??b,x=j.useRef(null),[_,E]=j.useState(0),N=j.useCallback(()=>{const L=x.current;if(!L)return;const D=Math.round(L.clientWidth);D&&E(D)},[]);j.useEffect(()=>{const L=x.current;if(!L)return;const D=new ResizeObserver(N);return D.observe(L),N(),()=>D.disconnect()},[N]),j.useEffect(()=>{t&&(requestAnimationFrame(N),setTimeout(N,50))},[t,N]);const T=j.useCallback((L,D)=>{const G=L.id.slice(0,6);let M="Layer";return L.type==="text"?M="Text":L.type==="rect"?M="Rect":L.type==="image"&&L.qrText?M="QR":L.type==="image"&&(M="Image"),`${M} #${D+1} (${G})`},[]),R=j.useCallback((L,D)=>{l(G=>{const M=G.findIndex(B=>B.id===L);if(M===-1)return G;const W=G.slice();return W[M]={...W[M],...D},W})},[]),z=j.useCallback(L=>{l(D=>{const G=D.findIndex(B=>B.id===L);if(G===-1)return D;const M=D.reduce((B,P)=>Math.max(B,P.z??1),1),W=D.slice();return W[G]={...W[G],z:M+1},W})},[]),F=j.useCallback(L=>{l(D=>{const G=D.findIndex(B=>B.id===L);if(G===-1)return D;const M=D.reduce((B,P)=>Math.min(B,P.z??1),1),W=D.slice();return W[G]={...W[G],z:M-1},W})},[]),Y=j.useCallback(L=>{l(D=>D.filter(G=>G.id!==L))},[]),C=j.useCallback(()=>{const L=crypto.randomUUID();return l(D=>[...D,{id:L,type:"text",...fe(ee),rotation:0,scaleX:1,scaleY:1,visible:!0,z:D.reduce((G,M)=>Math.max(G,M.z??1),1)+1}]),L},[]),k=j.useCallback(()=>{const L=crypto.randomUUID();return l(D=>[...D,{id:L,type:"rect",...fe(ne),rotation:0,scaleX:1,scaleY:1,visible:!0,z:D.reduce((G,M)=>Math.max(G,M.z??1),1)+1}]),L},[]),p=j.useCallback(async L=>{const D=crypto.randomUUID(),G=L&&L.trim()?L.trim():qt.text,M=Math.max(1,qt.size),W=await De(G,M);return l(B=>[...B,{id:D,type:"image",qrText:G,src:W,x:qt.x,y:qt.y,w:M,h:M,rotation:0,scaleX:1,scaleY:1,visible:!0,name:qt.name,z:B.reduce((P,Q)=>Math.max(P,Q.z??1),1)+1}]),D},[]);j.useEffect(()=>{t&&setTimeout(()=>f.current?.focus(),0)},[t,d]);const q=(L,D,G)=>Math.max(D,Math.min(G,L));return A.jsx(gi,{open:t,onOpenChange:n,children:A.jsxs(lr,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden flex flex-col",children:[A.jsxs(cr,{className:"shrink-0",children:[A.jsx(ur,{children:"Edit card"}),A.jsx(yi,{className:"sr-only",children:"Adjust zoom/position and edit layers."})]}),A.jsx("div",{className:"flex-1 overflow-auto",children:A.jsxs("div",{className:"grid gap-4",children:[A.jsx("div",{ref:f,tabIndex:0,onKeyDown:v,className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20 outline-none focus:outline-none",children:A.jsx("div",{className:"relative aspect-square overflow-hidden rounded-xl",ref:x,children:_>0&&A.jsx("div",{className:"absolute inset-0 pointer-events-auto z-0",children:A.jsx(an,{"data-dnd-ignore":!0,ref:w,photoId:e.id,size:_,selectedId:d,onSelect:y,transformOverride:g,layersOverride:s,backgroundOverride:u,onLayerPatch:(L,D)=>R(L,D),onTransformPatch:L=>m(D=>({...D,...L}))})})})}),A.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx(he,{className:"whitespace-nowrap",children:"Layers"}),A.jsxs(ui,{value:d??Ze,onValueChange:L=>y(L===Ze?null:L),children:[A.jsx(sr,{className:"w-[18rem]",children:A.jsx(fi,{placeholder:s.length?"Select a layer…":"No layers"})}),A.jsx(ar,{children:s.length===0?A.jsx(pe,{value:Ze,disabled:!0,children:"No layers"}):A.jsxs(A.Fragment,{children:[A.jsx(pe,{value:Ze,disabled:!0,children:"Select a layer…"}),s.slice().sort((L,D)=>L.z-D.z).map((L,D)=>A.jsx(pe,{value:L.id,children:T(L,D)},L.id))]})})]}),A.jsx("div",{className:"ml-auto"})]})}),d&&(()=>{const L=s.find(D=>D.id===d&&D.type==="text");return L?A.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[A.jsx("label",{className:"text-xs opacity-70",children:"Text"}),A.jsx("textarea",{value:L.text,onChange:D=>R(L.id,{text:D.target.value}),rows:3,className:"resize-y w-full rounded border px-2 py-1 text-sm bg-background"}),A.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[A.jsx("label",{className:"text-xs opacity-70",children:"Size"}),A.jsx("input",{type:"number",min:8,max:240,step:1,value:L.fontSize??ee.fontSize,onChange:D=>R(L.id,{fontSize:Number(D.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),A.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${L.fontStyle?.includes("bold")?"bg-foreground/10":""}`,onClick:()=>{const D=L.fontStyle?.includes("bold"),M=`${L.fontStyle?.includes("italic")?"italic":""} ${D?"":"bold"}`.trim();R(L.id,{fontStyle:M})},children:"Bold"}),A.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${L.fontStyle?.includes("italic")?"bg-foreground/10":""}`,onClick:()=>{const D=L.fontStyle?.includes("bold"),M=`${L.fontStyle?.includes("italic")?"":"italic"} ${D?"bold":""}`.trim();R(L.id,{fontStyle:M})},children:"Italic"}),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Color"}),A.jsx("input",{type:"color",value:L.fill??ee.fill,onChange:D=>R(L.id,{fill:D.target.value}),className:"h-8 w-10 cursor-pointer"})]}),A.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[A.jsx("label",{className:"text-xs opacity-70",children:"Font"}),A.jsx("select",{value:L.fontFamily??ee.fontFamily,onChange:async D=>{const G=D.target.value;await Ja(G),R(L.id,{fontFamily:G})},className:"rounded border px-2 py-1 text-sm",children:ei.map(D=>A.jsx("option",{value:D.family,children:D.label},D.id))})]}),A.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[A.jsx("label",{className:"text-xs opacity-70",children:"Align"}),["left","center","right"].map(D=>A.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${L.align===D?"bg-foreground/10":""}`,onClick:()=>R(L.id,{align:D}),children:D},D)),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Wrap width"}),A.jsx("input",{type:"number",min:0,max:It,step:10,value:L.width??ee.width,onChange:D=>R(L.id,{width:Number(D.target.value)||void 0}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0 disables wrapping"}),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Padding"}),A.jsx("input",{type:"number",min:0,max:200,step:1,value:L.padding??ee.padding,onChange:D=>R(L.id,{padding:Number(D.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Line height"}),A.jsx("input",{type:"number",min:.8,max:2,step:.05,value:L.lineHeight??ee.lineHeight,onChange:D=>R(L.id,{lineHeight:Number(D.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Tracking"}),A.jsx("input",{type:"number",min:-5,max:20,step:.5,value:L.letterSpacing??ee.letterSpacing,onChange:D=>R(L.id,{letterSpacing:Number(D.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Additional spacing between glyphs (px, card space)"})]})]}):null})(),d&&(()=>{const L=s.find(D=>D.id===d&&D.type==="image"&&D.qrText);return L?A.jsx(tl,{layer:L,onPatch:D=>R(L.id,D)}):null})(),d&&(()=>{const L=s.find(D=>D.id===d&&D.type==="rect");return L?A.jsx("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:A.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[A.jsx("label",{className:"text-xs opacity-70",children:"Fill"}),A.jsx("input",{type:"color",value:L.fill??ne.fill,onChange:D=>R(L.id,{fill:D.target.value}),className:"h-8 w-10 cursor-pointer"}),A.jsx("label",{className:"text-xs opacity-70",children:"Stroke"}),A.jsx("input",{type:"color",value:L.stroke??ne.stroke??"#000000",onChange:D=>R(L.id,{stroke:D.target.value}),className:"h-8 w-10 cursor-pointer"}),A.jsx("label",{className:"text-xs opacity-70",children:"Stroke width"}),A.jsx("input",{type:"number",min:0,max:100,step:1,value:L.strokeWidth??ne.strokeWidth,onChange:D=>R(L.id,{strokeWidth:Number(D.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Width in card pixels"}),A.jsx("label",{className:"text-xs opacity-70",children:"Radius"}),A.jsx("input",{type:"number",min:0,max:500,step:1,value:L.cornerRadius??ne.cornerRadius,onChange:D=>R(L.id,{cornerRadius:Number(D.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Corner radius in card pixels"}),A.jsx("label",{className:"text-xs opacity-70",children:"Opacity"}),A.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((L.opacity??ne.opacity)*100),onChange:D=>R(L.id,{opacity:Math.max(0,Math.min(1,Number(D.target.value)/100))}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0..100 %"}),A.jsx("label",{className:"text-xs opacity-70",children:"Width"}),A.jsx("input",{type:"number",min:1,max:It,step:1,value:L.width??ne.width,onChange:D=>R(L.id,{width:Number(D.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),A.jsx("label",{className:"text-xs opacity-70",children:"Height"}),A.jsx("input",{type:"number",min:1,max:It,step:1,value:L.height??ne.height,onChange:D=>R(L.id,{height:Number(D.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"})]})}):null})(),A.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:A.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[A.jsx(_t,{variant:"secondary",disabled:!d,onClick:()=>{if(!d)return;const L=s.find(G=>G.id===d);if(!L)return;const D=((L.rotation??0)-90)%360;R(d,{rotation:D<0?D+360:D})},children:"Rotate −90°"}),A.jsx(_t,{variant:"secondary",disabled:!d,onClick:()=>{if(!d)return;const L=s.find(G=>G.id===d);if(!L)return;const D=((L.rotation??0)+90)%360;R(d,{rotation:D})},children:"Rotate +90°"}),A.jsx(_t,{variant:"secondary",disabled:!d,onClick:()=>d&&z(d),children:"Bring to front"}),A.jsx(_t,{variant:"secondary",disabled:!d,onClick:()=>d&&F(d),children:"Send to back"}),A.jsx(_t,{variant:"destructive",disabled:!d,onClick:()=>{d&&(Y(d),y(null))},children:"Delete layer"})]})}),A.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:A.jsxs("div",{className:"grid gap-3",children:[A.jsxs("div",{className:"grid gap-1.5",children:[A.jsxs("div",{className:"flex items-center justify-between text-sm",children:[A.jsx(he,{children:"Zoom"}),A.jsxs("span",{className:"tabular-nums opacity-70",children:[g.scale.toFixed(2),"×"]})]}),A.jsx(Je,{value:[g.scale],min:.5,max:4,step:.01,onValueChange:([L])=>m(D=>({...D,scale:q(L??D.scale,.5,4)}))})]}),A.jsxs("div",{className:"grid gap-1.5",children:[A.jsxs("div",{className:"flex items-center justify-between text-sm",children:[A.jsx(he,{children:"Horizontal"}),A.jsxs("span",{className:"tabular-nums opacity-70",children:[g.tx.toFixed(0),"%"]})]}),A.jsx(Je,{value:[g.tx],min:-100,max:100,step:.1,onValueChange:([L])=>m(D=>({...D,tx:L}))})]}),A.jsxs("div",{className:"grid gap-1.5",children:[A.jsxs("div",{className:"flex items-center justify-between text-sm",children:[A.jsx(he,{children:"Vertical"}),A.jsxs("span",{className:"tabular-nums opacity-70",children:[g.ty.toFixed(0),"%"]})]}),A.jsx(Je,{value:[g.ty],min:-100,max:100,step:.1,onValueChange:([L])=>m(D=>({...D,ty:L}))})]})]})}),A.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:A.jsx("div",{className:"mt-3 grid gap-2 rounded-md border p-2 bg-background/60",children:A.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[A.jsx(he,{className:"opacity-70",children:"Background"}),A.jsx("label",{className:"text-xs opacity-70",children:"Color"}),A.jsx("input",{type:"color",value:u.color??qn.color,onChange:L=>c(D=>({...D,color:L.target.value})),className:"h-8 w-10 cursor-pointer"}),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Opacity"}),A.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((u.alpha??qn.alpha)*100),onChange:L=>c(D=>({...D,alpha:Math.max(0,Math.min(1,Number(L.target.value)/100))})),className:"w-20 rounded border px-2 py-1 text-sm",title:"0..100 %"}),A.jsx("span",{className:"text-xs opacity-60",children:"(0% = transparent, 100% = solid)"})]})})})]})}),A.jsxs(dr,{className:"shrink-0 space-y-2",children:[A.jsxs("div",{className:"flex items-center justify-between gap-2",children:[A.jsx(_t,{variant:"ghost",onClick:()=>{m(ge)},children:"Reset image"}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx(_t,{variant:"secondary",onClick:()=>{n(!1)},children:"Cancel"}),A.jsx(_t,{onClick:()=>{gt.setState(L=>({...L,transforms:{...L.transforms,[e.id]:fe(g)},cardBackground:{...L.cardBackground,[e.id]:fe(u)},layersByPhoto:{...L.layersByPhoto,[e.id]:fe(s)}})),n(!1)},children:"Save"})]})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx(_t,{variant:"secondary",onClick:async()=>{const L=window.prompt("QR text / URL:",qt.text)??"";if(!L.trim())return;const D=await p(L.trim());y(D)},children:"Add QR"}),A.jsx(_t,{variant:"secondary",onClick:()=>{const L=C();y(L)},children:"Add text layer"}),A.jsx(_t,{variant:"secondary",onClick:()=>{const L=k();y(L)},children:"Add rectangle"})]})]})]})})}function nl(t,n="card"){return(t.replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||n).slice(0,100)}function rl(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function ol({open:t,onOpenChange:n,photo:e,transform:r,layers:i,snapshot:o,onEdit:a}){const[s,l]=j.useState(null),[u,c]=j.useState(!1),g=j.useRef(null),[m,d]=j.useState(0);j.useEffect(()=>{const x=g.current;if(!x)return;const _=()=>d(Math.round(x.clientWidth));_();const E=new ResizeObserver(_);return E.observe(x),()=>E.disconnect()},[]);const y=j.useRef(null),[f,v]=j.useState(Ke),b=j.useMemo(()=>t?A.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:f,height:f,overflow:"hidden"},children:A.jsx(an,{ref:y,photoId:e.id,size:f,selectedId:null,onSelect:()=>{}})}):null,[t,e.id,f]);async function w(x){v(x),await new Promise(E=>setTimeout(E,0));try{const E=document;E?.fonts?.ready&&typeof E.fonts.ready.then=="function"&&await E.fonts.ready}catch{}const _=Date.now()+1e3;for(;!y.current?.isReady?.()&&!(Date.now()>_);)await new Promise(E=>setTimeout(E,30));return y.current?.toDataURL(x)??null}return j.useEffect(()=>{let x=!1;if(!t){l(null);return}return(async()=>{c(!0);const _=Math.max(Ke,m||Ke);let E=null;o&&(E=o(_)),E||(E=await w(_)),!x&&(l(E),c(!1))})(),()=>{x=!0}},[t,m,e.id,r.scale,r.tx,r.ty,i,o]),A.jsxs(gi,{"data-dnd-ignore":!0,open:t,onOpenChange:n,children:[b,A.jsxs(lr,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden",children:[A.jsx(cr,{children:A.jsx(ls,{asChild:!0,children:A.jsx(ur,{children:"Preview"})})}),A.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:A.jsxs("div",{ref:g,className:"relative aspect-square overflow-hidden rounded-xl",children:[s?A.jsx("img",{src:s,alt:e.name,className:"absolute inset-0 w-full h-full object-contain"}):A.jsx("div",{className:"h-24"}),A.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${u?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!u,children:A.jsx("div",{className:"h-7 w-7 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]})}),A.jsxs(dr,{className:"mt-2 gap-2",children:[A.jsx(_t,{variant:"secondary",onClick:()=>{n(!1),a?.()},children:"Edit"}),A.jsx(_t,{variant:"secondary",onClick:()=>n(!1),children:"Close"}),A.jsx(_t,{onClick:async()=>{const x=o&&o(It)||await w(It);x&&rl(x,`${nl(e.name||"card")}.png`)},children:"Save PNG"})]})]})]})}async function il(t,n=It){const e=document.createElement("div");e.style.position="fixed",e.style.left="-10000px",e.style.top="-10000px",e.style.width=`${n}px`,e.style.height=`${n}px`,document.body.appendChild(e);const r=j.createRef(),i=So.createRoot(e);i.render(j.createElement(an,{ref:r,photoId:t,size:n,selectedId:null,onSelect:()=>{}})),await new Promise(s=>setTimeout(s,0));try{const s=document;s?.fonts?.ready&&typeof s.fonts.ready.then=="function"&&await s.fonts.ready}catch{}const o=Date.now()+1500;for(;!r.current?.isReady?.()&&!(Date.now()>o);)await new Promise(s=>setTimeout(s,25));const a=r.current?.toDataURL(n)??"";return i.unmount(),e.remove(),a}async function vi(t,n=It){return il(t,n)}function sl(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function al({photo:t}){const n=gt(N=>N.remove),e=gt(N=>N.transforms[t.id]??ge),r=gt(N=>N.layersByPhoto),[i,o]=j.useState(!1),[a,s]=j.useState(!1),l=j.useRef(null),u=j.useRef(null),[c,g]=j.useState(0);j.useEffect(()=>{const N=u.current;if(!N)return;const T=()=>g(N.clientWidth);T();const R=new ResizeObserver(T);return R.observe(N),()=>R.disconnect()},[]);const m=j.useRef(null),[d,y]=j.useState(512),f=A.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:d,height:d,overflow:"hidden"},children:A.jsx(an,{ref:m,photoId:t.id,size:d,selectedId:null,onSelect:()=>{}})}),[v,b]=j.useState(null),[w,x]=j.useState(!0),_=j.useRef(null);j.useEffect(()=>{if(i)return;const N=window.devicePixelRatio||1,T=Math.max(384,Math.min(1024,Math.round((c||300)*N)));return y(T),_.current&&window.clearTimeout(_.current),_.current=window.setTimeout(async()=>{x(!0);try{const F=document;F?.fonts?.ready&&typeof F.fonts.ready.then=="function"&&await F.fonts.ready}catch{}const R=Date.now()+800;for(;!m.current?.isReady?.()&&!(Date.now()>R);)await new Promise(F=>setTimeout(F,25));const z=m.current?.toDataURL(T)??null;b(z),x(!1)},150),()=>{_.current&&(window.clearTimeout(_.current),_.current=null)}},[c,i,t.id,e.scale,e.tx,e.ty,r[t.id]]);const E=j.useCallback(async()=>{const N=await vi(t.id,It);if(!N)return;const R=(t.name||"card").replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||"card";sl(N,`${R}.png`)},[t.id,t.name]);return A.jsxs(A.Fragment,{children:[f,A.jsxs("div",{className:"overflow-hidden rounded-xl border border-foreground/15 bg-foreground/[0.02]",children:[A.jsxs("div",{ref:u,onClick:()=>s(!0),className:"relative aspect-square w-full overflow-hidden cursor-zoom-in",children:[A.jsx("button",{"aria-label":"Remove image",title:"Remove",onClick:N=>{N.stopPropagation(),n(t.id)},className:"absolute right-1 top-1 z-10 rounded-md bg-background/80 px-1.5 py-0.5 text-[11px] shadow hover:bg-background",children:"×"}),v?A.jsx("img",{src:v,alt:t.name,className:"h-full w-full object-cover"}):A.jsx("div",{className:"h-full w-full bg-foreground/[0.06]"}),A.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${w?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!w,children:A.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]}),A.jsxs("div",{className:"flex items-center justify-between gap-2 border-t bg-background/70 px-2 py-1.5 supports-[backdrop-filter]:bg-background/60",children:[A.jsx("button",{"aria-label":"Edit card",title:"Edit",onClick:N=>{N.stopPropagation(),o(!0)},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Edit"}),A.jsx("button",{"aria-label":"Save PNG",title:"Save PNG",onClick:N=>{N.stopPropagation(),E()},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Save PNG"})]})]}),A.jsx(ol,{open:a,onOpenChange:s,photo:t,transform:e,layers:r[t.id],snapshot:N=>l.current?.toDataURL(N)??null,onEdit:()=>o(!0)}),A.jsx(el,{open:i,onOpenChange:o,photo:t,canvasRef:l})]})}function ll(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return j.useMemo(()=>r=>{n.forEach(i=>i(r))},n)}const ln=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ve(t){const n=Object.prototype.toString.call(t);return n==="[object Window]"||n==="[object global]"}function fr(t){return"nodeType"in t}function Dt(t){var n,e;return t?ve(t)?t:fr(t)&&(n=(e=t.ownerDocument)==null?void 0:e.defaultView)!=null?n:window:window}function hr(t){const{Document:n}=Dt(t);return t instanceof n}function Be(t){return ve(t)?!1:t instanceof Dt(t).HTMLElement}function wi(t){return t instanceof Dt(t).SVGElement}function we(t){return t?ve(t)?t.document:fr(t)?hr(t)?t:Be(t)||wi(t)?t.ownerDocument:document:document:document}const Yt=ln?j.useLayoutEffect:j.useEffect;function pr(t){const n=j.useRef(t);return Yt(()=>{n.current=t}),j.useCallback(function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return n.current==null?void 0:n.current(...r)},[])}function cl(){const t=j.useRef(null),n=j.useCallback((r,i)=>{t.current=setInterval(r,i)},[]),e=j.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[n,e]}function ze(t,n){n===void 0&&(n=[t]);const e=j.useRef(t);return Yt(()=>{e.current!==t&&(e.current=t)},n),e}function Pe(t,n){const e=j.useRef();return j.useMemo(()=>{const r=t(e.current);return e.current=r,r},[...n])}function nn(t){const n=pr(t),e=j.useRef(null),r=j.useCallback(i=>{i!==e.current&&n?.(i,e.current),e.current=i},[]);return[e,r]}function Kn(t){const n=j.useRef();return j.useEffect(()=>{n.current=t},[t]),n.current}let Yn={};function Oe(t,n){return j.useMemo(()=>{if(n)return n;const e=Yn[t]==null?0:Yn[t]+1;return Yn[t]=e,t+"-"+e},[t,n])}function xi(t){return function(n){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return r.reduce((o,a)=>{const s=Object.entries(a);for(const[l,u]of s){const c=o[l];c!=null&&(o[l]=c+t*u)}return o},{...n})}}const me=xi(1),rn=xi(-1);function dl(t){return"clientX"in t&&"clientY"in t}function mr(t){if(!t)return!1;const{KeyboardEvent:n}=Dt(t.target);return n&&t instanceof n}function ul(t){if(!t)return!1;const{TouchEvent:n}=Dt(t.target);return n&&t instanceof n}function Jn(t){if(ul(t)){if(t.touches&&t.touches.length){const{clientX:n,clientY:e}=t.touches[0];return{x:n,y:e}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:n,clientY:e}=t.changedTouches[0];return{x:n,y:e}}}return dl(t)?{x:t.clientX,y:t.clientY}:null}const je=Object.freeze({Translate:{toString(t){if(!t)return;const{x:n,y:e}=t;return"translate3d("+(n?Math.round(n):0)+"px, "+(e?Math.round(e):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:n,scaleY:e}=t;return"scaleX("+n+") scaleY("+e+")"}},Transform:{toString(t){if(t)return[je.Translate.toString(t),je.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:n,duration:e,easing:r}=t;return n+" "+e+"ms "+r}}}),ao="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function fl(t){return t.matches(ao)?t:t.querySelector(ao)}const hl={display:"none"};function pl(t){let{id:n,value:e}=t;return Tt.createElement("div",{id:n,style:hl},e)}function ml(t){let{id:n,announcement:e,ariaLiveType:r="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Tt.createElement("div",{id:n,style:i,role:"status","aria-live":r,"aria-atomic":!0},e)}function gl(){const[t,n]=j.useState("");return{announce:j.useCallback(r=>{r!=null&&n(r)},[]),announcement:t}}const _i=j.createContext(null);function bl(t){const n=j.useContext(_i);j.useEffect(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(t)},[t,n])}function yl(){const[t]=j.useState(()=>new Set),n=j.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[j.useCallback(r=>{let{type:i,event:o}=r;t.forEach(a=>{var s;return(s=a[i])==null?void 0:s.call(a,o)})},[t]),n]}const vl={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},wl={onDragStart(t){let{active:n}=t;return"Picked up draggable item "+n.id+"."},onDragOver(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was moved over droppable area "+e.id+".":"Draggable item "+n.id+" is no longer over a droppable area."},onDragEnd(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was dropped over droppable area "+e.id:"Draggable item "+n.id+" was dropped."},onDragCancel(t){let{active:n}=t;return"Dragging was cancelled. Draggable item "+n.id+" was dropped."}};function xl(t){let{announcements:n=wl,container:e,hiddenTextDescribedById:r,screenReaderInstructions:i=vl}=t;const{announce:o,announcement:a}=gl(),s=Oe("DndLiveRegion"),[l,u]=j.useState(!1);if(j.useEffect(()=>{u(!0)},[]),bl(j.useMemo(()=>({onDragStart(g){let{active:m}=g;o(n.onDragStart({active:m}))},onDragMove(g){let{active:m,over:d}=g;n.onDragMove&&o(n.onDragMove({active:m,over:d}))},onDragOver(g){let{active:m,over:d}=g;o(n.onDragOver({active:m,over:d}))},onDragEnd(g){let{active:m,over:d}=g;o(n.onDragEnd({active:m,over:d}))},onDragCancel(g){let{active:m,over:d}=g;o(n.onDragCancel({active:m,over:d}))}}),[o,n])),!l)return null;const c=Tt.createElement(Tt.Fragment,null,Tt.createElement(pl,{id:r,value:i.draggable}),Tt.createElement(ml,{id:s,announcement:a}));return e?Re.createPortal(c,e):c}var Et;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Et||(Et={}));function on(){}function lo(t,n){return j.useMemo(()=>({sensor:t,options:n??{}}),[t,n])}function _l(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return j.useMemo(()=>[...n].filter(r=>r!=null),[...n])}const Pt=Object.freeze({x:0,y:0});function kl(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function Cl(t,n){let{data:{value:e}}=t,{data:{value:r}}=n;return e-r}function El(t,n){let{data:{value:e}}=t,{data:{value:r}}=n;return r-e}function Sl(t,n){if(!t||t.length===0)return null;const[e]=t;return e[n]}function co(t,n,e){return n===void 0&&(n=t.left),e===void 0&&(e=t.top),{x:n+t.width*.5,y:e+t.height*.5}}const Rl=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:r}=t;const i=co(n,n.left,n.top),o=[];for(const a of r){const{id:s}=a,l=e.get(s);if(l){const u=kl(co(l),i);o.push({id:s,data:{droppableContainer:a,value:u}})}}return o.sort(Cl)};function Al(t,n){const e=Math.max(n.top,t.top),r=Math.max(n.left,t.left),i=Math.min(n.left+n.width,t.left+t.width),o=Math.min(n.top+n.height,t.top+t.height),a=i-r,s=o-e;if(r<i&&e<o){const l=n.width*n.height,u=t.width*t.height,c=a*s,g=c/(l+u-c);return Number(g.toFixed(4))}return 0}const Nl=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:r}=t;const i=[];for(const o of r){const{id:a}=o,s=e.get(a);if(s){const l=Al(s,n);l>0&&i.push({id:a,data:{droppableContainer:o,value:l}})}}return i.sort(El)};function Il(t,n,e){return{...t,scaleX:n&&e?n.width/e.width:1,scaleY:n&&e?n.height/e.height:1}}function ki(t,n){return t&&n?{x:t.left-n.left,y:t.top-n.top}:Pt}function Tl(t){return function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i.reduce((a,s)=>({...a,top:a.top+t*s.y,bottom:a.bottom+t*s.y,left:a.left+t*s.x,right:a.right+t*s.x}),{...e})}}const Dl=Tl(1);function zl(t){if(t.startsWith("matrix3d(")){const n=t.slice(9,-1).split(/, /);return{x:+n[12],y:+n[13],scaleX:+n[0],scaleY:+n[5]}}else if(t.startsWith("matrix(")){const n=t.slice(7,-1).split(/, /);return{x:+n[4],y:+n[5],scaleX:+n[0],scaleY:+n[3]}}return null}function jl(t,n,e){const r=zl(n);if(!r)return t;const{scaleX:i,scaleY:o,x:a,y:s}=r,l=t.left-a-(1-i)*parseFloat(e),u=t.top-s-(1-o)*parseFloat(e.slice(e.indexOf(" ")+1)),c=i?t.width/i:t.width,g=o?t.height/o:t.height;return{width:c,height:g,top:u,right:l+c,bottom:u+g,left:l}}const Ll={ignoreTransform:!1};function xe(t,n){n===void 0&&(n=Ll);let e=t.getBoundingClientRect();if(n.ignoreTransform){const{transform:u,transformOrigin:c}=Dt(t).getComputedStyle(t);u&&(e=jl(e,u,c))}const{top:r,left:i,width:o,height:a,bottom:s,right:l}=e;return{top:r,left:i,width:o,height:a,bottom:s,right:l}}function uo(t){return xe(t,{ignoreTransform:!0})}function Ml(t){const n=t.innerWidth,e=t.innerHeight;return{top:0,left:0,right:n,bottom:e,width:n,height:e}}function Bl(t,n){return n===void 0&&(n=Dt(t).getComputedStyle(t)),n.position==="fixed"}function Pl(t,n){n===void 0&&(n=Dt(t).getComputedStyle(t));const e=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=n[i];return typeof o=="string"?e.test(o):!1})}function gr(t,n){const e=[];function r(i){if(n!=null&&e.length>=n||!i)return e;if(hr(i)&&i.scrollingElement!=null&&!e.includes(i.scrollingElement))return e.push(i.scrollingElement),e;if(!Be(i)||wi(i)||e.includes(i))return e;const o=Dt(t).getComputedStyle(i);return i!==t&&Pl(i,o)&&e.push(i),Bl(i,o)?e:r(i.parentNode)}return t?r(t):e}function Ci(t){const[n]=gr(t,1);return n??null}function Gn(t){return!ln||!t?null:ve(t)?t:fr(t)?hr(t)||t===we(t).scrollingElement?window:Be(t)?t:null:null}function Ei(t){return ve(t)?t.scrollX:t.scrollLeft}function Si(t){return ve(t)?t.scrollY:t.scrollTop}function Qn(t){return{x:Ei(t),y:Si(t)}}var At;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(At||(At={}));function Ri(t){return!ln||!t?!1:t===document.scrollingElement}function Ai(t){const n={x:0,y:0},e=Ri(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-e.width,y:t.scrollHeight-e.height},i=t.scrollTop<=n.y,o=t.scrollLeft<=n.x,a=t.scrollTop>=r.y,s=t.scrollLeft>=r.x;return{isTop:i,isLeft:o,isBottom:a,isRight:s,maxScroll:r,minScroll:n}}const Ol={x:.2,y:.2};function Fl(t,n,e,r,i){let{top:o,left:a,right:s,bottom:l}=e;r===void 0&&(r=10),i===void 0&&(i=Ol);const{isTop:u,isBottom:c,isLeft:g,isRight:m}=Ai(t),d={x:0,y:0},y={x:0,y:0},f={height:n.height*i.y,width:n.width*i.x};return!u&&o<=n.top+f.height?(d.y=At.Backward,y.y=r*Math.abs((n.top+f.height-o)/f.height)):!c&&l>=n.bottom-f.height&&(d.y=At.Forward,y.y=r*Math.abs((n.bottom-f.height-l)/f.height)),!m&&s>=n.right-f.width?(d.x=At.Forward,y.x=r*Math.abs((n.right-f.width-s)/f.width)):!g&&a<=n.left+f.width&&(d.x=At.Backward,y.x=r*Math.abs((n.left+f.width-a)/f.width)),{direction:d,speed:y}}function Ul(t){if(t===document.scrollingElement){const{innerWidth:o,innerHeight:a}=window;return{top:0,left:0,right:o,bottom:a,width:o,height:a}}const{top:n,left:e,right:r,bottom:i}=t.getBoundingClientRect();return{top:n,left:e,right:r,bottom:i,width:t.clientWidth,height:t.clientHeight}}function Ni(t){return t.reduce((n,e)=>me(n,Qn(e)),Pt)}function Wl(t){return t.reduce((n,e)=>n+Ei(e),0)}function ql(t){return t.reduce((n,e)=>n+Si(e),0)}function Yl(t,n){if(n===void 0&&(n=xe),!t)return;const{top:e,left:r,bottom:i,right:o}=n(t);Ci(t)&&(i<=0||o<=0||e>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const Gl=[["x",["left","right"],Wl],["y",["top","bottom"],ql]];class br{constructor(n,e){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=gr(e),i=Ni(r);this.rect={...n},this.width=n.width,this.height=n.height;for(const[o,a,s]of Gl)for(const l of a)Object.defineProperty(this,l,{get:()=>{const u=s(r),c=i[o]-u;return this.rect[l]+c},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ne{constructor(n){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...e)})},this.target=n}add(n,e,r){var i;(i=this.target)==null||i.addEventListener(n,e,r),this.listeners.push([n,e,r])}}function Vl(t){const{EventTarget:n}=Dt(t);return t instanceof n?t:we(t)}function Vn(t,n){const e=Math.abs(t.x),r=Math.abs(t.y);return typeof n=="number"?Math.sqrt(e**2+r**2)>n:"x"in n&&"y"in n?e>n.x&&r>n.y:"x"in n?e>n.x:"y"in n?r>n.y:!1}var Bt;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Bt||(Bt={}));function fo(t){t.preventDefault()}function $l(t){t.stopPropagation()}var mt;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(mt||(mt={}));const Ii={start:[mt.Space,mt.Enter],cancel:[mt.Esc],end:[mt.Space,mt.Enter,mt.Tab]},Hl=(t,n)=>{let{currentCoordinates:e}=n;switch(t.code){case mt.Right:return{...e,x:e.x+25};case mt.Left:return{...e,x:e.x-25};case mt.Down:return{...e,y:e.y+25};case mt.Up:return{...e,y:e.y-25}}};class Ti{constructor(n){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=n;const{event:{target:e}}=n;this.props=n,this.listeners=new Ne(we(e)),this.windowListeners=new Ne(Dt(e)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Bt.Resize,this.handleCancel),this.windowListeners.add(Bt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Bt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:n,onStart:e}=this.props,r=n.node.current;r&&Yl(r),e(Pt)}handleKeyDown(n){if(mr(n)){const{active:e,context:r,options:i}=this.props,{keyboardCodes:o=Ii,coordinateGetter:a=Hl,scrollBehavior:s="smooth"}=i,{code:l}=n;if(o.end.includes(l)){this.handleEnd(n);return}if(o.cancel.includes(l)){this.handleCancel(n);return}const{collisionRect:u}=r.current,c=u?{x:u.left,y:u.top}:Pt;this.referenceCoordinates||(this.referenceCoordinates=c);const g=a(n,{active:e,context:r.current,currentCoordinates:c});if(g){const m=rn(g,c),d={x:0,y:0},{scrollableAncestors:y}=r.current;for(const f of y){const v=n.code,{isTop:b,isRight:w,isLeft:x,isBottom:_,maxScroll:E,minScroll:N}=Ai(f),T=Ul(f),R={x:Math.min(v===mt.Right?T.right-T.width/2:T.right,Math.max(v===mt.Right?T.left:T.left+T.width/2,g.x)),y:Math.min(v===mt.Down?T.bottom-T.height/2:T.bottom,Math.max(v===mt.Down?T.top:T.top+T.height/2,g.y))},z=v===mt.Right&&!w||v===mt.Left&&!x,F=v===mt.Down&&!_||v===mt.Up&&!b;if(z&&R.x!==g.x){const Y=f.scrollLeft+m.x,C=v===mt.Right&&Y<=E.x||v===mt.Left&&Y>=N.x;if(C&&!m.y){f.scrollTo({left:Y,behavior:s});return}C?d.x=f.scrollLeft-Y:d.x=v===mt.Right?f.scrollLeft-E.x:f.scrollLeft-N.x,d.x&&f.scrollBy({left:-d.x,behavior:s});break}else if(F&&R.y!==g.y){const Y=f.scrollTop+m.y,C=v===mt.Down&&Y<=E.y||v===mt.Up&&Y>=N.y;if(C&&!m.x){f.scrollTo({top:Y,behavior:s});return}C?d.y=f.scrollTop-Y:d.y=v===mt.Down?f.scrollTop-E.y:f.scrollTop-N.y,d.y&&f.scrollBy({top:-d.y,behavior:s});break}}this.handleMove(n,me(rn(g,this.referenceCoordinates),d))}}}handleMove(n,e){const{onMove:r}=this.props;n.preventDefault(),r(e)}handleEnd(n){const{onEnd:e}=this.props;n.preventDefault(),this.detach(),e()}handleCancel(n){const{onCancel:e}=this.props;n.preventDefault(),this.detach(),e()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ti.activators=[{eventName:"onKeyDown",handler:(t,n,e)=>{let{keyboardCodes:r=Ii,onActivation:i}=n,{active:o}=e;const{code:a}=t.nativeEvent;if(r.start.includes(a)){const s=o.activatorNode.current;return s&&t.target!==s?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function ho(t){return!!(t&&"distance"in t)}function po(t){return!!(t&&"delay"in t)}class yr{constructor(n,e,r){var i;r===void 0&&(r=Vl(n.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=n,this.events=e;const{event:o}=n,{target:a}=o;this.props=n,this.events=e,this.document=we(a),this.documentListeners=new Ne(this.document),this.listeners=new Ne(r),this.windowListeners=new Ne(Dt(a)),this.initialCoordinates=(i=Jn(o))!=null?i:Pt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:n,props:{options:{activationConstraint:e,bypassActivationConstraint:r}}}=this;if(this.listeners.add(n.move.name,this.handleMove,{passive:!1}),this.listeners.add(n.end.name,this.handleEnd),n.cancel&&this.listeners.add(n.cancel.name,this.handleCancel),this.windowListeners.add(Bt.Resize,this.handleCancel),this.windowListeners.add(Bt.DragStart,fo),this.windowListeners.add(Bt.VisibilityChange,this.handleCancel),this.windowListeners.add(Bt.ContextMenu,fo),this.documentListeners.add(Bt.Keydown,this.handleKeydown),e){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(po(e)){this.timeoutId=setTimeout(this.handleStart,e.delay),this.handlePending(e);return}if(ho(e)){this.handlePending(e);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(n,e){const{active:r,onPending:i}=this.props;i(r,n,this.initialCoordinates,e)}handleStart(){const{initialCoordinates:n}=this,{onStart:e}=this.props;n&&(this.activated=!0,this.documentListeners.add(Bt.Click,$l,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Bt.SelectionChange,this.removeTextSelection),e(n))}handleMove(n){var e;const{activated:r,initialCoordinates:i,props:o}=this,{onMove:a,options:{activationConstraint:s}}=o;if(!i)return;const l=(e=Jn(n))!=null?e:Pt,u=rn(i,l);if(!r&&s){if(ho(s)){if(s.tolerance!=null&&Vn(u,s.tolerance))return this.handleCancel();if(Vn(u,s.distance))return this.handleStart()}if(po(s)&&Vn(u,s.tolerance))return this.handleCancel();this.handlePending(s,u);return}n.cancelable&&n.preventDefault(),a(l)}handleEnd(){const{onAbort:n,onEnd:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleCancel(){const{onAbort:n,onCancel:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleKeydown(n){n.code===mt.Esc&&this.handleCancel()}removeTextSelection(){var n;(n=this.document.getSelection())==null||n.removeAllRanges()}}const Zl={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class vr extends yr{constructor(n){const{event:e}=n,r=we(e.target);super(n,Zl,r)}}vr.activators=[{eventName:"onPointerDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;return!e.isPrimary||e.button!==0?!1:(r?.({event:e}),!0)}}];const Xl={move:{name:"mousemove"},end:{name:"mouseup"}};var tr;(function(t){t[t.RightClick=2]="RightClick"})(tr||(tr={}));class Kl extends yr{constructor(n){super(n,Xl,we(n.event.target))}}Kl.activators=[{eventName:"onMouseDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;return e.button===tr.RightClick?!1:(r?.({event:e}),!0)}}];const $n={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Di extends yr{constructor(n){super(n,$n)}static setup(){return window.addEventListener($n.move.name,n,{capture:!1,passive:!1}),function(){window.removeEventListener($n.move.name,n)};function n(){}}}Di.activators=[{eventName:"onTouchStart",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;const{touches:i}=e;return i.length>1?!1:(r?.({event:e}),!0)}}];var Ie;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Ie||(Ie={}));var sn;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(sn||(sn={}));function Jl(t){let{acceleration:n,activator:e=Ie.Pointer,canScroll:r,draggingRect:i,enabled:o,interval:a=5,order:s=sn.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:c,delta:g,threshold:m}=t;const d=tc({delta:g,disabled:!o}),[y,f]=cl(),v=j.useRef({x:0,y:0}),b=j.useRef({x:0,y:0}),w=j.useMemo(()=>{switch(e){case Ie.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Ie.DraggableRect:return i}},[e,i,l]),x=j.useRef(null),_=j.useCallback(()=>{const N=x.current;if(!N)return;const T=v.current.x*b.current.x,R=v.current.y*b.current.y;N.scrollBy(T,R)},[]),E=j.useMemo(()=>s===sn.TreeOrder?[...u].reverse():u,[s,u]);j.useEffect(()=>{if(!o||!u.length||!w){f();return}for(const N of E){if(r?.(N)===!1)continue;const T=u.indexOf(N),R=c[T];if(!R)continue;const{direction:z,speed:F}=Fl(N,R,w,n,m);for(const Y of["x","y"])d[Y][z[Y]]||(F[Y]=0,z[Y]=0);if(F.x>0||F.y>0){f(),x.current=N,y(_,a),v.current=F,b.current=z;return}}v.current={x:0,y:0},b.current={x:0,y:0},f()},[n,_,r,f,o,a,JSON.stringify(w),JSON.stringify(d),y,u,E,c,JSON.stringify(m)])}const Ql={x:{[At.Backward]:!1,[At.Forward]:!1},y:{[At.Backward]:!1,[At.Forward]:!1}};function tc(t){let{delta:n,disabled:e}=t;const r=Kn(n);return Pe(i=>{if(e||!r||!i)return Ql;const o={x:Math.sign(n.x-r.x),y:Math.sign(n.y-r.y)};return{x:{[At.Backward]:i.x[At.Backward]||o.x===-1,[At.Forward]:i.x[At.Forward]||o.x===1},y:{[At.Backward]:i.y[At.Backward]||o.y===-1,[At.Forward]:i.y[At.Forward]||o.y===1}}},[e,n,r])}function ec(t,n){const e=n!=null?t.get(n):void 0,r=e?e.node.current:null;return Pe(i=>{var o;return n==null?null:(o=r??i)!=null?o:null},[r,n])}function nc(t,n){return j.useMemo(()=>t.reduce((e,r)=>{const{sensor:i}=r,o=i.activators.map(a=>({eventName:a.eventName,handler:n(a.handler,r)}));return[...e,...o]},[]),[t,n])}var Le;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Le||(Le={}));var er;(function(t){t.Optimized="optimized"})(er||(er={}));const mo=new Map;function rc(t,n){let{dragging:e,dependencies:r,config:i}=n;const[o,a]=j.useState(null),{frequency:s,measure:l,strategy:u}=i,c=j.useRef(t),g=v(),m=ze(g),d=j.useCallback(function(b){b===void 0&&(b=[]),!m.current&&a(w=>w===null?b:w.concat(b.filter(x=>!w.includes(x))))},[m]),y=j.useRef(null),f=Pe(b=>{if(g&&!e)return mo;if(!b||b===mo||c.current!==t||o!=null){const w=new Map;for(let x of t){if(!x)continue;if(o&&o.length>0&&!o.includes(x.id)&&x.rect.current){w.set(x.id,x.rect.current);continue}const _=x.node.current,E=_?new br(l(_),_):null;x.rect.current=E,E&&w.set(x.id,E)}return w}return b},[t,o,e,g,l]);return j.useEffect(()=>{c.current=t},[t]),j.useEffect(()=>{g||d()},[e,g]),j.useEffect(()=>{o&&o.length>0&&a(null)},[JSON.stringify(o)]),j.useEffect(()=>{g||typeof s!="number"||y.current!==null||(y.current=setTimeout(()=>{d(),y.current=null},s))},[s,g,d,...r]),{droppableRects:f,measureDroppableContainers:d,measuringScheduled:o!=null};function v(){switch(u){case Le.Always:return!1;case Le.BeforeDragging:return e;default:return!e}}}function zi(t,n){return Pe(e=>t?e||(typeof n=="function"?n(t):t):null,[n,t])}function oc(t,n){return zi(t,n)}function ic(t){let{callback:n,disabled:e}=t;const r=pr(n),i=j.useMemo(()=>{if(e||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,e]);return j.useEffect(()=>()=>i?.disconnect(),[i]),i}function cn(t){let{callback:n,disabled:e}=t;const r=pr(n),i=j.useMemo(()=>{if(e||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[e]);return j.useEffect(()=>()=>i?.disconnect(),[i]),i}function sc(t){return new br(xe(t),t)}function go(t,n,e){n===void 0&&(n=sc);const[r,i]=j.useState(null);function o(){i(l=>{if(!t)return null;if(t.isConnected===!1){var u;return(u=l??e)!=null?u:null}const c=n(t);return JSON.stringify(l)===JSON.stringify(c)?l:c})}const a=ic({callback(l){if(t)for(const u of l){const{type:c,target:g}=u;if(c==="childList"&&g instanceof HTMLElement&&g.contains(t)){o();break}}}}),s=cn({callback:o});return Yt(()=>{o(),t?(s?.observe(t),a?.observe(document.body,{childList:!0,subtree:!0})):(s?.disconnect(),a?.disconnect())},[t]),r}function ac(t){const n=zi(t);return ki(t,n)}const bo=[];function lc(t){const n=j.useRef(t),e=Pe(r=>t?r&&r!==bo&&t&&n.current&&t.parentNode===n.current.parentNode?r:gr(t):bo,[t]);return j.useEffect(()=>{n.current=t},[t]),e}function cc(t){const[n,e]=j.useState(null),r=j.useRef(t),i=j.useCallback(o=>{const a=Gn(o.target);a&&e(s=>s?(s.set(a,Qn(a)),new Map(s)):null)},[]);return j.useEffect(()=>{const o=r.current;if(t!==o){a(o);const s=t.map(l=>{const u=Gn(l);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,Qn(u)]):null}).filter(l=>l!=null);e(s.length?new Map(s):null),r.current=t}return()=>{a(t),a(o)};function a(s){s.forEach(l=>{const u=Gn(l);u?.removeEventListener("scroll",i)})}},[i,t]),j.useMemo(()=>t.length?n?Array.from(n.values()).reduce((o,a)=>me(o,a),Pt):Ni(t):Pt,[t,n])}function yo(t,n){n===void 0&&(n=[]);const e=j.useRef(null);return j.useEffect(()=>{e.current=null},n),j.useEffect(()=>{const r=t!==Pt;r&&!e.current&&(e.current=t),!r&&e.current&&(e.current=null)},[t]),e.current?rn(t,e.current):Pt}function dc(t){j.useEffect(()=>{if(!ln)return;const n=t.map(e=>{let{sensor:r}=e;return r.setup==null?void 0:r.setup()});return()=>{for(const e of n)e?.()}},t.map(n=>{let{sensor:e}=n;return e}))}function uc(t,n){return j.useMemo(()=>t.reduce((e,r)=>{let{eventName:i,handler:o}=r;return e[i]=a=>{o(a,n)},e},{}),[t,n])}function ji(t){return j.useMemo(()=>t?Ml(t):null,[t])}const vo=[];function fc(t,n){n===void 0&&(n=xe);const[e]=t,r=ji(e?Dt(e):null),[i,o]=j.useState(vo);function a(){o(()=>t.length?t.map(l=>Ri(l)?r:new br(n(l),l)):vo)}const s=cn({callback:a});return Yt(()=>{s?.disconnect(),a(),t.forEach(l=>s?.observe(l))},[t]),i}function hc(t){if(!t)return null;if(t.children.length>1)return t;const n=t.children[0];return Be(n)?n:t}function pc(t){let{measure:n}=t;const[e,r]=j.useState(null),i=j.useCallback(u=>{for(const{target:c}of u)if(Be(c)){r(g=>{const m=n(c);return g?{...g,width:m.width,height:m.height}:m});break}},[n]),o=cn({callback:i}),a=j.useCallback(u=>{const c=hc(u);o?.disconnect(),c&&o?.observe(c),r(c?n(c):null)},[n,o]),[s,l]=nn(a);return j.useMemo(()=>({nodeRef:s,rect:e,setRef:l}),[e,s,l])}const mc=[{sensor:vr,options:{}},{sensor:Ti,options:{}}],gc={current:{}},Qe={draggable:{measure:uo},droppable:{measure:uo,strategy:Le.WhileDragging,frequency:er.Optimized},dragOverlay:{measure:xe}};class Te extends Map{get(n){var e;return n!=null&&(e=super.get(n))!=null?e:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(n=>{let{disabled:e}=n;return!e})}getNodeFor(n){var e,r;return(e=(r=this.get(n))==null?void 0:r.node.current)!=null?e:void 0}}const bc={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Te,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:on},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Qe,measureDroppableContainers:on,windowRect:null,measuringScheduled:!1},yc={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:on,draggableNodes:new Map,over:null,measureDroppableContainers:on},dn=j.createContext(yc),Li=j.createContext(bc);function vc(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Te}}}function wc(t,n){switch(n.type){case Et.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:n.initialCoordinates,active:n.active}};case Et.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:n.coordinates.x-t.draggable.initialCoordinates.x,y:n.coordinates.y-t.draggable.initialCoordinates.y}}};case Et.DragEnd:case Et.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Et.RegisterDroppable:{const{element:e}=n,{id:r}=e,i=new Te(t.droppable.containers);return i.set(r,e),{...t,droppable:{...t.droppable,containers:i}}}case Et.SetDroppableDisabled:{const{id:e,key:r,disabled:i}=n,o=t.droppable.containers.get(e);if(!o||r!==o.key)return t;const a=new Te(t.droppable.containers);return a.set(e,{...o,disabled:i}),{...t,droppable:{...t.droppable,containers:a}}}case Et.UnregisterDroppable:{const{id:e,key:r}=n,i=t.droppable.containers.get(e);if(!i||r!==i.key)return t;const o=new Te(t.droppable.containers);return o.delete(e),{...t,droppable:{...t.droppable,containers:o}}}default:return t}}function xc(t){let{disabled:n}=t;const{active:e,activatorEvent:r,draggableNodes:i}=j.useContext(dn),o=Kn(r),a=Kn(e?.id);return j.useEffect(()=>{if(!n&&!r&&o&&a!=null){if(!mr(o)||document.activeElement===o.target)return;const s=i.get(a);if(!s)return;const{activatorNode:l,node:u}=s;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const c of[l.current,u.current]){if(!c)continue;const g=fl(c);if(g){g.focus();break}}})}},[r,n,i,a,o]),null}function _c(t,n){let{transform:e,...r}=n;return t!=null&&t.length?t.reduce((i,o)=>o({transform:i,...r}),e):e}function kc(t){return j.useMemo(()=>({draggable:{...Qe.draggable,...t?.draggable},droppable:{...Qe.droppable,...t?.droppable},dragOverlay:{...Qe.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function Cc(t){let{activeNode:n,measure:e,initialRect:r,config:i=!0}=t;const o=j.useRef(!1),{x:a,y:s}=typeof i=="boolean"?{x:i,y:i}:i;Yt(()=>{if(!a&&!s||!n){o.current=!1;return}if(o.current||!r)return;const u=n?.node.current;if(!u||u.isConnected===!1)return;const c=e(u),g=ki(c,r);if(a||(g.x=0),s||(g.y=0),o.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const m=Ci(u);m&&m.scrollBy({top:g.y,left:g.x})}},[n,a,s,r,e])}const Mi=j.createContext({...Pt,scaleX:1,scaleY:1});var re;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(re||(re={}));const Ec=j.memo(function(n){var e,r,i,o;let{id:a,accessibility:s,autoScroll:l=!0,children:u,sensors:c=mc,collisionDetection:g=Nl,measuring:m,modifiers:d,...y}=n;const f=j.useReducer(wc,void 0,vc),[v,b]=f,[w,x]=yl(),[_,E]=j.useState(re.Uninitialized),N=_===re.Initialized,{draggable:{active:T,nodes:R,translate:z},droppable:{containers:F}}=v,Y=T!=null?R.get(T):null,C=j.useRef({initial:null,translated:null}),k=j.useMemo(()=>{var xt;return T!=null?{id:T,data:(xt=Y?.data)!=null?xt:gc,rect:C}:null},[T,Y]),p=j.useRef(null),[q,L]=j.useState(null),[D,G]=j.useState(null),M=ze(y,Object.values(y)),W=Oe("DndDescribedBy",a),B=j.useMemo(()=>F.getEnabled(),[F]),P=kc(m),{droppableRects:Q,measureDroppableContainers:K,measuringScheduled:Z}=rc(B,{dragging:N,dependencies:[z.x,z.y],config:P.droppable}),ct=ec(R,T),it=j.useMemo(()=>D?Jn(D):null,[D]),nt=We(),rt=oc(ct,P.draggable.measure);Cc({activeNode:T!=null?R.get(T):null,config:nt.layoutShiftCompensation,initialRect:rt,measure:P.draggable.measure});const J=go(ct,P.draggable.measure,rt),ut=go(ct?ct.parentElement:null),ht=j.useRef({activatorEvent:null,active:null,activeNode:ct,collisionRect:null,collisions:null,droppableRects:Q,draggableNodes:R,draggingNode:null,draggingNodeRect:null,droppableContainers:F,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),wt=F.getNodeFor((e=ht.current.over)==null?void 0:e.id),h=pc({measure:P.dragOverlay.measure}),$=(r=h.nodeRef.current)!=null?r:ct,V=N?(i=h.rect)!=null?i:J:null,I=!!(h.nodeRef.current&&h.rect),S=ac(I?null:J),O=ji($?Dt($):null),H=lc(N?wt??ct:null),X=fc(H),U=_c(d,{transform:{x:z.x-S.x,y:z.y-S.y,scaleX:1,scaleY:1},activatorEvent:D,active:k,activeNodeRect:J,containerNodeRect:ut,draggingNodeRect:V,over:ht.current.over,overlayNodeRect:h.rect,scrollableAncestors:H,scrollableAncestorRects:X,windowRect:O}),tt=it?me(it,z):null,ot=cc(H),et=yo(ot),lt=yo(ot,[J]),pt=me(U,et),dt=V?Dl(V,U):null,St=k&&dt?g({active:k,collisionRect:dt,droppableRects:Q,droppableContainers:B,pointerCoordinates:tt}):null,Ht=Sl(St,"id"),[kt,Zt]=j.useState(null),vt=I?U:me(U,lt),le=Il(vt,(o=kt?.rect)!=null?o:null,J),oe=j.useRef(null),Lt=j.useCallback((xt,Rt)=>{let{sensor:zt,options:Xt}=Rt;if(p.current==null)return;const Mt=R.get(p.current);if(!Mt)return;const jt=xt.nativeEvent,Ot=new zt({active:p.current,activeNode:Mt,event:jt,options:Xt,context:ht,onAbort(Nt){if(!R.get(Nt))return;const{onDragAbort:Ft}=M.current,Gt={id:Nt};Ft?.(Gt),w({type:"onDragAbort",event:Gt})},onPending(Nt,Kt,Ft,Gt){if(!R.get(Nt))return;const{onDragPending:ke}=M.current,Jt={id:Nt,constraint:Kt,initialCoordinates:Ft,offset:Gt};ke?.(Jt),w({type:"onDragPending",event:Jt})},onStart(Nt){const Kt=p.current;if(Kt==null)return;const Ft=R.get(Kt);if(!Ft)return;const{onDragStart:Gt}=M.current,_e={activatorEvent:jt,active:{id:Kt,data:Ft.data,rect:C}};Re.unstable_batchedUpdates(()=>{Gt?.(_e),E(re.Initializing),b({type:Et.DragStart,initialCoordinates:Nt,active:Kt}),w({type:"onDragStart",event:_e}),L(oe.current),G(jt)})},onMove(Nt){b({type:Et.DragMove,coordinates:Nt})},onEnd:ce(Et.DragEnd),onCancel:ce(Et.DragCancel)});oe.current=Ot;function ce(Nt){return async function(){const{active:Ft,collisions:Gt,over:_e,scrollAdjustedTranslate:ke}=ht.current;let Jt=null;if(Ft&&ke){const{cancelDrop:Ce}=M.current;Jt={activatorEvent:jt,active:Ft,collisions:Gt,delta:ke,over:_e},Nt===Et.DragEnd&&typeof Ce=="function"&&await Promise.resolve(Ce(Jt))&&(Nt=Et.DragCancel)}p.current=null,Re.unstable_batchedUpdates(()=>{b({type:Nt}),E(re.Uninitialized),Zt(null),L(null),G(null),oe.current=null;const Ce=Nt===Et.DragEnd?"onDragEnd":"onDragCancel";if(Jt){const hn=M.current[Ce];hn?.(Jt),w({type:Ce,event:Jt})}})}}},[R]),Fe=j.useCallback((xt,Rt)=>(zt,Xt)=>{const Mt=zt.nativeEvent,jt=R.get(Xt);if(p.current!==null||!jt||Mt.dndKit||Mt.defaultPrevented)return;const Ot={active:jt};xt(zt,Rt.options,Ot)===!0&&(Mt.dndKit={capturedBy:Rt.sensor},p.current=Xt,Lt(zt,Rt))},[R,Lt]),Ue=nc(c,Fe);dc(c),Yt(()=>{J&&_===re.Initializing&&E(re.Initialized)},[J,_]),j.useEffect(()=>{const{onDragMove:xt}=M.current,{active:Rt,activatorEvent:zt,collisions:Xt,over:Mt}=ht.current;if(!Rt||!zt)return;const jt={active:Rt,activatorEvent:zt,collisions:Xt,delta:{x:pt.x,y:pt.y},over:Mt};Re.unstable_batchedUpdates(()=>{xt?.(jt),w({type:"onDragMove",event:jt})})},[pt.x,pt.y]),j.useEffect(()=>{const{active:xt,activatorEvent:Rt,collisions:zt,droppableContainers:Xt,scrollAdjustedTranslate:Mt}=ht.current;if(!xt||p.current==null||!Rt||!Mt)return;const{onDragOver:jt}=M.current,Ot=Xt.get(Ht),ce=Ot&&Ot.rect.current?{id:Ot.id,rect:Ot.rect.current,data:Ot.data,disabled:Ot.disabled}:null,Nt={active:xt,activatorEvent:Rt,collisions:zt,delta:{x:Mt.x,y:Mt.y},over:ce};Re.unstable_batchedUpdates(()=>{Zt(ce),jt?.(Nt),w({type:"onDragOver",event:Nt})})},[Ht]),Yt(()=>{ht.current={activatorEvent:D,active:k,activeNode:ct,collisionRect:dt,collisions:St,droppableRects:Q,draggableNodes:R,draggingNode:$,draggingNodeRect:V,droppableContainers:F,over:kt,scrollableAncestors:H,scrollAdjustedTranslate:pt},C.current={initial:V,translated:dt}},[k,ct,St,dt,R,$,V,Q,F,kt,H,pt]),Jl({...nt,delta:z,draggingRect:dt,pointerCoordinates:tt,scrollableAncestors:H,scrollableAncestorRects:X});const un=j.useMemo(()=>({active:k,activeNode:ct,activeNodeRect:J,activatorEvent:D,collisions:St,containerNodeRect:ut,dragOverlay:h,draggableNodes:R,droppableContainers:F,droppableRects:Q,over:kt,measureDroppableContainers:K,scrollableAncestors:H,scrollableAncestorRects:X,measuringConfiguration:P,measuringScheduled:Z,windowRect:O}),[k,ct,J,D,St,ut,h,R,F,Q,kt,K,H,X,P,Z,O]),fn=j.useMemo(()=>({activatorEvent:D,activators:Ue,active:k,activeNodeRect:J,ariaDescribedById:{draggable:W},dispatch:b,draggableNodes:R,over:kt,measureDroppableContainers:K}),[D,Ue,k,J,b,W,R,kt,K]);return Tt.createElement(_i.Provider,{value:x},Tt.createElement(dn.Provider,{value:fn},Tt.createElement(Li.Provider,{value:un},Tt.createElement(Mi.Provider,{value:le},u)),Tt.createElement(xc,{disabled:s?.restoreFocus===!1})),Tt.createElement(xl,{...s,hiddenTextDescribedById:W}));function We(){const xt=q?.autoScrollEnabled===!1,Rt=typeof l=="object"?l.enabled===!1:l===!1,zt=N&&!xt&&!Rt;return typeof l=="object"?{...l,enabled:zt}:{enabled:zt}}}),Sc=j.createContext(null),wo="button",Rc="Draggable";function Ac(t){let{id:n,data:e,disabled:r=!1,attributes:i}=t;const o=Oe(Rc),{activators:a,activatorEvent:s,active:l,activeNodeRect:u,ariaDescribedById:c,draggableNodes:g,over:m}=j.useContext(dn),{role:d=wo,roleDescription:y="draggable",tabIndex:f=0}=i??{},v=l?.id===n,b=j.useContext(v?Mi:Sc),[w,x]=nn(),[_,E]=nn(),N=uc(a,n),T=ze(e);Yt(()=>(g.set(n,{id:n,key:o,node:w,activatorNode:_,data:T}),()=>{const z=g.get(n);z&&z.key===o&&g.delete(n)}),[g,n]);const R=j.useMemo(()=>({role:d,tabIndex:f,"aria-disabled":r,"aria-pressed":v&&d===wo?!0:void 0,"aria-roledescription":y,"aria-describedby":c.draggable}),[r,d,f,v,y,c.draggable]);return{active:l,activatorEvent:s,activeNodeRect:u,attributes:R,isDragging:v,listeners:r?void 0:N,node:w,over:m,setNodeRef:x,setActivatorNodeRef:E,transform:b}}function Nc(){return j.useContext(Li)}const Ic="Droppable",Tc={timeout:25};function Dc(t){let{data:n,disabled:e=!1,id:r,resizeObserverConfig:i}=t;const o=Oe(Ic),{active:a,dispatch:s,over:l,measureDroppableContainers:u}=j.useContext(dn),c=j.useRef({disabled:e}),g=j.useRef(!1),m=j.useRef(null),d=j.useRef(null),{disabled:y,updateMeasurementsFor:f,timeout:v}={...Tc,...i},b=ze(f??r),w=j.useCallback(()=>{if(!g.current){g.current=!0;return}d.current!=null&&clearTimeout(d.current),d.current=setTimeout(()=>{u(Array.isArray(b.current)?b.current:[b.current]),d.current=null},v)},[v]),x=cn({callback:w,disabled:y||!a}),_=j.useCallback((R,z)=>{x&&(z&&(x.unobserve(z),g.current=!1),R&&x.observe(R))},[x]),[E,N]=nn(_),T=ze(n);return j.useEffect(()=>{!x||!E.current||(x.disconnect(),g.current=!1,x.observe(E.current))},[E,x]),j.useEffect(()=>(s({type:Et.RegisterDroppable,element:{id:r,key:o,disabled:e,node:E,rect:m,data:T}}),()=>s({type:Et.UnregisterDroppable,key:o,id:r})),[r]),j.useEffect(()=>{e!==c.current.disabled&&(s({type:Et.SetDroppableDisabled,id:r,key:o,disabled:e}),c.current.disabled=e)},[r,o,e,s]),{active:a,rect:m,isOver:l?.id===r,node:E,over:l,setNodeRef:N}}function wr(t,n,e){const r=t.slice();return r.splice(e<0?r.length+e:e,0,r.splice(n,1)[0]),r}function zc(t,n){return t.reduce((e,r,i)=>{const o=n.get(r);return o&&(e[i]=o),e},Array(t.length))}function Xe(t){return t!==null&&t>=0}function jc(t,n){if(t===n)return!0;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function Lc(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const xr=t=>{let{rects:n,activeIndex:e,overIndex:r,index:i}=t;const o=wr(n,r,e),a=n[i],s=o[i];return!s||!a?null:{x:s.left-a.left,y:s.top-a.top,scaleX:s.width/a.width,scaleY:s.height/a.height}},Bi="Sortable",Pi=Tt.createContext({activeIndex:-1,containerId:Bi,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:xr,disabled:{draggable:!1,droppable:!1}});function Mc(t){let{children:n,id:e,items:r,strategy:i=xr,disabled:o=!1}=t;const{active:a,dragOverlay:s,droppableRects:l,over:u,measureDroppableContainers:c}=Nc(),g=Oe(Bi,e),m=s.rect!==null,d=j.useMemo(()=>r.map(N=>typeof N=="object"&&"id"in N?N.id:N),[r]),y=a!=null,f=a?d.indexOf(a.id):-1,v=u?d.indexOf(u.id):-1,b=j.useRef(d),w=!jc(d,b.current),x=v!==-1&&f===-1||w,_=Lc(o);Yt(()=>{w&&y&&c(d)},[w,d,y,c]),j.useEffect(()=>{b.current=d},[d]);const E=j.useMemo(()=>({activeIndex:f,containerId:g,disabled:_,disableTransforms:x,items:d,overIndex:v,useDragOverlay:m,sortedRects:zc(d,l),strategy:i}),[f,g,_.draggable,_.droppable,x,d,v,l,m,i]);return Tt.createElement(Pi.Provider,{value:E},n)}const Bc=t=>{let{id:n,items:e,activeIndex:r,overIndex:i}=t;return wr(e,r,i).indexOf(n)},Pc=t=>{let{containerId:n,isSorting:e,wasDragging:r,index:i,items:o,newIndex:a,previousItems:s,previousContainerId:l,transition:u}=t;return!u||!r||s!==o&&i===a?!1:e?!0:a!==i&&n===l},Oc={duration:200,easing:"ease"},Oi="transform",Fc=je.Transition.toString({property:Oi,duration:0,easing:"linear"}),Uc={roleDescription:"sortable"};function Wc(t){let{disabled:n,index:e,node:r,rect:i}=t;const[o,a]=j.useState(null),s=j.useRef(e);return Yt(()=>{if(!n&&e!==s.current&&r.current){const l=i.current;if(l){const u=xe(r.current,{ignoreTransform:!0}),c={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(c.x||c.y)&&a(c)}}e!==s.current&&(s.current=e)},[n,e,r,i]),j.useEffect(()=>{o&&a(null)},[o]),o}function qc(t){let{animateLayoutChanges:n=Pc,attributes:e,disabled:r,data:i,getNewIndex:o=Bc,id:a,strategy:s,resizeObserverConfig:l,transition:u=Oc}=t;const{items:c,containerId:g,activeIndex:m,disabled:d,disableTransforms:y,sortedRects:f,overIndex:v,useDragOverlay:b,strategy:w}=j.useContext(Pi),x=Yc(r,d),_=c.indexOf(a),E=j.useMemo(()=>({sortable:{containerId:g,index:_,items:c},...i}),[g,i,_,c]),N=j.useMemo(()=>c.slice(c.indexOf(a)),[c,a]),{rect:T,node:R,isOver:z,setNodeRef:F}=Dc({id:a,data:E,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...l}}),{active:Y,activatorEvent:C,activeNodeRect:k,attributes:p,setNodeRef:q,listeners:L,isDragging:D,over:G,setActivatorNodeRef:M,transform:W}=Ac({id:a,data:E,attributes:{...Uc,...e},disabled:x.draggable}),B=ll(F,q),P=!!Y,Q=P&&!y&&Xe(m)&&Xe(v),K=!b&&D,Z=K&&Q?W:null,it=Q?Z??(s??w)({rects:f,activeNodeRect:k,activeIndex:m,overIndex:v,index:_}):null,nt=Xe(m)&&Xe(v)?o({id:a,items:c,activeIndex:m,overIndex:v}):_,rt=Y?.id,J=j.useRef({activeId:rt,items:c,newIndex:nt,containerId:g}),ut=c!==J.current.items,ht=n({active:Y,containerId:g,isDragging:D,isSorting:P,id:a,index:_,items:c,newIndex:J.current.newIndex,previousItems:J.current.items,previousContainerId:J.current.containerId,transition:u,wasDragging:J.current.activeId!=null}),wt=Wc({disabled:!ht,index:_,node:R,rect:T});return j.useEffect(()=>{P&&J.current.newIndex!==nt&&(J.current.newIndex=nt),g!==J.current.containerId&&(J.current.containerId=g),c!==J.current.items&&(J.current.items=c)},[P,nt,g,c]),j.useEffect(()=>{if(rt===J.current.activeId)return;if(rt!=null&&J.current.activeId==null){J.current.activeId=rt;return}const $=setTimeout(()=>{J.current.activeId=rt},50);return()=>clearTimeout($)},[rt]),{active:Y,activeIndex:m,attributes:p,data:E,rect:T,index:_,newIndex:nt,items:c,isOver:z,isSorting:P,isDragging:D,listeners:L,node:R,overIndex:v,over:G,setNodeRef:B,setActivatorNodeRef:M,setDroppableNodeRef:F,setDraggableNodeRef:q,transform:wt??it,transition:h()};function h(){if(wt||ut&&J.current.newIndex===_)return Fc;if(!(K&&!mr(C)||!u)&&(P||ht))return je.Transition.toString({...u,property:Oi})}}function Yc(t,n){var e,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(e=t?.draggable)!=null?e:n.draggable,droppable:(r=t?.droppable)!=null?r:n.droppable}}mt.Down,mt.Right,mt.Up,mt.Left;function Gc({id:t,children:n}){const{attributes:e,listeners:r,setNodeRef:i,transform:o,transition:a,isDragging:s,isSorting:l}=qc({id:t}),u={transform:je.Translate.toString(o),transition:a,position:"relative",zIndex:s?9999:l?2:1,cursor:s?"grabbing":"grab",touchAction:"none"};return A.jsx("div",{ref:i,style:u,...e,...r,children:n})}async function Vc(t,n={}){const e=n.format??"png",r=Math.max(.5,Math.min(.95,n.quality??.8)),i=new or,o=i.folder("images");if(!o)throw new Error("ZIP: cannot create images/");for(let a=0;a<t.length;a++){const s=await vi(t[a].id,It),l=e==="jpeg"?await Hc(s,r):s,u=e==="jpeg"?"jpg":"png",c=`card-${String(a+1).padStart(3,"0")}.${u}`;o.file(c,$c(l)),n.onProgress?.({done:a+1,total:t.length})}return i.generateAsync({type:"blob",compression:"DEFLATE"})}function $c(t){const n=t.indexOf(","),e=t.slice(n+1),r=atob(e),i=new Uint8Array(r.length);for(let o=0;o<r.length;o++)i[o]=r.charCodeAt(o);return i}async function Hc(t,n){const e=await Zc(t),r=document.createElement("canvas");r.width=Math.max(1,e.naturalWidth||e.width||1),r.height=Math.max(1,e.naturalHeight||e.height||1);const i=r.getContext("2d");if(!i)throw new Error("Canvas2D unavailable");return i.drawImage(e,0,0),r.toDataURL("image/jpeg",n)}function Zc(t){return new Promise((n,e)=>{const r=new Image;r.onload=()=>n(r),r.onerror=e,r.src=t})}function xo(t){const n=t/1e3;return n<60?`${n.toFixed(1)}s`:`${Math.floor(n/60)}m ${(n%60).toFixed(0)}s`}class Xc extends vr{static activators=[{eventName:"onPointerDown",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}class Kc extends Di{static activators=[{eventName:"onTouchStart",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}function Jc(){const t=gt(_=>_.photos),n=gt(_=>_.reorderPhotos),[e,r]=j.useState(!1),[i,o]=j.useState(null),a=j.useRef(!1),[s,l]=j.useState("jpeg"),[u,c]=j.useState(Ks*100),g=i?.pct??0,m=j.useMemo(()=>{if(!i)return"";const _=i.etaMs??0;return`Rendering ${i.done}/${i.total} • ${g}% • elapsed ${xo(i.elapsedMs)}${i.done<i.total?` • ETA ${xo(_)}`:""}`},[i,g]);j.useEffect(()=>{i&&i.done>=i.total&&o(null)},[i]);const d=j.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{r(!0),o({done:0,total:t.length,elapsedMs:0,pct:0});const _=performance.now(),E=await Vc(t,{format:s,quality:s==="jpeg"?u/100:void 0,onProgress:({done:R,total:z})=>{const F=performance.now()-_,Y=Math.round(R/z*100);o({done:R,total:z,elapsedMs:F,pct:Y})}}),N=URL.createObjectURL(E),T=document.createElement("a");T.href=N,T.download="story-squares-images.zip",document.body.appendChild(T),T.click(),T.remove(),URL.revokeObjectURL(N)}finally{r(!1),a.current=!1}}},[t,s,u]),y=j.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{r(!0);const{exportCardsToPdf:_}=await cs(async()=>{const{exportCardsToPdf:z}=await import("./pdf-DTZ1VRQY.js");return{exportCardsToPdf:z}},__vite__mapDeps([0,1,2,3])),E=await _(t,{format:s,quality:s==="jpeg"?u/100:void 0,onProgress:z=>o(z)}),N=new Blob([E],{type:"application/pdf"}),T=URL.createObjectURL(N),R=document.createElement("a");R.href=T,R.download="story-squares.pdf",document.body.appendChild(R),R.click(),R.remove(),URL.revokeObjectURL(T)}finally{r(!1),a.current=!1}}},[t,s,u]),f=j.useCallback(async()=>{r(!0);try{const _=await za({imageFormat:s,quality:s==="jpeg"?u/100:void 0,onProgress:({done:T,total:R})=>o({done:T,total:R,elapsedMs:0,pct:Math.round(T/R*100)})}),E=URL.createObjectURL(_),N=document.createElement("a");N.href=E,N.download="story-squares.zip",document.body.appendChild(N),N.click(),N.remove(),URL.revokeObjectURL(E)}finally{r(!1)}},[s,u]),v=Tt.useRef(null),b=j.useCallback(async _=>{try{const{warnings:E}=await ci(_);E.length&&alert(`Import finished with warnings:
`+E.join(`
`))}catch(E){alert("Import failed: "+(E?.message||String(E)))}},[]),w=_l(lo(Xc,{activationConstraint:{distance:6}}),lo(Kc,{activationConstraint:{delay:120,tolerance:6}})),x=t.map(_=>_.id);return A.jsxs("section",{className:"space-y-3",children:[A.jsx(Ec,{sensors:w,collisionDetection:Rl,onDragEnd:({active:_,over:E})=>{if(!E||_.id===E.id)return;const N=x.indexOf(String(_.id)),T=x.indexOf(String(E.id));if(N===-1||T===-1)return;const R=wr(x,N,T);n(R)},children:A.jsx(Mc,{items:x,strategy:xr,children:A.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:t.map(_=>A.jsx(Gc,{id:_.id,children:A.jsx(al,{photo:_})},_.id))})})}),t.length>0&&A.jsxs(di,{className:"p-4",children:[A.jsx("div",{className:"mb-3 text-sm font-medium",children:"Export the collection to..."}),i&&A.jsxs(A.Fragment,{children:[A.jsx(ir,{value:g,className:"mb-1 h-2"}),A.jsx("div",{className:"mb-3 text-xs opacity-70",children:m})]}),A.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("span",{className:"opacity-70",children:"Format"}),A.jsxs(ui,{value:s,onValueChange:_=>l(_),children:[A.jsx(sr,{className:"w-28 h-8",children:A.jsx(fi,{placeholder:"Format"})}),A.jsxs(ar,{children:[A.jsx(pe,{value:"jpeg",children:"JPEG (small)"}),A.jsx(pe,{value:"png",children:"PNG (lossless)"})]})]})]}),s==="jpeg"&&A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("span",{className:"opacity-70",children:"Quality"}),A.jsx("input",{type:"range",min:50,max:95,step:5,value:u,onChange:_=>c(Number(_.target.value))}),A.jsxs("span",{className:"tabular-nums",children:[u,"%"]})]}),A.jsx("div",{className:"grow"}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx(_t,{type:"button",size:"sm",onClick:f,disabled:!t.length||e,children:"Save collection (.zip)"}),A.jsx("input",{ref:v,type:"file",accept:".zip,application/zip",className:"hidden",onChange:_=>{const E=_.currentTarget.files?.[0];E&&b(E),_.currentTarget.value=""}}),A.jsx(_t,{type:"button",size:"sm",onClick:d,disabled:!t.length||e,children:"Export images (.zip)"}),A.jsx(_t,{type:"button",size:"sm",onClick:y,disabled:!t.length||e,children:e?"Exporting…":"Export PDF"})]})]})]})]})}function Qc(){const t=Ae(r=>r.busy),n=Ae(r=>r.busyText),e=Ae(r=>r.progress);return t?A.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/60 backdrop-blur-sm","aria-live":"polite","aria-busy":"true",role:"status",children:A.jsxs("div",{className:"flex min-w-64 flex-col items-stretch gap-3 rounded-2xl border bg-background px-4 py-3 shadow-lg",children:[A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent","aria-hidden":"true"}),A.jsx("div",{className:"text-sm",children:n??"Loading..."})]}),typeof e=="number"&&A.jsx(ir,{value:e,className:"h-2"})]})}):null}function td(){return ds(),A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"sticky top-0 z-10 w-full py-3 text-center text-3xl font-bold bg-background border-b border-gray-300",children:"Story Squares v1.1"}),A.jsxs("main",{className:"mx-auto max-w-screen-md px-4 space-y-5",children:[A.jsx(Pa,{}),A.jsx(Jc,{})]}),A.jsx(Qc,{})]})}So.createRoot(document.getElementById("root")).render(A.jsx(Tt.StrictMode,{children:A.jsx(td,{})}));export{It as C,Ks as P,vi as e};
