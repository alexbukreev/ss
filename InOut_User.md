# Руководство пользователя — Импорт / Экспорт в Story Squares

Этот документ объясняет, как загрузить изображения, сохранить коллекцию, сделать PDF и работать с CSV.

---

## 1) Импорт изображений

**Кнопка:** `Choose images` — выберите файлы на компьютере.
Поддерживаются PNG / JPEG и др. Количество ограничено настройкой «Cards: X / MAX» вверху.

**Навигация и масштаб в редакторе карточки**

* Колёсико мыши — масштаб (Zoom).
* Перетаскивание мышью/тачем — сдвиг изображения внутри карточки.

---

## 2) Импорт из CSV

**Кнопка:** `Import CSV` — выберите CSV-файл.
Файл должен содержать как минимум колонку `url` — ссылка на картинку (http/https или data:).

### 2.1 Формат CSV

* Разделитель: запятая **или** точка с запятой. Кавычки для значений — поддерживаются.
* Заголовок первой строки обязателен, как минимум поле `url`. Можно добавлять поля для слоёв.

Пример заголовка:

```
url,caption,layer_1_text,layer_2_text,layer_3_text
```

### 2.2 Как CSV влияет на карточки

* Каждая строка создаёт одну карточку.
* Поля вида `layer_N_text` заполняют **text** у слоёв, в конфиге которых указан `name: "layer_N"`:

  * `layer_1_text` → текстовый слой `name: "layer_1"`.
  * `layer_2_text` → QR-слой `name: "layer_2"` (QR будет сгенерирован заново).
  * `layer_3_text` → любые текстовые элементы профилей ориентации с `name: "layer_3"`.
* Если подходящего `name` нет — значение пропускается.

> Относительные пути (локальные файлы) из CSV в этой сборке не поддерживаются.

---

## 3) Сохранение коллекции в ZIP

**Кнопка:** `Save collection (.zip)` — скачивается архив cо всем проектом.
Внутри: `manifest.json` + папка `images/` с файлами картинок.

**Формат/качество** (в панели экспорта):

* `Format`: `JPEG` (меньше размер) или `PNG` (без потерь).
* `Quality`: ползунок влияет на JPEG (50–95%).

---

## 4) Открытие коллекции из ZIP

**Кнопка:** `Open collection (.zip)` — выберите ранее сохранённый архив.
Приложение восстановит порядок карточек, фон, трансформы (масштаб и сдвиг) и слои.
QR-коды автоматически воссоздаются по сохранённому тексту.

Если в архиве отсутствует часть картинок, карточки загрузятся с заглушками и появится предупреждение.

---

## 5) Экспорт в PDF

**Кнопка:** `Export PDF` — каждая карточка становится отдельной страницей.
Параметры формата и качества — такие же, как при сохранении ZIP.

> Если PDF получился «тяжёлым», попробуйте `JPEG` + снизить «Quality».

---

## 6) Экспорт в CSV (если доступно в вашей сборке)

**Цель:** выгрузить список карточек в таблицу с колонками:

```
url,caption,layer_1_text,layer_2_text,layer_3_text
```

* В `url` попадёт исходный URL (если был). Для локально добавленных файлов поле может быть пустым.
* `layer_N_text` — значения текущих текстов слоёв с `name: "layer_N"` (для профилей ориентации берётся активный вариант).

> Если пункта нет в меню — он отключён в вашей сборке.

---

## Важно про `cover` / `contain`

* Эти режимы относятся **только** к **шаблонной загрузке в пустые карточки** (как разместить новое изображение при добавлении).
* В **сохранённых коллекциях** режимы `cover/contain` **не хранятся и не используются**.
  Для каждой карточки сохраняются **только её трансформы** — масштаб (`scale`) и сдвиг (`tx`, `ty`).
  Именно они целиком определяют вид изображения при открытии коллекции.
* Вы можете в любой момент отредактировать масштаб/сдвиг вручную (колёсиком/перетаскиванием).

---

## Частые вопросы

**Картинка не умещается/обрезана** — уменьшите масштаб колёсиком и сдвиньте изображение.
**После открытия старого проекта «поехали» кадры** — импортируйте актуальную версию и проверьте колёсиком/перетаскиванием, что трансформы считались корректно.
**QR выглядит размытым** — увеличьте `size` QR в конфиге шаблона или используйте PNG при экспорте.
