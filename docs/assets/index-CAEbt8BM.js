const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-DHALY8Bc.js","assets/jspdf-Bb3MAaWf.js","assets/vendor-react-Cx2gpj_n.js","assets/vendor-ui-BDp2sjC_.js"])))=>i.map(i=>d[i]);
import{r as D,j as E,k as wo,m as xo,n as We,C as _o,p as Vi,q as Hi,S as Gi,L as Yi,t as yr,I as ko,T as Zi,v as Xi,X as Ki,w as Co,x as Eo,R as Tt,a as Se,y as Qi,z as Ji,A as pn,N as ts,B as es}from"./vendor-react-Cx2gpj_n.js";import{S as ns,R as So,I as rs,T as Ro,a as os,b as Ao,c as No,P as is,C as Io,V as ss,L as To,d as Do,e as as,f as ls,g as zo,h as cs,i as ds,O as jo,j as us,k as Mo,l as fs,m as Lo,D as Bo,n as hs,o as ps,p as Po,q as Oo,r as ms,s as gs,t as bs,u as ys,H as vs,v as ws,w as xs,x as _s}from"./vendor-ui-BDp2sjC_.js";import{_ as ks}from"./jspdf-Bb3MAaWf.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}})();if(typeof window<"u"){const t=n=>{const e=n?.reason&&(n.reason.message||String(n.reason))||"Unknown async error";console.error("Unhandled promise rejection:",n?.reason),setTimeout(()=>alert(`Error: ${e}`),0)};window.addEventListener("unhandledrejection",t)}function mn(t){const n=document.documentElement,e=window.matchMedia("(prefers-color-scheme: dark)").matches,r=t==="dark"||t==="system"&&e;n.classList.toggle("dark",r)}function Cs(){D.useEffect(()=>{const t=localStorage.getItem("theme")??"system";mn(t);const n=window.matchMedia("(prefers-color-scheme: dark)"),e=()=>{const o=localStorage.getItem("theme")??"system";o==="system"&&mn(o)};n.addEventListener("change",e);const r=o=>{if(o.key==="theme"){const i=o.newValue??"system";mn(i)}};return window.addEventListener("storage",r),()=>{n.removeEventListener("change",e),window.removeEventListener("storage",r)}},[])}function Fo(t){var n,e,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(n=0;n<o;n++)t[n]&&(e=Fo(t[n]))&&(r&&(r+=" "),r+=e)}else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Uo(){for(var t,n,e=0,r="",o=arguments.length;e<o;e++)(t=arguments[e])&&(n=Fo(t))&&(r&&(r+=" "),r+=n);return r}const vr=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,wr=Uo,Wo=(t,n)=>e=>{var r;if(n?.variants==null)return wr(t,e?.class,e?.className);const{variants:o,defaultVariants:i}=n,a=Object.keys(o).map(u=>{const c=e?.[u],g=i?.[u];if(c===null)return null;const f=vr(c)||vr(g);return o[u][f]}),s=e&&Object.entries(e).reduce((u,c)=>{let[g,f]=c;return f===void 0||(u[g]=f),u},{}),l=n==null||(r=n.compoundVariants)===null||r===void 0?void 0:r.reduce((u,c)=>{let{class:g,className:f,...d}=c;return Object.entries(d).every(y=>{let[h,v]=y;return Array.isArray(v)?v.includes({...i,...s}[h]):{...i,...s}[h]===v})?[...u,g,f]:u},[]);return wr(t,a,l,e?.class,e?.className)},rr="-",Es=t=>{const n=Rs(t),{conflictingClassGroups:e,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const s=a.split(rr);return s[0]===""&&s.length!==1&&s.shift(),qo(s,n)||Ss(a)},getConflictingClassGroupIds:(a,s)=>{const l=e[a]||[];return s&&r[a]?[...l,...r[a]]:l}}},qo=(t,n)=>{if(t.length===0)return n.classGroupId;const e=t[0],r=n.nextPart.get(e),o=r?qo(t.slice(1),r):void 0;if(o)return o;if(n.validators.length===0)return;const i=t.join(rr);return n.validators.find(({validator:a})=>a(i))?.classGroupId},xr=/^\[(.+)\]$/,Ss=t=>{if(xr.test(t)){const n=xr.exec(t)[1],e=n?.substring(0,n.indexOf(":"));if(e)return"arbitrary.."+e}},Rs=t=>{const{theme:n,classGroups:e}=t,r={nextPart:new Map,validators:[]};for(const o in e)Yn(e[o],r,o,n);return r},Yn=(t,n,e,r)=>{t.forEach(o=>{if(typeof o=="string"){const i=o===""?n:_r(n,o);i.classGroupId=e;return}if(typeof o=="function"){if(As(o)){Yn(o(r),n,e,r);return}n.validators.push({validator:o,classGroupId:e});return}Object.entries(o).forEach(([i,a])=>{Yn(a,_r(n,i),e,r)})})},_r=(t,n)=>{let e=t;return n.split(rr).forEach(r=>{e.nextPart.has(r)||e.nextPart.set(r,{nextPart:new Map,validators:[]}),e=e.nextPart.get(r)}),e},As=t=>t.isThemeGetter,Ns=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,e=new Map,r=new Map;const o=(i,a)=>{e.set(i,a),n++,n>t&&(n=0,r=e,e=new Map)};return{get(i){let a=e.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return o(i,a),a},set(i,a){e.has(i)?e.set(i,a):o(i,a)}}},Zn="!",Xn=":",Is=Xn.length,Ts=t=>{const{prefix:n,experimentalParseClassName:e}=t;let r=o=>{const i=[];let a=0,s=0,l=0,u;for(let y=0;y<o.length;y++){let h=o[y];if(a===0&&s===0){if(h===Xn){i.push(o.slice(l,y)),l=y+Is;continue}if(h==="/"){u=y;continue}}h==="["?a++:h==="]"?a--:h==="("?s++:h===")"&&s--}const c=i.length===0?o:o.substring(l),g=Ds(c),f=g!==c,d=u&&u>l?u-l:void 0;return{modifiers:i,hasImportantModifier:f,baseClassName:g,maybePostfixModifierPosition:d}};if(n){const o=n+Xn,i=r;r=a=>a.startsWith(o)?i(a.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(e){const o=r;r=i=>e({className:i,parseClassName:o})}return r},Ds=t=>t.endsWith(Zn)?t.substring(0,t.length-1):t.startsWith(Zn)?t.substring(1):t,zs=t=>{const n=Object.fromEntries(t.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const o=[];let i=[];return r.forEach(a=>{a[0]==="["||n[a]?(o.push(...i.sort(),a),i=[]):i.push(a)}),o.push(...i.sort()),o}},js=t=>({cache:Ns(t.cacheSize),parseClassName:Ts(t),sortModifiers:zs(t),...Es(t)}),Ms=/\s+/,Ls=(t,n)=>{const{parseClassName:e,getClassGroupId:r,getConflictingClassGroupIds:o,sortModifiers:i}=n,a=[],s=t.trim().split(Ms);let l="";for(let u=s.length-1;u>=0;u-=1){const c=s[u],{isExternal:g,modifiers:f,hasImportantModifier:d,baseClassName:y,maybePostfixModifierPosition:h}=e(c);if(g){l=c+(l.length>0?" "+l:l);continue}let v=!!h,b=r(v?y.substring(0,h):y);if(!b){if(!v){l=c+(l.length>0?" "+l:l);continue}if(b=r(y),!b){l=c+(l.length>0?" "+l:l);continue}v=!1}const w=i(f).join(":"),k=d?w+Zn:w,x=k+b;if(a.includes(x))continue;a.push(x);const S=o(b,v);for(let A=0;A<S.length;++A){const I=S[A];a.push(k+I)}l=c+(l.length>0?" "+l:l)}return l};function Bs(){let t=0,n,e,r="";for(;t<arguments.length;)(n=arguments[t++])&&(e=$o(n))&&(r&&(r+=" "),r+=e);return r}const $o=t=>{if(typeof t=="string")return t;let n,e="";for(let r=0;r<t.length;r++)t[r]&&(n=$o(t[r]))&&(e&&(e+=" "),e+=n);return e};function Ps(t,...n){let e,r,o,i=a;function a(l){const u=n.reduce((c,g)=>g(c),t());return e=js(u),r=e.cache.get,o=e.cache.set,i=s,s(l)}function s(l){const u=r(l);if(u)return u;const c=Ls(l,e);return o(l,c),c}return function(){return i(Bs.apply(null,arguments))}}const Ct=t=>{const n=e=>e[t]||[];return n.isThemeGetter=!0,n},Vo=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Ho=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Os=/^\d+\/\d+$/,Fs=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Us=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ws=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,qs=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,$s=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,de=t=>Os.test(t),ft=t=>!!t&&!Number.isNaN(Number(t)),Qt=t=>!!t&&Number.isInteger(Number(t)),gn=t=>t.endsWith("%")&&ft(t.slice(0,-1)),Vt=t=>Fs.test(t),Vs=()=>!0,Hs=t=>Us.test(t)&&!Ws.test(t),Go=()=>!1,Gs=t=>qs.test(t),Ys=t=>$s.test(t),Zs=t=>!st(t)&&!at(t),Xs=t=>me(t,Xo,Go),st=t=>Vo.test(t),re=t=>me(t,Ko,Hs),bn=t=>me(t,ea,ft),kr=t=>me(t,Yo,Go),Ks=t=>me(t,Zo,Ys),qe=t=>me(t,Qo,Gs),at=t=>Ho.test(t),ke=t=>ge(t,Ko),Qs=t=>ge(t,na),Cr=t=>ge(t,Yo),Js=t=>ge(t,Xo),ta=t=>ge(t,Zo),$e=t=>ge(t,Qo,!0),me=(t,n,e)=>{const r=Vo.exec(t);return r?r[1]?n(r[1]):e(r[2]):!1},ge=(t,n,e=!1)=>{const r=Ho.exec(t);return r?r[1]?n(r[1]):e:!1},Yo=t=>t==="position"||t==="percentage",Zo=t=>t==="image"||t==="url",Xo=t=>t==="length"||t==="size"||t==="bg-size",Ko=t=>t==="length",ea=t=>t==="number",na=t=>t==="family-name",Qo=t=>t==="shadow",ra=()=>{const t=Ct("color"),n=Ct("font"),e=Ct("text"),r=Ct("font-weight"),o=Ct("tracking"),i=Ct("leading"),a=Ct("breakpoint"),s=Ct("container"),l=Ct("spacing"),u=Ct("radius"),c=Ct("shadow"),g=Ct("inset-shadow"),f=Ct("text-shadow"),d=Ct("drop-shadow"),y=Ct("blur"),h=Ct("perspective"),v=Ct("aspect"),b=Ct("ease"),w=Ct("animate"),k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],x=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],S=()=>[...x(),at,st],A=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto","contain","none"],N=()=>[at,st,l],z=()=>[de,"full","auto",...N()],j=()=>[Qt,"none","subgrid",at,st],P=()=>["auto",{span:["full",Qt,at,st]},Qt,at,st],_=()=>[Qt,"auto",at,st],C=()=>["auto","min","max","fr",at,st],p=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],U=()=>["start","end","center","stretch","center-safe","end-safe"],nt=()=>["auto",...N()],$=()=>[de,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],F=()=>[t,at,st],M=()=>[...x(),Cr,kr,{position:[at,st]}],et=()=>["no-repeat",{repeat:["","x","y","space","round"]}],O=()=>["auto","cover","contain",Js,Xs,{size:[at,st]}],B=()=>[gn,ke,re],K=()=>["","none","full",u,at,st],Z=()=>["",ft,ke,re],G=()=>["solid","dashed","dotted","double"],ct=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],it=()=>[ft,gn,Cr,kr],tt=()=>["","none",y,at,st],X=()=>["none",ft,at,st],rt=()=>["none",ft,at,st],ut=()=>[ft,at,st],mt=()=>[de,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Vt],breakpoint:[Vt],color:[Vs],container:[Vt],"drop-shadow":[Vt],ease:["in","out","in-out"],font:[Zs],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Vt],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Vt],shadow:[Vt],spacing:["px",ft],text:[Vt],"text-shadow":[Vt],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",de,st,at,v]}],container:["container"],columns:[{columns:[ft,st,at,s]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:S()}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:z()}],"inset-x":[{"inset-x":z()}],"inset-y":[{"inset-y":z()}],start:[{start:z()}],end:[{end:z()}],top:[{top:z()}],right:[{right:z()}],bottom:[{bottom:z()}],left:[{left:z()}],visibility:["visible","invisible","collapse"],z:[{z:[Qt,"auto",at,st]}],basis:[{basis:[de,"full","auto",s,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ft,de,"auto","initial","none",st]}],grow:[{grow:["",ft,at,st]}],shrink:[{shrink:["",ft,at,st]}],order:[{order:[Qt,"first","last","none",at,st]}],"grid-cols":[{"grid-cols":j()}],"col-start-end":[{col:P()}],"col-start":[{"col-start":_()}],"col-end":[{"col-end":_()}],"grid-rows":[{"grid-rows":j()}],"row-start-end":[{row:P()}],"row-start":[{"row-start":_()}],"row-end":[{"row-end":_()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":C()}],"auto-rows":[{"auto-rows":C()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...p(),"normal"]}],"justify-items":[{"justify-items":[...U(),"normal"]}],"justify-self":[{"justify-self":["auto",...U()]}],"align-content":[{content:["normal",...p()]}],"align-items":[{items:[...U(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...U(),{baseline:["","last"]}]}],"place-content":[{"place-content":p()}],"place-items":[{"place-items":[...U(),"baseline"]}],"place-self":[{"place-self":["auto",...U()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:nt()}],mx:[{mx:nt()}],my:[{my:nt()}],ms:[{ms:nt()}],me:[{me:nt()}],mt:[{mt:nt()}],mr:[{mr:nt()}],mb:[{mb:nt()}],ml:[{ml:nt()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:$()}],w:[{w:[s,"screen",...$()]}],"min-w":[{"min-w":[s,"screen","none",...$()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[a]},...$()]}],h:[{h:["screen","lh",...$()]}],"min-h":[{"min-h":["screen","lh","none",...$()]}],"max-h":[{"max-h":["screen","lh",...$()]}],"font-size":[{text:["base",e,ke,re]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,at,bn]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",gn,st]}],"font-family":[{font:[Qs,st,n]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,at,st]}],"line-clamp":[{"line-clamp":[ft,"none",at,bn]}],leading:[{leading:[i,...N()]}],"list-image":[{"list-image":["none",at,st]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",at,st]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:F()}],"text-color":[{text:F()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:[ft,"from-font","auto",at,re]}],"text-decoration-color":[{decoration:F()}],"underline-offset":[{"underline-offset":[ft,"auto",at,st]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",at,st]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",at,st]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:M()}],"bg-repeat":[{bg:et()}],"bg-size":[{bg:O()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Qt,at,st],radial:["",at,st],conic:[Qt,at,st]},ta,Ks]}],"bg-color":[{bg:F()}],"gradient-from-pos":[{from:B()}],"gradient-via-pos":[{via:B()}],"gradient-to-pos":[{to:B()}],"gradient-from":[{from:F()}],"gradient-via":[{via:F()}],"gradient-to":[{to:F()}],rounded:[{rounded:K()}],"rounded-s":[{"rounded-s":K()}],"rounded-e":[{"rounded-e":K()}],"rounded-t":[{"rounded-t":K()}],"rounded-r":[{"rounded-r":K()}],"rounded-b":[{"rounded-b":K()}],"rounded-l":[{"rounded-l":K()}],"rounded-ss":[{"rounded-ss":K()}],"rounded-se":[{"rounded-se":K()}],"rounded-ee":[{"rounded-ee":K()}],"rounded-es":[{"rounded-es":K()}],"rounded-tl":[{"rounded-tl":K()}],"rounded-tr":[{"rounded-tr":K()}],"rounded-br":[{"rounded-br":K()}],"rounded-bl":[{"rounded-bl":K()}],"border-w":[{border:Z()}],"border-w-x":[{"border-x":Z()}],"border-w-y":[{"border-y":Z()}],"border-w-s":[{"border-s":Z()}],"border-w-e":[{"border-e":Z()}],"border-w-t":[{"border-t":Z()}],"border-w-r":[{"border-r":Z()}],"border-w-b":[{"border-b":Z()}],"border-w-l":[{"border-l":Z()}],"divide-x":[{"divide-x":Z()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Z()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...G(),"hidden","none"]}],"divide-style":[{divide:[...G(),"hidden","none"]}],"border-color":[{border:F()}],"border-color-x":[{"border-x":F()}],"border-color-y":[{"border-y":F()}],"border-color-s":[{"border-s":F()}],"border-color-e":[{"border-e":F()}],"border-color-t":[{"border-t":F()}],"border-color-r":[{"border-r":F()}],"border-color-b":[{"border-b":F()}],"border-color-l":[{"border-l":F()}],"divide-color":[{divide:F()}],"outline-style":[{outline:[...G(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ft,at,st]}],"outline-w":[{outline:["",ft,ke,re]}],"outline-color":[{outline:F()}],shadow:[{shadow:["","none",c,$e,qe]}],"shadow-color":[{shadow:F()}],"inset-shadow":[{"inset-shadow":["none",g,$e,qe]}],"inset-shadow-color":[{"inset-shadow":F()}],"ring-w":[{ring:Z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:F()}],"ring-offset-w":[{"ring-offset":[ft,re]}],"ring-offset-color":[{"ring-offset":F()}],"inset-ring-w":[{"inset-ring":Z()}],"inset-ring-color":[{"inset-ring":F()}],"text-shadow":[{"text-shadow":["none",f,$e,qe]}],"text-shadow-color":[{"text-shadow":F()}],opacity:[{opacity:[ft,at,st]}],"mix-blend":[{"mix-blend":[...ct(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ct()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ft]}],"mask-image-linear-from-pos":[{"mask-linear-from":it()}],"mask-image-linear-to-pos":[{"mask-linear-to":it()}],"mask-image-linear-from-color":[{"mask-linear-from":F()}],"mask-image-linear-to-color":[{"mask-linear-to":F()}],"mask-image-t-from-pos":[{"mask-t-from":it()}],"mask-image-t-to-pos":[{"mask-t-to":it()}],"mask-image-t-from-color":[{"mask-t-from":F()}],"mask-image-t-to-color":[{"mask-t-to":F()}],"mask-image-r-from-pos":[{"mask-r-from":it()}],"mask-image-r-to-pos":[{"mask-r-to":it()}],"mask-image-r-from-color":[{"mask-r-from":F()}],"mask-image-r-to-color":[{"mask-r-to":F()}],"mask-image-b-from-pos":[{"mask-b-from":it()}],"mask-image-b-to-pos":[{"mask-b-to":it()}],"mask-image-b-from-color":[{"mask-b-from":F()}],"mask-image-b-to-color":[{"mask-b-to":F()}],"mask-image-l-from-pos":[{"mask-l-from":it()}],"mask-image-l-to-pos":[{"mask-l-to":it()}],"mask-image-l-from-color":[{"mask-l-from":F()}],"mask-image-l-to-color":[{"mask-l-to":F()}],"mask-image-x-from-pos":[{"mask-x-from":it()}],"mask-image-x-to-pos":[{"mask-x-to":it()}],"mask-image-x-from-color":[{"mask-x-from":F()}],"mask-image-x-to-color":[{"mask-x-to":F()}],"mask-image-y-from-pos":[{"mask-y-from":it()}],"mask-image-y-to-pos":[{"mask-y-to":it()}],"mask-image-y-from-color":[{"mask-y-from":F()}],"mask-image-y-to-color":[{"mask-y-to":F()}],"mask-image-radial":[{"mask-radial":[at,st]}],"mask-image-radial-from-pos":[{"mask-radial-from":it()}],"mask-image-radial-to-pos":[{"mask-radial-to":it()}],"mask-image-radial-from-color":[{"mask-radial-from":F()}],"mask-image-radial-to-color":[{"mask-radial-to":F()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":x()}],"mask-image-conic-pos":[{"mask-conic":[ft]}],"mask-image-conic-from-pos":[{"mask-conic-from":it()}],"mask-image-conic-to-pos":[{"mask-conic-to":it()}],"mask-image-conic-from-color":[{"mask-conic-from":F()}],"mask-image-conic-to-color":[{"mask-conic-to":F()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:M()}],"mask-repeat":[{mask:et()}],"mask-size":[{mask:O()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",at,st]}],filter:[{filter:["","none",at,st]}],blur:[{blur:tt()}],brightness:[{brightness:[ft,at,st]}],contrast:[{contrast:[ft,at,st]}],"drop-shadow":[{"drop-shadow":["","none",d,$e,qe]}],"drop-shadow-color":[{"drop-shadow":F()}],grayscale:[{grayscale:["",ft,at,st]}],"hue-rotate":[{"hue-rotate":[ft,at,st]}],invert:[{invert:["",ft,at,st]}],saturate:[{saturate:[ft,at,st]}],sepia:[{sepia:["",ft,at,st]}],"backdrop-filter":[{"backdrop-filter":["","none",at,st]}],"backdrop-blur":[{"backdrop-blur":tt()}],"backdrop-brightness":[{"backdrop-brightness":[ft,at,st]}],"backdrop-contrast":[{"backdrop-contrast":[ft,at,st]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ft,at,st]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ft,at,st]}],"backdrop-invert":[{"backdrop-invert":["",ft,at,st]}],"backdrop-opacity":[{"backdrop-opacity":[ft,at,st]}],"backdrop-saturate":[{"backdrop-saturate":[ft,at,st]}],"backdrop-sepia":[{"backdrop-sepia":["",ft,at,st]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",at,st]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ft,"initial",at,st]}],ease:[{ease:["linear","initial",b,at,st]}],delay:[{delay:[ft,at,st]}],animate:[{animate:["none",w,at,st]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[h,at,st]}],"perspective-origin":[{"perspective-origin":S()}],rotate:[{rotate:X()}],"rotate-x":[{"rotate-x":X()}],"rotate-y":[{"rotate-y":X()}],"rotate-z":[{"rotate-z":X()}],scale:[{scale:rt()}],"scale-x":[{"scale-x":rt()}],"scale-y":[{"scale-y":rt()}],"scale-z":[{"scale-z":rt()}],"scale-3d":["scale-3d"],skew:[{skew:ut()}],"skew-x":[{"skew-x":ut()}],"skew-y":[{"skew-y":ut()}],transform:[{transform:[at,st,"","none","gpu","cpu"]}],"transform-origin":[{origin:S()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:mt()}],"translate-x":[{"translate-x":mt()}],"translate-y":[{"translate-y":mt()}],"translate-z":[{"translate-z":mt()}],"translate-none":["translate-none"],accent:[{accent:F()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:F()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",at,st]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",at,st]}],fill:[{fill:["none",...F()]}],"stroke-w":[{stroke:[ft,ke,re,bn]}],stroke:[{stroke:["none",...F()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},oa=Ps(ra);function yt(...t){return oa(Uo(t))}const ia=Wo("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),_t=D.forwardRef(({className:t,variant:n,size:e,asChild:r=!1,...o},i)=>{const a=r?ns:"button";return E.jsx(a,{className:yt(ia({variant:n,size:e,className:t})),ref:i,...o})});_t.displayName="Button";const sa=/^(image\/(jpeg|png|webp|gif|avif|bmp|tiff))$/i;function aa(t){return sa.test(t.type)}function la(t,n=36){const e=[];for(const r of t)if(aa(r)){if(e.length>=n)break;e.push({id:crypto.randomUUID(),url:URL.createObjectURL(r),name:r.name,size:r.size,type:r.type})}return e}function Er(t){for(const n of t)try{URL.revokeObjectURL(n.url)}catch{}}let Wt=null;function Ve(){if(!Wt)throw new Error("ConfigController: not initialized. Call Config.init().")}function Sr(t){if(t.MAX_CARDS!=null&&(!Number.isInteger(t.MAX_CARDS)||t.MAX_CARDS<=0))throw new Error("MAX_CARDS must be a positive integer.");if(t.CARD_EXPORT_SIZE!=null&&(!Number.isInteger(t.CARD_EXPORT_SIZE)||t.CARD_EXPORT_SIZE<=0))throw new Error("CARD_EXPORT_SIZE must be a positive integer.");if(t.PREVIEW_EXACT_SIZE!=null&&(!Number.isInteger(t.PREVIEW_EXACT_SIZE)||t.PREVIEW_EXACT_SIZE<=0))throw new Error("PREVIEW_EXACT_SIZE must be a positive integer.");if(t.PREVIEW_FAST_SIZE!=null&&(!Number.isInteger(t.PREVIEW_FAST_SIZE)||t.PREVIEW_FAST_SIZE<=0))throw new Error("PREVIEW_FAST_SIZE must be a positive integer.");if(t.PDF_JPEG_QUALITY!=null&&(t.PDF_JPEG_QUALITY<0||t.PDF_JPEG_QUALITY>1))throw new Error("PDF_JPEG_QUALITY must be within [0..1].");if(t.IMAGE_FIT_MODE!=null&&t.IMAGE_FIT_MODE!=="cover"&&t.IMAGE_FIT_MODE!=="contain")throw new Error("IMAGE_FIT_MODE must be 'cover' or 'contain'.");if(t.INITIAL_ALIGN_X!=null&&!["center","left","right"].includes(t.INITIAL_ALIGN_X))throw new Error("INITIAL_ALIGN_X must be 'center' | 'left' | 'right'.");if(t.INITIAL_ALIGN_Y!=null&&!["center","top","bottom"].includes(t.INITIAL_ALIGN_Y))throw new Error("INITIAL_ALIGN_Y must be 'center' | 'top' | 'bottom'.");if(t.FONT_CATALOG!=null&&!Array.isArray(t.FONT_CATALOG))throw new Error("FONT_CATALOG must be an array.");if(t.DEFAULT_CARD_LAYERS!=null&&!Array.isArray(t.DEFAULT_CARD_LAYERS))throw new Error("DEFAULT_CARD_LAYERS must be an array.");if(t.DEFAULTS!=null&&(typeof t.DEFAULTS!="object"||Array.isArray(t.DEFAULTS)))throw new Error("DEFAULTS must be an object.");if(t.NEAR_SQUARE_TOLERANCE!=null&&(t.NEAR_SQUARE_TOLERANCE<0||t.NEAR_SQUARE_TOLERANCE>.5))throw new Error("NEAR_SQUARE_TOLERANCE must be within [0..0.5].");if(t.NEAR_SQUARE_SCALE!=null&&(t.NEAR_SQUARE_SCALE<=0||t.NEAR_SQUARE_SCALE>1))throw new Error("NEAR_SQUARE_SCALE must be within (0..1].");if(t.LAYER_PROFILES!=null){if(typeof t.LAYER_PROFILES!="object"||Array.isArray(t.LAYER_PROFILES))throw new Error("LAYER_PROFILES must be an object.");for(const[n,e]of Object.entries(t.LAYER_PROFILES)){if(e==null||typeof e!="object"||Array.isArray(e))throw new Error(`LAYER_PROFILES['${n}'] must be an object.`);if(e.on!=null&&typeof e.on!="boolean")throw new Error(`LAYER_PROFILES['${n}'].on must be boolean if provided.`);if(e.landscape!=null&&!Array.isArray(e.landscape))throw new Error(`LAYER_PROFILES['${n}'].landscape must be an array if provided.`);if(e.portrait!=null&&!Array.isArray(e.portrait))throw new Error(`LAYER_PROFILES['${n}'].portrait must be an array if provided.`);if(e.square!=null&&!Array.isArray(e.square))throw new Error(`LAYER_PROFILES['${n}'].square must be an array if provided.`)}}}const bt={init(t){Wt=Object.freeze({...t})},get(){return Ve(),Wt},update(t){return Ve(),Sr(t),Wt=Object.freeze({...Wt,...t}),Wt},loadFromJson(t){Ve();const n=t;return Sr(n),Wt=Object.freeze({...Wt,...n}),Wt},toJson(){return Ve(),{...Wt}},async loadFromUrl(t){const n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error(`Config.loadFromUrl failed: ${n.status}`);const e=await n.json(),{schemaVersion:r,...o}=e??{};return this.loadFromJson(o)}};bt.init({});const ca="/ss/configs/default.json";await bt.loadFromUrl(ca);const Jo=bt.get().MAX_CARDS,It=bt.get().CARD_EXPORT_SIZE,Xe=bt.get().PREVIEW_EXACT_SIZE,da=bt.get().PREVIEW_FAST_SIZE,ua=bt.get().PDF_JPEG_QUALITY,Rr=bt.get().IMAGE_FIT_MODE,fa=bt.get().INITIAL_ALIGN_X,ha=bt.get().INITIAL_ALIGN_Y,ti=bt.get().FONT_CATALOG;bt.get().NEAR_SQUARE_TOLERANCE;bt.get().NEAR_SQUARE_SCALE;bt.get().DEFAULTS;bt.get().DEFAULT_CARD_LAYERS;var ue={},yn,Ar;function pa(){return Ar||(Ar=1,yn=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),yn}var vn={},Jt={},Nr;function se(){if(Nr)return Jt;Nr=1;let t;const n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Jt.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17},Jt.getSymbolTotalCodewords=function(r){return n[r]},Jt.getBCHDigit=function(e){let r=0;for(;e!==0;)r++,e>>>=1;return r},Jt.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');t=r},Jt.isKanjiModeEnabled=function(){return typeof t<"u"},Jt.toSJIS=function(r){return t(r)},Jt}var wn={},Ir;function or(){return Ir||(Ir=1,function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function n(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}t.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},t.from=function(r,o){if(t.isValid(r))return r;try{return n(r)}catch{return o}}}(wn)),wn}var xn,Tr;function ma(){if(Tr)return xn;Tr=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(n){const e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let r=0;r<e;r++)this.putBit((n>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}},xn=t,xn}var _n,Dr;function ga(){if(Dr)return _n;Dr=1;function t(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}return t.prototype.set=function(n,e,r,o){const i=n*this.size+e;this.data[i]=r,o&&(this.reservedBit[i]=!0)},t.prototype.get=function(n,e){return this.data[n*this.size+e]},t.prototype.xor=function(n,e,r){this.data[n*this.size+e]^=r},t.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]},_n=t,_n}var kn={},zr;function ba(){return zr||(zr=1,function(t){const n=se().getSymbolSize;t.getRowColCoords=function(r){if(r===1)return[];const o=Math.floor(r/7)+2,i=n(r),a=i===145?26:Math.ceil((i-13)/(2*o-2))*2,s=[i-7];for(let l=1;l<o-1;l++)s[l]=s[l-1]-a;return s.push(6),s.reverse()},t.getPositions=function(r){const o=[],i=t.getRowColCoords(r),a=i.length;for(let s=0;s<a;s++)for(let l=0;l<a;l++)s===0&&l===0||s===0&&l===a-1||s===a-1&&l===0||o.push([i[s],i[l]]);return o}}(kn)),kn}var Cn={},jr;function ya(){if(jr)return Cn;jr=1;const t=se().getSymbolSize,n=7;return Cn.getPositions=function(r){const o=t(r);return[[0,0],[o-n,0],[0,o-n]]},Cn}var En={},Mr;function va(){return Mr||(Mr=1,function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n={N1:3,N2:3,N3:40,N4:10};t.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},t.from=function(o){return t.isValid(o)?parseInt(o,10):void 0},t.getPenaltyN1=function(o){const i=o.size;let a=0,s=0,l=0,u=null,c=null;for(let g=0;g<i;g++){s=l=0,u=c=null;for(let f=0;f<i;f++){let d=o.get(g,f);d===u?s++:(s>=5&&(a+=n.N1+(s-5)),u=d,s=1),d=o.get(f,g),d===c?l++:(l>=5&&(a+=n.N1+(l-5)),c=d,l=1)}s>=5&&(a+=n.N1+(s-5)),l>=5&&(a+=n.N1+(l-5))}return a},t.getPenaltyN2=function(o){const i=o.size;let a=0;for(let s=0;s<i-1;s++)for(let l=0;l<i-1;l++){const u=o.get(s,l)+o.get(s,l+1)+o.get(s+1,l)+o.get(s+1,l+1);(u===4||u===0)&&a++}return a*n.N2},t.getPenaltyN3=function(o){const i=o.size;let a=0,s=0,l=0;for(let u=0;u<i;u++){s=l=0;for(let c=0;c<i;c++)s=s<<1&2047|o.get(u,c),c>=10&&(s===1488||s===93)&&a++,l=l<<1&2047|o.get(c,u),c>=10&&(l===1488||l===93)&&a++}return a*n.N3},t.getPenaltyN4=function(o){let i=0;const a=o.data.length;for(let l=0;l<a;l++)i+=o.data[l];return Math.abs(Math.ceil(i*100/a/5)-10)*n.N4};function e(r,o,i){switch(r){case t.Patterns.PATTERN000:return(o+i)%2===0;case t.Patterns.PATTERN001:return o%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(o+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return o*i%2+o*i%3===0;case t.Patterns.PATTERN110:return(o*i%2+o*i%3)%2===0;case t.Patterns.PATTERN111:return(o*i%3+(o+i)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}t.applyMask=function(o,i){const a=i.size;for(let s=0;s<a;s++)for(let l=0;l<a;l++)i.isReserved(l,s)||i.xor(l,s,e(o,l,s))},t.getBestMask=function(o,i){const a=Object.keys(t.Patterns).length;let s=0,l=1/0;for(let u=0;u<a;u++){i(u),t.applyMask(u,o);const c=t.getPenaltyN1(o)+t.getPenaltyN2(o)+t.getPenaltyN3(o)+t.getPenaltyN4(o);t.applyMask(u,o),c<l&&(l=c,s=u)}return s}}(En)),En}var He={},Lr;function ei(){if(Lr)return He;Lr=1;const t=or(),n=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],e=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return He.getBlocksCount=function(o,i){switch(i){case t.L:return n[(o-1)*4+0];case t.M:return n[(o-1)*4+1];case t.Q:return n[(o-1)*4+2];case t.H:return n[(o-1)*4+3];default:return}},He.getTotalCodewordsCount=function(o,i){switch(i){case t.L:return e[(o-1)*4+0];case t.M:return e[(o-1)*4+1];case t.Q:return e[(o-1)*4+2];case t.H:return e[(o-1)*4+3];default:return}},He}var Sn={},Ce={},Br;function wa(){if(Br)return Ce;Br=1;const t=new Uint8Array(512),n=new Uint8Array(256);return function(){let r=1;for(let o=0;o<255;o++)t[o]=r,n[r]=o,r<<=1,r&256&&(r^=285);for(let o=255;o<512;o++)t[o]=t[o-255]}(),Ce.log=function(r){if(r<1)throw new Error("log("+r+")");return n[r]},Ce.exp=function(r){return t[r]},Ce.mul=function(r,o){return r===0||o===0?0:t[n[r]+n[o]]},Ce}var Pr;function xa(){return Pr||(Pr=1,function(t){const n=wa();t.mul=function(r,o){const i=new Uint8Array(r.length+o.length-1);for(let a=0;a<r.length;a++)for(let s=0;s<o.length;s++)i[a+s]^=n.mul(r[a],o[s]);return i},t.mod=function(r,o){let i=new Uint8Array(r);for(;i.length-o.length>=0;){const a=i[0];for(let l=0;l<o.length;l++)i[l]^=n.mul(o[l],a);let s=0;for(;s<i.length&&i[s]===0;)s++;i=i.slice(s)}return i},t.generateECPolynomial=function(r){let o=new Uint8Array([1]);for(let i=0;i<r;i++)o=t.mul(o,new Uint8Array([1,n.exp(i)]));return o}}(Sn)),Sn}var Rn,Or;function _a(){if(Or)return Rn;Or=1;const t=xa();function n(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}return n.prototype.initialize=function(r){this.degree=r,this.genPoly=t.generateECPolynomial(this.degree)},n.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(r.length+this.degree);o.set(r);const i=t.mod(o,this.genPoly),a=this.degree-i.length;if(a>0){const s=new Uint8Array(this.degree);return s.set(i,a),s}return i},Rn=n,Rn}var An={},Nn={},In={},Fr;function ni(){return Fr||(Fr=1,In.isValid=function(n){return!isNaN(n)&&n>=1&&n<=40}),In}var Ut={},Ur;function ri(){if(Ur)return Ut;Ur=1;const t="[0-9]+",n="[A-Z $%*+\\-./:]+";let e="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";e=e.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+e+`)(?:.|[\r
]))+`;Ut.KANJI=new RegExp(e,"g"),Ut.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Ut.BYTE=new RegExp(r,"g"),Ut.NUMERIC=new RegExp(t,"g"),Ut.ALPHANUMERIC=new RegExp(n,"g");const o=new RegExp("^"+e+"$"),i=new RegExp("^"+t+"$"),a=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Ut.testKanji=function(l){return o.test(l)},Ut.testNumeric=function(l){return i.test(l)},Ut.testAlphanumeric=function(l){return a.test(l)},Ut}var Wr;function ae(){return Wr||(Wr=1,function(t){const n=ni(),e=ri();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,a){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!n.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?i.ccBits[0]:a<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return e.testNumeric(i)?t.NUMERIC:e.testAlphanumeric(i)?t.ALPHANUMERIC:e.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function r(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+o)}}t.from=function(i,a){if(t.isValid(i))return i;try{return r(i)}catch{return a}}}(Nn)),Nn}var qr;function ka(){return qr||(qr=1,function(t){const n=se(),e=ei(),r=or(),o=ae(),i=ni(),a=7973,s=n.getBCHDigit(a);function l(f,d,y){for(let h=1;h<=40;h++)if(d<=t.getCapacity(h,y,f))return h}function u(f,d){return o.getCharCountIndicator(f,d)+4}function c(f,d){let y=0;return f.forEach(function(h){const v=u(h.mode,d);y+=v+h.getBitsLength()}),y}function g(f,d){for(let y=1;y<=40;y++)if(c(f,y)<=t.getCapacity(y,d,o.MIXED))return y}t.from=function(d,y){return i.isValid(d)?parseInt(d,10):y},t.getCapacity=function(d,y,h){if(!i.isValid(d))throw new Error("Invalid QR Code version");typeof h>"u"&&(h=o.BYTE);const v=n.getSymbolTotalCodewords(d),b=e.getTotalCodewordsCount(d,y),w=(v-b)*8;if(h===o.MIXED)return w;const k=w-u(h,d);switch(h){case o.NUMERIC:return Math.floor(k/10*3);case o.ALPHANUMERIC:return Math.floor(k/11*2);case o.KANJI:return Math.floor(k/13);case o.BYTE:default:return Math.floor(k/8)}},t.getBestVersionForData=function(d,y){let h;const v=r.from(y,r.M);if(Array.isArray(d)){if(d.length>1)return g(d,v);if(d.length===0)return 1;h=d[0]}else h=d;return l(h.mode,h.getLength(),v)},t.getEncodedBits=function(d){if(!i.isValid(d)||d<7)throw new Error("Invalid QR Code version");let y=d<<12;for(;n.getBCHDigit(y)-s>=0;)y^=a<<n.getBCHDigit(y)-s;return d<<12|y}}(An)),An}var Tn={},$r;function Ca(){if($r)return Tn;$r=1;const t=se(),n=1335,e=21522,r=t.getBCHDigit(n);return Tn.getEncodedBits=function(i,a){const s=i.bit<<3|a;let l=s<<10;for(;t.getBCHDigit(l)-r>=0;)l^=n<<t.getBCHDigit(l)-r;return(s<<10|l)^e},Tn}var Dn={},zn,Vr;function Ea(){if(Vr)return zn;Vr=1;const t=ae();function n(e){this.mode=t.NUMERIC,this.data=e.toString()}return n.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let o,i,a;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),a=parseInt(i,10),r.put(a,10);const s=this.data.length-o;s>0&&(i=this.data.substr(o),a=parseInt(i,10),r.put(a,s*3+1))},zn=n,zn}var jn,Hr;function Sa(){if(Hr)return jn;Hr=1;const t=ae(),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function e(r){this.mode=t.ALPHANUMERIC,this.data=r}return e.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(o){let i;for(i=0;i+2<=this.data.length;i+=2){let a=n.indexOf(this.data[i])*45;a+=n.indexOf(this.data[i+1]),o.put(a,11)}this.data.length%2&&o.put(n.indexOf(this.data[i]),6)},jn=e,jn}var Mn,Gr;function Ra(){if(Gr)return Mn;Gr=1;const t=ae();function n(e){this.mode=t.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}return n.getBitsLength=function(r){return r*8},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(e){for(let r=0,o=this.data.length;r<o;r++)e.put(this.data[r],8)},Mn=n,Mn}var Ln,Yr;function Aa(){if(Yr)return Ln;Yr=1;const t=ae(),n=se();function e(r){this.mode=t.KANJI,this.data=r}return e.getBitsLength=function(o){return o*13},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(r){let o;for(o=0;o<this.data.length;o++){let i=n.toSJIS(this.data[o]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),r.put(i,13)}},Ln=e,Ln}var Bn={exports:{}},Zr;function Na(){return Zr||(Zr=1,function(t){var n={single_source_shortest_paths:function(e,r,o){var i={},a={};a[r]=0;var s=n.PriorityQueue.make();s.push(r,0);for(var l,u,c,g,f,d,y,h,v;!s.empty();){l=s.pop(),u=l.value,g=l.cost,f=e[u]||{};for(c in f)f.hasOwnProperty(c)&&(d=f[c],y=g+d,h=a[c],v=typeof a[c]>"u",(v||h>y)&&(a[c]=y,s.push(c,y),i[c]=u))}if(typeof o<"u"&&typeof a[o]>"u"){var b=["Could not find a path from ",r," to ",o,"."].join("");throw new Error(b)}return i},extract_shortest_path_from_predecessor_list:function(e,r){for(var o=[],i=r;i;)o.push(i),e[i],i=e[i];return o.reverse(),o},find_path:function(e,r,o){var i=n.single_source_shortest_paths(e,r,o);return n.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(e){var r=n.PriorityQueue,o={},i;e=e||{};for(i in r)r.hasOwnProperty(i)&&(o[i]=r[i]);return o.queue=[],o.sorter=e.sorter||r.default_sorter,o},default_sorter:function(e,r){return e.cost-r.cost},push:function(e,r){var o={value:e,cost:r};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=n}(Bn)),Bn.exports}var Xr;function Ia(){return Xr||(Xr=1,function(t){const n=ae(),e=Ea(),r=Sa(),o=Ra(),i=Aa(),a=ri(),s=se(),l=Na();function u(b){return unescape(encodeURIComponent(b)).length}function c(b,w,k){const x=[];let S;for(;(S=b.exec(k))!==null;)x.push({data:S[0],index:S.index,mode:w,length:S[0].length});return x}function g(b){const w=c(a.NUMERIC,n.NUMERIC,b),k=c(a.ALPHANUMERIC,n.ALPHANUMERIC,b);let x,S;return s.isKanjiModeEnabled()?(x=c(a.BYTE,n.BYTE,b),S=c(a.KANJI,n.KANJI,b)):(x=c(a.BYTE_KANJI,n.BYTE,b),S=[]),w.concat(k,x,S).sort(function(I,N){return I.index-N.index}).map(function(I){return{data:I.data,mode:I.mode,length:I.length}})}function f(b,w){switch(w){case n.NUMERIC:return e.getBitsLength(b);case n.ALPHANUMERIC:return r.getBitsLength(b);case n.KANJI:return i.getBitsLength(b);case n.BYTE:return o.getBitsLength(b)}}function d(b){return b.reduce(function(w,k){const x=w.length-1>=0?w[w.length-1]:null;return x&&x.mode===k.mode?(w[w.length-1].data+=k.data,w):(w.push(k),w)},[])}function y(b){const w=[];for(let k=0;k<b.length;k++){const x=b[k];switch(x.mode){case n.NUMERIC:w.push([x,{data:x.data,mode:n.ALPHANUMERIC,length:x.length},{data:x.data,mode:n.BYTE,length:x.length}]);break;case n.ALPHANUMERIC:w.push([x,{data:x.data,mode:n.BYTE,length:x.length}]);break;case n.KANJI:w.push([x,{data:x.data,mode:n.BYTE,length:u(x.data)}]);break;case n.BYTE:w.push([{data:x.data,mode:n.BYTE,length:u(x.data)}])}}return w}function h(b,w){const k={},x={start:{}};let S=["start"];for(let A=0;A<b.length;A++){const I=b[A],N=[];for(let z=0;z<I.length;z++){const j=I[z],P=""+A+z;N.push(P),k[P]={node:j,lastCount:0},x[P]={};for(let _=0;_<S.length;_++){const C=S[_];k[C]&&k[C].node.mode===j.mode?(x[C][P]=f(k[C].lastCount+j.length,j.mode)-f(k[C].lastCount,j.mode),k[C].lastCount+=j.length):(k[C]&&(k[C].lastCount=j.length),x[C][P]=f(j.length,j.mode)+4+n.getCharCountIndicator(j.mode,w))}}S=N}for(let A=0;A<S.length;A++)x[S[A]].end=0;return{map:x,table:k}}function v(b,w){let k;const x=n.getBestModeForData(b);if(k=n.from(w,x),k!==n.BYTE&&k.bit<x.bit)throw new Error('"'+b+'" cannot be encoded with mode '+n.toString(k)+`.
 Suggested mode is: `+n.toString(x));switch(k===n.KANJI&&!s.isKanjiModeEnabled()&&(k=n.BYTE),k){case n.NUMERIC:return new e(b);case n.ALPHANUMERIC:return new r(b);case n.KANJI:return new i(b);case n.BYTE:return new o(b)}}t.fromArray=function(w){return w.reduce(function(k,x){return typeof x=="string"?k.push(v(x,null)):x.data&&k.push(v(x.data,x.mode)),k},[])},t.fromString=function(w,k){const x=g(w,s.isKanjiModeEnabled()),S=y(x),A=h(S,k),I=l.find_path(A.map,"start","end"),N=[];for(let z=1;z<I.length-1;z++)N.push(A.table[I[z]].node);return t.fromArray(d(N))},t.rawSplit=function(w){return t.fromArray(g(w,s.isKanjiModeEnabled()))}}(Dn)),Dn}var Kr;function Ta(){if(Kr)return vn;Kr=1;const t=se(),n=or(),e=ma(),r=ga(),o=ba(),i=ya(),a=va(),s=ei(),l=_a(),u=ka(),c=Ca(),g=ae(),f=Ia();function d(A,I){const N=A.size,z=i.getPositions(I);for(let j=0;j<z.length;j++){const P=z[j][0],_=z[j][1];for(let C=-1;C<=7;C++)if(!(P+C<=-1||N<=P+C))for(let p=-1;p<=7;p++)_+p<=-1||N<=_+p||(C>=0&&C<=6&&(p===0||p===6)||p>=0&&p<=6&&(C===0||C===6)||C>=2&&C<=4&&p>=2&&p<=4?A.set(P+C,_+p,!0,!0):A.set(P+C,_+p,!1,!0))}}function y(A){const I=A.size;for(let N=8;N<I-8;N++){const z=N%2===0;A.set(N,6,z,!0),A.set(6,N,z,!0)}}function h(A,I){const N=o.getPositions(I);for(let z=0;z<N.length;z++){const j=N[z][0],P=N[z][1];for(let _=-2;_<=2;_++)for(let C=-2;C<=2;C++)_===-2||_===2||C===-2||C===2||_===0&&C===0?A.set(j+_,P+C,!0,!0):A.set(j+_,P+C,!1,!0)}}function v(A,I){const N=A.size,z=u.getEncodedBits(I);let j,P,_;for(let C=0;C<18;C++)j=Math.floor(C/3),P=C%3+N-8-3,_=(z>>C&1)===1,A.set(j,P,_,!0),A.set(P,j,_,!0)}function b(A,I,N){const z=A.size,j=c.getEncodedBits(I,N);let P,_;for(P=0;P<15;P++)_=(j>>P&1)===1,P<6?A.set(P,8,_,!0):P<8?A.set(P+1,8,_,!0):A.set(z-15+P,8,_,!0),P<8?A.set(8,z-P-1,_,!0):P<9?A.set(8,15-P-1+1,_,!0):A.set(8,15-P-1,_,!0);A.set(z-8,8,1,!0)}function w(A,I){const N=A.size;let z=-1,j=N-1,P=7,_=0;for(let C=N-1;C>0;C-=2)for(C===6&&C--;;){for(let p=0;p<2;p++)if(!A.isReserved(j,C-p)){let U=!1;_<I.length&&(U=(I[_]>>>P&1)===1),A.set(j,C-p,U),P--,P===-1&&(_++,P=7)}if(j+=z,j<0||N<=j){j-=z,z=-z;break}}}function k(A,I,N){const z=new e;N.forEach(function(p){z.put(p.mode.bit,4),z.put(p.getLength(),g.getCharCountIndicator(p.mode,A)),p.write(z)});const j=t.getSymbolTotalCodewords(A),P=s.getTotalCodewordsCount(A,I),_=(j-P)*8;for(z.getLengthInBits()+4<=_&&z.put(0,4);z.getLengthInBits()%8!==0;)z.putBit(0);const C=(_-z.getLengthInBits())/8;for(let p=0;p<C;p++)z.put(p%2?17:236,8);return x(z,A,I)}function x(A,I,N){const z=t.getSymbolTotalCodewords(I),j=s.getTotalCodewordsCount(I,N),P=z-j,_=s.getBlocksCount(I,N),C=z%_,p=_-C,U=Math.floor(z/_),nt=Math.floor(P/_),$=nt+1,F=U-nt,M=new l(F);let et=0;const O=new Array(_),B=new Array(_);let K=0;const Z=new Uint8Array(A.buffer);for(let X=0;X<_;X++){const rt=X<p?nt:$;O[X]=Z.slice(et,et+rt),B[X]=M.encode(O[X]),et+=rt,K=Math.max(K,rt)}const G=new Uint8Array(z);let ct=0,it,tt;for(it=0;it<K;it++)for(tt=0;tt<_;tt++)it<O[tt].length&&(G[ct++]=O[tt][it]);for(it=0;it<F;it++)for(tt=0;tt<_;tt++)G[ct++]=B[tt][it];return G}function S(A,I,N,z){let j;if(Array.isArray(A))j=f.fromArray(A);else if(typeof A=="string"){let U=I;if(!U){const nt=f.rawSplit(A);U=u.getBestVersionForData(nt,N)}j=f.fromString(A,U||40)}else throw new Error("Invalid data");const P=u.getBestVersionForData(j,N);if(!P)throw new Error("The amount of data is too big to be stored in a QR Code");if(!I)I=P;else if(I<P)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+P+`.
`);const _=k(I,N,j),C=t.getSymbolSize(I),p=new r(C);return d(p,I),y(p),h(p,I),b(p,N,0),I>=7&&v(p,I),w(p,_),isNaN(z)&&(z=a.getBestMask(p,b.bind(null,p,N))),a.applyMask(z,p),b(p,N,z),{modules:p,version:I,errorCorrectionLevel:N,maskPattern:z,segments:j}}return vn.create=function(I,N){if(typeof I>"u"||I==="")throw new Error("No input text");let z=n.M,j,P;return typeof N<"u"&&(z=n.from(N.errorCorrectionLevel,n.M),j=u.from(N.version),P=a.from(N.maskPattern),N.toSJISFunc&&t.setToSJISFunction(N.toSJISFunc)),S(I,j,z,P)},vn}var Pn={},On={},Qr;function oi(){return Qr||(Qr=1,function(t){function n(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let r=e.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+e);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(i){return[i,i]}))),r.length===6&&r.push("F","F");const o=parseInt(r.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+r.slice(0,6).join("")}}t.getOptions=function(r){r||(r={}),r.color||(r.color={});const o=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,i=r.width&&r.width>=21?r.width:void 0,a=r.scale||4;return{width:i,scale:i?4:a,margin:o,color:{dark:n(r.color.dark||"#000000ff"),light:n(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},t.getScale=function(r,o){return o.width&&o.width>=r+o.margin*2?o.width/(r+o.margin*2):o.scale},t.getImageWidth=function(r,o){const i=t.getScale(r,o);return Math.floor((r+o.margin*2)*i)},t.qrToImageData=function(r,o,i){const a=o.modules.size,s=o.modules.data,l=t.getScale(a,i),u=Math.floor((a+i.margin*2)*l),c=i.margin*l,g=[i.color.light,i.color.dark];for(let f=0;f<u;f++)for(let d=0;d<u;d++){let y=(f*u+d)*4,h=i.color.light;if(f>=c&&d>=c&&f<u-c&&d<u-c){const v=Math.floor((f-c)/l),b=Math.floor((d-c)/l);h=g[s[v*a+b]?1:0]}r[y++]=h.r,r[y++]=h.g,r[y++]=h.b,r[y]=h.a}}}(On)),On}var Jr;function Da(){return Jr||(Jr=1,function(t){const n=oi();function e(o,i,a){o.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=a,i.width=a,i.style.height=a+"px",i.style.width=a+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,a,s){let l=s,u=a;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),a||(u=r()),l=n.getOptions(l);const c=n.getImageWidth(i.modules.size,l),g=u.getContext("2d"),f=g.createImageData(c,c);return n.qrToImageData(f.data,i,l),e(g,u,c),g.putImageData(f,0,0),u},t.renderToDataURL=function(i,a,s){let l=s;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),l||(l={});const u=t.render(i,a,l),c=l.type||"image/png",g=l.rendererOpts||{};return u.toDataURL(c,g.quality)}}(Pn)),Pn}var Fn={},to;function za(){if(to)return Fn;to=1;const t=oi();function n(o,i){const a=o.a/255,s=i+'="'+o.hex+'"';return a<1?s+" "+i+'-opacity="'+a.toFixed(2).slice(1)+'"':s}function e(o,i,a){let s=o+i;return typeof a<"u"&&(s+=" "+a),s}function r(o,i,a){let s="",l=0,u=!1,c=0;for(let g=0;g<o.length;g++){const f=Math.floor(g%i),d=Math.floor(g/i);!f&&!u&&(u=!0),o[g]?(c++,g>0&&f>0&&o[g-1]||(s+=u?e("M",f+a,.5+d+a):e("m",l,0),l=0,u=!1),f+1<i&&o[g+1]||(s+=e("h",c),c=0)):l++}return s}return Fn.render=function(i,a,s){const l=t.getOptions(a),u=i.modules.size,c=i.modules.data,g=u+l.margin*2,f=l.color.light.a?"<path "+n(l.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",d="<path "+n(l.color.dark,"stroke")+' d="'+r(c,u,l.margin)+'"/>',y='viewBox="0 0 '+g+" "+g+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+y+' shape-rendering="crispEdges">'+f+d+`</svg>
`;return typeof s=="function"&&s(null,v),v},Fn}var eo;function ja(){if(eo)return ue;eo=1;const t=pa(),n=Ta(),e=Da(),r=za();function o(i,a,s,l,u){const c=[].slice.call(arguments,1),g=c.length,f=typeof c[g-1]=="function";if(!f&&!t())throw new Error("Callback required as last argument");if(f){if(g<2)throw new Error("Too few arguments provided");g===2?(u=s,s=a,a=l=void 0):g===3&&(a.getContext&&typeof u>"u"?(u=l,l=void 0):(u=l,l=s,s=a,a=void 0))}else{if(g<1)throw new Error("Too few arguments provided");return g===1?(s=a,a=l=void 0):g===2&&!a.getContext&&(l=s,s=a,a=void 0),new Promise(function(d,y){try{const h=n.create(s,l);d(i(h,a,l))}catch(h){y(h)}})}try{const d=n.create(s,l);u(null,i(d,a,l))}catch(d){u(d)}}return ue.create=n.create,ue.toCanvas=o.bind(null,e.render),ue.toDataURL=o.bind(null,e.renderToDataURL),ue.toString=o.bind(null,function(i,a,s){return r.render(i,s)}),ue}var Ma=ja();const La=wo(Ma);async function De(t,n=512,e=1){const r={errorCorrectionLevel:"M",type:"image/png",margin:e,width:n,color:{dark:"#000000",light:"#ffffff"}};return La.toDataURL(t,r)}const on=(()=>{const t=bt.get().DEFAULTS?.BACKGROUND;return{color:typeof t?.color=="string"?t.color:"#ffffff",alpha:Math.max(0,Math.min(1,typeof t?.alpha=="number"?t.alpha:1))}})(),pe={scale:1,tx:0,ty:0},Un=(t,n,e)=>Math.max(n,Math.min(e,t)),Ht=(t,n)=>typeof t=="number"?t:n;function Ba(t){return new Promise((n,e)=>{const r=new Image;r.onload=()=>n({w:r.naturalWidth,h:r.naturalHeight}),r.onerror=e,r.src=t})}function Pa(t,n,e,r,o,i,a=1){const s=e/t,l=e/n,u=Math.min(s,l)*a,c=t*u,g=n*u,f=o==="left"?0:o==="right"?e-c:(e-c)/2,d=i==="top"?0:i==="bottom"?e-g:(e-g)/2,y=(f-(e-c)/2)/e*100,h=(d-(e-g)/2)/e*100;return{tx:Math.max(-100,Math.min(100,y)),ty:Math.max(-100,Math.min(100,h))}}const gt=xo((t,n)=>({photos:[],max:Jo,fitModeByPhoto:{},setFitMode:(e,r)=>t(o=>({fitModeByPhoto:{...o.fitModeByPhoto,[e]:r}})),transforms:{},layersByPhoto:{},cardBackground:{},setCardBackground:(e,r)=>t(o=>{const i=o.cardBackground[e]??on,a={color:r.color??i.color,alpha:Math.max(0,Math.min(1,r.alpha??i.alpha))};return{cardBackground:{...o.cardBackground,[e]:a}}}),setTransform:(e,r)=>t(o=>{const i=o.transforms[e]??pe,a={scale:Un(r.scale??i.scale,.5,4),...r.scaleAbs!=null?{scaleAbs:Math.max(1e-4,r.scaleAbs)}:i.scaleAbs!=null?{scaleAbs:i.scaleAbs}:{},tx:Un(r.tx??i.tx,-100,100),ty:Un(r.ty??i.ty,-100,100)};return{transforms:{...o.transforms,[e]:a}}}),resetTransform:e=>t(r=>{const{[e]:o,...i}=r.transforms;return{transforms:i}}),add:(e,r)=>{if(!e?.length)return;const{photos:o,max:i}=n(),a=Math.max(0,i-o.length);if(a<=0){alert(`  : ${i} .`);return}let s=e;if(e.length>a&&(alert(`   ${a}  ${e.length}    ${i}.`),s=e.slice(0,a)),t({photos:[...o,...s]}),r?.skipInit)return;r?.skipInit||t(u=>{const c={...u.fitModeByPhoto};for(const g of s)c[g.id]==null&&(c[g.id]=Rr);return{fitModeByPhoto:c}});const l=bt.get().DEFAULT_CARD_LAYERS??[];if(l.length){for(const u of s)for(const c of l)if(c?.type==="text"){const g=Ht(c.y,It-140);n().addTextLayer(u.id,{x:typeof c.x=="number"?c.x:40,y:g,text:typeof c.text=="string"?c.text:void 0,fontFamily:typeof c.fontFamily=="string"?c.fontFamily:void 0,fontSize:typeof c.fontSize=="number"?c.fontSize:void 0,fontStyle:typeof c.fontStyle=="string"?c.fontStyle:void 0,fill:typeof c.fill=="string"?c.fill:void 0,align:["left","center","right"].includes(c.align)?c.align:void 0,lineHeight:typeof c.lineHeight=="number"?c.lineHeight:void 0,letterSpacing:typeof c.letterSpacing=="number"?c.letterSpacing:void 0,width:typeof c.width=="number"?c.width:void 0,rotation:typeof c.rotation=="number"?c.rotation:void 0,name:typeof c.name=="string"?c.name:void 0})}else if(c?.type==="rect"){const g=Ht(c.y,40);n().addRectLayer(u.id,{x:typeof c.x=="number"?c.x:40,y:g,width:typeof c.width=="number"?c.width:void 0,height:typeof c.height=="number"?c.height:void 0,fill:typeof c.fill=="string"?c.fill:void 0,stroke:typeof c.stroke=="string"?c.stroke:void 0,strokeWidth:typeof c.strokeWidth=="number"?c.strokeWidth:void 0,cornerRadius:typeof c.cornerRadius=="number"?c.cornerRadius:void 0,opacity:typeof c.opacity=="number"?c.opacity:void 0,rotation:typeof c.rotation=="number"?c.rotation:void 0,name:typeof c.name=="string"?c.name:void 0})}else if(c?.type==="qr"){const g=Ht(c.y,40),f=Math.max(1,Math.round(typeof c.size=="number"?c.size:512));(async()=>{const d=await n().addQrLayer(u.id,typeof c.text=="string"?c.text:"",f);n().updateLayer(u.id,d,{x:typeof c.x=="number"?c.x:40,y:g,name:typeof c.name=="string"?c.name:void 0})})()}}for(const u of s)(async()=>{try{const{w:c,h:g}=await Ba(u.url),f=bt.get(),d=Math.max(0,Number(f.NEAR_SQUARE_TOLERANCE??0)),y=Number(f.NEAR_SQUARE_SCALE??1),h=It,v=h/c,b=h/g,w=Math.min(v,b),k=Math.max(v,b),x=Rr==="contain",S=c/g,A=Math.abs(S-1)<=d;let I=1;x?I=A?y:1:I=k/w;const{tx:N,ty:z}=Pa(c,g,h,"contain",fa,ha,I);n().setTransform(u.id,{tx:N,ty:z,scale:Math.max(.5,Math.min(4,pe.scale*I))});const j=bt.get().LAYER_PROFILES?.orientation;if(j&&j.on!==!1){let P;S>1+d?P="landscape":S<1-d?P="portrait":P="square";const _=P==="landscape"?j.landscape??[]:P==="portrait"?j.portrait??[]:j.square??[];for(const C of _)if(!(!C||typeof C!="object")){if(C.type==="text"){const p=Ht(C.y,It-140);n().addTextLayer(u.id,{x:typeof C.x=="number"?C.x:40,y:p,text:typeof C.text=="string"?C.text:void 0,fontFamily:typeof C.fontFamily=="string"?C.fontFamily:void 0,fontSize:typeof C.fontSize=="number"?C.fontSize:void 0,fontStyle:typeof C.fontStyle=="string"?C.fontStyle:void 0,fill:typeof C.fill=="string"?C.fill:void 0,align:["left","center","right"].includes(C.align)?C.align:void 0,lineHeight:typeof C.lineHeight=="number"?C.lineHeight:void 0,letterSpacing:typeof C.letterSpacing=="number"?C.letterSpacing:void 0,width:typeof C.width=="number"?C.width:void 0,rotation:typeof C.rotation=="number"?C.rotation:void 0,name:typeof C.name=="string"?C.name:void 0})}else if(C.type==="rect"){const p=Ht(C.y,40);n().addRectLayer(u.id,{x:typeof C.x=="number"?C.x:40,y:p,width:typeof C.width=="number"?C.width:void 0,height:typeof C.height=="number"?C.height:void 0,fill:typeof C.fill=="string"?C.fill:void 0,stroke:typeof C.stroke=="string"?C.stroke:void 0,strokeWidth:typeof C.strokeWidth=="number"?C.strokeWidth:void 0,cornerRadius:typeof C.cornerRadius=="number"?C.cornerRadius:void 0,opacity:typeof C.opacity=="number"?C.opacity:void 0,rotation:typeof C.rotation=="number"?C.rotation:void 0,name:typeof C.name=="string"?C.name:void 0})}else if(C.type==="qr"){const p=Ht(C.y,40),U=Math.max(1,Math.round(typeof C.size=="number"?C.size:512)),nt=await n().addQrLayer(u.id,typeof C.text=="string"?C.text:"",U);n().updateLayer(u.id,nt,{x:typeof C.x=="number"?C.x:40,y:p,rotation:typeof C.rotation=="number"?C.rotation:void 0,name:typeof C.name=="string"?C.name:void 0})}}}}catch{}})()},clear:()=>{const e=n().photos;e.length&&Er(e),t({photos:[],transforms:{},layersByPhoto:{},cardBackground:{},fitModeByPhoto:{}})},remove:e=>t(r=>{const o=r.photos.findIndex(u=>u.id===e);if(o===-1)return null;Er([r.photos[o]]);const{[e]:i,...a}=r.transforms,s={...r.layersByPhoto};delete s[e];const l={...r.fitModeByPhoto};return delete l[e],{photos:r.photos.filter(u=>u.id!==e),transforms:a,layersByPhoto:s,fitModeByPhoto:l}}),addTextLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const u=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=bt.get().DEFAULTS?.TEXT??{},g=Ht(c.y,It-140),f=u??g,d={id:o,type:"text",x:typeof c.x=="number"?c.x:40,y:f,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,text:typeof c.text=="string"?c.text:"New text",fontFamily:typeof c.fontFamily=="string"?c.fontFamily:"Georgia, serif",fontSize:typeof c.fontSize=="number"?c.fontSize:36,fontStyle:typeof c.fontStyle=="string"?c.fontStyle:"",fill:typeof c.fill=="string"?c.fill:"#111",align:["left","center","right"].includes(c.align)?c.align:"left",verticalAlign:["top","middle","bottom"].includes(c.verticalAlign)?c.verticalAlign:"top",padding:typeof c.padding=="number"?c.padding:0,lineHeight:typeof c.lineHeight=="number"?c.lineHeight:1.25,letterSpacing:typeof c.letterSpacing=="number"?c.letterSpacing:0,width:typeof c.width=="number"?c.width:void 0,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,d]}}}),o},addRectLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const u=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=bt.get().DEFAULTS?.RECT??{},g=Ht(c.y,40),f=u??g,d={id:o,type:"rect",x:typeof c.x=="number"?c.x:40,y:f,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,width:typeof c.width=="number"?c.width:600,height:typeof c.height=="number"?c.height:300,fill:typeof c.fill=="string"?c.fill:"#ffffff",stroke:typeof c.stroke=="string"?c.stroke:void 0,strokeWidth:typeof c.strokeWidth=="number"?c.strokeWidth:0,cornerRadius:typeof c.cornerRadius=="number"?c.cornerRadius:0,opacity:typeof c.opacity=="number"?c.opacity:1,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,d]}}}),o},addImageLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const u=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=bt.get().DEFAULTS?.IMAGE??{},g=Ht(c.y,40),f=u??g,d={id:o,type:"image",x:typeof c.x=="number"?c.x:40,y:f,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,src:"",w:typeof c.w=="number"?c.w:void 0,h:typeof c.h=="number"?c.h:void 0,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,d]}}}),o},addQrLayer:async(e,r,o=512)=>{const i=bt.get().DEFAULTS?.QR??{},a=Math.max(1,Math.round(typeof o=="number"?o:i.size??512)),s=await De(r,a,1);return n().addImageLayer(e,{src:s,x:typeof i.x=="number"?i.x:40,y:typeof i.y=="number"?i.y:40,w:a,h:a,qrText:r})},updateQrLayer:async(e,r,o)=>{const a=n().layersByPhoto[e]??[],s=a.findIndex(f=>f.id===r&&f.type==="image");if(s===-1)return;const l=a[s];if(!l.qrText&&!o.text)return;const u=o.text??l.qrText??"",c=Math.max(1,Math.round(o.size??l.w??l.h??512)),g=await De(u,c,1);n().updateLayer(e,r,{src:g,w:c,h:c,...u?{qrText:u}:{}})},updateLayer:(e,r,o)=>t(i=>{const a=i.layersByPhoto[e]??[],s=a.findIndex(f=>f.id===r);if(s===-1)return null;const l=a[s],u={...o};delete u.id,delete u.type;const c={...l,...u},g=[...a];return g[s]=c,{layersByPhoto:{...i.layersByPhoto,[e]:g}}}),removeLayer:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[],a=i.filter(s=>s.id!==r);return a===i?null:{layersByPhoto:{...o.layersByPhoto,[e]:a}}}),bringToFront:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=Math.max(...i.map(l=>l.z)),s=i.map(l=>l.id===r?{...l,z:a+1}:l);return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),sendToBack:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=Math.min(...i.map(l=>l.z)),s=i.map(l=>l.id===r?{...l,z:a-1}:l);return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),setLayersOrder:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=new Map(i.map(u=>[u.id,u])),s=[];let l=1;for(const u of r){const c=a.get(u);c&&s.push({...c,z:l++})}for(const u of i)r.includes(u.id)||s.push({...u,z:l++});return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),reorderPhotos:e=>t(r=>{if(!Array.isArray(e)||!e.length)return null;const o=new Map(r.photos.map(a=>[a.id,a])),i=e.map(a=>o.get(a)).filter(Boolean);for(const a of r.photos)e.includes(a.id)||i.push(a);return{photos:i}})}));function Oa(t){const n=t.replace(/^\uFEFF/,"").replace(/\r\n?/g,`
`).split(`
`).filter(Boolean);if(!n.length)return{rows:[],hasRelative:!1};const e=n[0].toLowerCase(),r=e.includes(";")&&!e.includes(",")?";":",",o=new RegExp(`\\s*(?:"([^"]*)"|([^${r}\\n]*))\\s*(?:${r}|$)`,"g");function i(u){const c=u.toLowerCase();switch(c){case"fontsize":return"fontSize";case"fontstyle":return"fontStyle";case"lineheight":return"lineHeight";case"letterspacing":return"letterSpacing";default:return c}}let a=null;{const u=n[0].toLowerCase();if(/\burl\b/.test(u)){o.lastIndex=0;const c=[];let g;for(;g=o.exec(n[0]);){const f=g[1]??g[2]??"",d=(g[1]?f.replace(/""/g,'"'):f).trim();if(d&&c.push(d),g.index+g[0].length>=n[0].length)break}c.map(f=>f.toLowerCase()).includes("url")&&(a=c)}}const s=[];for(let u=0;u<n.length;u++){const c=n[u];if(!c.trim()||u===0&&a)continue;const g=[];o.lastIndex=0;let f,d=0;for(;(f=o.exec(c))&&d++<1e3;){const w=f[1]??f[2]??"",k=(f[1]?w.replace(/""/g,'"'):w).trim();if(g.push(k),f.index+f[0].length>=c.length)break}if(!g.length)continue;if(!a){const w=(g[0]??"").trim();if(!w)continue;const k=(g[1]??"").trim()||void 0;s.push({url:w,caption:k});continue}const y={};a.forEach((w,k)=>y[w.trim().toLowerCase()]=g[k]??"");const h=(y.url??"").trim();if(!h)continue;const v=(y.caption??"").trim()||void 0,b={};for(const[w,k]of Object.entries(y)){const x=k?.trim(),S=/^layer_([^_]+)_(.+)$/i.exec(w.trim());if(S&&x){const A=`layer_${S[1]}`.toLowerCase(),I=i(S[2]);b[A]||(b[A]={}),b[A][I]=x}}s.push({url:h,caption:v,layers:Object.keys(b).length?b:void 0})}const l=s.some(u=>Fa(u.url));return{rows:s,hasRelative:l}}function ii(t){return/^https?:\/\//i.test(t)}function si(t){return/^data:/i.test(t)}function Fa(t){return!(ii(t)||si(t)||/^blob:/.test(t))}function Ge(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wn={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var no;function Ua(){return no||(no=1,function(t,n){(function(e){t.exports=e()})(function(){return function e(r,o,i){function a(u,c){if(!o[u]){if(!r[u]){var g=typeof Ge=="function"&&Ge;if(!c&&g)return g(u,!0);if(s)return s(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var d=o[u]={exports:{}};r[u][0].call(d.exports,function(y){var h=r[u][1][y];return a(h||y)},d,d.exports,e,r,o,i)}return o[u].exports}for(var s=typeof Ge=="function"&&Ge,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(e,r,o){var i=e("./utils"),a=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(l){for(var u,c,g,f,d,y,h,v=[],b=0,w=l.length,k=w,x=i.getTypeOf(l)!=="string";b<l.length;)k=w-b,g=x?(u=l[b++],c=b<w?l[b++]:0,b<w?l[b++]:0):(u=l.charCodeAt(b++),c=b<w?l.charCodeAt(b++):0,b<w?l.charCodeAt(b++):0),f=u>>2,d=(3&u)<<4|c>>4,y=1<k?(15&c)<<2|g>>6:64,h=2<k?63&g:64,v.push(s.charAt(f)+s.charAt(d)+s.charAt(y)+s.charAt(h));return v.join("")},o.decode=function(l){var u,c,g,f,d,y,h=0,v=0,b="data:";if(l.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var w,k=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&k--,l.charAt(l.length-2)===s.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=a.uint8array?new Uint8Array(0|k):new Array(0|k);h<l.length;)u=s.indexOf(l.charAt(h++))<<2|(f=s.indexOf(l.charAt(h++)))>>4,c=(15&f)<<4|(d=s.indexOf(l.charAt(h++)))>>2,g=(3&d)<<6|(y=s.indexOf(l.charAt(h++))),w[v++]=u,d!==64&&(w[v++]=c),y!==64&&(w[v++]=g);return w}},{"./support":30,"./utils":32}],2:[function(e,r,o){var i=e("./external"),a=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function u(c,g,f,d,y){this.compressedSize=c,this.uncompressedSize=g,this.crc32=f,this.compression=d,this.compressedContent=y}u.prototype={getContentWorker:function(){var c=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),g=this;return c.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,g,f){return c.pipe(new s).pipe(new l("uncompressedSize")).pipe(g.compressWorker(f)).pipe(new l("compressedSize")).withStreamInfo("compression",g)},r.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,o){var i=e("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},o.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,o){var i=e("./utils"),a=function(){for(var s,l=[],u=0;u<256;u++){s=u;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;l[u]=s}return l}();r.exports=function(s,l){return s!==void 0&&s.length?i.getTypeOf(s)!=="string"?function(u,c,g,f){var d=a,y=f+g;u^=-1;for(var h=f;h<y;h++)u=u>>>8^d[255&(u^c[h])];return-1^u}(0|l,s,s.length,0):function(u,c,g,f){var d=a,y=f+g;u^=-1;for(var h=f;h<y;h++)u=u>>>8^d[255&(u^c.charCodeAt(h))];return-1^u}(0|l,s,s.length,0):0}},{"./utils":32}],5:[function(e,r,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(e,r,o){var i=null;i=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:i}},{lie:37}],7:[function(e,r,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=e("pako"),s=e("./utils"),l=e("./stream/GenericWorker"),u=i?"uint8array":"array";function c(g,f){l.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=f,this.meta={}}o.magic="\b\0",s.inherits(c,l),c.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(u,g.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(f){g.push({data:f,meta:g.meta})}},o.compressWorker=function(g){return new c("Deflate",g)},o.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,o){function i(d,y){var h,v="";for(h=0;h<y;h++)v+=String.fromCharCode(255&d),d>>>=8;return v}function a(d,y,h,v,b,w){var k,x,S=d.file,A=d.compression,I=w!==u.utf8encode,N=s.transformTo("string",w(S.name)),z=s.transformTo("string",u.utf8encode(S.name)),j=S.comment,P=s.transformTo("string",w(j)),_=s.transformTo("string",u.utf8encode(j)),C=z.length!==S.name.length,p=_.length!==j.length,U="",nt="",$="",F=S.dir,M=S.date,et={crc32:0,compressedSize:0,uncompressedSize:0};y&&!h||(et.crc32=d.crc32,et.compressedSize=d.compressedSize,et.uncompressedSize=d.uncompressedSize);var O=0;y&&(O|=8),I||!C&&!p||(O|=2048);var B=0,K=0;F&&(B|=16),b==="UNIX"?(K=798,B|=function(G,ct){var it=G;return G||(it=ct?16893:33204),(65535&it)<<16}(S.unixPermissions,F)):(K=20,B|=function(G){return 63&(G||0)}(S.dosPermissions)),k=M.getUTCHours(),k<<=6,k|=M.getUTCMinutes(),k<<=5,k|=M.getUTCSeconds()/2,x=M.getUTCFullYear()-1980,x<<=4,x|=M.getUTCMonth()+1,x<<=5,x|=M.getUTCDate(),C&&(nt=i(1,1)+i(c(N),4)+z,U+="up"+i(nt.length,2)+nt),p&&($=i(1,1)+i(c(P),4)+_,U+="uc"+i($.length,2)+$);var Z="";return Z+=`
\0`,Z+=i(O,2),Z+=A.magic,Z+=i(k,2),Z+=i(x,2),Z+=i(et.crc32,4),Z+=i(et.compressedSize,4),Z+=i(et.uncompressedSize,4),Z+=i(N.length,2),Z+=i(U.length,2),{fileRecord:g.LOCAL_FILE_HEADER+Z+N+U,dirRecord:g.CENTRAL_FILE_HEADER+i(K,2)+Z+i(P.length,2)+"\0\0\0\0"+i(B,4)+i(v,4)+N+U+P}}var s=e("../utils"),l=e("../stream/GenericWorker"),u=e("../utf8"),c=e("../crc32"),g=e("../signature");function f(d,y,h,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=h,this.encodeFileName=v,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(f,l),f.prototype.push=function(d){var y=d.meta.percent||0,h=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,l.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:h?(y+100*(h-v-1))/h:100}}))},f.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var y=this.streamFiles&&!d.file.dir;if(y){var h=a(d,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},f.prototype.closedSource=function(d){this.accumulate=!1;var y=this.streamFiles&&!d.file.dir,h=a(d,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),y)this.push({data:function(v){return g.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},f.prototype.flush=function(){for(var d=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var h=this.bytesWritten-d,v=function(b,w,k,x,S){var A=s.transformTo("string",S(x));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(b,2)+i(b,2)+i(w,4)+i(k,4)+i(A.length,2)+A}(this.dirRecords.length,h,d,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},f.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},f.prototype.registerPrevious=function(d){this._sources.push(d);var y=this;return d.on("data",function(h){y.processChunk(h)}),d.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),d.on("error",function(h){y.error(h)}),this},f.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},f.prototype.error=function(d){var y=this._sources;if(!l.prototype.error.call(this,d))return!1;for(var h=0;h<y.length;h++)try{y[h].error(d)}catch{}return!0},f.prototype.lock=function(){l.prototype.lock.call(this);for(var d=this._sources,y=0;y<d.length;y++)d[y].lock()},r.exports=f},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,o){var i=e("../compressions"),a=e("./ZipFileWorker");o.generateWorker=function(s,l,u){var c=new a(l.streamFiles,u,l.platform,l.encodeFileName),g=0;try{s.forEach(function(f,d){g++;var y=function(w,k){var x=w||k,S=i[x];if(!S)throw new Error(x+" is not a valid compression method !");return S}(d.options.compression,l.compression),h=d.options.compressionOptions||l.compressionOptions||{},v=d.dir,b=d.date;d._compressWorker(y,h).withStreamInfo("file",{name:f,dir:v,date:b,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(c)}),c.entriesCount=g}catch(f){c.error(f)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,o){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var s in this)typeof this[s]!="function"&&(a[s]=this[s]);return a}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(a,s){return new i().loadAsync(a,s)},i.external=e("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,o){var i=e("./utils"),a=e("./external"),s=e("./utf8"),l=e("./zipEntries"),u=e("./stream/Crc32Probe"),c=e("./nodejsUtils");function g(f){return new a.Promise(function(d,y){var h=f.decompressed.getContentWorker().pipe(new u);h.on("error",function(v){y(v)}).on("end",function(){h.streamInfo.crc32!==f.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}r.exports=function(f,d){var y=this;return d=i.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),c.isNode&&c.isStream(f)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",f,!0,d.optimizedBinaryString,d.base64).then(function(h){var v=new l(d);return v.load(h),v}).then(function(h){var v=[a.Promise.resolve(h)],b=h.files;if(d.checkCRC32)for(var w=0;w<b.length;w++)v.push(g(b[w]));return a.Promise.all(v)}).then(function(h){for(var v=h.shift(),b=v.files,w=0;w<b.length;w++){var k=b[w],x=k.fileNameStr,S=i.resolve(k.fileNameStr);y.file(S,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:d.createFolders}),k.dir||(y.file(S).unsafeOriginalName=x)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,o){var i=e("../utils"),a=e("../stream/GenericWorker");function s(l,u){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}i.inherits(s,a),s.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,o){var i=e("readable-stream").Readable;function a(s,l,u){i.call(this,l),this._helper=s;var c=this;s.on("data",function(g,f){c.push(g)||c._helper.pause(),u&&u(f)}).on("error",function(g){c.emit("error",g)}).on("end",function(){c.push(null)})}e("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,r,o){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,a)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var a=new Buffer(i);return a.fill(0),a},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(e,r,o){function i(S,A,I){var N,z=s.getTypeOf(A),j=s.extend(I||{},c);j.date=j.date||new Date,j.compression!==null&&(j.compression=j.compression.toUpperCase()),typeof j.unixPermissions=="string"&&(j.unixPermissions=parseInt(j.unixPermissions,8)),j.unixPermissions&&16384&j.unixPermissions&&(j.dir=!0),j.dosPermissions&&16&j.dosPermissions&&(j.dir=!0),j.dir&&(S=b(S)),j.createFolders&&(N=v(S))&&w.call(this,N,!0);var P=z==="string"&&j.binary===!1&&j.base64===!1;I&&I.binary!==void 0||(j.binary=!P),(A instanceof g&&A.uncompressedSize===0||j.dir||!A||A.length===0)&&(j.base64=!1,j.binary=!0,A="",j.compression="STORE",z="string");var _=null;_=A instanceof g||A instanceof l?A:y.isNode&&y.isStream(A)?new h(S,A):s.prepareContent(S,A,j.binary,j.optimizedBinaryString,j.base64);var C=new f(S,_,j);this.files[S]=C}var a=e("./utf8"),s=e("./utils"),l=e("./stream/GenericWorker"),u=e("./stream/StreamHelper"),c=e("./defaults"),g=e("./compressedObject"),f=e("./zipObject"),d=e("./generate"),y=e("./nodejsUtils"),h=e("./nodejs/NodejsStreamInputAdapter"),v=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var A=S.lastIndexOf("/");return 0<A?S.substring(0,A):""},b=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},w=function(S,A){return A=A!==void 0?A:c.createFolders,S=b(S),this.files[S]||i.call(this,S,null,{dir:!0,createFolders:A}),this.files[S]};function k(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var A,I,N;for(A in this.files)N=this.files[A],(I=A.slice(this.root.length,A.length))&&A.slice(0,this.root.length)===this.root&&S(I,N)},filter:function(S){var A=[];return this.forEach(function(I,N){S(I,N)&&A.push(N)}),A},file:function(S,A,I){if(arguments.length!==1)return S=this.root+S,i.call(this,S,A,I),this;if(k(S)){var N=S;return this.filter(function(j,P){return!P.dir&&N.test(j)})}var z=this.files[this.root+S];return z&&!z.dir?z:null},folder:function(S){if(!S)return this;if(k(S))return this.filter(function(z,j){return j.dir&&S.test(z)});var A=this.root+S,I=w.call(this,A),N=this.clone();return N.root=I.name,N},remove:function(S){S=this.root+S;var A=this.files[S];if(A||(S.slice(-1)!=="/"&&(S+="/"),A=this.files[S]),A&&!A.dir)delete this.files[S];else for(var I=this.filter(function(z,j){return j.name.slice(0,S.length)===S}),N=0;N<I.length;N++)delete this.files[I[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var A,I={};try{if((I=s.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");s.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var N=I.comment||this.comment||"";A=d.generateWorker(this,I,N)}catch(z){(A=new l("error")).error(z)}return new u(A,I.type||"string",I.mimeType)},generateAsync:function(S,A){return this.generateInternalStream(S).accumulate(A)},generateNodeStream:function(S,A){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(A)}};r.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,o){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,o){var i=e("./DataReader");function a(s){i.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}e("../utils").inherits(a,i),a.prototype.byteAt=function(s){return this.data[this.zero+s]},a.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),u=s.charCodeAt(1),c=s.charCodeAt(2),g=s.charCodeAt(3),f=this.length-4;0<=f;--f)if(this.data[f]===l&&this.data[f+1]===u&&this.data[f+2]===c&&this.data[f+3]===g)return f-this.zero;return-1},a.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),u=s.charCodeAt(1),c=s.charCodeAt(2),g=s.charCodeAt(3),f=this.readData(4);return l===f[0]&&u===f[1]&&c===f[2]&&g===f[3]},a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,r,o){var i=e("../utils");function a(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var l,u=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=s,u},readString:function(s){return i.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},r.exports=a},{"../utils":32}],19:[function(e,r,o){var i=e("./Uint8ArrayReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,o){var i=e("./DataReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},a.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},a.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,r,o){var i=e("./ArrayReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,o){var i=e("../utils"),a=e("../support"),s=e("./ArrayReader"),l=e("./StringReader"),u=e("./NodeBufferReader"),c=e("./Uint8ArrayReader");r.exports=function(g){var f=i.getTypeOf(g);return i.checkSupport(f),f!=="string"||a.uint8array?f==="nodebuffer"?new u(g):a.uint8array?new c(i.transformTo("uint8array",g)):new s(i.transformTo("array",g)):new l(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,o){var i=e("./GenericWorker"),a=e("../utils");function s(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(s,i),s.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,o){var i=e("./GenericWorker"),a=e("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,i),s.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,o){var i=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(s,a),s.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,o){var i=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){u.dataIsReady=!0,u.data=c,u.max=c&&c.length||0,u.type=i.getTypeOf(c),u.isPaused||u._tickAndRepeat()},function(c){u.error(c)})}i.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,o){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,s){return this._listeners[a].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,s){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,s)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var s=this;return a.on("data",function(l){s.processChunk(l)}),a.on("end",function(){s.end()}),a.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,s){return this.extraStreamInfo[a]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(e,r,o){var i=e("../utils"),a=e("./ConvertWorker"),s=e("./GenericWorker"),l=e("../base64"),u=e("../support"),c=e("../external"),g=null;if(u.nodestream)try{g=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function f(y,h){return new c.Promise(function(v,b){var w=[],k=y._internalType,x=y._outputType,S=y._mimeType;y.on("data",function(A,I){w.push(A),h&&h(I)}).on("error",function(A){w=[],b(A)}).on("end",function(){try{var A=function(I,N,z){switch(I){case"blob":return i.newBlob(i.transformTo("arraybuffer",N),z);case"base64":return l.encode(N);default:return i.transformTo(I,N)}}(x,function(I,N){var z,j=0,P=null,_=0;for(z=0;z<N.length;z++)_+=N[z].length;switch(I){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(P=new Uint8Array(_),z=0;z<N.length;z++)P.set(N[z],j),j+=N[z].length;return P;case"nodebuffer":return Buffer.concat(N);default:throw new Error("concat : unsupported type '"+I+"'")}}(k,w),S);v(A)}catch(I){b(I)}w=[]}).resume()})}function d(y,h,v){var b=h;switch(h){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=h,this._mimeType=v,i.checkSupport(b),this._worker=y.pipe(new a(b)),y.lock()}catch(w){this._worker=new s("error"),this._worker.error(w)}}d.prototype={accumulate:function(y){return f(this,y)},on:function(y,h){var v=this;return y==="data"?this._worker.on(y,function(b){h.call(v,b.data,b.meta)}):this._worker.on(y,function(){i.delay(h,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var i=new ArrayBuffer(0);try{o.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),o.blob=a.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!e("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,o){for(var i=e("./utils"),a=e("./support"),s=e("./nodejsUtils"),l=e("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;u[254]=u[254]=1;function g(){l.call(this,"utf-8 decode"),this.leftOver=null}function f(){l.call(this,"utf-8 encode")}o.utf8encode=function(d){return a.nodebuffer?s.newBufferFrom(d,"utf-8"):function(y){var h,v,b,w,k,x=y.length,S=0;for(w=0;w<x;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<x&&(64512&(b=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),w++),S+=v<128?1:v<2048?2:v<65536?3:4;for(h=a.uint8array?new Uint8Array(S):new Array(S),w=k=0;k<S;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<x&&(64512&(b=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),w++),v<128?h[k++]=v:(v<2048?h[k++]=192|v>>>6:(v<65536?h[k++]=224|v>>>12:(h[k++]=240|v>>>18,h[k++]=128|v>>>12&63),h[k++]=128|v>>>6&63),h[k++]=128|63&v);return h}(d)},o.utf8decode=function(d){return a.nodebuffer?i.transformTo("nodebuffer",d).toString("utf-8"):function(y){var h,v,b,w,k=y.length,x=new Array(2*k);for(h=v=0;h<k;)if((b=y[h++])<128)x[v++]=b;else if(4<(w=u[b]))x[v++]=65533,h+=w-1;else{for(b&=w===2?31:w===3?15:7;1<w&&h<k;)b=b<<6|63&y[h++],w--;1<w?x[v++]=65533:b<65536?x[v++]=b:(b-=65536,x[v++]=55296|b>>10&1023,x[v++]=56320|1023&b)}return x.length!==v&&(x.subarray?x=x.subarray(0,v):x.length=v),i.applyFromCharCode(x)}(d=i.transformTo(a.uint8array?"uint8array":"array",d))},i.inherits(g,l),g.prototype.processChunk=function(d){var y=i.transformTo(a.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var h=y;(y=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),y.set(h,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(w,k){var x;for((k=k||w.length)>w.length&&(k=w.length),x=k-1;0<=x&&(192&w[x])==128;)x--;return x<0||x===0?k:x+u[w[x]]>k?x:k}(y),b=y;v!==y.length&&(a.uint8array?(b=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(b=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:o.utf8decode(b),meta:d.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=g,i.inherits(f,l),f.prototype.processChunk=function(d){this.push({data:o.utf8encode(d.data),meta:d.meta})},o.Utf8EncodeWorker=f},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,o){var i=e("./support"),a=e("./base64"),s=e("./nodejsUtils"),l=e("./external");function u(h){return h}function c(h,v){for(var b=0;b<h.length;++b)v[b]=255&h.charCodeAt(b);return v}e("setimmediate"),o.newBlob=function(h,v){o.checkSupport("blob");try{return new Blob([h],{type:v})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(h),b.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(h,v,b){var w=[],k=0,x=h.length;if(x<=b)return String.fromCharCode.apply(null,h);for(;k<x;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,h.slice(k,Math.min(k+b,x)))):w.push(String.fromCharCode.apply(null,h.subarray(k,Math.min(k+b,x)))),k+=b;return w.join("")},stringifyByChar:function(h){for(var v="",b=0;b<h.length;b++)v+=String.fromCharCode(h[b]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function f(h){var v=65536,b=o.getTypeOf(h),w=!0;if(b==="uint8array"?w=g.applyCanBeUsed.uint8array:b==="nodebuffer"&&(w=g.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return g.stringifyByChunk(h,b,v)}catch{v=Math.floor(v/2)}return g.stringifyByChar(h)}function d(h,v){for(var b=0;b<h.length;b++)v[b]=h[b];return v}o.applyFromCharCode=f;var y={};y.string={string:u,array:function(h){return c(h,new Array(h.length))},arraybuffer:function(h){return y.string.uint8array(h).buffer},uint8array:function(h){return c(h,new Uint8Array(h.length))},nodebuffer:function(h){return c(h,s.allocBuffer(h.length))}},y.array={string:f,array:u,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return s.newBufferFrom(h)}},y.arraybuffer={string:function(h){return f(new Uint8Array(h))},array:function(h){return d(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:u,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return s.newBufferFrom(new Uint8Array(h))}},y.uint8array={string:f,array:function(h){return d(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:u,nodebuffer:function(h){return s.newBufferFrom(h)}},y.nodebuffer={string:f,array:function(h){return d(h,new Array(h.length))},arraybuffer:function(h){return y.nodebuffer.uint8array(h).buffer},uint8array:function(h){return d(h,new Uint8Array(h.length))},nodebuffer:u},o.transformTo=function(h,v){if(v=v||"",!h)return v;o.checkSupport(h);var b=o.getTypeOf(v);return y[b][h](v)},o.resolve=function(h){for(var v=h.split("/"),b=[],w=0;w<v.length;w++){var k=v[w];k==="."||k===""&&w!==0&&w!==v.length-1||(k===".."?b.pop():b.push(k))}return b.join("/")},o.getTypeOf=function(h){return typeof h=="string"?"string":Object.prototype.toString.call(h)==="[object Array]"?"array":i.nodebuffer&&s.isBuffer(h)?"nodebuffer":i.uint8array&&h instanceof Uint8Array?"uint8array":i.arraybuffer&&h instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(h){if(!i[h.toLowerCase()])throw new Error(h+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(h){var v,b,w="";for(b=0;b<(h||"").length;b++)w+="\\x"+((v=h.charCodeAt(b))<16?"0":"")+v.toString(16).toUpperCase();return w},o.delay=function(h,v,b){setImmediate(function(){h.apply(b||null,v||[])})},o.inherits=function(h,v){function b(){}b.prototype=v.prototype,h.prototype=new b},o.extend=function(){var h,v,b={};for(h=0;h<arguments.length;h++)for(v in arguments[h])Object.prototype.hasOwnProperty.call(arguments[h],v)&&b[v]===void 0&&(b[v]=arguments[h][v]);return b},o.prepareContent=function(h,v,b,w,k){return l.Promise.resolve(v).then(function(x){return i.blob&&(x instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x))!==-1)&&typeof FileReader<"u"?new l.Promise(function(S,A){var I=new FileReader;I.onload=function(N){S(N.target.result)},I.onerror=function(N){A(N.target.error)},I.readAsArrayBuffer(x)}):x}).then(function(x){var S=o.getTypeOf(x);return S?(S==="arraybuffer"?x=o.transformTo("uint8array",x):S==="string"&&(k?x=a.decode(x):b&&w!==!0&&(x=function(A){return c(A,i.uint8array?new Uint8Array(A.length):new Array(A.length))}(x))),x):l.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,o){var i=e("./reader/readerFor"),a=e("./utils"),s=e("./signature"),l=e("./zipEntry"),u=e("./support");function c(g){this.files=[],this.loadOptions=g}c.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var f=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(f)+", expected "+a.pretty(g)+")")}},isSignature:function(g,f){var d=this.reader.index;this.reader.setIndex(g);var y=this.reader.readString(4)===f;return this.reader.setIndex(d),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),f=u.uint8array?"uint8array":"array",d=a.transformTo(f,g);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,f,d,y=this.zip64EndOfCentralSize-44;0<y;)g=this.reader.readInt(2),f=this.reader.readInt(4),d=this.reader.readData(f),this.zip64ExtensibleData[g]={id:g,length:f,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,f;for(g=0;g<this.files.length;g++)f=this.files[g],this.reader.setIndex(f.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),f.readLocalPart(this.reader),f.handleUTF8(),f.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(g=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var f=g;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var y=f-d;if(0<y)this.isSignature(f,s.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(g){this.reader=i(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,o){var i=e("./reader/readerFor"),a=e("./utils"),s=e("./compressedObject"),l=e("./crc32"),u=e("./utf8"),c=e("./compressions"),g=e("./support");function f(d,y){this.options=d,this.loadOptions=y}f.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var y,h;if(d.skip(22),this.fileNameLength=d.readInt(2),h=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var b in c)if(Object.prototype.hasOwnProperty.call(c,b)&&c[b].magic===v)return c[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,y,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var y=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(y),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var y,h,v,b=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<b;)y=d.readInt(2),h=d.readInt(2),v=d.readData(h),this.extraFields[y]={id:y,length:h,value:v};d.setIndex(b)},handleUTF8:function(){var d=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var h=a.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var b=a.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var y=i(d.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:u.utf8decode(y.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var y=i(d.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:u.utf8decode(y.readData(d.length-5))}return null}},r.exports=f},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,o){function i(y,h,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=h,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),l=e("./utf8"),u=e("./compressedObject"),c=e("./stream/GenericWorker");i.prototype={internalStream:function(y){var h=null,v="string";try{if(!y)throw new Error("No output type specified.");var b=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),h=this._decompressWorker();var w=!this._dataBinary;w&&!b&&(h=h.pipe(new l.Utf8EncodeWorker)),!w&&b&&(h=h.pipe(new l.Utf8DecodeWorker))}catch(k){(h=new c("error")).error(k)}return new a(h,v,"")},async:function(y,h){return this.internalStream(y).accumulate(h)},nodeStream:function(y,h){return this.internalStream(y||"nodebuffer").toNodejsStream(h)},_compressWorker:function(y,h){if(this._data instanceof u&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(v,y,h)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof c?this._data:new s(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],f=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<g.length;d++)i.prototype[g[d]]=f;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,o){(function(i){var a,s,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var u=0,c=new l(y),g=i.document.createTextNode("");c.observe(g,{characterData:!0}),a=function(){g.data=u=++u%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var h=i.document.createElement("script");h.onreadystatechange=function(){y(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},i.document.documentElement.appendChild(h)}:function(){setTimeout(y,0)};else{var f=new i.MessageChannel;f.port1.onmessage=y,a=function(){f.port2.postMessage(0)}}var d=[];function y(){var h,v;s=!0;for(var b=d.length;b;){for(v=d,d=[],h=-1;++h<b;)v[h]();b=d.length}s=!1}r.exports=function(h){d.push(h)!==1||s||a()}}).call(this,typeof We<"u"?We:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,o){var i=e("immediate");function a(){}var s={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];function g(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,b!==a&&h(this,b)}function f(b,w,k){this.promise=b,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function d(b,w,k){i(function(){var x;try{x=w(k)}catch(S){return s.reject(b,S)}x===b?s.reject(b,new TypeError("Cannot resolve promise with itself")):s.resolve(b,x)})}function y(b){var w=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof w=="function")return function(){w.apply(b,arguments)}}function h(b,w){var k=!1;function x(I){k||(k=!0,s.reject(b,I))}function S(I){k||(k=!0,s.resolve(b,I))}var A=v(function(){w(S,x)});A.status==="error"&&x(A.value)}function v(b,w){var k={};try{k.value=b(w),k.status="success"}catch(x){k.status="error",k.value=x}return k}(r.exports=g).prototype.finally=function(b){if(typeof b!="function")return this;var w=this.constructor;return this.then(function(k){return w.resolve(b()).then(function(){return k})},function(k){return w.resolve(b()).then(function(){throw k})})},g.prototype.catch=function(b){return this.then(null,b)},g.prototype.then=function(b,w){if(typeof b!="function"&&this.state===u||typeof w!="function"&&this.state===l)return this;var k=new this.constructor(a);return this.state!==c?d(k,this.state===u?b:w,this.outcome):this.queue.push(new f(k,b,w)),k},f.prototype.callFulfilled=function(b){s.resolve(this.promise,b)},f.prototype.otherCallFulfilled=function(b){d(this.promise,this.onFulfilled,b)},f.prototype.callRejected=function(b){s.reject(this.promise,b)},f.prototype.otherCallRejected=function(b){d(this.promise,this.onRejected,b)},s.resolve=function(b,w){var k=v(y,w);if(k.status==="error")return s.reject(b,k.value);var x=k.value;if(x)h(b,x);else{b.state=u,b.outcome=w;for(var S=-1,A=b.queue.length;++S<A;)b.queue[S].callFulfilled(w)}return b},s.reject=function(b,w){b.state=l,b.outcome=w;for(var k=-1,x=b.queue.length;++k<x;)b.queue[k].callRejected(w);return b},g.resolve=function(b){return b instanceof this?b:s.resolve(new this(a),b)},g.reject=function(b){var w=new this(a);return s.reject(w,b)},g.all=function(b){var w=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=b.length,x=!1;if(!k)return this.resolve([]);for(var S=new Array(k),A=0,I=-1,N=new this(a);++I<k;)z(b[I],I);return N;function z(j,P){w.resolve(j).then(function(_){S[P]=_,++A!==k||x||(x=!0,s.resolve(N,S))},function(_){x||(x=!0,s.reject(N,_))})}},g.race=function(b){var w=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=b.length,x=!1;if(!k)return this.resolve([]);for(var S=-1,A=new this(a);++S<k;)I=b[S],w.resolve(I).then(function(N){x||(x=!0,s.resolve(A,N))},function(N){x||(x=!0,s.reject(A,N))});var I;return A}},{immediate:36}],38:[function(e,r,o){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,o){var i=e("./zlib/deflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/messages"),u=e("./zlib/zstream"),c=Object.prototype.toString,g=0,f=-1,d=0,y=8;function h(b){if(!(this instanceof h))return new h(b);this.options=a.assign({level:f,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},b||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var k=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(k!==g)throw new Error(l[k]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var x;if(x=typeof w.dictionary=="string"?s.string2buf(w.dictionary):c.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(k=i.deflateSetDictionary(this.strm,x))!==g)throw new Error(l[k]);this._dict_set=!0}}function v(b,w){var k=new h(w);if(k.push(b,!0),k.err)throw k.msg||l[k.err];return k.result}h.prototype.push=function(b,w){var k,x,S=this.strm,A=this.options.chunkSize;if(this.ended)return!1;x=w===~~w?w:w===!0?4:0,typeof b=="string"?S.input=s.string2buf(b):c.call(b)==="[object ArrayBuffer]"?S.input=new Uint8Array(b):S.input=b,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new a.Buf8(A),S.next_out=0,S.avail_out=A),(k=i.deflate(S,x))!==1&&k!==g)return this.onEnd(k),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||x!==4&&x!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(a.shrinkBuf(S.output,S.next_out))):this.onData(a.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&k!==1);return x===4?(k=i.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===g):x!==2||(this.onEnd(g),!(S.avail_out=0))},h.prototype.onData=function(b){this.chunks.push(b)},h.prototype.onEnd=function(b){b===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},o.Deflate=h,o.deflate=v,o.deflateRaw=function(b,w){return(w=w||{}).raw=!0,v(b,w)},o.gzip=function(b,w){return(w=w||{}).gzip=!0,v(b,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,o){var i=e("./zlib/inflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/constants"),u=e("./zlib/messages"),c=e("./zlib/zstream"),g=e("./zlib/gzheader"),f=Object.prototype.toString;function d(h){if(!(this instanceof d))return new d(h);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},h||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||h&&h.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var b=i.inflateInit2(this.strm,v.windowBits);if(b!==l.Z_OK)throw new Error(u[b]);this.header=new g,i.inflateGetHeader(this.strm,this.header)}function y(h,v){var b=new d(v);if(b.push(h,!0),b.err)throw b.msg||u[b.err];return b.result}d.prototype.push=function(h,v){var b,w,k,x,S,A,I=this.strm,N=this.options.chunkSize,z=this.options.dictionary,j=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof h=="string"?I.input=s.binstring2buf(h):f.call(h)==="[object ArrayBuffer]"?I.input=new Uint8Array(h):I.input=h,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new a.Buf8(N),I.next_out=0,I.avail_out=N),(b=i.inflate(I,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&z&&(A=typeof z=="string"?s.string2buf(z):f.call(z)==="[object ArrayBuffer]"?new Uint8Array(z):z,b=i.inflateSetDictionary(this.strm,A)),b===l.Z_BUF_ERROR&&j===!0&&(b=l.Z_OK,j=!1),b!==l.Z_STREAM_END&&b!==l.Z_OK)return this.onEnd(b),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&b!==l.Z_STREAM_END&&(I.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=s.utf8border(I.output,I.next_out),x=I.next_out-k,S=s.buf2string(I.output,k),I.next_out=x,I.avail_out=N-x,x&&a.arraySet(I.output,I.output,k,x,0),this.onData(S)):this.onData(a.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(j=!0)}while((0<I.avail_in||I.avail_out===0)&&b!==l.Z_STREAM_END);return b===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(b=i.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(I.avail_out=0))},d.prototype.onData=function(h){this.chunks.push(h)},d.prototype.onEnd=function(h){h===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},o.Inflate=d,o.inflate=y,o.inflateRaw=function(h,v){return(v=v||{}).raw=!0,y(h,v)},o.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var g in c)c.hasOwnProperty(g)&&(l[g]=c[g])}}return l},o.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var a={arraySet:function(l,u,c,g,f){if(u.subarray&&l.subarray)l.set(u.subarray(c,c+g),f);else for(var d=0;d<g;d++)l[f+d]=u[c+d]},flattenChunks:function(l){var u,c,g,f,d,y;for(u=g=0,c=l.length;u<c;u++)g+=l[u].length;for(y=new Uint8Array(g),u=f=0,c=l.length;u<c;u++)d=l[u],y.set(d,f),f+=d.length;return y}},s={arraySet:function(l,u,c,g,f){for(var d=0;d<g;d++)l[f+d]=u[c+d]},flattenChunks:function(l){return[].concat.apply([],l)}};o.setTyped=function(l){l?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,a)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,s))},o.setTyped(i)},{}],42:[function(e,r,o){var i=e("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new i.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function c(g,f){if(f<65537&&(g.subarray&&s||!g.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(g,f));for(var d="",y=0;y<f;y++)d+=String.fromCharCode(g[y]);return d}l[254]=l[254]=1,o.string2buf=function(g){var f,d,y,h,v,b=g.length,w=0;for(h=0;h<b;h++)(64512&(d=g.charCodeAt(h)))==55296&&h+1<b&&(64512&(y=g.charCodeAt(h+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),h++),w+=d<128?1:d<2048?2:d<65536?3:4;for(f=new i.Buf8(w),h=v=0;v<w;h++)(64512&(d=g.charCodeAt(h)))==55296&&h+1<b&&(64512&(y=g.charCodeAt(h+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),h++),d<128?f[v++]=d:(d<2048?f[v++]=192|d>>>6:(d<65536?f[v++]=224|d>>>12:(f[v++]=240|d>>>18,f[v++]=128|d>>>12&63),f[v++]=128|d>>>6&63),f[v++]=128|63&d);return f},o.buf2binstring=function(g){return c(g,g.length)},o.binstring2buf=function(g){for(var f=new i.Buf8(g.length),d=0,y=f.length;d<y;d++)f[d]=g.charCodeAt(d);return f},o.buf2string=function(g,f){var d,y,h,v,b=f||g.length,w=new Array(2*b);for(d=y=0;d<b;)if((h=g[d++])<128)w[y++]=h;else if(4<(v=l[h]))w[y++]=65533,d+=v-1;else{for(h&=v===2?31:v===3?15:7;1<v&&d<b;)h=h<<6|63&g[d++],v--;1<v?w[y++]=65533:h<65536?w[y++]=h:(h-=65536,w[y++]=55296|h>>10&1023,w[y++]=56320|1023&h)}return c(w,y)},o.utf8border=function(g,f){var d;for((f=f||g.length)>g.length&&(f=g.length),d=f-1;0<=d&&(192&g[d])==128;)d--;return d<0||d===0?f:d+l[g[d]]>f?d:f}},{"./common":41}],43:[function(e,r,o){r.exports=function(i,a,s,l){for(var u=65535&i|0,c=i>>>16&65535|0,g=0;s!==0;){for(s-=g=2e3<s?2e3:s;c=c+(u=u+a[l++]|0)|0,--g;);u%=65521,c%=65521}return u|c<<16|0}},{}],44:[function(e,r,o){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,o){var i=function(){for(var a,s=[],l=0;l<256;l++){a=l;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;s[l]=a}return s}();r.exports=function(a,s,l,u){var c=i,g=u+l;a^=-1;for(var f=u;f<g;f++)a=a>>>8^c[255&(a^s[f])];return-1^a}},{}],46:[function(e,r,o){var i,a=e("../utils/common"),s=e("./trees"),l=e("./adler32"),u=e("./crc32"),c=e("./messages"),g=0,f=4,d=0,y=-2,h=-1,v=4,b=2,w=8,k=9,x=286,S=30,A=19,I=2*x+1,N=15,z=3,j=258,P=j+z+1,_=42,C=113,p=1,U=2,nt=3,$=4;function F(m,V){return m.msg=c[V],V}function M(m){return(m<<1)-(4<m?9:0)}function et(m){for(var V=m.length;0<=--V;)m[V]=0}function O(m){var V=m.state,q=V.pending;q>m.avail_out&&(q=m.avail_out),q!==0&&(a.arraySet(m.output,V.pending_buf,V.pending_out,q,m.next_out),m.next_out+=q,V.pending_out+=q,m.total_out+=q,m.avail_out-=q,V.pending-=q,V.pending===0&&(V.pending_out=0))}function B(m,V){s._tr_flush_block(m,0<=m.block_start?m.block_start:-1,m.strstart-m.block_start,V),m.block_start=m.strstart,O(m.strm)}function K(m,V){m.pending_buf[m.pending++]=V}function Z(m,V){m.pending_buf[m.pending++]=V>>>8&255,m.pending_buf[m.pending++]=255&V}function G(m,V){var q,T,R=m.max_chain_length,L=m.strstart,H=m.prev_length,Y=m.nice_match,W=m.strstart>m.w_size-P?m.strstart-(m.w_size-P):0,Q=m.window,ot=m.w_mask,J=m.prev,lt=m.strstart+j,ht=Q[L+H-1],dt=Q[L+H];m.prev_length>=m.good_match&&(R>>=2),Y>m.lookahead&&(Y=m.lookahead);do if(Q[(q=V)+H]===dt&&Q[q+H-1]===ht&&Q[q]===Q[L]&&Q[++q]===Q[L+1]){L+=2,q++;do;while(Q[++L]===Q[++q]&&Q[++L]===Q[++q]&&Q[++L]===Q[++q]&&Q[++L]===Q[++q]&&Q[++L]===Q[++q]&&Q[++L]===Q[++q]&&Q[++L]===Q[++q]&&Q[++L]===Q[++q]&&L<lt);if(T=j-(lt-L),L=lt-j,H<T){if(m.match_start=V,Y<=(H=T))break;ht=Q[L+H-1],dt=Q[L+H]}}while((V=J[V&ot])>W&&--R!=0);return H<=m.lookahead?H:m.lookahead}function ct(m){var V,q,T,R,L,H,Y,W,Q,ot,J=m.w_size;do{if(R=m.window_size-m.lookahead-m.strstart,m.strstart>=J+(J-P)){for(a.arraySet(m.window,m.window,J,J,0),m.match_start-=J,m.strstart-=J,m.block_start-=J,V=q=m.hash_size;T=m.head[--V],m.head[V]=J<=T?T-J:0,--q;);for(V=q=J;T=m.prev[--V],m.prev[V]=J<=T?T-J:0,--q;);R+=J}if(m.strm.avail_in===0)break;if(H=m.strm,Y=m.window,W=m.strstart+m.lookahead,Q=R,ot=void 0,ot=H.avail_in,Q<ot&&(ot=Q),q=ot===0?0:(H.avail_in-=ot,a.arraySet(Y,H.input,H.next_in,ot,W),H.state.wrap===1?H.adler=l(H.adler,Y,ot,W):H.state.wrap===2&&(H.adler=u(H.adler,Y,ot,W)),H.next_in+=ot,H.total_in+=ot,ot),m.lookahead+=q,m.lookahead+m.insert>=z)for(L=m.strstart-m.insert,m.ins_h=m.window[L],m.ins_h=(m.ins_h<<m.hash_shift^m.window[L+1])&m.hash_mask;m.insert&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[L+z-1])&m.hash_mask,m.prev[L&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=L,L++,m.insert--,!(m.lookahead+m.insert<z)););}while(m.lookahead<P&&m.strm.avail_in!==0)}function it(m,V){for(var q,T;;){if(m.lookahead<P){if(ct(m),m.lookahead<P&&V===g)return p;if(m.lookahead===0)break}if(q=0,m.lookahead>=z&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+z-1])&m.hash_mask,q=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),q!==0&&m.strstart-q<=m.w_size-P&&(m.match_length=G(m,q)),m.match_length>=z)if(T=s._tr_tally(m,m.strstart-m.match_start,m.match_length-z),m.lookahead-=m.match_length,m.match_length<=m.max_lazy_match&&m.lookahead>=z){for(m.match_length--;m.strstart++,m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+z-1])&m.hash_mask,q=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart,--m.match_length!=0;);m.strstart++}else m.strstart+=m.match_length,m.match_length=0,m.ins_h=m.window[m.strstart],m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+1])&m.hash_mask;else T=s._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++;if(T&&(B(m,!1),m.strm.avail_out===0))return p}return m.insert=m.strstart<z-1?m.strstart:z-1,V===f?(B(m,!0),m.strm.avail_out===0?nt:$):m.last_lit&&(B(m,!1),m.strm.avail_out===0)?p:U}function tt(m,V){for(var q,T,R;;){if(m.lookahead<P){if(ct(m),m.lookahead<P&&V===g)return p;if(m.lookahead===0)break}if(q=0,m.lookahead>=z&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+z-1])&m.hash_mask,q=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),m.prev_length=m.match_length,m.prev_match=m.match_start,m.match_length=z-1,q!==0&&m.prev_length<m.max_lazy_match&&m.strstart-q<=m.w_size-P&&(m.match_length=G(m,q),m.match_length<=5&&(m.strategy===1||m.match_length===z&&4096<m.strstart-m.match_start)&&(m.match_length=z-1)),m.prev_length>=z&&m.match_length<=m.prev_length){for(R=m.strstart+m.lookahead-z,T=s._tr_tally(m,m.strstart-1-m.prev_match,m.prev_length-z),m.lookahead-=m.prev_length-1,m.prev_length-=2;++m.strstart<=R&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+z-1])&m.hash_mask,q=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),--m.prev_length!=0;);if(m.match_available=0,m.match_length=z-1,m.strstart++,T&&(B(m,!1),m.strm.avail_out===0))return p}else if(m.match_available){if((T=s._tr_tally(m,0,m.window[m.strstart-1]))&&B(m,!1),m.strstart++,m.lookahead--,m.strm.avail_out===0)return p}else m.match_available=1,m.strstart++,m.lookahead--}return m.match_available&&(T=s._tr_tally(m,0,m.window[m.strstart-1]),m.match_available=0),m.insert=m.strstart<z-1?m.strstart:z-1,V===f?(B(m,!0),m.strm.avail_out===0?nt:$):m.last_lit&&(B(m,!1),m.strm.avail_out===0)?p:U}function X(m,V,q,T,R){this.good_length=m,this.max_lazy=V,this.nice_length=q,this.max_chain=T,this.func=R}function rt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*I),this.dyn_dtree=new a.Buf16(2*(2*S+1)),this.bl_tree=new a.Buf16(2*(2*A+1)),et(this.dyn_ltree),et(this.dyn_dtree),et(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(N+1),this.heap=new a.Buf16(2*x+1),et(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*x+1),et(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ut(m){var V;return m&&m.state?(m.total_in=m.total_out=0,m.data_type=b,(V=m.state).pending=0,V.pending_out=0,V.wrap<0&&(V.wrap=-V.wrap),V.status=V.wrap?_:C,m.adler=V.wrap===2?0:1,V.last_flush=g,s._tr_init(V),d):F(m,y)}function mt(m){var V=ut(m);return V===d&&function(q){q.window_size=2*q.w_size,et(q.head),q.max_lazy_match=i[q.level].max_lazy,q.good_match=i[q.level].good_length,q.nice_match=i[q.level].nice_length,q.max_chain_length=i[q.level].max_chain,q.strstart=0,q.block_start=0,q.lookahead=0,q.insert=0,q.match_length=q.prev_length=z-1,q.match_available=0,q.ins_h=0}(m.state),V}function xt(m,V,q,T,R,L){if(!m)return y;var H=1;if(V===h&&(V=6),T<0?(H=0,T=-T):15<T&&(H=2,T-=16),R<1||k<R||q!==w||T<8||15<T||V<0||9<V||L<0||v<L)return F(m,y);T===8&&(T=9);var Y=new rt;return(m.state=Y).strm=m,Y.wrap=H,Y.gzhead=null,Y.w_bits=T,Y.w_size=1<<Y.w_bits,Y.w_mask=Y.w_size-1,Y.hash_bits=R+7,Y.hash_size=1<<Y.hash_bits,Y.hash_mask=Y.hash_size-1,Y.hash_shift=~~((Y.hash_bits+z-1)/z),Y.window=new a.Buf8(2*Y.w_size),Y.head=new a.Buf16(Y.hash_size),Y.prev=new a.Buf16(Y.w_size),Y.lit_bufsize=1<<R+6,Y.pending_buf_size=4*Y.lit_bufsize,Y.pending_buf=new a.Buf8(Y.pending_buf_size),Y.d_buf=1*Y.lit_bufsize,Y.l_buf=3*Y.lit_bufsize,Y.level=V,Y.strategy=L,Y.method=q,mt(m)}i=[new X(0,0,0,0,function(m,V){var q=65535;for(q>m.pending_buf_size-5&&(q=m.pending_buf_size-5);;){if(m.lookahead<=1){if(ct(m),m.lookahead===0&&V===g)return p;if(m.lookahead===0)break}m.strstart+=m.lookahead,m.lookahead=0;var T=m.block_start+q;if((m.strstart===0||m.strstart>=T)&&(m.lookahead=m.strstart-T,m.strstart=T,B(m,!1),m.strm.avail_out===0)||m.strstart-m.block_start>=m.w_size-P&&(B(m,!1),m.strm.avail_out===0))return p}return m.insert=0,V===f?(B(m,!0),m.strm.avail_out===0?nt:$):(m.strstart>m.block_start&&(B(m,!1),m.strm.avail_out),p)}),new X(4,4,8,4,it),new X(4,5,16,8,it),new X(4,6,32,32,it),new X(4,4,16,16,tt),new X(8,16,32,32,tt),new X(8,16,128,128,tt),new X(8,32,128,256,tt),new X(32,128,258,1024,tt),new X(32,258,258,4096,tt)],o.deflateInit=function(m,V){return xt(m,V,w,15,8,0)},o.deflateInit2=xt,o.deflateReset=mt,o.deflateResetKeep=ut,o.deflateSetHeader=function(m,V){return m&&m.state?m.state.wrap!==2?y:(m.state.gzhead=V,d):y},o.deflate=function(m,V){var q,T,R,L;if(!m||!m.state||5<V||V<0)return m?F(m,y):y;if(T=m.state,!m.output||!m.input&&m.avail_in!==0||T.status===666&&V!==f)return F(m,m.avail_out===0?-5:y);if(T.strm=m,q=T.last_flush,T.last_flush=V,T.status===_)if(T.wrap===2)m.adler=0,K(T,31),K(T,139),K(T,8),T.gzhead?(K(T,(T.gzhead.text?1:0)+(T.gzhead.hcrc?2:0)+(T.gzhead.extra?4:0)+(T.gzhead.name?8:0)+(T.gzhead.comment?16:0)),K(T,255&T.gzhead.time),K(T,T.gzhead.time>>8&255),K(T,T.gzhead.time>>16&255),K(T,T.gzhead.time>>24&255),K(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),K(T,255&T.gzhead.os),T.gzhead.extra&&T.gzhead.extra.length&&(K(T,255&T.gzhead.extra.length),K(T,T.gzhead.extra.length>>8&255)),T.gzhead.hcrc&&(m.adler=u(m.adler,T.pending_buf,T.pending,0)),T.gzindex=0,T.status=69):(K(T,0),K(T,0),K(T,0),K(T,0),K(T,0),K(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),K(T,3),T.status=C);else{var H=w+(T.w_bits-8<<4)<<8;H|=(2<=T.strategy||T.level<2?0:T.level<6?1:T.level===6?2:3)<<6,T.strstart!==0&&(H|=32),H+=31-H%31,T.status=C,Z(T,H),T.strstart!==0&&(Z(T,m.adler>>>16),Z(T,65535&m.adler)),m.adler=1}if(T.status===69)if(T.gzhead.extra){for(R=T.pending;T.gzindex<(65535&T.gzhead.extra.length)&&(T.pending!==T.pending_buf_size||(T.gzhead.hcrc&&T.pending>R&&(m.adler=u(m.adler,T.pending_buf,T.pending-R,R)),O(m),R=T.pending,T.pending!==T.pending_buf_size));)K(T,255&T.gzhead.extra[T.gzindex]),T.gzindex++;T.gzhead.hcrc&&T.pending>R&&(m.adler=u(m.adler,T.pending_buf,T.pending-R,R)),T.gzindex===T.gzhead.extra.length&&(T.gzindex=0,T.status=73)}else T.status=73;if(T.status===73)if(T.gzhead.name){R=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>R&&(m.adler=u(m.adler,T.pending_buf,T.pending-R,R)),O(m),R=T.pending,T.pending===T.pending_buf_size)){L=1;break}L=T.gzindex<T.gzhead.name.length?255&T.gzhead.name.charCodeAt(T.gzindex++):0,K(T,L)}while(L!==0);T.gzhead.hcrc&&T.pending>R&&(m.adler=u(m.adler,T.pending_buf,T.pending-R,R)),L===0&&(T.gzindex=0,T.status=91)}else T.status=91;if(T.status===91)if(T.gzhead.comment){R=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>R&&(m.adler=u(m.adler,T.pending_buf,T.pending-R,R)),O(m),R=T.pending,T.pending===T.pending_buf_size)){L=1;break}L=T.gzindex<T.gzhead.comment.length?255&T.gzhead.comment.charCodeAt(T.gzindex++):0,K(T,L)}while(L!==0);T.gzhead.hcrc&&T.pending>R&&(m.adler=u(m.adler,T.pending_buf,T.pending-R,R)),L===0&&(T.status=103)}else T.status=103;if(T.status===103&&(T.gzhead.hcrc?(T.pending+2>T.pending_buf_size&&O(m),T.pending+2<=T.pending_buf_size&&(K(T,255&m.adler),K(T,m.adler>>8&255),m.adler=0,T.status=C)):T.status=C),T.pending!==0){if(O(m),m.avail_out===0)return T.last_flush=-1,d}else if(m.avail_in===0&&M(V)<=M(q)&&V!==f)return F(m,-5);if(T.status===666&&m.avail_in!==0)return F(m,-5);if(m.avail_in!==0||T.lookahead!==0||V!==g&&T.status!==666){var Y=T.strategy===2?function(W,Q){for(var ot;;){if(W.lookahead===0&&(ct(W),W.lookahead===0)){if(Q===g)return p;break}if(W.match_length=0,ot=s._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++,ot&&(B(W,!1),W.strm.avail_out===0))return p}return W.insert=0,Q===f?(B(W,!0),W.strm.avail_out===0?nt:$):W.last_lit&&(B(W,!1),W.strm.avail_out===0)?p:U}(T,V):T.strategy===3?function(W,Q){for(var ot,J,lt,ht,dt=W.window;;){if(W.lookahead<=j){if(ct(W),W.lookahead<=j&&Q===g)return p;if(W.lookahead===0)break}if(W.match_length=0,W.lookahead>=z&&0<W.strstart&&(J=dt[lt=W.strstart-1])===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]){ht=W.strstart+j;do;while(J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&lt<ht);W.match_length=j-(ht-lt),W.match_length>W.lookahead&&(W.match_length=W.lookahead)}if(W.match_length>=z?(ot=s._tr_tally(W,1,W.match_length-z),W.lookahead-=W.match_length,W.strstart+=W.match_length,W.match_length=0):(ot=s._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++),ot&&(B(W,!1),W.strm.avail_out===0))return p}return W.insert=0,Q===f?(B(W,!0),W.strm.avail_out===0?nt:$):W.last_lit&&(B(W,!1),W.strm.avail_out===0)?p:U}(T,V):i[T.level].func(T,V);if(Y!==nt&&Y!==$||(T.status=666),Y===p||Y===nt)return m.avail_out===0&&(T.last_flush=-1),d;if(Y===U&&(V===1?s._tr_align(T):V!==5&&(s._tr_stored_block(T,0,0,!1),V===3&&(et(T.head),T.lookahead===0&&(T.strstart=0,T.block_start=0,T.insert=0))),O(m),m.avail_out===0))return T.last_flush=-1,d}return V!==f?d:T.wrap<=0?1:(T.wrap===2?(K(T,255&m.adler),K(T,m.adler>>8&255),K(T,m.adler>>16&255),K(T,m.adler>>24&255),K(T,255&m.total_in),K(T,m.total_in>>8&255),K(T,m.total_in>>16&255),K(T,m.total_in>>24&255)):(Z(T,m.adler>>>16),Z(T,65535&m.adler)),O(m),0<T.wrap&&(T.wrap=-T.wrap),T.pending!==0?d:1)},o.deflateEnd=function(m){var V;return m&&m.state?(V=m.state.status)!==_&&V!==69&&V!==73&&V!==91&&V!==103&&V!==C&&V!==666?F(m,y):(m.state=null,V===C?F(m,-3):d):y},o.deflateSetDictionary=function(m,V){var q,T,R,L,H,Y,W,Q,ot=V.length;if(!m||!m.state||(L=(q=m.state).wrap)===2||L===1&&q.status!==_||q.lookahead)return y;for(L===1&&(m.adler=l(m.adler,V,ot,0)),q.wrap=0,ot>=q.w_size&&(L===0&&(et(q.head),q.strstart=0,q.block_start=0,q.insert=0),Q=new a.Buf8(q.w_size),a.arraySet(Q,V,ot-q.w_size,q.w_size,0),V=Q,ot=q.w_size),H=m.avail_in,Y=m.next_in,W=m.input,m.avail_in=ot,m.next_in=0,m.input=V,ct(q);q.lookahead>=z;){for(T=q.strstart,R=q.lookahead-(z-1);q.ins_h=(q.ins_h<<q.hash_shift^q.window[T+z-1])&q.hash_mask,q.prev[T&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=T,T++,--R;);q.strstart=T,q.lookahead=z-1,ct(q)}return q.strstart+=q.lookahead,q.block_start=q.strstart,q.insert=q.lookahead,q.lookahead=0,q.match_length=q.prev_length=z-1,q.match_available=0,m.next_in=Y,m.input=W,m.avail_in=H,q.wrap=L,d},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,o){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,o){r.exports=function(i,a){var s,l,u,c,g,f,d,y,h,v,b,w,k,x,S,A,I,N,z,j,P,_,C,p,U;s=i.state,l=i.next_in,p=i.input,u=l+(i.avail_in-5),c=i.next_out,U=i.output,g=c-(a-i.avail_out),f=c+(i.avail_out-257),d=s.dmax,y=s.wsize,h=s.whave,v=s.wnext,b=s.window,w=s.hold,k=s.bits,x=s.lencode,S=s.distcode,A=(1<<s.lenbits)-1,I=(1<<s.distbits)-1;t:do{k<15&&(w+=p[l++]<<k,k+=8,w+=p[l++]<<k,k+=8),N=x[w&A];e:for(;;){if(w>>>=z=N>>>24,k-=z,(z=N>>>16&255)===0)U[c++]=65535&N;else{if(!(16&z)){if((64&z)==0){N=x[(65535&N)+(w&(1<<z)-1)];continue e}if(32&z){s.mode=12;break t}i.msg="invalid literal/length code",s.mode=30;break t}j=65535&N,(z&=15)&&(k<z&&(w+=p[l++]<<k,k+=8),j+=w&(1<<z)-1,w>>>=z,k-=z),k<15&&(w+=p[l++]<<k,k+=8,w+=p[l++]<<k,k+=8),N=S[w&I];n:for(;;){if(w>>>=z=N>>>24,k-=z,!(16&(z=N>>>16&255))){if((64&z)==0){N=S[(65535&N)+(w&(1<<z)-1)];continue n}i.msg="invalid distance code",s.mode=30;break t}if(P=65535&N,k<(z&=15)&&(w+=p[l++]<<k,(k+=8)<z&&(w+=p[l++]<<k,k+=8)),d<(P+=w&(1<<z)-1)){i.msg="invalid distance too far back",s.mode=30;break t}if(w>>>=z,k-=z,(z=c-g)<P){if(h<(z=P-z)&&s.sane){i.msg="invalid distance too far back",s.mode=30;break t}if(C=b,(_=0)===v){if(_+=y-z,z<j){for(j-=z;U[c++]=b[_++],--z;);_=c-P,C=U}}else if(v<z){if(_+=y+v-z,(z-=v)<j){for(j-=z;U[c++]=b[_++],--z;);if(_=0,v<j){for(j-=z=v;U[c++]=b[_++],--z;);_=c-P,C=U}}}else if(_+=v-z,z<j){for(j-=z;U[c++]=b[_++],--z;);_=c-P,C=U}for(;2<j;)U[c++]=C[_++],U[c++]=C[_++],U[c++]=C[_++],j-=3;j&&(U[c++]=C[_++],1<j&&(U[c++]=C[_++]))}else{for(_=c-P;U[c++]=U[_++],U[c++]=U[_++],U[c++]=U[_++],2<(j-=3););j&&(U[c++]=U[_++],1<j&&(U[c++]=U[_++]))}break}}break}}while(l<u&&c<f);l-=j=k>>3,w&=(1<<(k-=j<<3))-1,i.next_in=l,i.next_out=c,i.avail_in=l<u?u-l+5:5-(l-u),i.avail_out=c<f?f-c+257:257-(c-f),s.hold=w,s.bits=k}},{}],49:[function(e,r,o){var i=e("../utils/common"),a=e("./adler32"),s=e("./crc32"),l=e("./inffast"),u=e("./inftrees"),c=1,g=2,f=0,d=-2,y=1,h=852,v=592;function b(_){return(_>>>24&255)+(_>>>8&65280)+((65280&_)<<8)+((255&_)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(_){var C;return _&&_.state?(C=_.state,_.total_in=_.total_out=C.total=0,_.msg="",C.wrap&&(_.adler=1&C.wrap),C.mode=y,C.last=0,C.havedict=0,C.dmax=32768,C.head=null,C.hold=0,C.bits=0,C.lencode=C.lendyn=new i.Buf32(h),C.distcode=C.distdyn=new i.Buf32(v),C.sane=1,C.back=-1,f):d}function x(_){var C;return _&&_.state?((C=_.state).wsize=0,C.whave=0,C.wnext=0,k(_)):d}function S(_,C){var p,U;return _&&_.state?(U=_.state,C<0?(p=0,C=-C):(p=1+(C>>4),C<48&&(C&=15)),C&&(C<8||15<C)?d:(U.window!==null&&U.wbits!==C&&(U.window=null),U.wrap=p,U.wbits=C,x(_))):d}function A(_,C){var p,U;return _?(U=new w,(_.state=U).window=null,(p=S(_,C))!==f&&(_.state=null),p):d}var I,N,z=!0;function j(_){if(z){var C;for(I=new i.Buf32(512),N=new i.Buf32(32),C=0;C<144;)_.lens[C++]=8;for(;C<256;)_.lens[C++]=9;for(;C<280;)_.lens[C++]=7;for(;C<288;)_.lens[C++]=8;for(u(c,_.lens,0,288,I,0,_.work,{bits:9}),C=0;C<32;)_.lens[C++]=5;u(g,_.lens,0,32,N,0,_.work,{bits:5}),z=!1}_.lencode=I,_.lenbits=9,_.distcode=N,_.distbits=5}function P(_,C,p,U){var nt,$=_.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new i.Buf8($.wsize)),U>=$.wsize?(i.arraySet($.window,C,p-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(U<(nt=$.wsize-$.wnext)&&(nt=U),i.arraySet($.window,C,p-U,nt,$.wnext),(U-=nt)?(i.arraySet($.window,C,p-U,U,0),$.wnext=U,$.whave=$.wsize):($.wnext+=nt,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=nt))),0}o.inflateReset=x,o.inflateReset2=S,o.inflateResetKeep=k,o.inflateInit=function(_){return A(_,15)},o.inflateInit2=A,o.inflate=function(_,C){var p,U,nt,$,F,M,et,O,B,K,Z,G,ct,it,tt,X,rt,ut,mt,xt,m,V,q,T,R=0,L=new i.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_||!_.state||!_.output||!_.input&&_.avail_in!==0)return d;(p=_.state).mode===12&&(p.mode=13),F=_.next_out,nt=_.output,et=_.avail_out,$=_.next_in,U=_.input,M=_.avail_in,O=p.hold,B=p.bits,K=M,Z=et,V=f;t:for(;;)switch(p.mode){case y:if(p.wrap===0){p.mode=13;break}for(;B<16;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}if(2&p.wrap&&O===35615){L[p.check=0]=255&O,L[1]=O>>>8&255,p.check=s(p.check,L,2,0),B=O=0,p.mode=2;break}if(p.flags=0,p.head&&(p.head.done=!1),!(1&p.wrap)||(((255&O)<<8)+(O>>8))%31){_.msg="incorrect header check",p.mode=30;break}if((15&O)!=8){_.msg="unknown compression method",p.mode=30;break}if(B-=4,m=8+(15&(O>>>=4)),p.wbits===0)p.wbits=m;else if(m>p.wbits){_.msg="invalid window size",p.mode=30;break}p.dmax=1<<m,_.adler=p.check=1,p.mode=512&O?10:12,B=O=0;break;case 2:for(;B<16;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}if(p.flags=O,(255&p.flags)!=8){_.msg="unknown compression method",p.mode=30;break}if(57344&p.flags){_.msg="unknown header flags set",p.mode=30;break}p.head&&(p.head.text=O>>8&1),512&p.flags&&(L[0]=255&O,L[1]=O>>>8&255,p.check=s(p.check,L,2,0)),B=O=0,p.mode=3;case 3:for(;B<32;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}p.head&&(p.head.time=O),512&p.flags&&(L[0]=255&O,L[1]=O>>>8&255,L[2]=O>>>16&255,L[3]=O>>>24&255,p.check=s(p.check,L,4,0)),B=O=0,p.mode=4;case 4:for(;B<16;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}p.head&&(p.head.xflags=255&O,p.head.os=O>>8),512&p.flags&&(L[0]=255&O,L[1]=O>>>8&255,p.check=s(p.check,L,2,0)),B=O=0,p.mode=5;case 5:if(1024&p.flags){for(;B<16;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}p.length=O,p.head&&(p.head.extra_len=O),512&p.flags&&(L[0]=255&O,L[1]=O>>>8&255,p.check=s(p.check,L,2,0)),B=O=0}else p.head&&(p.head.extra=null);p.mode=6;case 6:if(1024&p.flags&&(M<(G=p.length)&&(G=M),G&&(p.head&&(m=p.head.extra_len-p.length,p.head.extra||(p.head.extra=new Array(p.head.extra_len)),i.arraySet(p.head.extra,U,$,G,m)),512&p.flags&&(p.check=s(p.check,U,G,$)),M-=G,$+=G,p.length-=G),p.length))break t;p.length=0,p.mode=7;case 7:if(2048&p.flags){if(M===0)break t;for(G=0;m=U[$+G++],p.head&&m&&p.length<65536&&(p.head.name+=String.fromCharCode(m)),m&&G<M;);if(512&p.flags&&(p.check=s(p.check,U,G,$)),M-=G,$+=G,m)break t}else p.head&&(p.head.name=null);p.length=0,p.mode=8;case 8:if(4096&p.flags){if(M===0)break t;for(G=0;m=U[$+G++],p.head&&m&&p.length<65536&&(p.head.comment+=String.fromCharCode(m)),m&&G<M;);if(512&p.flags&&(p.check=s(p.check,U,G,$)),M-=G,$+=G,m)break t}else p.head&&(p.head.comment=null);p.mode=9;case 9:if(512&p.flags){for(;B<16;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}if(O!==(65535&p.check)){_.msg="header crc mismatch",p.mode=30;break}B=O=0}p.head&&(p.head.hcrc=p.flags>>9&1,p.head.done=!0),_.adler=p.check=0,p.mode=12;break;case 10:for(;B<32;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}_.adler=p.check=b(O),B=O=0,p.mode=11;case 11:if(p.havedict===0)return _.next_out=F,_.avail_out=et,_.next_in=$,_.avail_in=M,p.hold=O,p.bits=B,2;_.adler=p.check=1,p.mode=12;case 12:if(C===5||C===6)break t;case 13:if(p.last){O>>>=7&B,B-=7&B,p.mode=27;break}for(;B<3;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}switch(p.last=1&O,B-=1,3&(O>>>=1)){case 0:p.mode=14;break;case 1:if(j(p),p.mode=20,C!==6)break;O>>>=2,B-=2;break t;case 2:p.mode=17;break;case 3:_.msg="invalid block type",p.mode=30}O>>>=2,B-=2;break;case 14:for(O>>>=7&B,B-=7&B;B<32;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}if((65535&O)!=(O>>>16^65535)){_.msg="invalid stored block lengths",p.mode=30;break}if(p.length=65535&O,B=O=0,p.mode=15,C===6)break t;case 15:p.mode=16;case 16:if(G=p.length){if(M<G&&(G=M),et<G&&(G=et),G===0)break t;i.arraySet(nt,U,$,G,F),M-=G,$+=G,et-=G,F+=G,p.length-=G;break}p.mode=12;break;case 17:for(;B<14;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}if(p.nlen=257+(31&O),O>>>=5,B-=5,p.ndist=1+(31&O),O>>>=5,B-=5,p.ncode=4+(15&O),O>>>=4,B-=4,286<p.nlen||30<p.ndist){_.msg="too many length or distance symbols",p.mode=30;break}p.have=0,p.mode=18;case 18:for(;p.have<p.ncode;){for(;B<3;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}p.lens[H[p.have++]]=7&O,O>>>=3,B-=3}for(;p.have<19;)p.lens[H[p.have++]]=0;if(p.lencode=p.lendyn,p.lenbits=7,q={bits:p.lenbits},V=u(0,p.lens,0,19,p.lencode,0,p.work,q),p.lenbits=q.bits,V){_.msg="invalid code lengths set",p.mode=30;break}p.have=0,p.mode=19;case 19:for(;p.have<p.nlen+p.ndist;){for(;X=(R=p.lencode[O&(1<<p.lenbits)-1])>>>16&255,rt=65535&R,!((tt=R>>>24)<=B);){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}if(rt<16)O>>>=tt,B-=tt,p.lens[p.have++]=rt;else{if(rt===16){for(T=tt+2;B<T;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}if(O>>>=tt,B-=tt,p.have===0){_.msg="invalid bit length repeat",p.mode=30;break}m=p.lens[p.have-1],G=3+(3&O),O>>>=2,B-=2}else if(rt===17){for(T=tt+3;B<T;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}B-=tt,m=0,G=3+(7&(O>>>=tt)),O>>>=3,B-=3}else{for(T=tt+7;B<T;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}B-=tt,m=0,G=11+(127&(O>>>=tt)),O>>>=7,B-=7}if(p.have+G>p.nlen+p.ndist){_.msg="invalid bit length repeat",p.mode=30;break}for(;G--;)p.lens[p.have++]=m}}if(p.mode===30)break;if(p.lens[256]===0){_.msg="invalid code -- missing end-of-block",p.mode=30;break}if(p.lenbits=9,q={bits:p.lenbits},V=u(c,p.lens,0,p.nlen,p.lencode,0,p.work,q),p.lenbits=q.bits,V){_.msg="invalid literal/lengths set",p.mode=30;break}if(p.distbits=6,p.distcode=p.distdyn,q={bits:p.distbits},V=u(g,p.lens,p.nlen,p.ndist,p.distcode,0,p.work,q),p.distbits=q.bits,V){_.msg="invalid distances set",p.mode=30;break}if(p.mode=20,C===6)break t;case 20:p.mode=21;case 21:if(6<=M&&258<=et){_.next_out=F,_.avail_out=et,_.next_in=$,_.avail_in=M,p.hold=O,p.bits=B,l(_,Z),F=_.next_out,nt=_.output,et=_.avail_out,$=_.next_in,U=_.input,M=_.avail_in,O=p.hold,B=p.bits,p.mode===12&&(p.back=-1);break}for(p.back=0;X=(R=p.lencode[O&(1<<p.lenbits)-1])>>>16&255,rt=65535&R,!((tt=R>>>24)<=B);){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}if(X&&(240&X)==0){for(ut=tt,mt=X,xt=rt;X=(R=p.lencode[xt+((O&(1<<ut+mt)-1)>>ut)])>>>16&255,rt=65535&R,!(ut+(tt=R>>>24)<=B);){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}O>>>=ut,B-=ut,p.back+=ut}if(O>>>=tt,B-=tt,p.back+=tt,p.length=rt,X===0){p.mode=26;break}if(32&X){p.back=-1,p.mode=12;break}if(64&X){_.msg="invalid literal/length code",p.mode=30;break}p.extra=15&X,p.mode=22;case 22:if(p.extra){for(T=p.extra;B<T;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}p.length+=O&(1<<p.extra)-1,O>>>=p.extra,B-=p.extra,p.back+=p.extra}p.was=p.length,p.mode=23;case 23:for(;X=(R=p.distcode[O&(1<<p.distbits)-1])>>>16&255,rt=65535&R,!((tt=R>>>24)<=B);){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}if((240&X)==0){for(ut=tt,mt=X,xt=rt;X=(R=p.distcode[xt+((O&(1<<ut+mt)-1)>>ut)])>>>16&255,rt=65535&R,!(ut+(tt=R>>>24)<=B);){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}O>>>=ut,B-=ut,p.back+=ut}if(O>>>=tt,B-=tt,p.back+=tt,64&X){_.msg="invalid distance code",p.mode=30;break}p.offset=rt,p.extra=15&X,p.mode=24;case 24:if(p.extra){for(T=p.extra;B<T;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}p.offset+=O&(1<<p.extra)-1,O>>>=p.extra,B-=p.extra,p.back+=p.extra}if(p.offset>p.dmax){_.msg="invalid distance too far back",p.mode=30;break}p.mode=25;case 25:if(et===0)break t;if(G=Z-et,p.offset>G){if((G=p.offset-G)>p.whave&&p.sane){_.msg="invalid distance too far back",p.mode=30;break}ct=G>p.wnext?(G-=p.wnext,p.wsize-G):p.wnext-G,G>p.length&&(G=p.length),it=p.window}else it=nt,ct=F-p.offset,G=p.length;for(et<G&&(G=et),et-=G,p.length-=G;nt[F++]=it[ct++],--G;);p.length===0&&(p.mode=21);break;case 26:if(et===0)break t;nt[F++]=p.length,et--,p.mode=21;break;case 27:if(p.wrap){for(;B<32;){if(M===0)break t;M--,O|=U[$++]<<B,B+=8}if(Z-=et,_.total_out+=Z,p.total+=Z,Z&&(_.adler=p.check=p.flags?s(p.check,nt,Z,F-Z):a(p.check,nt,Z,F-Z)),Z=et,(p.flags?O:b(O))!==p.check){_.msg="incorrect data check",p.mode=30;break}B=O=0}p.mode=28;case 28:if(p.wrap&&p.flags){for(;B<32;){if(M===0)break t;M--,O+=U[$++]<<B,B+=8}if(O!==(4294967295&p.total)){_.msg="incorrect length check",p.mode=30;break}B=O=0}p.mode=29;case 29:V=1;break t;case 30:V=-3;break t;case 31:return-4;case 32:default:return d}return _.next_out=F,_.avail_out=et,_.next_in=$,_.avail_in=M,p.hold=O,p.bits=B,(p.wsize||Z!==_.avail_out&&p.mode<30&&(p.mode<27||C!==4))&&P(_,_.output,_.next_out,Z-_.avail_out)?(p.mode=31,-4):(K-=_.avail_in,Z-=_.avail_out,_.total_in+=K,_.total_out+=Z,p.total+=Z,p.wrap&&Z&&(_.adler=p.check=p.flags?s(p.check,nt,Z,_.next_out-Z):a(p.check,nt,Z,_.next_out-Z)),_.data_type=p.bits+(p.last?64:0)+(p.mode===12?128:0)+(p.mode===20||p.mode===15?256:0),(K==0&&Z===0||C===4)&&V===f&&(V=-5),V)},o.inflateEnd=function(_){if(!_||!_.state)return d;var C=_.state;return C.window&&(C.window=null),_.state=null,f},o.inflateGetHeader=function(_,C){var p;return _&&_.state?(2&(p=_.state).wrap)==0?d:((p.head=C).done=!1,f):d},o.inflateSetDictionary=function(_,C){var p,U=C.length;return _&&_.state?(p=_.state).wrap!==0&&p.mode!==11?d:p.mode===11&&a(1,C,U,0)!==p.check?-3:P(_,C,U,U)?(p.mode=31,-4):(p.havedict=1,f):d},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,o){var i=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(c,g,f,d,y,h,v,b){var w,k,x,S,A,I,N,z,j,P=b.bits,_=0,C=0,p=0,U=0,nt=0,$=0,F=0,M=0,et=0,O=0,B=null,K=0,Z=new i.Buf16(16),G=new i.Buf16(16),ct=null,it=0;for(_=0;_<=15;_++)Z[_]=0;for(C=0;C<d;C++)Z[g[f+C]]++;for(nt=P,U=15;1<=U&&Z[U]===0;U--);if(U<nt&&(nt=U),U===0)return y[h++]=20971520,y[h++]=20971520,b.bits=1,0;for(p=1;p<U&&Z[p]===0;p++);for(nt<p&&(nt=p),_=M=1;_<=15;_++)if(M<<=1,(M-=Z[_])<0)return-1;if(0<M&&(c===0||U!==1))return-1;for(G[1]=0,_=1;_<15;_++)G[_+1]=G[_]+Z[_];for(C=0;C<d;C++)g[f+C]!==0&&(v[G[g[f+C]]++]=C);if(I=c===0?(B=ct=v,19):c===1?(B=a,K-=257,ct=s,it-=257,256):(B=l,ct=u,-1),_=p,A=h,F=C=O=0,x=-1,S=(et=1<<($=nt))-1,c===1&&852<et||c===2&&592<et)return 1;for(;;){for(N=_-F,j=v[C]<I?(z=0,v[C]):v[C]>I?(z=ct[it+v[C]],B[K+v[C]]):(z=96,0),w=1<<_-F,p=k=1<<$;y[A+(O>>F)+(k-=w)]=N<<24|z<<16|j|0,k!==0;);for(w=1<<_-1;O&w;)w>>=1;if(w!==0?(O&=w-1,O+=w):O=0,C++,--Z[_]==0){if(_===U)break;_=g[f+v[C]]}if(nt<_&&(O&S)!==x){for(F===0&&(F=nt),A+=p,M=1<<($=_-F);$+F<U&&!((M-=Z[$+F])<=0);)$++,M<<=1;if(et+=1<<$,c===1&&852<et||c===2&&592<et)return 1;y[x=O&S]=nt<<24|$<<16|A-h|0}}return O!==0&&(y[A+O]=_-F<<24|64<<16|0),b.bits=nt,0}},{"../utils/common":41}],51:[function(e,r,o){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,o){var i=e("../utils/common"),a=0,s=1;function l(R){for(var L=R.length;0<=--L;)R[L]=0}var u=0,c=29,g=256,f=g+1+c,d=30,y=19,h=2*f+1,v=15,b=16,w=7,k=256,x=16,S=17,A=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=new Array(2*(f+2));l(P);var _=new Array(2*d);l(_);var C=new Array(512);l(C);var p=new Array(256);l(p);var U=new Array(c);l(U);var nt,$,F,M=new Array(d);function et(R,L,H,Y,W){this.static_tree=R,this.extra_bits=L,this.extra_base=H,this.elems=Y,this.max_length=W,this.has_stree=R&&R.length}function O(R,L){this.dyn_tree=R,this.max_code=0,this.stat_desc=L}function B(R){return R<256?C[R]:C[256+(R>>>7)]}function K(R,L){R.pending_buf[R.pending++]=255&L,R.pending_buf[R.pending++]=L>>>8&255}function Z(R,L,H){R.bi_valid>b-H?(R.bi_buf|=L<<R.bi_valid&65535,K(R,R.bi_buf),R.bi_buf=L>>b-R.bi_valid,R.bi_valid+=H-b):(R.bi_buf|=L<<R.bi_valid&65535,R.bi_valid+=H)}function G(R,L,H){Z(R,H[2*L],H[2*L+1])}function ct(R,L){for(var H=0;H|=1&R,R>>>=1,H<<=1,0<--L;);return H>>>1}function it(R,L,H){var Y,W,Q=new Array(v+1),ot=0;for(Y=1;Y<=v;Y++)Q[Y]=ot=ot+H[Y-1]<<1;for(W=0;W<=L;W++){var J=R[2*W+1];J!==0&&(R[2*W]=ct(Q[J]++,J))}}function tt(R){var L;for(L=0;L<f;L++)R.dyn_ltree[2*L]=0;for(L=0;L<d;L++)R.dyn_dtree[2*L]=0;for(L=0;L<y;L++)R.bl_tree[2*L]=0;R.dyn_ltree[2*k]=1,R.opt_len=R.static_len=0,R.last_lit=R.matches=0}function X(R){8<R.bi_valid?K(R,R.bi_buf):0<R.bi_valid&&(R.pending_buf[R.pending++]=R.bi_buf),R.bi_buf=0,R.bi_valid=0}function rt(R,L,H,Y){var W=2*L,Q=2*H;return R[W]<R[Q]||R[W]===R[Q]&&Y[L]<=Y[H]}function ut(R,L,H){for(var Y=R.heap[H],W=H<<1;W<=R.heap_len&&(W<R.heap_len&&rt(L,R.heap[W+1],R.heap[W],R.depth)&&W++,!rt(L,Y,R.heap[W],R.depth));)R.heap[H]=R.heap[W],H=W,W<<=1;R.heap[H]=Y}function mt(R,L,H){var Y,W,Q,ot,J=0;if(R.last_lit!==0)for(;Y=R.pending_buf[R.d_buf+2*J]<<8|R.pending_buf[R.d_buf+2*J+1],W=R.pending_buf[R.l_buf+J],J++,Y===0?G(R,W,L):(G(R,(Q=p[W])+g+1,L),(ot=I[Q])!==0&&Z(R,W-=U[Q],ot),G(R,Q=B(--Y),H),(ot=N[Q])!==0&&Z(R,Y-=M[Q],ot)),J<R.last_lit;);G(R,k,L)}function xt(R,L){var H,Y,W,Q=L.dyn_tree,ot=L.stat_desc.static_tree,J=L.stat_desc.has_stree,lt=L.stat_desc.elems,ht=-1;for(R.heap_len=0,R.heap_max=h,H=0;H<lt;H++)Q[2*H]!==0?(R.heap[++R.heap_len]=ht=H,R.depth[H]=0):Q[2*H+1]=0;for(;R.heap_len<2;)Q[2*(W=R.heap[++R.heap_len]=ht<2?++ht:0)]=1,R.depth[W]=0,R.opt_len--,J&&(R.static_len-=ot[2*W+1]);for(L.max_code=ht,H=R.heap_len>>1;1<=H;H--)ut(R,Q,H);for(W=lt;H=R.heap[1],R.heap[1]=R.heap[R.heap_len--],ut(R,Q,1),Y=R.heap[1],R.heap[--R.heap_max]=H,R.heap[--R.heap_max]=Y,Q[2*W]=Q[2*H]+Q[2*Y],R.depth[W]=(R.depth[H]>=R.depth[Y]?R.depth[H]:R.depth[Y])+1,Q[2*H+1]=Q[2*Y+1]=W,R.heap[1]=W++,ut(R,Q,1),2<=R.heap_len;);R.heap[--R.heap_max]=R.heap[1],function(dt,St){var Gt,kt,Yt,vt,le,ne,Mt=St.dyn_tree,Oe=St.max_code,Fe=St.stat_desc.static_tree,un=St.stat_desc.has_stree,fn=St.stat_desc.extra_bits,Ue=St.stat_desc.extra_base,wt=St.stat_desc.max_length,Rt=0;for(vt=0;vt<=v;vt++)dt.bl_count[vt]=0;for(Mt[2*dt.heap[dt.heap_max]+1]=0,Gt=dt.heap_max+1;Gt<h;Gt++)wt<(vt=Mt[2*Mt[2*(kt=dt.heap[Gt])+1]+1]+1)&&(vt=wt,Rt++),Mt[2*kt+1]=vt,Oe<kt||(dt.bl_count[vt]++,le=0,Ue<=kt&&(le=fn[kt-Ue]),ne=Mt[2*kt],dt.opt_len+=ne*(vt+le),un&&(dt.static_len+=ne*(Fe[2*kt+1]+le)));if(Rt!==0){do{for(vt=wt-1;dt.bl_count[vt]===0;)vt--;dt.bl_count[vt]--,dt.bl_count[vt+1]+=2,dt.bl_count[wt]--,Rt-=2}while(0<Rt);for(vt=wt;vt!==0;vt--)for(kt=dt.bl_count[vt];kt!==0;)Oe<(Yt=dt.heap[--Gt])||(Mt[2*Yt+1]!==vt&&(dt.opt_len+=(vt-Mt[2*Yt+1])*Mt[2*Yt],Mt[2*Yt+1]=vt),kt--)}}(R,L),it(Q,ht,R.bl_count)}function m(R,L,H){var Y,W,Q=-1,ot=L[1],J=0,lt=7,ht=4;for(ot===0&&(lt=138,ht=3),L[2*(H+1)+1]=65535,Y=0;Y<=H;Y++)W=ot,ot=L[2*(Y+1)+1],++J<lt&&W===ot||(J<ht?R.bl_tree[2*W]+=J:W!==0?(W!==Q&&R.bl_tree[2*W]++,R.bl_tree[2*x]++):J<=10?R.bl_tree[2*S]++:R.bl_tree[2*A]++,Q=W,ht=(J=0)===ot?(lt=138,3):W===ot?(lt=6,3):(lt=7,4))}function V(R,L,H){var Y,W,Q=-1,ot=L[1],J=0,lt=7,ht=4;for(ot===0&&(lt=138,ht=3),Y=0;Y<=H;Y++)if(W=ot,ot=L[2*(Y+1)+1],!(++J<lt&&W===ot)){if(J<ht)for(;G(R,W,R.bl_tree),--J!=0;);else W!==0?(W!==Q&&(G(R,W,R.bl_tree),J--),G(R,x,R.bl_tree),Z(R,J-3,2)):J<=10?(G(R,S,R.bl_tree),Z(R,J-3,3)):(G(R,A,R.bl_tree),Z(R,J-11,7));Q=W,ht=(J=0)===ot?(lt=138,3):W===ot?(lt=6,3):(lt=7,4)}}l(M);var q=!1;function T(R,L,H,Y){Z(R,(u<<1)+(Y?1:0),3),function(W,Q,ot,J){X(W),K(W,ot),K(W,~ot),i.arraySet(W.pending_buf,W.window,Q,ot,W.pending),W.pending+=ot}(R,L,H)}o._tr_init=function(R){q||(function(){var L,H,Y,W,Q,ot=new Array(v+1);for(W=Y=0;W<c-1;W++)for(U[W]=Y,L=0;L<1<<I[W];L++)p[Y++]=W;for(p[Y-1]=W,W=Q=0;W<16;W++)for(M[W]=Q,L=0;L<1<<N[W];L++)C[Q++]=W;for(Q>>=7;W<d;W++)for(M[W]=Q<<7,L=0;L<1<<N[W]-7;L++)C[256+Q++]=W;for(H=0;H<=v;H++)ot[H]=0;for(L=0;L<=143;)P[2*L+1]=8,L++,ot[8]++;for(;L<=255;)P[2*L+1]=9,L++,ot[9]++;for(;L<=279;)P[2*L+1]=7,L++,ot[7]++;for(;L<=287;)P[2*L+1]=8,L++,ot[8]++;for(it(P,f+1,ot),L=0;L<d;L++)_[2*L+1]=5,_[2*L]=ct(L,5);nt=new et(P,I,g+1,f,v),$=new et(_,N,0,d,v),F=new et(new Array(0),z,0,y,w)}(),q=!0),R.l_desc=new O(R.dyn_ltree,nt),R.d_desc=new O(R.dyn_dtree,$),R.bl_desc=new O(R.bl_tree,F),R.bi_buf=0,R.bi_valid=0,tt(R)},o._tr_stored_block=T,o._tr_flush_block=function(R,L,H,Y){var W,Q,ot=0;0<R.level?(R.strm.data_type===2&&(R.strm.data_type=function(J){var lt,ht=4093624447;for(lt=0;lt<=31;lt++,ht>>>=1)if(1&ht&&J.dyn_ltree[2*lt]!==0)return a;if(J.dyn_ltree[18]!==0||J.dyn_ltree[20]!==0||J.dyn_ltree[26]!==0)return s;for(lt=32;lt<g;lt++)if(J.dyn_ltree[2*lt]!==0)return s;return a}(R)),xt(R,R.l_desc),xt(R,R.d_desc),ot=function(J){var lt;for(m(J,J.dyn_ltree,J.l_desc.max_code),m(J,J.dyn_dtree,J.d_desc.max_code),xt(J,J.bl_desc),lt=y-1;3<=lt&&J.bl_tree[2*j[lt]+1]===0;lt--);return J.opt_len+=3*(lt+1)+5+5+4,lt}(R),W=R.opt_len+3+7>>>3,(Q=R.static_len+3+7>>>3)<=W&&(W=Q)):W=Q=H+5,H+4<=W&&L!==-1?T(R,L,H,Y):R.strategy===4||Q===W?(Z(R,2+(Y?1:0),3),mt(R,P,_)):(Z(R,4+(Y?1:0),3),function(J,lt,ht,dt){var St;for(Z(J,lt-257,5),Z(J,ht-1,5),Z(J,dt-4,4),St=0;St<dt;St++)Z(J,J.bl_tree[2*j[St]+1],3);V(J,J.dyn_ltree,lt-1),V(J,J.dyn_dtree,ht-1)}(R,R.l_desc.max_code+1,R.d_desc.max_code+1,ot+1),mt(R,R.dyn_ltree,R.dyn_dtree)),tt(R),Y&&X(R)},o._tr_tally=function(R,L,H){return R.pending_buf[R.d_buf+2*R.last_lit]=L>>>8&255,R.pending_buf[R.d_buf+2*R.last_lit+1]=255&L,R.pending_buf[R.l_buf+R.last_lit]=255&H,R.last_lit++,L===0?R.dyn_ltree[2*H]++:(R.matches++,L--,R.dyn_ltree[2*(p[H]+g+1)]++,R.dyn_dtree[2*B(L)]++),R.last_lit===R.lit_bufsize-1},o._tr_align=function(R){Z(R,2,3),G(R,k,P),function(L){L.bi_valid===16?(K(L,L.bi_buf),L.bi_buf=0,L.bi_valid=0):8<=L.bi_valid&&(L.pending_buf[L.pending++]=255&L.bi_buf,L.bi_buf>>=8,L.bi_valid-=8)}(R)}},{"../utils/common":41}],53:[function(e,r,o){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,o){(function(i){(function(a,s){if(!a.setImmediate){var l,u,c,g,f=1,d={},y=!1,h=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(x){process.nextTick(function(){w(x)})}:function(){if(a.postMessage&&!a.importScripts){var x=!0,S=a.onmessage;return a.onmessage=function(){x=!1},a.postMessage("","*"),a.onmessage=S,x}}()?(g="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",k,!1):a.attachEvent("onmessage",k),function(x){a.postMessage(g+x,"*")}):a.MessageChannel?((c=new MessageChannel).port1.onmessage=function(x){w(x.data)},function(x){c.port2.postMessage(x)}):h&&"onreadystatechange"in h.createElement("script")?(u=h.documentElement,function(x){var S=h.createElement("script");S.onreadystatechange=function(){w(x),S.onreadystatechange=null,u.removeChild(S),S=null},u.appendChild(S)}):function(x){setTimeout(w,0,x)},v.setImmediate=function(x){typeof x!="function"&&(x=new Function(""+x));for(var S=new Array(arguments.length-1),A=0;A<S.length;A++)S[A]=arguments[A+1];var I={callback:x,args:S};return d[f]=I,l(f),f++},v.clearImmediate=b}function b(x){delete d[x]}function w(x){if(y)setTimeout(w,0,x);else{var S=d[x];if(S){y=!0;try{(function(A){var I=A.callback,N=A.args;switch(N.length){case 0:I();break;case 1:I(N[0]);break;case 2:I(N[0],N[1]);break;case 3:I(N[0],N[1],N[2]);break;default:I.apply(s,N)}})(S)}finally{b(x),y=!1}}}}function k(x){x.source===a&&typeof x.data=="string"&&x.data.indexOf(g)===0&&w(+x.data.slice(g.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof We<"u"?We:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(Wn)),Wn.exports}var Wa=Ua();const ir=wo(Wa);function qa(t){const n=t?.toLowerCase()||"";return n.includes("jpeg")?"jpeg":n.includes("png")?"png":n.includes("webp")?"webp":n.includes("gif")?"gif":n.includes("bmp")?"bmp":n.includes("avif")?"avif":"jpg"}async function $a(t){try{const n=await fetch(t,{cache:"no-store"});if(n.ok){const e=await n.blob();return{blob:e,mime:e.type||"image/jpeg"}}}catch{}try{const n=await Va(t),{blob:e,mime:r}=await Ha(n);return{blob:e,mime:r}}catch{throw new Error("Unable to read image bytes (fetch/canvas failed).")}}function Va(t){return new Promise((n,e)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>n(r),r.onerror=e,r.src=t})}function Ha(t){return new Promise((n,e)=>{const r=Math.max(1,t.naturalWidth||t.width||1),o=Math.max(1,t.naturalHeight||t.height||1),i=document.createElement("canvas");i.width=r,i.height=o;const a=i.getContext("2d");if(!a)return e(new Error("Canvas2D unavailable"));a.drawImage(t,0,0,r,o),i.toBlob(s=>{if(!s)return e(new Error("Canvas toBlob failed (tainted?)"));n({blob:s,mime:s.type||"image/png"})},"image/png",.92)})}async function Ga(t){const n=t?.imageFormat??"jpeg",e=Math.max(.5,Math.min(.95,t?.quality??.8)),r=gt.getState(),o=r.photos,i=o.length;let a=0;const s=new ir,l=s.folder("images");if(!l)throw new Error("ZIP: cannot create images/");const u={schemaVersion:1,createdAt:new Date().toISOString(),appConfigSnapshot:{MAX_CARDS:Jo,CARD_EXPORT_SIZE:It,PREVIEW_EXACT_SIZE:Xe,PREVIEW_FAST_SIZE:da},images:[],cards:[]};for(let g=0;g<o.length;g++){const f=o[g];let d=null,y="image/jpeg";try{const x=await $a(f.url);d=x.blob,y=x.mime||y}catch{d=null}if(d){const x=(d.type||"").toLowerCase();if(n==="jpeg"){if(!/jpe?g/.test(x)||e!==.8)try{d=await Za(d,e),y="image/jpeg"}catch{}}else if(n==="png"&&!/png/.test(x))try{d=await Xa(d),y="image/png"}catch{}}const h=qa(y),v=`images/${f.id}.${h}`;d?(l.file(`${f.id}.${h}`,d),u.images.push({id:f.id,path:v,mime:y,size:d.size,source:{type:"embedded"}})):u.images.push({id:f.id,path:v,mime:y,source:{type:"url"}});const b=r.transforms[f.id]??{scale:1,tx:0,ty:0},w=r.cardBackground?.[f.id],k=(r.layersByPhoto[f.id]??[]).map(Ya);u.cards.push({photoId:f.id,order:g,transform:b,background:w,layers:k}),a++,t?.onProgress?.({done:a,total:i})}return s.file("manifest.json",JSON.stringify(u,null,2)),await s.generateAsync({type:"blob",compression:"DEFLATE"})}function Ya(t){if(!t)return t;if(t.type==="image"&&t.qrText){const{src:n,...e}=t;return e}if(t.type==="image"&&typeof t.src=="string"&&t.src.startsWith("data:")){const{src:n,...e}=t;return e}return{...t}}async function ai(t){const n=URL.createObjectURL(t);try{return await new Promise((e,r)=>{const o=new Image;o.onload=()=>e(o),o.onerror=r,o.src=n})}finally{URL.revokeObjectURL(n)}}async function Za(t,n){const e=await ai(t),r=document.createElement("canvas");r.width=Math.max(1,e.naturalWidth||e.width||1),r.height=Math.max(1,e.naturalHeight||e.height||1);const o=r.getContext("2d");if(!o)throw new Error("Canvas2D unavailable");o.drawImage(e,0,0);const i=r.toDataURL("image/jpeg",n);return await(await fetch(i)).blob()}async function Xa(t){const n=await ai(t),e=document.createElement("canvas");e.width=Math.max(1,n.naturalWidth||n.width||1),e.height=Math.max(1,n.naturalHeight||n.height||1);const r=e.getContext("2d");if(!r)throw new Error("Canvas2D unavailable");r.drawImage(n,0,0);const o=e.toDataURL("image/png");return await(await fetch(o)).blob()}async function li(t){const n=[],e=await ir.loadAsync(t),r=e.file("manifest.json");if(!r)throw new Error("manifest.json not found in zip");const o=await r.async("string");let i;try{i=JSON.parse(o)}catch{throw new Error("manifest.json is not valid JSON")}if(i.schemaVersion!==1)throw new Error(`Unsupported schemaVersion: ${i.schemaVersion}`);const a=new Map;for(const f of i.images){const d=e.file(f.path);if(!d){n.push(`Image file missing in zip: ${f.path}`);continue}try{const y=await d.async("blob"),h=URL.createObjectURL(y);a.set(f.id,h)}catch{n.push(`Failed to read image: ${f.path}`)}}const s=[],l={},u={},c={},g=[...i.cards].sort((f,d)=>f.order-d.order);for(const f of g){const d=a.get(f.photoId);d?s.push({id:f.photoId,url:d}):(n.push(`Missing image for card photoId=${f.photoId}. Card will appear without photo.`),s.push({id:f.photoId,url:Ka})),l[f.photoId]={...f.transform},f.background&&(c[f.photoId]={...f.background});const y=Array.isArray(f.layers)?f.layers.slice():[];for(const h of y)if(h&&h.type==="image"&&h.qrText&&!h.src){const v=Math.max(1,Math.round(h.w??h.h??512));h.src=await De(h.qrText,v,1),h.w==null&&(h.w=v),h.h==null&&(h.h=v)}u[f.photoId]=y}return gt.setState({photos:s,transforms:l,layersByPhoto:u,cardBackground:c}),{warnings:n}}const Ka="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=",Ae=xo(t=>({busy:!1,busyText:void 0,progress:void 0,setBusy:(n,e,r)=>t({busy:n,busyText:n?e:void 0,progress:n?r:void 0}),start:n=>t({busy:!0,busyText:n??"Loading...",progress:0}),setProgress:(n,e)=>t(r=>({progress:Math.max(0,Math.min(100,n)),busyText:e??r.busyText})),stop:()=>t({busy:!1,busyText:void 0,progress:void 0})}));function Qa(){const t=D.useRef(null),n=D.useRef(null),e=D.useRef(null),r=gt(f=>f.photos),o=gt(f=>f.add),i=gt(f=>f.clear),a=D.useCallback(f=>{if(!f?.length)return;const d=Array.from(f),y=la(d);o(y)},[o]),s=D.useCallback(f=>{a(f.target.files),f.target.value=""},[a]);async function l(f){const d=f.target.files?.[0];if(!d)return;const y=await d.text();f.target.value="";const{rows:h,hasRelative:v}=Oa(y);if(!h.length)return;if(v){alert("  CSV   .       . ,   URL (http/https)     Choose images.");return}const b=Ae.getState();b.start("Importing CSV");try{await g(h,null)}finally{b.stop()}}function u(f){return new Promise(d=>setTimeout(d,f))}async function c(f,d,y=4e3,h=50){const v=Date.now()+y,b=d.map(w=>w.toLowerCase());for(;Date.now()<v;){const k=gt.getState().layersByPhoto[f]??[],x=new Set(k.map(A=>typeof A?.name=="string"?A.name.toLowerCase():"").filter(Boolean));if(b.filter(A=>!x.has(A)).length===0)return[];await u(h)}return d}async function g(f,d){const y=Ae.getState(),h=gt.getState(),v=h.photos.length,b=h.max,w=Math.max(0,b-v);if(w<=0){alert(`  : ${b} .`);return}const k=Math.min(w,f.length);k<f.length&&alert(`   ${k}  ${f.length}    ${b}.`);const x=f.slice(0,k),S=[];let A=0,I=0;for(let C=0;C<x.length;C++){const p=x[C];try{let U=null,nt="image";if(ii(p.url)){const M=await fetch(p.url,{mode:"cors"});if(!M.ok)throw new Error(`HTTP ${M.status}`);U=await M.blob(),nt=p.url.split("/").pop()||nt}else if(si(p.url))U=await(await fetch(p.url)).blob(),nt="data.png";else throw new Error("Relative paths are disabled in this build");const $=URL.createObjectURL(U),F=crypto.randomUUID();S.push({id:F,url:$,name:nt}),A++}catch(U){console.warn("CSV import skip:",p.url,U),I++}y.setProgress(Math.round((C+1)/x.length*100),`Importing CSV (${C+1}/${x.length})`)}const N=gt.getState().add;N(S);const P=gt.getState().photos.slice(v).map(C=>C.id),_=x.slice(0,P.length);for(let C=0;C<_.length;C++){const p=_[C],U=P[C];if(!p.layers)continue;const nt=Object.keys(p.layers).map(O=>O.toLowerCase());(await c(U,nt,4e3,50)).length;const F=gt.getState(),M=F.layersByPhoto[U]??[],et=O=>["x","y","w","h","width","height","fontSize","rotation","letterSpacing","lineHeight","padding","opacity","strokeWidth"].includes(O);for(const[O,B]of Object.entries(p.layers)){const K=String(O).toLowerCase(),Z=M.filter(G=>typeof G?.name=="string"&&G.name.toLowerCase()===K);if(Z.length)for(const G of Z)for(const[ct,it]of Object.entries(B)){const tt=ct;if(G.type==="image"&&G.qrText!==void 0){if(tt==="text"){await F.updateQrLayer(U,G.id,{text:it});continue}if(tt==="size"){const rt=parseInt(it,10);Number.isNaN(rt)||await F.updateQrLayer(U,G.id,{size:rt});continue}}const X={};if(tt==="text"?X.text=it:tt==="fill"?X.fill=it:tt==="align"?X.align=it:tt==="vertical_align"||tt==="verticalalign"?X.verticalAlign=it:tt==="fontfamily"||tt==="font_family"?X.fontFamily=it:(tt==="fontstyle"||tt==="font_style")&&(X.fontStyle=it),et(tt)){const rt=parseFloat(it);Number.isNaN(rt)||(X[tt]=rt)}Object.keys(X).length&&F.updateLayer(U,G.id,X)}}y.setProgress(Math.round((C+1)/_.length*100),`Applying CSV overrides (${C+1}/${_.length})`)}I&&alert(`CSV import:  ${A},  ${I}`)}return E.jsx("section",{className:"mt-4 space-y-4",children:E.jsxs("div",{className:"flex items-center justify-between gap-2",children:[E.jsxs("div",{className:"text-sm opacity-80",children:["Cards: ",E.jsx("b",{children:r.length})]}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("input",{ref:t,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:s}),E.jsx("input",{ref:n,type:"file",accept:".csv,text/csv",className:"hidden",onChange:l}),E.jsx("input",{ref:e,type:"file",accept:".zip,application/zip",className:"hidden",onChange:async f=>{const d=f.currentTarget,y=d.files?.[0];if(d.value="",!!y)try{const{warnings:h}=await li(y);h.length&&alert(`Import finished with warnings:
`+h.join(`
`))}catch(h){setTimeout(()=>{alert(`Cannot open .zip: ${h?.message??String(h)}`)},0)}}}),E.jsx(_t,{variant:"secondary",onClick:()=>e.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Open collection (.zip)"}),E.jsx("button",{onClick:()=>n.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Import CSV"}),E.jsx("button",{onClick:()=>t.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Choose images"}),E.jsx(_t,{variant:"destructive",onClick:i,disabled:!r.length,children:"Clear"})]})]})})}const ci=D.forwardRef(({className:t,...n},e)=>E.jsx("div",{ref:e,className:yt("rounded-xl border bg-card text-card-foreground shadow",t),...n}));ci.displayName="Card";const Ja=D.forwardRef(({className:t,...n},e)=>E.jsx("div",{ref:e,className:yt("flex flex-col space-y-1.5 p-6",t),...n}));Ja.displayName="CardHeader";const tl=D.forwardRef(({className:t,...n},e)=>E.jsx("div",{ref:e,className:yt("font-semibold leading-none tracking-tight",t),...n}));tl.displayName="CardTitle";const el=D.forwardRef(({className:t,...n},e)=>E.jsx("div",{ref:e,className:yt("text-sm text-muted-foreground",t),...n}));el.displayName="CardDescription";const nl=D.forwardRef(({className:t,...n},e)=>E.jsx("div",{ref:e,className:yt("p-6 pt-0",t),...n}));nl.displayName="CardContent";const rl=D.forwardRef(({className:t,...n},e)=>E.jsx("div",{ref:e,className:yt("flex items-center p-6 pt-0",t),...n}));rl.displayName="CardFooter";const sr=D.forwardRef(({className:t,value:n,...e},r)=>E.jsx(So,{ref:r,className:yt("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...e,children:E.jsx(rs,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));sr.displayName=So.displayName;const ol=cs,il=ds,di=D.forwardRef(({className:t,children:n,...e},r)=>E.jsxs(Ro,{ref:r,className:yt("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...e,children:[n,E.jsx(os,{asChild:!0,children:E.jsx(_o,{className:"h-4 w-4 opacity-50"})})]}));di.displayName=Ro.displayName;const ui=D.forwardRef(({className:t,...n},e)=>E.jsx(Ao,{ref:e,className:yt("flex cursor-default items-center justify-center py-1",t),...n,children:E.jsx(Vi,{className:"h-4 w-4"})}));ui.displayName=Ao.displayName;const fi=D.forwardRef(({className:t,...n},e)=>E.jsx(No,{ref:e,className:yt("flex cursor-default items-center justify-center py-1",t),...n,children:E.jsx(_o,{className:"h-4 w-4"})}));fi.displayName=No.displayName;const hi=D.forwardRef(({className:t,children:n,position:e="popper",...r},o)=>E.jsx(is,{children:E.jsxs(Io,{ref:o,className:yt("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:e,...r,children:[E.jsx(ui,{}),E.jsx(ss,{className:yt("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),E.jsx(fi,{})]})}));hi.displayName=Io.displayName;const sl=D.forwardRef(({className:t,...n},e)=>E.jsx(To,{ref:e,className:yt("px-2 py-1.5 text-sm font-semibold",t),...n}));sl.displayName=To.displayName;const Kn=D.forwardRef(({className:t,children:n,...e},r)=>E.jsxs(Do,{ref:r,className:yt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e,children:[E.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:E.jsx(as,{children:E.jsx(Hi,{className:"h-4 w-4"})})}),E.jsx(ls,{children:n})]}));Kn.displayName=Do.displayName;const al=D.forwardRef(({className:t,...n},e)=>E.jsx(zo,{ref:e,className:yt("-mx-1 my-1 h-px bg-muted",t),...n}));al.displayName=zo.displayName;const ll=[];function pi(t,n=""){const[e,r]=D.useState(null),[o,i]=D.useState("idle");return D.useEffect(()=>{if(!t){r(null),i("idle");return}let a=!1;const s=new Image;return n&&(s.crossOrigin=n),i("loading"),s.onload=()=>{a||(r(s),i("loaded"))},s.onerror=()=>{a||(r(null),i("failed"))},s.src=t,()=>{a=!0}},[t,n]),[e,o]}function cl({layer:t,k:n,onSelect:e,updateLayer:r,selectedId:o,forwardRef:i,onReady:a}){const[s]=pi(t.src||"","anonymous"),l=o===t.id,u=D.useRef(null),c=l&&i?i:u;D.useEffect(()=>{s&&a?.()},[s]);const g=t.x*n,f=t.y*n,d=s?.naturalWidth??0,y=s?.naturalHeight??0,h=Math.max(1,t.w?t.w*n:d*n||1),v=Math.max(1,t.h?t.h*n:y*n||1);return E.jsx(ko,{ref:c,draggable:!0,listening:!0,image:s??void 0,x:g,y:f,width:h,height:v,rotation:t.rotation,visible:t.visible,onMouseDown:()=>e(t.id),onTap:()=>e(t.id),onDragEnd:b=>{r(t.photoId,t.id,{x:b.target.x()/n,y:b.target.y()/n})},onTransformEnd:b=>{const w=b.target,k=typeof w.scaleX=="function"?w.scaleX():1,x=typeof w.scaleY=="function"?w.scaleY():1,S=typeof w.width=="function"?w.width():h,A=typeof w.height=="function"?w.height():v,I={x:w.x()/n,y:w.y()/n,rotation:w.rotation(),scaleX:1,scaleY:1,w:Math.max(1,Math.round(S*k/n)),h:Math.max(1,Math.round(A*x/n))};typeof w.scaleX=="function"&&w.scaleX(1),typeof w.scaleY=="function"&&w.scaleY(1),r(t.photoId,t.id,I)}},t.id)}const sn=D.forwardRef(function({photoId:n,size:e,selectedId:r,onSelect:o,transformOverride:i,layersOverride:a,backgroundOverride:s,onLayerPatch:l,onTransformPatch:u},c){const f=D.useRef(null),d=gt(F=>F.photos.find(M=>M.id===n)?.url),y=gt(F=>F.transforms[n]??pe),h=gt(F=>F.setTransform),v=i??y,b=gt(F=>F.layersByPhoto[n]??ll,Object.is).map(F=>({...F,photoId:n})),w=(a??b).map(F=>({...F,photoId:n})),k=s||gt(F=>F.cardBackground?.[n]??on,Object.is),x=gt(F=>F.updateLayer),S=D.useCallback((F,M,et)=>{l?l(M,et):x(F,M,et)},[l,x]),[A,I]=pi(d??"","anonymous"),N=I==="loaded";D.useImperativeHandle(c,()=>({toDataURL:F=>{const M=f.current;if(!M)return null;const et=F&&F>0?F/e:1;return M.toDataURL({pixelRatio:et,mimeType:"image/png"})},isReady:()=>!!f.current&&N}));const z=D.useRef(null),j=D.useRef(null),[P,_]=D.useState(0),C=e/It,p=D.useMemo(()=>w.find(F=>F.id===r),[w,r]),U=!!(p?.type==="image"&&p?.qrText);D.useLayoutEffect(()=>{const F=z.current,M=j.current;F&&(r&&M?F.nodes([M]):F.nodes([]),F.getLayer()?.batchDraw())},[r,p?.id,w.length,P]);function nt(F,M,et){const O=M/F.width,B=M/F.height,Z=Math.min(O,B)*(et?.scale??1),G=F.width*Z,ct=F.height*Z,it=(M-G)/2+(et?.tx??0)/100*M,tt=(M-ct)/2+(et?.ty??0)/100*M;return{x:it*C,y:tt*C,width:G*C,height:ct*C}}const $=D.useCallback(F=>{if(!(F.evt.ctrlKey||F.evt.metaKey))return;F.evt.preventDefault();const et=F.evt.deltaY||0;if(!Number.isFinite(et)||et===0)return;const O=Math.pow(1.0015,-et),B=v,K=Math.max(.5,Math.min(4,B.scale*O));K!==B.scale&&(u?u({scale:K}):h(n,{scale:K}))},[n,v,u,h]);return E.jsx(Gi,{ref:f,width:e,height:e,pixelRatio:1,listening:!0,style:{width:"100%",height:"100%"},onWheel:$,onMouseDown:F=>{F.target===F.target.getStage()&&o(null)},onTouchStart:F=>{F.target===F.target.getStage()&&o(null)},children:E.jsxs(Yi,{children:[E.jsx(yr,{x:0,y:0,width:e,height:e,fill:k.color,opacity:k.alpha,listening:!1}),A?E.jsx(ko,{image:A,...nt(A,It,v),listening:!1}):null,w.map(F=>{if(F.type==="text"){const M=F,O=r===M.id?j:void 0,B=M.x*C,K=M.y*C,Z=(M.fontSize??16)*C,G=M.width?M.width*C:void 0,ct=(M.padding??0)*C,it=(M.letterSpacing??0)*C;return E.jsx(Zi,{ref:O,draggable:!0,x:B,y:K,text:M.text,fontFamily:M.fontFamily||"Georgia, serif",fontSize:Z,fontStyle:M.fontStyle,fill:M.fill,width:G,align:M.align,lineHeight:M.lineHeight??1.25,padding:ct,letterSpacing:it,rotation:M.rotation,scaleX:1,scaleY:1,visible:M.visible,perfectDrawEnabled:!1,onTransform:tt=>{const X=tt.target,rt=typeof X.scaleX=="function"?X.scaleX():1,ut=typeof X.width=="function"?X.width():void 0;ut!==void 0&&rt&&rt!==1&&(X.width(Math.max(4,Math.round(ut*rt))),typeof X.scaleX=="function"&&X.scaleX(1),typeof X.scaleY=="function"&&X.scaleY(1),X.getLayer()?.batchDraw())},onMouseDown:()=>o(M.id),onTap:()=>o(M.id),onDragEnd:tt=>{S(n,M.id,{x:tt.target.x()/C,y:tt.target.y()/C})},onTransformEnd:tt=>{const X=tt.target,rt=typeof X.scaleX=="function"?X.scaleX():1,ut=typeof X.width=="function"?X.width():void 0,mt={x:X.x()/C,y:X.y()/C,rotation:X.rotation(),scaleX:1,scaleY:1,width:ut!==void 0?Math.max(4,Math.round(ut*rt/C)):void 0};typeof X.scaleX=="function"&&X.scaleX(1),typeof X.scaleY=="function"&&X.scaleY(1),S(n,M.id,mt)}},M.id)}if(F.type==="rect"){const M=F,O=r===M.id?j:void 0,B=M.x*C,K=M.y*C,Z=Math.max(1,(M.width??100)*C),G=Math.max(1,(M.height??100)*C),ct=Math.max(0,(M.strokeWidth??0)*C),it=Math.max(0,(M.cornerRadius??0)*C);return E.jsx(yr,{ref:O,draggable:!0,x:B,y:K,width:Z,height:G,rotation:M.rotation,fill:M.fill??"#ffffff",stroke:M.stroke,strokeWidth:ct,cornerRadius:it,visible:M.visible,opacity:Math.max(0,Math.min(1,M.opacity??1)),onMouseDown:()=>o(M.id),onTap:()=>o(M.id),onDragEnd:tt=>{S(n,M.id,{x:tt.target.x()/C,y:tt.target.y()/C})},onTransformEnd:tt=>{const X=tt.target,rt=typeof X.scaleX=="function"?X.scaleX():1,ut=typeof X.scaleY=="function"?X.scaleY():1,mt=typeof X.width=="function"?X.width():Z,xt=typeof X.height=="function"?X.height():G,m={x:X.x()/C,y:X.y()/C,rotation:X.rotation(),scaleX:1,scaleY:1,width:Math.max(1,Math.round(mt*rt/C)),height:Math.max(1,Math.round(xt*ut/C))};typeof X.scaleX=="function"&&X.scaleX(1),typeof X.scaleY=="function"&&X.scaleY(1),S(n,M.id,m)}},M.id)}if(F.type==="image"){const M=r===F.id;return E.jsx(cl,{layer:F,k:C,selectedId:r,onSelect:o,updateLayer:S,forwardRef:M?j:void 0,onReady:()=>_(et=>et+1)},F.id)}return null}),r&&E.jsx(Xi,{ref:z,rotateEnabled:!0,enabledAnchors:["middle-left","middle-right","top-center","bottom-center","top-left","top-right","bottom-left","bottom-right"],borderStroke:"#fff",anchorStroke:"#fff",anchorFill:"#111",anchorSize:7,keepRatio:U,centeredScaling:!1,boundBoxFunc:(F,M)=>{const O=Math.max(6,M.width),B=Math.max(6,M.height);return{...M,width:O,height:B}}})]})})}),dl=hs,ul=us,mi=D.forwardRef(({className:t,...n},e)=>E.jsx(jo,{ref:e,className:yt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));mi.displayName=jo.displayName;const gi=D.forwardRef(({className:t,children:n,...e},r)=>E.jsxs(ul,{children:[E.jsx(mi,{}),E.jsxs(Mo,{ref:r,className:yt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e,children:[n,E.jsxs(fs,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[E.jsx(Ki,{className:"h-4 w-4"}),E.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));gi.displayName=Mo.displayName;const bi=({className:t,...n})=>E.jsx("div",{className:yt("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});bi.displayName="DialogHeader";const yi=({className:t,...n})=>E.jsx("div",{className:yt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});yi.displayName="DialogFooter";const vi=D.forwardRef(({className:t,...n},e)=>E.jsx(Lo,{ref:e,className:yt("text-lg font-semibold leading-none tracking-tight",t),...n}));vi.displayName=Lo.displayName;const fl=D.forwardRef(({className:t,...n},e)=>E.jsx(Bo,{ref:e,className:yt("text-sm text-muted-foreground",t),...n}));fl.displayName=Bo.displayName;function hl(t,n="card"){return(t.replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||n).slice(0,100)}function pl(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function ml({open:t,onOpenChange:n,photo:e,transform:r,layers:o,snapshot:i,onEdit:a}){const[s,l]=D.useState(null),[u,c]=D.useState(!1),g=D.useRef(null),[f,d]=D.useState(0);D.useEffect(()=>{const k=g.current;if(!k)return;const x=()=>d(Math.round(k.clientWidth));x();const S=new ResizeObserver(x);return S.observe(k),()=>S.disconnect()},[]);const y=D.useRef(null),[h,v]=D.useState(Xe),b=D.useMemo(()=>t?E.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:h,height:h,overflow:"hidden"},children:E.jsx(sn,{ref:y,photoId:e.id,size:h,selectedId:null,onSelect:()=>{}})}):null,[t,e.id,h]);async function w(k){v(k),await new Promise(S=>setTimeout(S,0));try{const S=document;S?.fonts?.ready&&typeof S.fonts.ready.then=="function"&&await S.fonts.ready}catch{}const x=Date.now()+1e3;for(;!y.current?.isReady?.()&&!(Date.now()>x);)await new Promise(S=>setTimeout(S,30));return y.current?.toDataURL(k)??null}return D.useEffect(()=>{let k=!1;if(!t){l(null);return}return(async()=>{c(!0);const x=Math.max(Xe,f||Xe);let S=null;i&&(S=i(x)),S||(S=await w(x)),!k&&(l(S),c(!1))})(),()=>{k=!0}},[t,f,e.id,r.scale,r.tx,r.ty,o,i]),E.jsxs(dl,{"data-dnd-ignore":!0,open:t,onOpenChange:n,children:[b,E.jsxs(gi,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden",children:[E.jsx(bi,{children:E.jsx(ps,{asChild:!0,children:E.jsx(vi,{children:"Preview"})})}),E.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:E.jsxs("div",{ref:g,className:"relative aspect-square overflow-hidden rounded-xl",children:[s?E.jsx("img",{src:s,alt:e.name,className:"absolute inset-0 w-full h-full object-contain"}):E.jsx("div",{className:"h-24"}),E.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${u?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!u,children:E.jsx("div",{className:"h-7 w-7 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]})}),E.jsxs(yi,{className:"mt-2 gap-2",children:[E.jsx(_t,{variant:"secondary",onClick:()=>{n(!1),a?.()},children:"Edit"}),E.jsx(_t,{variant:"secondary",onClick:()=>n(!1),children:"Close"}),E.jsx(_t,{onClick:async()=>{const k=i&&i(It)||await w(It);k&&pl(k,`${hl(e.name||"card")}.png`)},children:"Save PNG"})]})]})]})}const qn=new Map;function Je(t){const n=t.trim();if(n.startsWith('"')){const e=n.indexOf('"',1);return e>1?n.slice(1,e):n.replace(/["']/g,"")}return n.split(",")[0].replace(/["']/g,"").trim()}function gl(t){const n=Je(t);return ti.find(e=>Je(e.family).toLowerCase()===n.toLowerCase())}function bl(t,n){if(document.getElementById(n))return;const e=document.createElement("link");e.id=n,e.rel="stylesheet",e.href=t;const r=document.createElement("link");r.rel="preconnect",r.href="https://fonts.googleapis.com";const o=document.createElement("link");o.rel="preconnect",o.href="https://fonts.gstatic.com",o.crossOrigin="anonymous",document.head.appendChild(r),document.head.appendChild(o),document.head.appendChild(e)}function yl(t){const n=Je(t);if(qn.has(n))return qn.get(n);const e=(async()=>{const r=gl(t);r&&r.cssHref&&bl(r.cssHref,`font-css-${r.id}`);try{const o=document;o?.fonts?.ready&&typeof o.fonts.ready.then=="function"&&await o.fonts.ready}catch{}try{document.fonts?.load&&await document.fonts.load(`1em ${Je(t)}`)}catch{}})();return qn.set(n,e),e}async function vl(t,n=It){const e=document.createElement("div");e.style.position="fixed",e.style.left="-10000px",e.style.top="-10000px",e.style.width=`${n}px`,e.style.height=`${n}px`,document.body.appendChild(e);const r=D.createRef(),o=Co.createRoot(e);o.render(D.createElement(sn,{ref:r,photoId:t,size:n,selectedId:null,onSelect:()=>{}})),await new Promise(s=>setTimeout(s,0));try{const s=document;s?.fonts?.ready&&typeof s.fonts.ready.then=="function"&&await s.fonts.ready}catch{}const i=Date.now()+1500;for(;!r.current?.isReady?.()&&!(Date.now()>i);)await new Promise(s=>setTimeout(s,25));const a=r.current?.toDataURL(n)??"";return o.unmount(),e.remove(),a}async function wi(t,n=It){return vl(t,n)}function wl(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function xl({photo:t}){const n=gt(A=>A.remove),e=gt(A=>A.transforms[t.id]??pe),r=gt(A=>A.layersByPhoto),[o,i]=D.useState(!1),[a,s]=D.useState(!1),l=Eo(),u=D.useRef(null),[c,g]=D.useState(0);D.useEffect(()=>{const A=u.current;if(!A)return;const I=()=>g(A.clientWidth);I();const N=new ResizeObserver(I);return N.observe(A),()=>N.disconnect()},[]);const f=D.useRef(null),[d,y]=D.useState(512),h=E.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:d,height:d,overflow:"hidden"},children:E.jsx(sn,{ref:f,photoId:t.id,size:d,selectedId:null,onSelect:()=>{}})}),[v,b]=D.useState(null),[w,k]=D.useState(!0),x=D.useRef(null);D.useEffect(()=>{if(o)return;const A=window.devicePixelRatio||1,I=Math.max(384,Math.min(1024,Math.round((c||300)*A)));return y(I),x.current&&window.clearTimeout(x.current),x.current=window.setTimeout(async()=>{k(!0);try{const j=document;j?.fonts?.ready&&typeof j.fonts.ready.then=="function"&&await j.fonts.ready}catch{}const N=Date.now()+800;for(;!f.current?.isReady?.()&&!(Date.now()>N);)await new Promise(j=>setTimeout(j,25));const z=f.current?.toDataURL(I)??null;b(z),k(!1)},150),()=>{x.current&&(window.clearTimeout(x.current),x.current=null)}},[c,o,t.id,e.scale,e.tx,e.ty,r[t.id]]);const S=D.useCallback(async()=>{const A=await wi(t.id,It);if(!A)return;const N=(t.name||"card").replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||"card";wl(A,`${N}.png`)},[t.id,t.name]);return E.jsxs(E.Fragment,{children:[h,E.jsxs("div",{className:"overflow-hidden rounded-xl border border-foreground/15 bg-foreground/[0.02]",children:[E.jsxs("div",{ref:u,onClick:()=>s(!0),className:"relative aspect-square w-full overflow-hidden cursor-zoom-in",children:[E.jsx("button",{"aria-label":"Remove image",title:"Remove",onClick:A=>{A.stopPropagation(),n(t.id)},className:"absolute right-1 top-1 z-10 rounded-md bg-background/80 px-1.5 py-0.5 text-[11px] shadow hover:bg-background",children:""}),v?E.jsx("img",{src:v,alt:t.name,className:"h-full w-full object-cover"}):E.jsx("div",{className:"h-full w-full bg-foreground/[0.06]"}),E.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${w?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!w,children:E.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]}),E.jsxs("div",{className:"flex items-center justify-between gap-2 border-t bg-background/70 px-2 py-1.5 supports-[backdrop-filter]:bg-background/60",children:[E.jsx("button",{"aria-label":"Edit card",title:"Edit",onClick:A=>{A.stopPropagation(),i(!0),l(`/edit/${t.id}`)},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Edit"}),E.jsx("button",{"aria-label":"Save PNG",title:"Save PNG",onClick:A=>{A.stopPropagation(),S()},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Save PNG"})]})]}),E.jsx(ml,{open:a,onOpenChange:s,photo:t,transform:e,layers:r[t.id],onEdit:()=>l(`/edit/${t.id}`)})]})}function _l(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return D.useMemo(()=>r=>{n.forEach(o=>o(r))},n)}const an=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function be(t){const n=Object.prototype.toString.call(t);return n==="[object Window]"||n==="[object global]"}function ar(t){return"nodeType"in t}function Dt(t){var n,e;return t?be(t)?t:ar(t)&&(n=(e=t.ownerDocument)==null?void 0:e.defaultView)!=null?n:window:window}function lr(t){const{Document:n}=Dt(t);return t instanceof n}function Le(t){return be(t)?!1:t instanceof Dt(t).HTMLElement}function xi(t){return t instanceof Dt(t).SVGElement}function ye(t){return t?be(t)?t.document:ar(t)?lr(t)?t:Le(t)||xi(t)?t.ownerDocument:document:document:document}const qt=an?D.useLayoutEffect:D.useEffect;function cr(t){const n=D.useRef(t);return qt(()=>{n.current=t}),D.useCallback(function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return n.current==null?void 0:n.current(...r)},[])}function kl(){const t=D.useRef(null),n=D.useCallback((r,o)=>{t.current=setInterval(r,o)},[]),e=D.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[n,e]}function ze(t,n){n===void 0&&(n=[t]);const e=D.useRef(t);return qt(()=>{e.current!==t&&(e.current=t)},n),e}function Be(t,n){const e=D.useRef();return D.useMemo(()=>{const r=t(e.current);return e.current=r,r},[...n])}function tn(t){const n=cr(t),e=D.useRef(null),r=D.useCallback(o=>{o!==e.current&&n?.(o,e.current),e.current=o},[]);return[e,r]}function Qn(t){const n=D.useRef();return D.useEffect(()=>{n.current=t},[t]),n.current}let $n={};function Pe(t,n){return D.useMemo(()=>{if(n)return n;const e=$n[t]==null?0:$n[t]+1;return $n[t]=e,t+"-"+e},[t,n])}function _i(t){return function(n){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return r.reduce((i,a)=>{const s=Object.entries(a);for(const[l,u]of s){const c=i[l];c!=null&&(i[l]=c+t*u)}return i},{...n})}}const he=_i(1),en=_i(-1);function Cl(t){return"clientX"in t&&"clientY"in t}function dr(t){if(!t)return!1;const{KeyboardEvent:n}=Dt(t.target);return n&&t instanceof n}function El(t){if(!t)return!1;const{TouchEvent:n}=Dt(t.target);return n&&t instanceof n}function Jn(t){if(El(t)){if(t.touches&&t.touches.length){const{clientX:n,clientY:e}=t.touches[0];return{x:n,y:e}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:n,clientY:e}=t.changedTouches[0];return{x:n,y:e}}}return Cl(t)?{x:t.clientX,y:t.clientY}:null}const je=Object.freeze({Translate:{toString(t){if(!t)return;const{x:n,y:e}=t;return"translate3d("+(n?Math.round(n):0)+"px, "+(e?Math.round(e):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:n,scaleY:e}=t;return"scaleX("+n+") scaleY("+e+")"}},Transform:{toString(t){if(t)return[je.Translate.toString(t),je.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:n,duration:e,easing:r}=t;return n+" "+e+"ms "+r}}}),ro="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Sl(t){return t.matches(ro)?t:t.querySelector(ro)}const Rl={display:"none"};function Al(t){let{id:n,value:e}=t;return Tt.createElement("div",{id:n,style:Rl},e)}function Nl(t){let{id:n,announcement:e,ariaLiveType:r="assertive"}=t;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Tt.createElement("div",{id:n,style:o,role:"status","aria-live":r,"aria-atomic":!0},e)}function Il(){const[t,n]=D.useState("");return{announce:D.useCallback(r=>{r!=null&&n(r)},[]),announcement:t}}const ki=D.createContext(null);function Tl(t){const n=D.useContext(ki);D.useEffect(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(t)},[t,n])}function Dl(){const[t]=D.useState(()=>new Set),n=D.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[D.useCallback(r=>{let{type:o,event:i}=r;t.forEach(a=>{var s;return(s=a[o])==null?void 0:s.call(a,i)})},[t]),n]}const zl={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},jl={onDragStart(t){let{active:n}=t;return"Picked up draggable item "+n.id+"."},onDragOver(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was moved over droppable area "+e.id+".":"Draggable item "+n.id+" is no longer over a droppable area."},onDragEnd(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was dropped over droppable area "+e.id:"Draggable item "+n.id+" was dropped."},onDragCancel(t){let{active:n}=t;return"Dragging was cancelled. Draggable item "+n.id+" was dropped."}};function Ml(t){let{announcements:n=jl,container:e,hiddenTextDescribedById:r,screenReaderInstructions:o=zl}=t;const{announce:i,announcement:a}=Il(),s=Pe("DndLiveRegion"),[l,u]=D.useState(!1);if(D.useEffect(()=>{u(!0)},[]),Tl(D.useMemo(()=>({onDragStart(g){let{active:f}=g;i(n.onDragStart({active:f}))},onDragMove(g){let{active:f,over:d}=g;n.onDragMove&&i(n.onDragMove({active:f,over:d}))},onDragOver(g){let{active:f,over:d}=g;i(n.onDragOver({active:f,over:d}))},onDragEnd(g){let{active:f,over:d}=g;i(n.onDragEnd({active:f,over:d}))},onDragCancel(g){let{active:f,over:d}=g;i(n.onDragCancel({active:f,over:d}))}}),[i,n])),!l)return null;const c=Tt.createElement(Tt.Fragment,null,Tt.createElement(Al,{id:r,value:o.draggable}),Tt.createElement(Nl,{id:s,announcement:a}));return e?Se.createPortal(c,e):c}var Et;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Et||(Et={}));function nn(){}function oo(t,n){return D.useMemo(()=>({sensor:t,options:n??{}}),[t,n])}function Ll(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return D.useMemo(()=>[...n].filter(r=>r!=null),[...n])}const Pt=Object.freeze({x:0,y:0});function Bl(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function Pl(t,n){let{data:{value:e}}=t,{data:{value:r}}=n;return e-r}function Ol(t,n){let{data:{value:e}}=t,{data:{value:r}}=n;return r-e}function Fl(t,n){if(!t||t.length===0)return null;const[e]=t;return e[n]}function io(t,n,e){return n===void 0&&(n=t.left),e===void 0&&(e=t.top),{x:n+t.width*.5,y:e+t.height*.5}}const Ul=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:r}=t;const o=io(n,n.left,n.top),i=[];for(const a of r){const{id:s}=a,l=e.get(s);if(l){const u=Bl(io(l),o);i.push({id:s,data:{droppableContainer:a,value:u}})}}return i.sort(Pl)};function Wl(t,n){const e=Math.max(n.top,t.top),r=Math.max(n.left,t.left),o=Math.min(n.left+n.width,t.left+t.width),i=Math.min(n.top+n.height,t.top+t.height),a=o-r,s=i-e;if(r<o&&e<i){const l=n.width*n.height,u=t.width*t.height,c=a*s,g=c/(l+u-c);return Number(g.toFixed(4))}return 0}const ql=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:r}=t;const o=[];for(const i of r){const{id:a}=i,s=e.get(a);if(s){const l=Wl(s,n);l>0&&o.push({id:a,data:{droppableContainer:i,value:l}})}}return o.sort(Ol)};function $l(t,n,e){return{...t,scaleX:n&&e?n.width/e.width:1,scaleY:n&&e?n.height/e.height:1}}function Ci(t,n){return t&&n?{x:t.left-n.left,y:t.top-n.top}:Pt}function Vl(t){return function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.reduce((a,s)=>({...a,top:a.top+t*s.y,bottom:a.bottom+t*s.y,left:a.left+t*s.x,right:a.right+t*s.x}),{...e})}}const Hl=Vl(1);function Gl(t){if(t.startsWith("matrix3d(")){const n=t.slice(9,-1).split(/, /);return{x:+n[12],y:+n[13],scaleX:+n[0],scaleY:+n[5]}}else if(t.startsWith("matrix(")){const n=t.slice(7,-1).split(/, /);return{x:+n[4],y:+n[5],scaleX:+n[0],scaleY:+n[3]}}return null}function Yl(t,n,e){const r=Gl(n);if(!r)return t;const{scaleX:o,scaleY:i,x:a,y:s}=r,l=t.left-a-(1-o)*parseFloat(e),u=t.top-s-(1-i)*parseFloat(e.slice(e.indexOf(" ")+1)),c=o?t.width/o:t.width,g=i?t.height/i:t.height;return{width:c,height:g,top:u,right:l+c,bottom:u+g,left:l}}const Zl={ignoreTransform:!1};function ve(t,n){n===void 0&&(n=Zl);let e=t.getBoundingClientRect();if(n.ignoreTransform){const{transform:u,transformOrigin:c}=Dt(t).getComputedStyle(t);u&&(e=Yl(e,u,c))}const{top:r,left:o,width:i,height:a,bottom:s,right:l}=e;return{top:r,left:o,width:i,height:a,bottom:s,right:l}}function so(t){return ve(t,{ignoreTransform:!0})}function Xl(t){const n=t.innerWidth,e=t.innerHeight;return{top:0,left:0,right:n,bottom:e,width:n,height:e}}function Kl(t,n){return n===void 0&&(n=Dt(t).getComputedStyle(t)),n.position==="fixed"}function Ql(t,n){n===void 0&&(n=Dt(t).getComputedStyle(t));const e=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=n[o];return typeof i=="string"?e.test(i):!1})}function ur(t,n){const e=[];function r(o){if(n!=null&&e.length>=n||!o)return e;if(lr(o)&&o.scrollingElement!=null&&!e.includes(o.scrollingElement))return e.push(o.scrollingElement),e;if(!Le(o)||xi(o)||e.includes(o))return e;const i=Dt(t).getComputedStyle(o);return o!==t&&Ql(o,i)&&e.push(o),Kl(o,i)?e:r(o.parentNode)}return t?r(t):e}function Ei(t){const[n]=ur(t,1);return n??null}function Vn(t){return!an||!t?null:be(t)?t:ar(t)?lr(t)||t===ye(t).scrollingElement?window:Le(t)?t:null:null}function Si(t){return be(t)?t.scrollX:t.scrollLeft}function Ri(t){return be(t)?t.scrollY:t.scrollTop}function tr(t){return{x:Si(t),y:Ri(t)}}var At;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(At||(At={}));function Ai(t){return!an||!t?!1:t===document.scrollingElement}function Ni(t){const n={x:0,y:0},e=Ai(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-e.width,y:t.scrollHeight-e.height},o=t.scrollTop<=n.y,i=t.scrollLeft<=n.x,a=t.scrollTop>=r.y,s=t.scrollLeft>=r.x;return{isTop:o,isLeft:i,isBottom:a,isRight:s,maxScroll:r,minScroll:n}}const Jl={x:.2,y:.2};function tc(t,n,e,r,o){let{top:i,left:a,right:s,bottom:l}=e;r===void 0&&(r=10),o===void 0&&(o=Jl);const{isTop:u,isBottom:c,isLeft:g,isRight:f}=Ni(t),d={x:0,y:0},y={x:0,y:0},h={height:n.height*o.y,width:n.width*o.x};return!u&&i<=n.top+h.height?(d.y=At.Backward,y.y=r*Math.abs((n.top+h.height-i)/h.height)):!c&&l>=n.bottom-h.height&&(d.y=At.Forward,y.y=r*Math.abs((n.bottom-h.height-l)/h.height)),!f&&s>=n.right-h.width?(d.x=At.Forward,y.x=r*Math.abs((n.right-h.width-s)/h.width)):!g&&a<=n.left+h.width&&(d.x=At.Backward,y.x=r*Math.abs((n.left+h.width-a)/h.width)),{direction:d,speed:y}}function ec(t){if(t===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:n,left:e,right:r,bottom:o}=t.getBoundingClientRect();return{top:n,left:e,right:r,bottom:o,width:t.clientWidth,height:t.clientHeight}}function Ii(t){return t.reduce((n,e)=>he(n,tr(e)),Pt)}function nc(t){return t.reduce((n,e)=>n+Si(e),0)}function rc(t){return t.reduce((n,e)=>n+Ri(e),0)}function oc(t,n){if(n===void 0&&(n=ve),!t)return;const{top:e,left:r,bottom:o,right:i}=n(t);Ei(t)&&(o<=0||i<=0||e>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const ic=[["x",["left","right"],nc],["y",["top","bottom"],rc]];class fr{constructor(n,e){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=ur(e),o=Ii(r);this.rect={...n},this.width=n.width,this.height=n.height;for(const[i,a,s]of ic)for(const l of a)Object.defineProperty(this,l,{get:()=>{const u=s(r),c=o[i]-u;return this.rect[l]+c},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ne{constructor(n){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...e)})},this.target=n}add(n,e,r){var o;(o=this.target)==null||o.addEventListener(n,e,r),this.listeners.push([n,e,r])}}function sc(t){const{EventTarget:n}=Dt(t);return t instanceof n?t:ye(t)}function Hn(t,n){const e=Math.abs(t.x),r=Math.abs(t.y);return typeof n=="number"?Math.sqrt(e**2+r**2)>n:"x"in n&&"y"in n?e>n.x&&r>n.y:"x"in n?e>n.x:"y"in n?r>n.y:!1}var Bt;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Bt||(Bt={}));function ao(t){t.preventDefault()}function ac(t){t.stopPropagation()}var pt;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(pt||(pt={}));const Ti={start:[pt.Space,pt.Enter],cancel:[pt.Esc],end:[pt.Space,pt.Enter,pt.Tab]},lc=(t,n)=>{let{currentCoordinates:e}=n;switch(t.code){case pt.Right:return{...e,x:e.x+25};case pt.Left:return{...e,x:e.x-25};case pt.Down:return{...e,y:e.y+25};case pt.Up:return{...e,y:e.y-25}}};class Di{constructor(n){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=n;const{event:{target:e}}=n;this.props=n,this.listeners=new Ne(ye(e)),this.windowListeners=new Ne(Dt(e)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Bt.Resize,this.handleCancel),this.windowListeners.add(Bt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Bt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:n,onStart:e}=this.props,r=n.node.current;r&&oc(r),e(Pt)}handleKeyDown(n){if(dr(n)){const{active:e,context:r,options:o}=this.props,{keyboardCodes:i=Ti,coordinateGetter:a=lc,scrollBehavior:s="smooth"}=o,{code:l}=n;if(i.end.includes(l)){this.handleEnd(n);return}if(i.cancel.includes(l)){this.handleCancel(n);return}const{collisionRect:u}=r.current,c=u?{x:u.left,y:u.top}:Pt;this.referenceCoordinates||(this.referenceCoordinates=c);const g=a(n,{active:e,context:r.current,currentCoordinates:c});if(g){const f=en(g,c),d={x:0,y:0},{scrollableAncestors:y}=r.current;for(const h of y){const v=n.code,{isTop:b,isRight:w,isLeft:k,isBottom:x,maxScroll:S,minScroll:A}=Ni(h),I=ec(h),N={x:Math.min(v===pt.Right?I.right-I.width/2:I.right,Math.max(v===pt.Right?I.left:I.left+I.width/2,g.x)),y:Math.min(v===pt.Down?I.bottom-I.height/2:I.bottom,Math.max(v===pt.Down?I.top:I.top+I.height/2,g.y))},z=v===pt.Right&&!w||v===pt.Left&&!k,j=v===pt.Down&&!x||v===pt.Up&&!b;if(z&&N.x!==g.x){const P=h.scrollLeft+f.x,_=v===pt.Right&&P<=S.x||v===pt.Left&&P>=A.x;if(_&&!f.y){h.scrollTo({left:P,behavior:s});return}_?d.x=h.scrollLeft-P:d.x=v===pt.Right?h.scrollLeft-S.x:h.scrollLeft-A.x,d.x&&h.scrollBy({left:-d.x,behavior:s});break}else if(j&&N.y!==g.y){const P=h.scrollTop+f.y,_=v===pt.Down&&P<=S.y||v===pt.Up&&P>=A.y;if(_&&!f.x){h.scrollTo({top:P,behavior:s});return}_?d.y=h.scrollTop-P:d.y=v===pt.Down?h.scrollTop-S.y:h.scrollTop-A.y,d.y&&h.scrollBy({top:-d.y,behavior:s});break}}this.handleMove(n,he(en(g,this.referenceCoordinates),d))}}}handleMove(n,e){const{onMove:r}=this.props;n.preventDefault(),r(e)}handleEnd(n){const{onEnd:e}=this.props;n.preventDefault(),this.detach(),e()}handleCancel(n){const{onCancel:e}=this.props;n.preventDefault(),this.detach(),e()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Di.activators=[{eventName:"onKeyDown",handler:(t,n,e)=>{let{keyboardCodes:r=Ti,onActivation:o}=n,{active:i}=e;const{code:a}=t.nativeEvent;if(r.start.includes(a)){const s=i.activatorNode.current;return s&&t.target!==s?!1:(t.preventDefault(),o?.({event:t.nativeEvent}),!0)}return!1}}];function lo(t){return!!(t&&"distance"in t)}function co(t){return!!(t&&"delay"in t)}class hr{constructor(n,e,r){var o;r===void 0&&(r=sc(n.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=n,this.events=e;const{event:i}=n,{target:a}=i;this.props=n,this.events=e,this.document=ye(a),this.documentListeners=new Ne(this.document),this.listeners=new Ne(r),this.windowListeners=new Ne(Dt(a)),this.initialCoordinates=(o=Jn(i))!=null?o:Pt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:n,props:{options:{activationConstraint:e,bypassActivationConstraint:r}}}=this;if(this.listeners.add(n.move.name,this.handleMove,{passive:!1}),this.listeners.add(n.end.name,this.handleEnd),n.cancel&&this.listeners.add(n.cancel.name,this.handleCancel),this.windowListeners.add(Bt.Resize,this.handleCancel),this.windowListeners.add(Bt.DragStart,ao),this.windowListeners.add(Bt.VisibilityChange,this.handleCancel),this.windowListeners.add(Bt.ContextMenu,ao),this.documentListeners.add(Bt.Keydown,this.handleKeydown),e){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(co(e)){this.timeoutId=setTimeout(this.handleStart,e.delay),this.handlePending(e);return}if(lo(e)){this.handlePending(e);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(n,e){const{active:r,onPending:o}=this.props;o(r,n,this.initialCoordinates,e)}handleStart(){const{initialCoordinates:n}=this,{onStart:e}=this.props;n&&(this.activated=!0,this.documentListeners.add(Bt.Click,ac,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Bt.SelectionChange,this.removeTextSelection),e(n))}handleMove(n){var e;const{activated:r,initialCoordinates:o,props:i}=this,{onMove:a,options:{activationConstraint:s}}=i;if(!o)return;const l=(e=Jn(n))!=null?e:Pt,u=en(o,l);if(!r&&s){if(lo(s)){if(s.tolerance!=null&&Hn(u,s.tolerance))return this.handleCancel();if(Hn(u,s.distance))return this.handleStart()}if(co(s)&&Hn(u,s.tolerance))return this.handleCancel();this.handlePending(s,u);return}n.cancelable&&n.preventDefault(),a(l)}handleEnd(){const{onAbort:n,onEnd:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleCancel(){const{onAbort:n,onCancel:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleKeydown(n){n.code===pt.Esc&&this.handleCancel()}removeTextSelection(){var n;(n=this.document.getSelection())==null||n.removeAllRanges()}}const cc={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class pr extends hr{constructor(n){const{event:e}=n,r=ye(e.target);super(n,cc,r)}}pr.activators=[{eventName:"onPointerDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;return!e.isPrimary||e.button!==0?!1:(r?.({event:e}),!0)}}];const dc={move:{name:"mousemove"},end:{name:"mouseup"}};var er;(function(t){t[t.RightClick=2]="RightClick"})(er||(er={}));class uc extends hr{constructor(n){super(n,dc,ye(n.event.target))}}uc.activators=[{eventName:"onMouseDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;return e.button===er.RightClick?!1:(r?.({event:e}),!0)}}];const Gn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class zi extends hr{constructor(n){super(n,Gn)}static setup(){return window.addEventListener(Gn.move.name,n,{capture:!1,passive:!1}),function(){window.removeEventListener(Gn.move.name,n)};function n(){}}}zi.activators=[{eventName:"onTouchStart",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;const{touches:o}=e;return o.length>1?!1:(r?.({event:e}),!0)}}];var Ie;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Ie||(Ie={}));var rn;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(rn||(rn={}));function fc(t){let{acceleration:n,activator:e=Ie.Pointer,canScroll:r,draggingRect:o,enabled:i,interval:a=5,order:s=rn.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:c,delta:g,threshold:f}=t;const d=pc({delta:g,disabled:!i}),[y,h]=kl(),v=D.useRef({x:0,y:0}),b=D.useRef({x:0,y:0}),w=D.useMemo(()=>{switch(e){case Ie.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Ie.DraggableRect:return o}},[e,o,l]),k=D.useRef(null),x=D.useCallback(()=>{const A=k.current;if(!A)return;const I=v.current.x*b.current.x,N=v.current.y*b.current.y;A.scrollBy(I,N)},[]),S=D.useMemo(()=>s===rn.TreeOrder?[...u].reverse():u,[s,u]);D.useEffect(()=>{if(!i||!u.length||!w){h();return}for(const A of S){if(r?.(A)===!1)continue;const I=u.indexOf(A),N=c[I];if(!N)continue;const{direction:z,speed:j}=tc(A,N,w,n,f);for(const P of["x","y"])d[P][z[P]]||(j[P]=0,z[P]=0);if(j.x>0||j.y>0){h(),k.current=A,y(x,a),v.current=j,b.current=z;return}}v.current={x:0,y:0},b.current={x:0,y:0},h()},[n,x,r,h,i,a,JSON.stringify(w),JSON.stringify(d),y,u,S,c,JSON.stringify(f)])}const hc={x:{[At.Backward]:!1,[At.Forward]:!1},y:{[At.Backward]:!1,[At.Forward]:!1}};function pc(t){let{delta:n,disabled:e}=t;const r=Qn(n);return Be(o=>{if(e||!r||!o)return hc;const i={x:Math.sign(n.x-r.x),y:Math.sign(n.y-r.y)};return{x:{[At.Backward]:o.x[At.Backward]||i.x===-1,[At.Forward]:o.x[At.Forward]||i.x===1},y:{[At.Backward]:o.y[At.Backward]||i.y===-1,[At.Forward]:o.y[At.Forward]||i.y===1}}},[e,n,r])}function mc(t,n){const e=n!=null?t.get(n):void 0,r=e?e.node.current:null;return Be(o=>{var i;return n==null?null:(i=r??o)!=null?i:null},[r,n])}function gc(t,n){return D.useMemo(()=>t.reduce((e,r)=>{const{sensor:o}=r,i=o.activators.map(a=>({eventName:a.eventName,handler:n(a.handler,r)}));return[...e,...i]},[]),[t,n])}var Me;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Me||(Me={}));var nr;(function(t){t.Optimized="optimized"})(nr||(nr={}));const uo=new Map;function bc(t,n){let{dragging:e,dependencies:r,config:o}=n;const[i,a]=D.useState(null),{frequency:s,measure:l,strategy:u}=o,c=D.useRef(t),g=v(),f=ze(g),d=D.useCallback(function(b){b===void 0&&(b=[]),!f.current&&a(w=>w===null?b:w.concat(b.filter(k=>!w.includes(k))))},[f]),y=D.useRef(null),h=Be(b=>{if(g&&!e)return uo;if(!b||b===uo||c.current!==t||i!=null){const w=new Map;for(let k of t){if(!k)continue;if(i&&i.length>0&&!i.includes(k.id)&&k.rect.current){w.set(k.id,k.rect.current);continue}const x=k.node.current,S=x?new fr(l(x),x):null;k.rect.current=S,S&&w.set(k.id,S)}return w}return b},[t,i,e,g,l]);return D.useEffect(()=>{c.current=t},[t]),D.useEffect(()=>{g||d()},[e,g]),D.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),D.useEffect(()=>{g||typeof s!="number"||y.current!==null||(y.current=setTimeout(()=>{d(),y.current=null},s))},[s,g,d,...r]),{droppableRects:h,measureDroppableContainers:d,measuringScheduled:i!=null};function v(){switch(u){case Me.Always:return!1;case Me.BeforeDragging:return e;default:return!e}}}function ji(t,n){return Be(e=>t?e||(typeof n=="function"?n(t):t):null,[n,t])}function yc(t,n){return ji(t,n)}function vc(t){let{callback:n,disabled:e}=t;const r=cr(n),o=D.useMemo(()=>{if(e||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,e]);return D.useEffect(()=>()=>o?.disconnect(),[o]),o}function ln(t){let{callback:n,disabled:e}=t;const r=cr(n),o=D.useMemo(()=>{if(e||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[e]);return D.useEffect(()=>()=>o?.disconnect(),[o]),o}function wc(t){return new fr(ve(t),t)}function fo(t,n,e){n===void 0&&(n=wc);const[r,o]=D.useState(null);function i(){o(l=>{if(!t)return null;if(t.isConnected===!1){var u;return(u=l??e)!=null?u:null}const c=n(t);return JSON.stringify(l)===JSON.stringify(c)?l:c})}const a=vc({callback(l){if(t)for(const u of l){const{type:c,target:g}=u;if(c==="childList"&&g instanceof HTMLElement&&g.contains(t)){i();break}}}}),s=ln({callback:i});return qt(()=>{i(),t?(s?.observe(t),a?.observe(document.body,{childList:!0,subtree:!0})):(s?.disconnect(),a?.disconnect())},[t]),r}function xc(t){const n=ji(t);return Ci(t,n)}const ho=[];function _c(t){const n=D.useRef(t),e=Be(r=>t?r&&r!==ho&&t&&n.current&&t.parentNode===n.current.parentNode?r:ur(t):ho,[t]);return D.useEffect(()=>{n.current=t},[t]),e}function kc(t){const[n,e]=D.useState(null),r=D.useRef(t),o=D.useCallback(i=>{const a=Vn(i.target);a&&e(s=>s?(s.set(a,tr(a)),new Map(s)):null)},[]);return D.useEffect(()=>{const i=r.current;if(t!==i){a(i);const s=t.map(l=>{const u=Vn(l);return u?(u.addEventListener("scroll",o,{passive:!0}),[u,tr(u)]):null}).filter(l=>l!=null);e(s.length?new Map(s):null),r.current=t}return()=>{a(t),a(i)};function a(s){s.forEach(l=>{const u=Vn(l);u?.removeEventListener("scroll",o)})}},[o,t]),D.useMemo(()=>t.length?n?Array.from(n.values()).reduce((i,a)=>he(i,a),Pt):Ii(t):Pt,[t,n])}function po(t,n){n===void 0&&(n=[]);const e=D.useRef(null);return D.useEffect(()=>{e.current=null},n),D.useEffect(()=>{const r=t!==Pt;r&&!e.current&&(e.current=t),!r&&e.current&&(e.current=null)},[t]),e.current?en(t,e.current):Pt}function Cc(t){D.useEffect(()=>{if(!an)return;const n=t.map(e=>{let{sensor:r}=e;return r.setup==null?void 0:r.setup()});return()=>{for(const e of n)e?.()}},t.map(n=>{let{sensor:e}=n;return e}))}function Ec(t,n){return D.useMemo(()=>t.reduce((e,r)=>{let{eventName:o,handler:i}=r;return e[o]=a=>{i(a,n)},e},{}),[t,n])}function Mi(t){return D.useMemo(()=>t?Xl(t):null,[t])}const mo=[];function Sc(t,n){n===void 0&&(n=ve);const[e]=t,r=Mi(e?Dt(e):null),[o,i]=D.useState(mo);function a(){i(()=>t.length?t.map(l=>Ai(l)?r:new fr(n(l),l)):mo)}const s=ln({callback:a});return qt(()=>{s?.disconnect(),a(),t.forEach(l=>s?.observe(l))},[t]),o}function Rc(t){if(!t)return null;if(t.children.length>1)return t;const n=t.children[0];return Le(n)?n:t}function Ac(t){let{measure:n}=t;const[e,r]=D.useState(null),o=D.useCallback(u=>{for(const{target:c}of u)if(Le(c)){r(g=>{const f=n(c);return g?{...g,width:f.width,height:f.height}:f});break}},[n]),i=ln({callback:o}),a=D.useCallback(u=>{const c=Rc(u);i?.disconnect(),c&&i?.observe(c),r(c?n(c):null)},[n,i]),[s,l]=tn(a);return D.useMemo(()=>({nodeRef:s,rect:e,setRef:l}),[e,s,l])}const Nc=[{sensor:pr,options:{}},{sensor:Di,options:{}}],Ic={current:{}},Ke={draggable:{measure:so},droppable:{measure:so,strategy:Me.WhileDragging,frequency:nr.Optimized},dragOverlay:{measure:ve}};class Te extends Map{get(n){var e;return n!=null&&(e=super.get(n))!=null?e:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(n=>{let{disabled:e}=n;return!e})}getNodeFor(n){var e,r;return(e=(r=this.get(n))==null?void 0:r.node.current)!=null?e:void 0}}const Tc={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Te,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:nn},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ke,measureDroppableContainers:nn,windowRect:null,measuringScheduled:!1},Dc={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:nn,draggableNodes:new Map,over:null,measureDroppableContainers:nn},cn=D.createContext(Dc),Li=D.createContext(Tc);function zc(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Te}}}function jc(t,n){switch(n.type){case Et.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:n.initialCoordinates,active:n.active}};case Et.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:n.coordinates.x-t.draggable.initialCoordinates.x,y:n.coordinates.y-t.draggable.initialCoordinates.y}}};case Et.DragEnd:case Et.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Et.RegisterDroppable:{const{element:e}=n,{id:r}=e,o=new Te(t.droppable.containers);return o.set(r,e),{...t,droppable:{...t.droppable,containers:o}}}case Et.SetDroppableDisabled:{const{id:e,key:r,disabled:o}=n,i=t.droppable.containers.get(e);if(!i||r!==i.key)return t;const a=new Te(t.droppable.containers);return a.set(e,{...i,disabled:o}),{...t,droppable:{...t.droppable,containers:a}}}case Et.UnregisterDroppable:{const{id:e,key:r}=n,o=t.droppable.containers.get(e);if(!o||r!==o.key)return t;const i=new Te(t.droppable.containers);return i.delete(e),{...t,droppable:{...t.droppable,containers:i}}}default:return t}}function Mc(t){let{disabled:n}=t;const{active:e,activatorEvent:r,draggableNodes:o}=D.useContext(cn),i=Qn(r),a=Qn(e?.id);return D.useEffect(()=>{if(!n&&!r&&i&&a!=null){if(!dr(i)||document.activeElement===i.target)return;const s=o.get(a);if(!s)return;const{activatorNode:l,node:u}=s;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const c of[l.current,u.current]){if(!c)continue;const g=Sl(c);if(g){g.focus();break}}})}},[r,n,o,a,i]),null}function Lc(t,n){let{transform:e,...r}=n;return t!=null&&t.length?t.reduce((o,i)=>i({transform:o,...r}),e):e}function Bc(t){return D.useMemo(()=>({draggable:{...Ke.draggable,...t?.draggable},droppable:{...Ke.droppable,...t?.droppable},dragOverlay:{...Ke.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function Pc(t){let{activeNode:n,measure:e,initialRect:r,config:o=!0}=t;const i=D.useRef(!1),{x:a,y:s}=typeof o=="boolean"?{x:o,y:o}:o;qt(()=>{if(!a&&!s||!n){i.current=!1;return}if(i.current||!r)return;const u=n?.node.current;if(!u||u.isConnected===!1)return;const c=e(u),g=Ci(c,r);if(a||(g.x=0),s||(g.y=0),i.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const f=Ei(u);f&&f.scrollBy({top:g.y,left:g.x})}},[n,a,s,r,e])}const Bi=D.createContext({...Pt,scaleX:1,scaleY:1});var ee;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(ee||(ee={}));const Oc=D.memo(function(n){var e,r,o,i;let{id:a,accessibility:s,autoScroll:l=!0,children:u,sensors:c=Nc,collisionDetection:g=ql,measuring:f,modifiers:d,...y}=n;const h=D.useReducer(jc,void 0,zc),[v,b]=h,[w,k]=Dl(),[x,S]=D.useState(ee.Uninitialized),A=x===ee.Initialized,{draggable:{active:I,nodes:N,translate:z},droppable:{containers:j}}=v,P=I!=null?N.get(I):null,_=D.useRef({initial:null,translated:null}),C=D.useMemo(()=>{var wt;return I!=null?{id:I,data:(wt=P?.data)!=null?wt:Ic,rect:_}:null},[I,P]),p=D.useRef(null),[U,nt]=D.useState(null),[$,F]=D.useState(null),M=ze(y,Object.values(y)),et=Pe("DndDescribedBy",a),O=D.useMemo(()=>j.getEnabled(),[j]),B=Bc(f),{droppableRects:K,measureDroppableContainers:Z,measuringScheduled:G}=bc(O,{dragging:A,dependencies:[z.x,z.y],config:B.droppable}),ct=mc(N,I),it=D.useMemo(()=>$?Jn($):null,[$]),tt=Ue(),X=yc(ct,B.draggable.measure);Pc({activeNode:I!=null?N.get(I):null,config:tt.layoutShiftCompensation,initialRect:X,measure:B.draggable.measure});const rt=fo(ct,B.draggable.measure,X),ut=fo(ct?ct.parentElement:null),mt=D.useRef({activatorEvent:null,active:null,activeNode:ct,collisionRect:null,collisions:null,droppableRects:K,draggableNodes:N,draggingNode:null,draggingNodeRect:null,droppableContainers:j,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),xt=j.getNodeFor((e=mt.current.over)==null?void 0:e.id),m=Ac({measure:B.dragOverlay.measure}),V=(r=m.nodeRef.current)!=null?r:ct,q=A?(o=m.rect)!=null?o:rt:null,T=!!(m.nodeRef.current&&m.rect),R=xc(T?null:rt),L=Mi(V?Dt(V):null),H=_c(A?xt??ct:null),Y=Sc(H),W=Lc(d,{transform:{x:z.x-R.x,y:z.y-R.y,scaleX:1,scaleY:1},activatorEvent:$,active:C,activeNodeRect:rt,containerNodeRect:ut,draggingNodeRect:q,over:mt.current.over,overlayNodeRect:m.rect,scrollableAncestors:H,scrollableAncestorRects:Y,windowRect:L}),Q=it?he(it,z):null,ot=kc(H),J=po(ot),lt=po(ot,[rt]),ht=he(W,J),dt=q?Hl(q,W):null,St=C&&dt?g({active:C,collisionRect:dt,droppableRects:K,droppableContainers:O,pointerCoordinates:Q}):null,Gt=Fl(St,"id"),[kt,Yt]=D.useState(null),vt=T?W:he(W,lt),le=$l(vt,(i=kt?.rect)!=null?i:null,rt),ne=D.useRef(null),Mt=D.useCallback((wt,Rt)=>{let{sensor:zt,options:Zt}=Rt;if(p.current==null)return;const Lt=N.get(p.current);if(!Lt)return;const jt=wt.nativeEvent,Ot=new zt({active:p.current,activeNode:Lt,event:jt,options:Zt,context:mt,onAbort(Nt){if(!N.get(Nt))return;const{onDragAbort:Ft}=M.current,$t={id:Nt};Ft?.($t),w({type:"onDragAbort",event:$t})},onPending(Nt,Xt,Ft,$t){if(!N.get(Nt))return;const{onDragPending:xe}=M.current,Kt={id:Nt,constraint:Xt,initialCoordinates:Ft,offset:$t};xe?.(Kt),w({type:"onDragPending",event:Kt})},onStart(Nt){const Xt=p.current;if(Xt==null)return;const Ft=N.get(Xt);if(!Ft)return;const{onDragStart:$t}=M.current,we={activatorEvent:jt,active:{id:Xt,data:Ft.data,rect:_}};Se.unstable_batchedUpdates(()=>{$t?.(we),S(ee.Initializing),b({type:Et.DragStart,initialCoordinates:Nt,active:Xt}),w({type:"onDragStart",event:we}),nt(ne.current),F(jt)})},onMove(Nt){b({type:Et.DragMove,coordinates:Nt})},onEnd:ce(Et.DragEnd),onCancel:ce(Et.DragCancel)});ne.current=Ot;function ce(Nt){return async function(){const{active:Ft,collisions:$t,over:we,scrollAdjustedTranslate:xe}=mt.current;let Kt=null;if(Ft&&xe){const{cancelDrop:_e}=M.current;Kt={activatorEvent:jt,active:Ft,collisions:$t,delta:xe,over:we},Nt===Et.DragEnd&&typeof _e=="function"&&await Promise.resolve(_e(Kt))&&(Nt=Et.DragCancel)}p.current=null,Se.unstable_batchedUpdates(()=>{b({type:Nt}),S(ee.Uninitialized),Yt(null),nt(null),F(null),ne.current=null;const _e=Nt===Et.DragEnd?"onDragEnd":"onDragCancel";if(Kt){const hn=M.current[_e];hn?.(Kt),w({type:_e,event:Kt})}})}}},[N]),Oe=D.useCallback((wt,Rt)=>(zt,Zt)=>{const Lt=zt.nativeEvent,jt=N.get(Zt);if(p.current!==null||!jt||Lt.dndKit||Lt.defaultPrevented)return;const Ot={active:jt};wt(zt,Rt.options,Ot)===!0&&(Lt.dndKit={capturedBy:Rt.sensor},p.current=Zt,Mt(zt,Rt))},[N,Mt]),Fe=gc(c,Oe);Cc(c),qt(()=>{rt&&x===ee.Initializing&&S(ee.Initialized)},[rt,x]),D.useEffect(()=>{const{onDragMove:wt}=M.current,{active:Rt,activatorEvent:zt,collisions:Zt,over:Lt}=mt.current;if(!Rt||!zt)return;const jt={active:Rt,activatorEvent:zt,collisions:Zt,delta:{x:ht.x,y:ht.y},over:Lt};Se.unstable_batchedUpdates(()=>{wt?.(jt),w({type:"onDragMove",event:jt})})},[ht.x,ht.y]),D.useEffect(()=>{const{active:wt,activatorEvent:Rt,collisions:zt,droppableContainers:Zt,scrollAdjustedTranslate:Lt}=mt.current;if(!wt||p.current==null||!Rt||!Lt)return;const{onDragOver:jt}=M.current,Ot=Zt.get(Gt),ce=Ot&&Ot.rect.current?{id:Ot.id,rect:Ot.rect.current,data:Ot.data,disabled:Ot.disabled}:null,Nt={active:wt,activatorEvent:Rt,collisions:zt,delta:{x:Lt.x,y:Lt.y},over:ce};Se.unstable_batchedUpdates(()=>{Yt(ce),jt?.(Nt),w({type:"onDragOver",event:Nt})})},[Gt]),qt(()=>{mt.current={activatorEvent:$,active:C,activeNode:ct,collisionRect:dt,collisions:St,droppableRects:K,draggableNodes:N,draggingNode:V,draggingNodeRect:q,droppableContainers:j,over:kt,scrollableAncestors:H,scrollAdjustedTranslate:ht},_.current={initial:q,translated:dt}},[C,ct,St,dt,N,V,q,K,j,kt,H,ht]),fc({...tt,delta:z,draggingRect:dt,pointerCoordinates:Q,scrollableAncestors:H,scrollableAncestorRects:Y});const un=D.useMemo(()=>({active:C,activeNode:ct,activeNodeRect:rt,activatorEvent:$,collisions:St,containerNodeRect:ut,dragOverlay:m,draggableNodes:N,droppableContainers:j,droppableRects:K,over:kt,measureDroppableContainers:Z,scrollableAncestors:H,scrollableAncestorRects:Y,measuringConfiguration:B,measuringScheduled:G,windowRect:L}),[C,ct,rt,$,St,ut,m,N,j,K,kt,Z,H,Y,B,G,L]),fn=D.useMemo(()=>({activatorEvent:$,activators:Fe,active:C,activeNodeRect:rt,ariaDescribedById:{draggable:et},dispatch:b,draggableNodes:N,over:kt,measureDroppableContainers:Z}),[$,Fe,C,rt,b,et,N,kt,Z]);return Tt.createElement(ki.Provider,{value:k},Tt.createElement(cn.Provider,{value:fn},Tt.createElement(Li.Provider,{value:un},Tt.createElement(Bi.Provider,{value:le},u)),Tt.createElement(Mc,{disabled:s?.restoreFocus===!1})),Tt.createElement(Ml,{...s,hiddenTextDescribedById:et}));function Ue(){const wt=U?.autoScrollEnabled===!1,Rt=typeof l=="object"?l.enabled===!1:l===!1,zt=A&&!wt&&!Rt;return typeof l=="object"?{...l,enabled:zt}:{enabled:zt}}}),Fc=D.createContext(null),go="button",Uc="Draggable";function Wc(t){let{id:n,data:e,disabled:r=!1,attributes:o}=t;const i=Pe(Uc),{activators:a,activatorEvent:s,active:l,activeNodeRect:u,ariaDescribedById:c,draggableNodes:g,over:f}=D.useContext(cn),{role:d=go,roleDescription:y="draggable",tabIndex:h=0}=o??{},v=l?.id===n,b=D.useContext(v?Bi:Fc),[w,k]=tn(),[x,S]=tn(),A=Ec(a,n),I=ze(e);qt(()=>(g.set(n,{id:n,key:i,node:w,activatorNode:x,data:I}),()=>{const z=g.get(n);z&&z.key===i&&g.delete(n)}),[g,n]);const N=D.useMemo(()=>({role:d,tabIndex:h,"aria-disabled":r,"aria-pressed":v&&d===go?!0:void 0,"aria-roledescription":y,"aria-describedby":c.draggable}),[r,d,h,v,y,c.draggable]);return{active:l,activatorEvent:s,activeNodeRect:u,attributes:N,isDragging:v,listeners:r?void 0:A,node:w,over:f,setNodeRef:k,setActivatorNodeRef:S,transform:b}}function qc(){return D.useContext(Li)}const $c="Droppable",Vc={timeout:25};function Hc(t){let{data:n,disabled:e=!1,id:r,resizeObserverConfig:o}=t;const i=Pe($c),{active:a,dispatch:s,over:l,measureDroppableContainers:u}=D.useContext(cn),c=D.useRef({disabled:e}),g=D.useRef(!1),f=D.useRef(null),d=D.useRef(null),{disabled:y,updateMeasurementsFor:h,timeout:v}={...Vc,...o},b=ze(h??r),w=D.useCallback(()=>{if(!g.current){g.current=!0;return}d.current!=null&&clearTimeout(d.current),d.current=setTimeout(()=>{u(Array.isArray(b.current)?b.current:[b.current]),d.current=null},v)},[v]),k=ln({callback:w,disabled:y||!a}),x=D.useCallback((N,z)=>{k&&(z&&(k.unobserve(z),g.current=!1),N&&k.observe(N))},[k]),[S,A]=tn(x),I=ze(n);return D.useEffect(()=>{!k||!S.current||(k.disconnect(),g.current=!1,k.observe(S.current))},[S,k]),D.useEffect(()=>(s({type:Et.RegisterDroppable,element:{id:r,key:i,disabled:e,node:S,rect:f,data:I}}),()=>s({type:Et.UnregisterDroppable,key:i,id:r})),[r]),D.useEffect(()=>{e!==c.current.disabled&&(s({type:Et.SetDroppableDisabled,id:r,key:i,disabled:e}),c.current.disabled=e)},[r,i,e,s]),{active:a,rect:f,isOver:l?.id===r,node:S,over:l,setNodeRef:A}}function mr(t,n,e){const r=t.slice();return r.splice(e<0?r.length+e:e,0,r.splice(n,1)[0]),r}function Gc(t,n){return t.reduce((e,r,o)=>{const i=n.get(r);return i&&(e[o]=i),e},Array(t.length))}function Ye(t){return t!==null&&t>=0}function Yc(t,n){if(t===n)return!0;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function Zc(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const gr=t=>{let{rects:n,activeIndex:e,overIndex:r,index:o}=t;const i=mr(n,r,e),a=n[o],s=i[o];return!s||!a?null:{x:s.left-a.left,y:s.top-a.top,scaleX:s.width/a.width,scaleY:s.height/a.height}},Pi="Sortable",Oi=Tt.createContext({activeIndex:-1,containerId:Pi,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:gr,disabled:{draggable:!1,droppable:!1}});function Xc(t){let{children:n,id:e,items:r,strategy:o=gr,disabled:i=!1}=t;const{active:a,dragOverlay:s,droppableRects:l,over:u,measureDroppableContainers:c}=qc(),g=Pe(Pi,e),f=s.rect!==null,d=D.useMemo(()=>r.map(A=>typeof A=="object"&&"id"in A?A.id:A),[r]),y=a!=null,h=a?d.indexOf(a.id):-1,v=u?d.indexOf(u.id):-1,b=D.useRef(d),w=!Yc(d,b.current),k=v!==-1&&h===-1||w,x=Zc(i);qt(()=>{w&&y&&c(d)},[w,d,y,c]),D.useEffect(()=>{b.current=d},[d]);const S=D.useMemo(()=>({activeIndex:h,containerId:g,disabled:x,disableTransforms:k,items:d,overIndex:v,useDragOverlay:f,sortedRects:Gc(d,l),strategy:o}),[h,g,x.draggable,x.droppable,k,d,v,l,f,o]);return Tt.createElement(Oi.Provider,{value:S},n)}const Kc=t=>{let{id:n,items:e,activeIndex:r,overIndex:o}=t;return mr(e,r,o).indexOf(n)},Qc=t=>{let{containerId:n,isSorting:e,wasDragging:r,index:o,items:i,newIndex:a,previousItems:s,previousContainerId:l,transition:u}=t;return!u||!r||s!==i&&o===a?!1:e?!0:a!==o&&n===l},Jc={duration:200,easing:"ease"},Fi="transform",td=je.Transition.toString({property:Fi,duration:0,easing:"linear"}),ed={roleDescription:"sortable"};function nd(t){let{disabled:n,index:e,node:r,rect:o}=t;const[i,a]=D.useState(null),s=D.useRef(e);return qt(()=>{if(!n&&e!==s.current&&r.current){const l=o.current;if(l){const u=ve(r.current,{ignoreTransform:!0}),c={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(c.x||c.y)&&a(c)}}e!==s.current&&(s.current=e)},[n,e,r,o]),D.useEffect(()=>{i&&a(null)},[i]),i}function rd(t){let{animateLayoutChanges:n=Qc,attributes:e,disabled:r,data:o,getNewIndex:i=Kc,id:a,strategy:s,resizeObserverConfig:l,transition:u=Jc}=t;const{items:c,containerId:g,activeIndex:f,disabled:d,disableTransforms:y,sortedRects:h,overIndex:v,useDragOverlay:b,strategy:w}=D.useContext(Oi),k=od(r,d),x=c.indexOf(a),S=D.useMemo(()=>({sortable:{containerId:g,index:x,items:c},...o}),[g,o,x,c]),A=D.useMemo(()=>c.slice(c.indexOf(a)),[c,a]),{rect:I,node:N,isOver:z,setNodeRef:j}=Hc({id:a,data:S,disabled:k.droppable,resizeObserverConfig:{updateMeasurementsFor:A,...l}}),{active:P,activatorEvent:_,activeNodeRect:C,attributes:p,setNodeRef:U,listeners:nt,isDragging:$,over:F,setActivatorNodeRef:M,transform:et}=Wc({id:a,data:S,attributes:{...ed,...e},disabled:k.draggable}),O=_l(j,U),B=!!P,K=B&&!y&&Ye(f)&&Ye(v),Z=!b&&$,G=Z&&K?et:null,it=K?G??(s??w)({rects:h,activeNodeRect:C,activeIndex:f,overIndex:v,index:x}):null,tt=Ye(f)&&Ye(v)?i({id:a,items:c,activeIndex:f,overIndex:v}):x,X=P?.id,rt=D.useRef({activeId:X,items:c,newIndex:tt,containerId:g}),ut=c!==rt.current.items,mt=n({active:P,containerId:g,isDragging:$,isSorting:B,id:a,index:x,items:c,newIndex:rt.current.newIndex,previousItems:rt.current.items,previousContainerId:rt.current.containerId,transition:u,wasDragging:rt.current.activeId!=null}),xt=nd({disabled:!mt,index:x,node:N,rect:I});return D.useEffect(()=>{B&&rt.current.newIndex!==tt&&(rt.current.newIndex=tt),g!==rt.current.containerId&&(rt.current.containerId=g),c!==rt.current.items&&(rt.current.items=c)},[B,tt,g,c]),D.useEffect(()=>{if(X===rt.current.activeId)return;if(X!=null&&rt.current.activeId==null){rt.current.activeId=X;return}const V=setTimeout(()=>{rt.current.activeId=X},50);return()=>clearTimeout(V)},[X]),{active:P,activeIndex:f,attributes:p,data:S,rect:I,index:x,newIndex:tt,items:c,isOver:z,isSorting:B,isDragging:$,listeners:nt,node:N,overIndex:v,over:F,setNodeRef:O,setActivatorNodeRef:M,setDroppableNodeRef:j,setDraggableNodeRef:U,transform:xt??it,transition:m()};function m(){if(xt||ut&&rt.current.newIndex===x)return td;if(!(Z&&!dr(_)||!u)&&(B||mt))return je.Transition.toString({...u,property:Fi})}}function od(t,n){var e,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(e=t?.draggable)!=null?e:n.draggable,droppable:(r=t?.droppable)!=null?r:n.droppable}}pt.Down,pt.Right,pt.Up,pt.Left;function id({id:t,children:n}){const{attributes:e,listeners:r,setNodeRef:o,transform:i,transition:a,isDragging:s,isSorting:l}=rd({id:t}),u={transform:je.Translate.toString(i),transition:a,position:"relative",zIndex:s?9999:l?2:1,cursor:s?"grabbing":"grab",touchAction:"none"};return E.jsx("div",{ref:o,style:u,...e,...r,children:n})}async function sd(t,n={}){const e=n.format??"png",r=Math.max(.5,Math.min(.95,n.quality??.8)),o=new ir,i=o.folder("images");if(!i)throw new Error("ZIP: cannot create images/");for(let a=0;a<t.length;a++){const s=await wi(t[a].id,It),l=e==="jpeg"?await ld(s,r):s,u=e==="jpeg"?"jpg":"png",c=`card-${String(a+1).padStart(3,"0")}.${u}`;i.file(c,ad(l)),n.onProgress?.({done:a+1,total:t.length})}return o.generateAsync({type:"blob",compression:"DEFLATE"})}function ad(t){const n=t.indexOf(","),e=t.slice(n+1),r=atob(e),o=new Uint8Array(r.length);for(let i=0;i<r.length;i++)o[i]=r.charCodeAt(i);return o}async function ld(t,n){const e=await cd(t),r=document.createElement("canvas");r.width=Math.max(1,e.naturalWidth||e.width||1),r.height=Math.max(1,e.naturalHeight||e.height||1);const o=r.getContext("2d");if(!o)throw new Error("Canvas2D unavailable");return o.drawImage(e,0,0),r.toDataURL("image/jpeg",n)}function cd(t){return new Promise((n,e)=>{const r=new Image;r.onload=()=>n(r),r.onerror=e,r.src=t})}function bo(t){const n=t/1e3;return n<60?`${n.toFixed(1)}s`:`${Math.floor(n/60)}m ${(n%60).toFixed(0)}s`}class dd extends pr{static activators=[{eventName:"onPointerDown",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}class ud extends zi{static activators=[{eventName:"onTouchStart",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}function fd(){const t=gt(x=>x.photos),n=gt(x=>x.reorderPhotos),[e,r]=D.useState(!1),[o,i]=D.useState(null),a=D.useRef(!1),[s,l]=D.useState("jpeg"),[u,c]=D.useState(ua*100),g=o?.pct??0,f=D.useMemo(()=>{if(!o)return"";const x=o.etaMs??0;return`Rendering ${o.done}/${o.total}  ${g}%  elapsed ${bo(o.elapsedMs)}${o.done<o.total?`  ETA ${bo(x)}`:""}`},[o,g]);D.useEffect(()=>{o&&o.done>=o.total&&i(null)},[o]);const d=D.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{r(!0),i({done:0,total:t.length,elapsedMs:0,pct:0});const x=performance.now(),S=await sd(t,{format:s,quality:s==="jpeg"?u/100:void 0,onProgress:({done:N,total:z})=>{const j=performance.now()-x,P=Math.round(N/z*100);i({done:N,total:z,elapsedMs:j,pct:P})}}),A=URL.createObjectURL(S),I=document.createElement("a");I.href=A,I.download="story-squares-images.zip",document.body.appendChild(I),I.click(),I.remove(),URL.revokeObjectURL(A)}finally{r(!1),a.current=!1}}},[t,s,u]),y=D.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{r(!0);const{exportCardsToPdf:x}=await ks(async()=>{const{exportCardsToPdf:z}=await import("./pdf-DHALY8Bc.js");return{exportCardsToPdf:z}},__vite__mapDeps([0,1,2,3])),S=await x(t,{format:s,quality:s==="jpeg"?u/100:void 0,onProgress:z=>i(z)}),A=new Blob([S],{type:"application/pdf"}),I=URL.createObjectURL(A),N=document.createElement("a");N.href=I,N.download="story-squares.pdf",document.body.appendChild(N),N.click(),N.remove(),URL.revokeObjectURL(I)}finally{r(!1),a.current=!1}}},[t,s,u]),h=D.useCallback(async()=>{r(!0);try{const x=await Ga({imageFormat:s,quality:s==="jpeg"?u/100:void 0,onProgress:({done:I,total:N})=>i({done:I,total:N,elapsedMs:0,pct:Math.round(I/N*100)})}),S=URL.createObjectURL(x),A=document.createElement("a");A.href=S,A.download="story-squares.zip",document.body.appendChild(A),A.click(),A.remove(),URL.revokeObjectURL(S)}finally{r(!1)}},[s,u]),v=Tt.useRef(null),b=D.useCallback(async x=>{try{const{warnings:S}=await li(x);S.length&&alert(`Import finished with warnings:
`+S.join(`
`))}catch(S){alert("Import failed: "+(S?.message||String(S)))}},[]),w=Ll(oo(dd,{activationConstraint:{distance:6}}),oo(ud,{activationConstraint:{delay:120,tolerance:6}})),k=t.map(x=>x.id);return E.jsxs("section",{className:"space-y-3",children:[E.jsx(Oc,{sensors:w,collisionDetection:Ul,onDragEnd:({active:x,over:S})=>{if(!S||x.id===S.id)return;const A=k.indexOf(String(x.id)),I=k.indexOf(String(S.id));if(A===-1||I===-1)return;const N=mr(k,A,I);n(N)},children:E.jsx(Xc,{items:k,strategy:gr,children:E.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:t.map(x=>E.jsx(id,{id:x.id,children:E.jsx(xl,{photo:x})},x.id))})})}),t.length>0&&E.jsxs(ci,{className:"p-4",children:[E.jsx("div",{className:"mb-3 text-sm font-medium",children:"Export the collection to..."}),o&&E.jsxs(E.Fragment,{children:[E.jsx(sr,{value:g,className:"mb-1 h-2"}),E.jsx("div",{className:"mb-3 text-xs opacity-70",children:f})]}),E.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"opacity-70",children:"Format"}),E.jsxs(ol,{value:s,onValueChange:x=>l(x),children:[E.jsx(di,{className:"w-28 h-8",children:E.jsx(il,{placeholder:"Format"})}),E.jsxs(hi,{children:[E.jsx(Kn,{value:"jpeg",children:"JPEG (small)"}),E.jsx(Kn,{value:"png",children:"PNG (lossless)"})]})]})]}),s==="jpeg"&&E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"opacity-70",children:"Quality"}),E.jsx("input",{type:"range",min:50,max:95,step:5,value:u,onChange:x=>c(Number(x.target.value))}),E.jsxs("span",{className:"tabular-nums",children:[u,"%"]})]}),E.jsx("div",{className:"grow"}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx(_t,{type:"button",size:"sm",onClick:h,disabled:!t.length||e,children:"Save collection (.zip)"}),E.jsx("input",{ref:v,type:"file",accept:".zip,application/zip",className:"hidden",onChange:x=>{const S=x.currentTarget.files?.[0];S&&b(S),x.currentTarget.value=""}}),E.jsx(_t,{type:"button",size:"sm",onClick:d,disabled:!t.length||e,children:"Export images (.zip)"}),E.jsx(_t,{type:"button",size:"sm",onClick:y,disabled:!t.length||e,children:e?"Exporting":"Export PDF"})]})]})]})]})}function hd(){const t=Ae(r=>r.busy),n=Ae(r=>r.busyText),e=Ae(r=>r.progress);return t?E.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/60 backdrop-blur-sm","aria-live":"polite","aria-busy":"true",role:"status",children:E.jsxs("div",{className:"flex min-w-64 flex-col items-stretch gap-3 rounded-2xl border bg-background px-4 py-3 shadow-lg",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent","aria-hidden":"true"}),E.jsx("div",{className:"text-sm",children:n??"Loading..."})]}),typeof e=="number"&&E.jsx(sr,{value:e,className:"h-2"})]})}):null}function pd({photoId:t,size:n,selectedId:e,onSelect:r,transform:o,layers:i,background:a,onLayerPatch:s,onTransformPatch:l,canvasRef:u}){return E.jsx(sn,{ref:u,photoId:t,size:n,selectedId:e,onSelect:r,transformOverride:o,layersOverride:i,backgroundOverride:a,onLayerPatch:s,onTransformPatch:l})}function md(t){const{layers:n=[],selectedId:e=null,onSelect:r,bringToFront:o,sendToBack:i,patchLayer:a,removeLayer:s,onFront:l,onBack:u,onToggleVisible:c,onDelete:g}=t,f=D.useCallback(x=>o?o(x):l?.(x),[o,l]),d=D.useCallback(x=>i?i(x):u?.(x),[i,u]),y=D.useCallback(x=>{c?c(x.id):a?.(x.id,{visible:x.visible===!1})},[c,a]),h=D.useCallback(x=>s?s(x):g?.(x),[s,g]),v=D.useMemo(()=>n.slice().sort((x,S)=>(S.z??0)-(x.z??0)).map((x,S)=>({l:x,displayIndex:S+1})),[n]),b=x=>x.name&&x.name.trim()?x.name:x.type==="text"?"Text":x.type==="rect"?"Rect":x.type==="image"&&x.qrText?"QR":x.type==="image"?"Image":"Layer",w=()=>E.jsx("svg",{viewBox:"0 0 24 24",className:"h-4 w-4 opacity-90","aria-hidden":"true",children:E.jsx("path",{d:"M12 5c-6 0-9.5 7-9.5 7s3.5 7 9.5 7 9.5-7 9.5-7-3.5-7-9.5-7Zm0 11a4 4 0 1 1 0-8 4 4 0 0 1 0 8Z",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})}),k=()=>E.jsx("svg",{viewBox:"0 0 24 24",className:"h-4 w-4 text-red-500","aria-hidden":"true",children:E.jsx("path",{d:"M7 7l10 10M17 7L7 17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})});return E.jsx("div",{className:"",children:E.jsxs("div",{className:"space-y-px",children:[v.length===0&&E.jsx("div",{className:"text-sm opacity-60 px-2 py-3",children:"No layers"}),v.map(({l:x,displayIndex:S})=>{const A=e===x.id,I=x.visible!==!1;return E.jsxs("div",{onClick:()=>r?.(x.id),className:["flex items-center gap-2 rounded-lg border transition-colors","px-2 py-0.5 text-[0.95rem] leading-6",A?"bg-neutral-200 dark:bg-neutral-800 ring-neutral-400/50":"bg-background/60 hover:bg-background"].join(" "),children:[E.jsxs("span",{className:"shrink-0 rounded-full bg-foreground/10 px-2 py-0.5 text-xs font-medium",children:["#",S]}),E.jsx("span",{className:"min-w-0 flex-1 truncate",title:b(x),children:b(x)}),E.jsxs("div",{className:"ml-auto flex gap-px pr-px",children:[E.jsx(_t,{type:"button",variant:"secondary",size:"sm",className:"h-7 w-7 rounded-md p-0",title:I?"Hide layer":"Show layer",onClick:N=>{N.stopPropagation(),y(x)},children:I?E.jsx(w,{}):E.jsx(k,{})}),E.jsx(_t,{type:"button",variant:"secondary",size:"sm",className:"h-7 w-7 rounded-md p-0",title:"Move up",onClick:N=>{N.stopPropagation(),f(x.id)},children:E.jsx("svg",{viewBox:"0 0 24 24",className:"h-4 w-4","aria-hidden":"true",children:E.jsx("path",{d:"M7 14l5-5 5 5",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),E.jsx(_t,{type:"button",variant:"secondary",size:"sm",className:"h-7 w-7 rounded-md p-0",title:"Move down",onClick:N=>{N.stopPropagation(),d(x.id)},children:E.jsx("svg",{viewBox:"0 0 24 24",className:"h-4 w-4","aria-hidden":"true",children:E.jsx("path",{d:"M7 10l5 5 5-5",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),E.jsx(_t,{type:"button",variant:"destructive",size:"sm",className:"h-7 rounded-md px-3",title:"Delete layer",onClick:N=>{N.stopPropagation(),h(x.id)},children:"Del"})]})]},x.id)})]})})}const gd=Wo("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Re=D.forwardRef(({className:t,...n},e)=>E.jsx(Po,{ref:e,className:yt(gd(),t),...n}));Re.displayName=Po.displayName;const Qe=D.forwardRef(({className:t,...n},e)=>E.jsxs(Oo,{ref:e,className:yt("relative flex w-full touch-none select-none items-center",t),...n,children:[E.jsx(ms,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:E.jsx(gs,{className:"absolute h-full bg-primary"})}),E.jsx(bs,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Qe.displayName=Oo.displayName;const Ze=bt.get().DEFAULTS.QR;function bd({layer:t,onPatch:n}){const[e,r]=D.useState(t.qrText??Ze.text),[o,i]=D.useState(Math.max(1,Math.round(t.w??t.h??Ze.size))),[a,s]=D.useState(!1);return D.useEffect(()=>{r(t.qrText??Ze.text),i(Math.max(1,Math.round(t.w??t.h??Ze.size)))},[t.id,t.qrText,t.w,t.h]),E.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-foreground/10",children:"QR"}),E.jsx("span",{className:"opacity-70 text-sm",children:"This layer is a QR code"})]}),E.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[E.jsx("label",{className:"text-xs opacity-70",children:"QR text / URL"}),E.jsx("input",{type:"text",value:e,onChange:l=>r(l.target.value),className:"flex-1 min-w-[16rem] rounded border px-2 py-1 text-sm",placeholder:"https://example.com"}),E.jsx("label",{className:"text-xs opacity-70",children:"Size (px)"}),E.jsx("input",{type:"number",min:1,max:It,step:1,value:o,onChange:l=>i(Math.max(1,Number(l.target.value)||1)),className:"w-28 rounded border px-2 py-1 text-sm",title:"QR side size in card pixels"}),E.jsx(_t,{variant:"secondary",disabled:a,onClick:async()=>{const l=e.trim();if(l)try{s(!0);const u=Math.max(1,o),c=await De(l,u);n({qrText:l,w:u,h:u,src:c})}finally{s(!1)}},children:a?"Updating":"Update QR"})]})]})}const Ui=bt.get().DEFAULTS,oe=Ui.TEXT,ie=Ui.RECT;function yd({selectedId:t,layers:n,patchLayer:e,t:r,setT:o,bg:i,setBg:a,onAddText:s,onAddRect:l,onAddQr:u}){const c=t?n.find(f=>f.id===t):null,g=(f,d,y)=>Math.max(d,Math.min(y,f));return E.jsxs("section",{className:"space-y-3",children:[E.jsxs("div",{className:"flex flex-wrap items-center gap-2 overflow-x-hidden max-w-full",children:[E.jsx(_t,{type:"button",variant:"secondary",size:"sm",className:"min-w-0 shrink h-8 px-3",onClick:u,children:"Add QR"}),E.jsx(_t,{type:"button",variant:"secondary",size:"sm",className:"min-w-0 shrink h-8 px-3",onClick:s,children:"Add text layer"}),E.jsx(_t,{type:"button",variant:"secondary",size:"sm",className:"min-w-0 shrink h-8 px-3",onClick:l,children:"Add rectangle"})]}),c?.type==="text"&&E.jsxs("div",{className:"grid gap-2 rounded-md border p-2 bg-background/60",children:[E.jsx("label",{className:"text-xs opacity-70",children:"Text"}),E.jsx("textarea",{value:c.text,onChange:f=>e(c.id,{text:f.target.value}),rows:3,className:"resize-y w-full rounded border px-2 py-1 text-sm bg-background"}),E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsx("label",{className:"text-xs opacity-70",children:"Size"}),E.jsx("input",{type:"number",min:8,max:240,step:1,value:c.fontSize??oe.fontSize,onChange:f=>e(c.id,{fontSize:Number(f.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),E.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${c.fontStyle?.includes("bold")?"bg-foreground/10":""}`,onClick:()=>{const f=c.fontStyle?.includes("bold"),y=`${c.fontStyle?.includes("italic")?"italic":""} ${f?"":"bold"}`.trim();e(c.id,{fontStyle:y})},children:"Bold"}),E.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${c.fontStyle?.includes("italic")?"bg-foreground/10":""}`,onClick:()=>{const f=c.fontStyle?.includes("bold"),y=`${c.fontStyle?.includes("italic")?"":"italic"} ${f?"bold":""}`.trim();e(c.id,{fontStyle:y})},children:"Italic"}),E.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Color"}),E.jsx("input",{type:"color",value:c.fill??oe.fill,onChange:f=>e(c.id,{fill:f.target.value}),className:"h-8 w-10 cursor-pointer"})]}),E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsx("label",{className:"text-xs opacity-70",children:"Font"}),E.jsx("select",{value:c.fontFamily??oe.fontFamily,onChange:async f=>{const d=f.target.value;await yl(d),e(c.id,{fontFamily:d})},className:"rounded border px-2 py-1 text-sm",children:ti.map(f=>E.jsx("option",{value:f.family,children:f.label},f.id))})]}),E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsx("label",{className:"text-xs opacity-70",children:"Align"}),["left","center","right"].map(f=>E.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${c.align===f?"bg-foreground/10":""}`,onClick:()=>e(c.id,{align:f}),children:f},f)),E.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Wrap width"}),E.jsx("input",{type:"number",min:0,max:It,step:10,value:c.width??oe.width,onChange:f=>e(c.id,{width:Number(f.target.value)||void 0}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0 disables wrapping"}),E.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Padding"}),E.jsx("input",{type:"number",min:0,max:200,step:1,value:c.padding??oe.padding,onChange:f=>e(c.id,{padding:Number(f.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),E.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Line height"}),E.jsx("input",{type:"number",min:.8,max:2,step:.05,value:c.lineHeight??oe.lineHeight,onChange:f=>e(c.id,{lineHeight:Number(f.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),E.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Tracking"}),E.jsx("input",{type:"number",min:-5,max:20,step:.5,value:c.letterSpacing??oe.letterSpacing,onChange:f=>e(c.id,{letterSpacing:Number(f.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Additional spacing between glyphs (px, card space)"})]})]}),c?.type==="image"&&c.qrText&&E.jsx(bd,{layer:c,onPatch:f=>e(c.id,f)}),c?.type==="rect"&&E.jsx("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:E.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[E.jsx("label",{className:"text-xs opacity-70",children:"Fill"}),E.jsx("input",{type:"color",value:c.fill??ie.fill,onChange:f=>e(c.id,{fill:f.target.value}),className:"h-8 w-10 cursor-pointer"}),E.jsx("label",{className:"text-xs opacity-70",children:"Stroke"}),E.jsx("input",{type:"color",value:c.stroke??ie.stroke??"#000000",onChange:f=>e(c.id,{stroke:f.target.value}),className:"h-8 w-10 cursor-pointer"}),E.jsx("label",{className:"text-xs opacity-70",children:"Stroke width"}),E.jsx("input",{type:"number",min:0,max:100,step:1,value:c.strokeWidth??ie.strokeWidth,onChange:f=>e(c.id,{strokeWidth:Number(f.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Width in card pixels"}),E.jsx("label",{className:"text-xs opacity-70",children:"Radius"}),E.jsx("input",{type:"number",min:0,max:500,step:1,value:c.cornerRadius??ie.cornerRadius,onChange:f=>e(c.id,{cornerRadius:Number(f.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Corner radius in card pixels"}),E.jsx("label",{className:"text-xs opacity-70",children:"Opacity"}),E.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((c.opacity??ie.opacity)*100),onChange:f=>e(c.id,{opacity:Math.max(0,Math.min(1,Number(f.target.value)/100))}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0..100 %"}),E.jsx("label",{className:"text-xs opacity-70",children:"Width"}),E.jsx("input",{type:"number",min:1,max:It,step:1,value:c.width??ie.width,onChange:f=>e(c.id,{width:Number(f.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),E.jsx("label",{className:"text-xs opacity-70",children:"Height"}),E.jsx("input",{type:"number",min:1,max:It,step:1,value:c.height??ie.height,onChange:f=>e(c.id,{height:Number(f.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"})]})}),E.jsxs("div",{className:"grid gap-3 rounded-md border p-2 bg-background/60",children:[E.jsxs("div",{className:"grid gap-1.5",children:[E.jsxs("div",{className:"flex items-center justify-between text-sm",children:[E.jsx(Re,{children:"Zoom"}),E.jsxs("span",{className:"tabular-nums opacity-70",children:[r.scale.toFixed(2),""]})]}),E.jsx(Qe,{value:[r.scale],min:.5,max:4,step:.01,onValueChange:([f])=>o(d=>({...d,scale:g(f??d.scale,.5,4)}))})]}),E.jsxs("div",{className:"grid gap-1.5",children:[E.jsxs("div",{className:"flex items-center justify-between text-sm",children:[E.jsx(Re,{children:"Horizontal"}),E.jsxs("span",{className:"tabular-nums opacity-70",children:[r.tx.toFixed(0),"%"]})]}),E.jsx(Qe,{value:[r.tx],min:-100,max:100,step:.1,onValueChange:([f])=>o(d=>({...d,tx:f}))})]}),E.jsxs("div",{className:"grid gap-1.5",children:[E.jsxs("div",{className:"flex items-center justify-between text-sm",children:[E.jsx(Re,{children:"Vertical"}),E.jsxs("span",{className:"tabular-nums opacity-70",children:[r.ty.toFixed(0),"%"]})]}),E.jsx(Qe,{value:[r.ty],min:-100,max:100,step:.1,onValueChange:([f])=>o(d=>({...d,ty:f}))})]}),E.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3",children:[E.jsx(Re,{className:"opacity-70",children:"Background"}),E.jsx("label",{className:"text-xs opacity-70",children:"Color"}),E.jsx("input",{type:"color",value:i.color,onChange:f=>a(d=>({...d,color:f.target.value})),className:"h-8 w-10 cursor-pointer"}),E.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Opacity"}),E.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round(i.alpha*100),onChange:f=>a(d=>({...d,alpha:Math.max(0,Math.min(1,Number(f.target.value)/100))})),className:"w-20 rounded border px-2 py-1 text-sm",title:"0..100 %"})]})]})]})}const vd=[],dn=bt.get().DEFAULTS,wd=dn.TEXT,xd=dn.RECT,Ee=dn.QR,yo=dn.BACKGROUND??on;function fe(t){return JSON.parse(JSON.stringify(t))}function te(t){return t.map((n,e)=>({...n,z:e}))}function vo(t,n,e){if(n<0||e<0||n>=t.length||e>=t.length||n===e)return t;const r=t.slice(),o=r[n];return r[n]=r[e],r[e]=o,r}function _d(t){const n=gt(j=>j.layersByPhoto[t]??vd,Object.is),e=gt(j=>j.cardBackground?.[t]??on,Object.is),r=gt(j=>j.transforms[t]??pe),[o,i]=D.useState([]),[a,s]=D.useState(yo),[l,u]=D.useState(r),[c,g]=D.useState(null),d=D.useCallback(()=>{const j=fe(n).sort((P,_)=>(P.z??0)-(_.z??0));i(te(j)),s(e??yo),u({...r}),g(null)},[n,e,r]);D.useEffect(()=>{c&&(o.some(j=>j.id===c)||g(null))},[o,c]);const y=D.useCallback((j,P)=>{i(_=>{const C=_.findIndex(U=>U.id===j);if(C===-1)return _;const p=_.slice();return p[C]={...p[C],...P},p})},[]),h=D.useCallback(j=>{i(P=>{const _=P.findIndex(C=>C.id===j);return _===-1||_===P.length-1?P:te(vo(P,_,_+1))})},[]),v=D.useCallback(j=>{i(P=>{const _=P.findIndex(C=>C.id===j);return _<=0?P:te(vo(P,_,_-1))})},[]),b=h,w=v,k=D.useCallback(j=>{i(P=>te(P.filter(_=>_.id!==j)))},[]),x=D.useCallback(()=>{const j=crypto.randomUUID();return i(P=>te([...P,{id:j,type:"text",...fe(wd),rotation:0,scaleX:1,scaleY:1,visible:!0}])),j},[]),S=D.useCallback(()=>{const j=crypto.randomUUID();return i(P=>te([...P,{id:j,type:"rect",...fe(xd),rotation:0,scaleX:1,scaleY:1,visible:!0}])),j},[]),A=D.useCallback(async j=>{const P=crypto.randomUUID(),_=j&&j.trim()?j.trim():Ee.text,C=Math.max(1,Ee.size),p=await De(_,C);return i(U=>te([...U,{id:P,type:"image",qrText:_,src:p,x:Ee.x,y:Ee.y,w:C,h:C,name:Ee.name,rotation:0,scaleX:1,scaleY:1,visible:!0}])),P},[]),I=D.useCallback(j=>{const P=j.target,_=(P?.tagName||"").toLowerCase();if(!(_==="input"||_==="textarea"||P&&P.isContentEditable===!0)&&c){if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(j.key)){j.preventDefault();const p=j.altKey?1:j.shiftKey?20:5;let U=0,nt=0;j.key==="ArrowLeft"&&(U=-p),j.key==="ArrowRight"&&(U=p),j.key==="ArrowUp"&&(nt=-p),j.key==="ArrowDown"&&(nt=p),i($=>{const F=$.findIndex(O=>O.id===c);if(F===-1)return $;const M=$.slice(),et=M[F];return M[F]={...et,x:(et.x??0)+U,y:(et.y??0)+nt},M});return}(j.key==="Delete"||j.key==="Backspace")&&(j.preventDefault(),k(c),g(null))}},[c,k]),N=D.useCallback(()=>{gt.setState(j=>({...j,transforms:{...j.transforms,[t]:fe(l)},cardBackground:{...j.cardBackground,[t]:fe(a)},layersByPhoto:{...j.layersByPhoto,[t]:fe(te(o))}}))},[t,l,a,o]),z=D.useCallback(()=>{u(pe)},[]);return{layers:o,setLayers:i,bg:a,setBg:s,t:l,setT:u,selectedId:c,setSelectedId:g,patchLayer:y,bringToFront:b,sendToBack:w,removeLayer:k,addTextLayer:x,addRectLayer:S,addQrLayer:A,init:d,onKeyDown:I,save:N,resetImage:z}}function br(...t){return t.filter(Boolean).join(" ")}const kd=_s,Wi=D.forwardRef(({className:t,...n},e)=>E.jsx(ys,{ref:e,className:br("border-0 ring-0 outline-none",t),...n}));Wi.displayName="AccordionItem";const qi=D.forwardRef(({className:t,children:n,...e},r)=>E.jsx(vs,{className:"flex",children:E.jsxs(ws,{ref:r,className:br("flex w-full items-center justify-between py-2 text-left font-medium","outline-none ring-0 focus:ring-0 hover:text-foreground",t),...e,children:[E.jsx("span",{className:"pr-2",children:n}),E.jsx("svg",{className:"h-4 w-4 shrink-0 transition-transform duration-200 data-[state=open]:rotate-180",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:E.jsx("path",{d:"m6 9 6 6 6-6"})})]})}));qi.displayName="AccordionTrigger";const $i=D.forwardRef(({className:t,children:n,...e},r)=>E.jsx(xs,{ref:r,className:br("overflow-hidden border-0","data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",t),...e,children:E.jsx("div",{className:"py-0",children:n})}));$i.displayName="AccordionContent";function Cd({photoId:t,onCancel:n,onSaveDone:e}){const r=gt(_=>_.photos.find(C=>C.id===t)),{layers:o,bg:i,t:a,setT:s,setBg:l,selectedId:u,setSelectedId:c,patchLayer:g,bringToFront:f,sendToBack:d,removeLayer:y,addTextLayer:h,addRectLayer:v,addQrLayer:b,init:w,onKeyDown:k,save:x,resetImage:S}=_d(t);D.useEffect(()=>{w()},[w]);const A=D.useRef(null),I=D.useRef(null),[N,z]=D.useState(0),j=D.useCallback(()=>{const _=A.current;if(!_)return;const C=21,p=8,U=Math.floor(I.current?.offsetHeight||0),nt=_.getBoundingClientRect().top,$=Math.max(0,Math.floor(window.innerHeight-nt-p)),F=Math.max(0,_.clientWidth),M=Math.min(F,Math.max(0,$-U-C));z(Math.max(120,M))},[]);D.useEffect(()=>{j();const _=()=>j();window.addEventListener("resize",_);const C=new ResizeObserver(()=>j());return A.current&&C.observe(A.current),()=>{window.removeEventListener("resize",_),C.disconnect()}},[j]);const P=D.useRef(null);return r?E.jsx("div",{className:"w-full px-0",children:E.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-[minmax(0,1fr)_360px] xl:grid-cols-[minmax(0,1fr)_400px]",children:[E.jsx("div",{ref:A,className:"relative overflow-hidden",children:N>0&&E.jsxs("div",{className:"mx-auto flex flex-col items-center",style:{width:N},children:[E.jsx("div",{className:"w-full overflow-hidden rounded-xl border border-border bg-muted/20",style:{height:N},tabIndex:0,onKeyDown:k,children:E.jsx("div",{className:"relative w-full h-full",children:E.jsx("div",{className:"absolute inset-0 pointer-events-auto z-0",children:E.jsx(pd,{photoId:t,size:N,selectedId:u,onSelect:c,transform:a,layers:o,background:i,onLayerPatch:g,onTransformPatch:_=>s(C=>({...C,..._})),canvasRef:P})})})}),E.jsxs("div",{ref:I,className:"mt-3 flex w-full items-center justify-between",children:[E.jsxs("div",{className:"text-sm opacity-70",children:["Editing: ",E.jsx("span",{className:"font-medium",children:r.name})]}),E.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[E.jsx(_t,{variant:"ghost",onClick:S,children:"Reset image"}),E.jsx(_t,{variant:"secondary",onClick:n,children:"Cancel"}),E.jsx(_t,{onClick:()=>{x(),e()},children:"Save"})]})]})]})}),E.jsx("aside",{className:"lg:sticky lg:top-16 h-max min-w-[320px] overflow-y-auto overflow-x-hidden [scrollbar-gutter:stable]",children:E.jsxs("div",{className:"max-h-[calc(100vh-120px)] overflow-y-auto pr-1",children:[E.jsx(kd,{type:"single",collapsible:!0,defaultValue:"layers",className:"mb-3 border-0 divide-y-0",children:E.jsxs(Wi,{value:"layers",className:"border-0",children:[E.jsx(qi,{className:"text-base px-0 py-2 border-0 outline-none ring-0 hover:no-underline",children:"Layers"}),E.jsx($i,{className:"p-0 border-0",children:E.jsx(md,{layers:o,selectedId:u,onSelect:c,onToggleVisible:_=>g(_,{visible:!o.find(C=>C.id===_)?.visible}),onDelete:_=>{y(_),u===_&&c(null)},onFront:f,onBack:d})})]})}),E.jsx(yd,{selectedId:u,layers:o,patchLayer:g,t:a,setT:s,bg:i,setBg:l,onAddText:()=>{const _=h();c(_)},onAddRect:()=>{const _=v();c(_)},onAddQr:async()=>{const _=await b();c(_)}}),E.jsx("div",{className:"h-3"})]})})]})}):null}function Ed(){const{id:t}=Qi(),n=Eo(),e=gt(r=>r.photos.some(o=>o.id===t));return D.useEffect(()=>{(!t||!e)&&n("/",{replace:!0})},[t,e,n]),!t||!e?null:E.jsx("div",{className:"mx-auto max-w-[min(110rem,98vw)] px-4 py-4",children:E.jsx(Cd,{photoId:t,onCancel:()=>n(-1),onSaveDone:()=>n(-1)})})}function Sd(){return Cs(),E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"sticky top-0 z-10 w-full py-3 text-center text-3xl font-bold bg-background border-b border-gray-300",children:"Story Squares v1.1"}),E.jsxs(Ji,{children:[E.jsx(pn,{path:"/",element:E.jsxs("main",{className:"mx-auto max-w-screen-md px-4 space-y-5",children:[E.jsx(Qa,{}),E.jsx(fd,{})]})}),E.jsx(pn,{path:"/edit/:id",element:E.jsx(Ed,{})}),E.jsx(pn,{path:"*",element:E.jsx(ts,{to:"/",replace:!0})})]}),E.jsx(hd,{})]})}Co.createRoot(document.getElementById("root")).render(E.jsx(Tt.StrictMode,{children:E.jsx(es,{children:E.jsx(Sd,{})})}));export{It as C,ua as P,wi as e};
