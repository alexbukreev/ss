const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-2P9C5zPN.js","assets/jspdf-Cpx4AXLL.js","assets/vendor-react-CkEsgLSR.js","assets/vendor-ui-BqtEeXaX.js"])))=>i.map(i=>d[i]);
import{r as z,j as I,k as fi,m as To,n as Be,C as hi,p as Do,q as zo,S as jo,L as Lo,t as hr,I as pi,T as Bo,v as Po,X as Mo,w as mi,R as It,a as ke}from"./vendor-react-CkEsgLSR.js";import{S as Oo,R as gi,I as Fo,T as bi,a as Uo,b as yi,c as vi,P as Wo,C as wi,V as qo,L as xi,d as _i,e as Go,f as Yo,g as ki,h as Vo,i as Ho,O as Ci,j as Zo,k as Ei,l as $o,m as Si,D as Ri,n as Xo,o as Ai,p as Ni,q as Ko,r as Qo,s as Jo,t as ts}from"./vendor-ui-BqtEeXaX.js";import{_ as es}from"./jspdf-Cpx4AXLL.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();function sn(t){const n=document.documentElement,e=window.matchMedia("(prefers-color-scheme: dark)").matches,o=t==="dark"||t==="system"&&e;n.classList.toggle("dark",o)}function ns(){z.useEffect(()=>{const t=localStorage.getItem("theme")??"system";sn(t);const n=window.matchMedia("(prefers-color-scheme: dark)"),e=()=>{const i=localStorage.getItem("theme")??"system";i==="system"&&sn(i)};n.addEventListener("change",e);const o=i=>{if(i.key==="theme"){const r=i.newValue??"system";sn(r)}};return window.addEventListener("storage",o),()=>{n.removeEventListener("change",e),window.removeEventListener("storage",o)}},[])}function Ii(t){var n,e,o="";if(typeof t=="string"||typeof t=="number")o+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(e=Ii(t[n]))&&(o&&(o+=" "),o+=e)}else for(e in t)t[e]&&(o&&(o+=" "),o+=e);return o}function Ti(){for(var t,n,e=0,o="",i=arguments.length;e<i;e++)(t=arguments[e])&&(n=Ii(t))&&(o&&(o+=" "),o+=n);return o}const pr=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,mr=Ti,Di=(t,n)=>e=>{var o;if(n?.variants==null)return mr(t,e?.class,e?.className);const{variants:i,defaultVariants:r}=n,a=Object.keys(i).map(u=>{const p=e?.[u],m=r?.[u];if(p===null)return null;const g=pr(p)||pr(m);return i[u][g]}),s=e&&Object.entries(e).reduce((u,p)=>{let[m,g]=p;return g===void 0||(u[m]=g),u},{}),l=n==null||(o=n.compoundVariants)===null||o===void 0?void 0:o.reduce((u,p)=>{let{class:m,className:g,...d}=p;return Object.entries(d).every(y=>{let[f,v]=y;return Array.isArray(v)?v.includes({...r,...s}[f]):{...r,...s}[f]===v})?[...u,m,g]:u},[]);return mr(t,a,l,e?.class,e?.className)},Zn="-",rs=t=>{const n=os(t),{conflictingClassGroups:e,conflictingClassGroupModifiers:o}=t;return{getClassGroupId:a=>{const s=a.split(Zn);return s[0]===""&&s.length!==1&&s.shift(),zi(s,n)||is(a)},getConflictingClassGroupIds:(a,s)=>{const l=e[a]||[];return s&&o[a]?[...l,...o[a]]:l}}},zi=(t,n)=>{if(t.length===0)return n.classGroupId;const e=t[0],o=n.nextPart.get(e),i=o?zi(t.slice(1),o):void 0;if(i)return i;if(n.validators.length===0)return;const r=t.join(Zn);return n.validators.find(({validator:a})=>a(r))?.classGroupId},gr=/^\[(.+)\]$/,is=t=>{if(gr.test(t)){const n=gr.exec(t)[1],e=n?.substring(0,n.indexOf(":"));if(e)return"arbitrary.."+e}},os=t=>{const{theme:n,classGroups:e}=t,o={nextPart:new Map,validators:[]};for(const i in e)On(e[i],o,i,n);return o},On=(t,n,e,o)=>{t.forEach(i=>{if(typeof i=="string"){const r=i===""?n:br(n,i);r.classGroupId=e;return}if(typeof i=="function"){if(ss(i)){On(i(o),n,e,o);return}n.validators.push({validator:i,classGroupId:e});return}Object.entries(i).forEach(([r,a])=>{On(a,br(n,r),e,o)})})},br=(t,n)=>{let e=t;return n.split(Zn).forEach(o=>{e.nextPart.has(o)||e.nextPart.set(o,{nextPart:new Map,validators:[]}),e=e.nextPart.get(o)}),e},ss=t=>t.isThemeGetter,as=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,e=new Map,o=new Map;const i=(r,a)=>{e.set(r,a),n++,n>t&&(n=0,o=e,e=new Map)};return{get(r){let a=e.get(r);if(a!==void 0)return a;if((a=o.get(r))!==void 0)return i(r,a),a},set(r,a){e.has(r)?e.set(r,a):i(r,a)}}},Fn="!",Un=":",ls=Un.length,cs=t=>{const{prefix:n,experimentalParseClassName:e}=t;let o=i=>{const r=[];let a=0,s=0,l=0,u;for(let y=0;y<i.length;y++){let f=i[y];if(a===0&&s===0){if(f===Un){r.push(i.slice(l,y)),l=y+ls;continue}if(f==="/"){u=y;continue}}f==="["?a++:f==="]"?a--:f==="("?s++:f===")"&&s--}const p=r.length===0?i:i.substring(l),m=ds(p),g=m!==p,d=u&&u>l?u-l:void 0;return{modifiers:r,hasImportantModifier:g,baseClassName:m,maybePostfixModifierPosition:d}};if(n){const i=n+Un,r=o;o=a=>a.startsWith(i)?r(a.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(e){const i=o;o=r=>e({className:r,parseClassName:i})}return o},ds=t=>t.endsWith(Fn)?t.substring(0,t.length-1):t.startsWith(Fn)?t.substring(1):t,us=t=>{const n=Object.fromEntries(t.orderSensitiveModifiers.map(o=>[o,!0]));return o=>{if(o.length<=1)return o;const i=[];let r=[];return o.forEach(a=>{a[0]==="["||n[a]?(i.push(...r.sort(),a),r=[]):r.push(a)}),i.push(...r.sort()),i}},fs=t=>({cache:as(t.cacheSize),parseClassName:cs(t),sortModifiers:us(t),...rs(t)}),hs=/\s+/,ps=(t,n)=>{const{parseClassName:e,getClassGroupId:o,getConflictingClassGroupIds:i,sortModifiers:r}=n,a=[],s=t.trim().split(hs);let l="";for(let u=s.length-1;u>=0;u-=1){const p=s[u],{isExternal:m,modifiers:g,hasImportantModifier:d,baseClassName:y,maybePostfixModifierPosition:f}=e(p);if(m){l=p+(l.length>0?" "+l:l);continue}let v=!!f,b=o(v?y.substring(0,f):y);if(!b){if(!v){l=p+(l.length>0?" "+l:l);continue}if(b=o(y),!b){l=p+(l.length>0?" "+l:l);continue}v=!1}const x=r(g).join(":"),w=d?x+Fn:x,_=w+b;if(a.includes(_))continue;a.push(_);const N=i(b,v);for(let D=0;D<N.length;++D){const C=N[D];a.push(w+C)}l=p+(l.length>0?" "+l:l)}return l};function ms(){let t=0,n,e,o="";for(;t<arguments.length;)(n=arguments[t++])&&(e=ji(n))&&(o&&(o+=" "),o+=e);return o}const ji=t=>{if(typeof t=="string")return t;let n,e="";for(let o=0;o<t.length;o++)t[o]&&(n=ji(t[o]))&&(e&&(e+=" "),e+=n);return e};function gs(t,...n){let e,o,i,r=a;function a(l){const u=n.reduce((p,m)=>m(p),t());return e=fs(u),o=e.cache.get,i=e.cache.set,r=s,s(l)}function s(l){const u=o(l);if(u)return u;const p=ps(l,e);return i(l,p),p}return function(){return r(ms.apply(null,arguments))}}const kt=t=>{const n=e=>e[t]||[];return n.isThemeGetter=!0,n},Li=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Bi=/^\((?:(\w[\w-]*):)?(.+)\)$/i,bs=/^\d+\/\d+$/,ys=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,vs=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ws=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,xs=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,_s=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ae=t=>bs.test(t),ut=t=>!!t&&!Number.isNaN(Number(t)),Qt=t=>!!t&&Number.isInteger(Number(t)),an=t=>t.endsWith("%")&&ut(t.slice(0,-1)),Yt=t=>ys.test(t),ks=()=>!0,Cs=t=>vs.test(t)&&!ws.test(t),Pi=()=>!1,Es=t=>xs.test(t),Ss=t=>_s.test(t),Rs=t=>!nt(t)&&!rt(t),As=t=>he(t,Fi,Pi),nt=t=>Li.test(t),ne=t=>he(t,Ui,Cs),ln=t=>he(t,zs,ut),yr=t=>he(t,Mi,Pi),Ns=t=>he(t,Oi,Ss),Pe=t=>he(t,Wi,Es),rt=t=>Bi.test(t),xe=t=>pe(t,Ui),Is=t=>pe(t,js),vr=t=>pe(t,Mi),Ts=t=>pe(t,Fi),Ds=t=>pe(t,Oi),Me=t=>pe(t,Wi,!0),he=(t,n,e)=>{const o=Li.exec(t);return o?o[1]?n(o[1]):e(o[2]):!1},pe=(t,n,e=!1)=>{const o=Bi.exec(t);return o?o[1]?n(o[1]):e:!1},Mi=t=>t==="position"||t==="percentage",Oi=t=>t==="image"||t==="url",Fi=t=>t==="length"||t==="size"||t==="bg-size",Ui=t=>t==="length",zs=t=>t==="number",js=t=>t==="family-name",Wi=t=>t==="shadow",Ls=()=>{const t=kt("color"),n=kt("font"),e=kt("text"),o=kt("font-weight"),i=kt("tracking"),r=kt("leading"),a=kt("breakpoint"),s=kt("container"),l=kt("spacing"),u=kt("radius"),p=kt("shadow"),m=kt("inset-shadow"),g=kt("text-shadow"),d=kt("drop-shadow"),y=kt("blur"),f=kt("perspective"),v=kt("aspect"),b=kt("ease"),x=kt("animate"),w=()=>["auto","avoid","all","avoid-page","page","left","right","column"],_=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],N=()=>[..._(),rt,nt],D=()=>["auto","hidden","clip","visible","scroll"],C=()=>["auto","contain","none"],E=()=>[rt,nt,l],R=()=>[ae,"full","auto",...E()],B=()=>[Qt,"none","subgrid",rt,nt],F=()=>["auto",{span:["full",Qt,rt,nt]},Qt,rt,nt],S=()=>[Qt,"auto",rt,nt],k=()=>["auto","min","max","fr",rt,nt],c=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],O=()=>["start","end","center","stretch","center-safe","end-safe"],K=()=>["auto",...E()],q=()=>[ae,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...E()],V=()=>[t,rt,nt],U=()=>[..._(),vr,yr,{position:[rt,nt]}],et=()=>["no-repeat",{repeat:["","x","y","space","round"]}],P=()=>["auto","cover","contain",Ts,As,{size:[rt,nt]}],L=()=>[an,xe,ne],J=()=>["","none","full",u,rt,nt],Z=()=>["",ut,xe,ne],$=()=>["solid","dashed","dotted","double"],dt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],lt=()=>[ut,an,vr,yr],it=()=>["","none",y,rt,nt],at=()=>["none",ut,rt,nt],ot=()=>["none",ut,rt,nt],pt=()=>[ut,rt,nt],gt=()=>[ae,"full",...E()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Yt],breakpoint:[Yt],color:[ks],container:[Yt],"drop-shadow":[Yt],ease:["in","out","in-out"],font:[Rs],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Yt],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Yt],shadow:[Yt],spacing:["px",ut],text:[Yt],"text-shadow":[Yt],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ae,nt,rt,v]}],container:["container"],columns:[{columns:[ut,nt,rt,s]}],"break-after":[{"break-after":w()}],"break-before":[{"break-before":w()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:N()}],overflow:[{overflow:D()}],"overflow-x":[{"overflow-x":D()}],"overflow-y":[{"overflow-y":D()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:R()}],"inset-x":[{"inset-x":R()}],"inset-y":[{"inset-y":R()}],start:[{start:R()}],end:[{end:R()}],top:[{top:R()}],right:[{right:R()}],bottom:[{bottom:R()}],left:[{left:R()}],visibility:["visible","invisible","collapse"],z:[{z:[Qt,"auto",rt,nt]}],basis:[{basis:[ae,"full","auto",s,...E()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ut,ae,"auto","initial","none",nt]}],grow:[{grow:["",ut,rt,nt]}],shrink:[{shrink:["",ut,rt,nt]}],order:[{order:[Qt,"first","last","none",rt,nt]}],"grid-cols":[{"grid-cols":B()}],"col-start-end":[{col:F()}],"col-start":[{"col-start":S()}],"col-end":[{"col-end":S()}],"grid-rows":[{"grid-rows":B()}],"row-start-end":[{row:F()}],"row-start":[{"row-start":S()}],"row-end":[{"row-end":S()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":k()}],"auto-rows":[{"auto-rows":k()}],gap:[{gap:E()}],"gap-x":[{"gap-x":E()}],"gap-y":[{"gap-y":E()}],"justify-content":[{justify:[...c(),"normal"]}],"justify-items":[{"justify-items":[...O(),"normal"]}],"justify-self":[{"justify-self":["auto",...O()]}],"align-content":[{content:["normal",...c()]}],"align-items":[{items:[...O(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...O(),{baseline:["","last"]}]}],"place-content":[{"place-content":c()}],"place-items":[{"place-items":[...O(),"baseline"]}],"place-self":[{"place-self":["auto",...O()]}],p:[{p:E()}],px:[{px:E()}],py:[{py:E()}],ps:[{ps:E()}],pe:[{pe:E()}],pt:[{pt:E()}],pr:[{pr:E()}],pb:[{pb:E()}],pl:[{pl:E()}],m:[{m:K()}],mx:[{mx:K()}],my:[{my:K()}],ms:[{ms:K()}],me:[{me:K()}],mt:[{mt:K()}],mr:[{mr:K()}],mb:[{mb:K()}],ml:[{ml:K()}],"space-x":[{"space-x":E()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":E()}],"space-y-reverse":["space-y-reverse"],size:[{size:q()}],w:[{w:[s,"screen",...q()]}],"min-w":[{"min-w":[s,"screen","none",...q()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[a]},...q()]}],h:[{h:["screen","lh",...q()]}],"min-h":[{"min-h":["screen","lh","none",...q()]}],"max-h":[{"max-h":["screen","lh",...q()]}],"font-size":[{text:["base",e,xe,ne]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[o,rt,ln]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",an,nt]}],"font-family":[{font:[Is,nt,n]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,rt,nt]}],"line-clamp":[{"line-clamp":[ut,"none",rt,ln]}],leading:[{leading:[r,...E()]}],"list-image":[{"list-image":["none",rt,nt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",rt,nt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:V()}],"text-color":[{text:V()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...$(),"wavy"]}],"text-decoration-thickness":[{decoration:[ut,"from-font","auto",rt,ne]}],"text-decoration-color":[{decoration:V()}],"underline-offset":[{"underline-offset":[ut,"auto",rt,nt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:E()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",rt,nt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",rt,nt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:U()}],"bg-repeat":[{bg:et()}],"bg-size":[{bg:P()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Qt,rt,nt],radial:["",rt,nt],conic:[Qt,rt,nt]},Ds,Ns]}],"bg-color":[{bg:V()}],"gradient-from-pos":[{from:L()}],"gradient-via-pos":[{via:L()}],"gradient-to-pos":[{to:L()}],"gradient-from":[{from:V()}],"gradient-via":[{via:V()}],"gradient-to":[{to:V()}],rounded:[{rounded:J()}],"rounded-s":[{"rounded-s":J()}],"rounded-e":[{"rounded-e":J()}],"rounded-t":[{"rounded-t":J()}],"rounded-r":[{"rounded-r":J()}],"rounded-b":[{"rounded-b":J()}],"rounded-l":[{"rounded-l":J()}],"rounded-ss":[{"rounded-ss":J()}],"rounded-se":[{"rounded-se":J()}],"rounded-ee":[{"rounded-ee":J()}],"rounded-es":[{"rounded-es":J()}],"rounded-tl":[{"rounded-tl":J()}],"rounded-tr":[{"rounded-tr":J()}],"rounded-br":[{"rounded-br":J()}],"rounded-bl":[{"rounded-bl":J()}],"border-w":[{border:Z()}],"border-w-x":[{"border-x":Z()}],"border-w-y":[{"border-y":Z()}],"border-w-s":[{"border-s":Z()}],"border-w-e":[{"border-e":Z()}],"border-w-t":[{"border-t":Z()}],"border-w-r":[{"border-r":Z()}],"border-w-b":[{"border-b":Z()}],"border-w-l":[{"border-l":Z()}],"divide-x":[{"divide-x":Z()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Z()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...$(),"hidden","none"]}],"divide-style":[{divide:[...$(),"hidden","none"]}],"border-color":[{border:V()}],"border-color-x":[{"border-x":V()}],"border-color-y":[{"border-y":V()}],"border-color-s":[{"border-s":V()}],"border-color-e":[{"border-e":V()}],"border-color-t":[{"border-t":V()}],"border-color-r":[{"border-r":V()}],"border-color-b":[{"border-b":V()}],"border-color-l":[{"border-l":V()}],"divide-color":[{divide:V()}],"outline-style":[{outline:[...$(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ut,rt,nt]}],"outline-w":[{outline:["",ut,xe,ne]}],"outline-color":[{outline:V()}],shadow:[{shadow:["","none",p,Me,Pe]}],"shadow-color":[{shadow:V()}],"inset-shadow":[{"inset-shadow":["none",m,Me,Pe]}],"inset-shadow-color":[{"inset-shadow":V()}],"ring-w":[{ring:Z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:V()}],"ring-offset-w":[{"ring-offset":[ut,ne]}],"ring-offset-color":[{"ring-offset":V()}],"inset-ring-w":[{"inset-ring":Z()}],"inset-ring-color":[{"inset-ring":V()}],"text-shadow":[{"text-shadow":["none",g,Me,Pe]}],"text-shadow-color":[{"text-shadow":V()}],opacity:[{opacity:[ut,rt,nt]}],"mix-blend":[{"mix-blend":[...dt(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":dt()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ut]}],"mask-image-linear-from-pos":[{"mask-linear-from":lt()}],"mask-image-linear-to-pos":[{"mask-linear-to":lt()}],"mask-image-linear-from-color":[{"mask-linear-from":V()}],"mask-image-linear-to-color":[{"mask-linear-to":V()}],"mask-image-t-from-pos":[{"mask-t-from":lt()}],"mask-image-t-to-pos":[{"mask-t-to":lt()}],"mask-image-t-from-color":[{"mask-t-from":V()}],"mask-image-t-to-color":[{"mask-t-to":V()}],"mask-image-r-from-pos":[{"mask-r-from":lt()}],"mask-image-r-to-pos":[{"mask-r-to":lt()}],"mask-image-r-from-color":[{"mask-r-from":V()}],"mask-image-r-to-color":[{"mask-r-to":V()}],"mask-image-b-from-pos":[{"mask-b-from":lt()}],"mask-image-b-to-pos":[{"mask-b-to":lt()}],"mask-image-b-from-color":[{"mask-b-from":V()}],"mask-image-b-to-color":[{"mask-b-to":V()}],"mask-image-l-from-pos":[{"mask-l-from":lt()}],"mask-image-l-to-pos":[{"mask-l-to":lt()}],"mask-image-l-from-color":[{"mask-l-from":V()}],"mask-image-l-to-color":[{"mask-l-to":V()}],"mask-image-x-from-pos":[{"mask-x-from":lt()}],"mask-image-x-to-pos":[{"mask-x-to":lt()}],"mask-image-x-from-color":[{"mask-x-from":V()}],"mask-image-x-to-color":[{"mask-x-to":V()}],"mask-image-y-from-pos":[{"mask-y-from":lt()}],"mask-image-y-to-pos":[{"mask-y-to":lt()}],"mask-image-y-from-color":[{"mask-y-from":V()}],"mask-image-y-to-color":[{"mask-y-to":V()}],"mask-image-radial":[{"mask-radial":[rt,nt]}],"mask-image-radial-from-pos":[{"mask-radial-from":lt()}],"mask-image-radial-to-pos":[{"mask-radial-to":lt()}],"mask-image-radial-from-color":[{"mask-radial-from":V()}],"mask-image-radial-to-color":[{"mask-radial-to":V()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":_()}],"mask-image-conic-pos":[{"mask-conic":[ut]}],"mask-image-conic-from-pos":[{"mask-conic-from":lt()}],"mask-image-conic-to-pos":[{"mask-conic-to":lt()}],"mask-image-conic-from-color":[{"mask-conic-from":V()}],"mask-image-conic-to-color":[{"mask-conic-to":V()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:U()}],"mask-repeat":[{mask:et()}],"mask-size":[{mask:P()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",rt,nt]}],filter:[{filter:["","none",rt,nt]}],blur:[{blur:it()}],brightness:[{brightness:[ut,rt,nt]}],contrast:[{contrast:[ut,rt,nt]}],"drop-shadow":[{"drop-shadow":["","none",d,Me,Pe]}],"drop-shadow-color":[{"drop-shadow":V()}],grayscale:[{grayscale:["",ut,rt,nt]}],"hue-rotate":[{"hue-rotate":[ut,rt,nt]}],invert:[{invert:["",ut,rt,nt]}],saturate:[{saturate:[ut,rt,nt]}],sepia:[{sepia:["",ut,rt,nt]}],"backdrop-filter":[{"backdrop-filter":["","none",rt,nt]}],"backdrop-blur":[{"backdrop-blur":it()}],"backdrop-brightness":[{"backdrop-brightness":[ut,rt,nt]}],"backdrop-contrast":[{"backdrop-contrast":[ut,rt,nt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ut,rt,nt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ut,rt,nt]}],"backdrop-invert":[{"backdrop-invert":["",ut,rt,nt]}],"backdrop-opacity":[{"backdrop-opacity":[ut,rt,nt]}],"backdrop-saturate":[{"backdrop-saturate":[ut,rt,nt]}],"backdrop-sepia":[{"backdrop-sepia":["",ut,rt,nt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":E()}],"border-spacing-x":[{"border-spacing-x":E()}],"border-spacing-y":[{"border-spacing-y":E()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",rt,nt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ut,"initial",rt,nt]}],ease:[{ease:["linear","initial",b,rt,nt]}],delay:[{delay:[ut,rt,nt]}],animate:[{animate:["none",x,rt,nt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[f,rt,nt]}],"perspective-origin":[{"perspective-origin":N()}],rotate:[{rotate:at()}],"rotate-x":[{"rotate-x":at()}],"rotate-y":[{"rotate-y":at()}],"rotate-z":[{"rotate-z":at()}],scale:[{scale:ot()}],"scale-x":[{"scale-x":ot()}],"scale-y":[{"scale-y":ot()}],"scale-z":[{"scale-z":ot()}],"scale-3d":["scale-3d"],skew:[{skew:pt()}],"skew-x":[{"skew-x":pt()}],"skew-y":[{"skew-y":pt()}],transform:[{transform:[rt,nt,"","none","gpu","cpu"]}],"transform-origin":[{origin:N()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:gt()}],"translate-x":[{"translate-x":gt()}],"translate-y":[{"translate-y":gt()}],"translate-z":[{"translate-z":gt()}],"translate-none":["translate-none"],accent:[{accent:V()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:V()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",rt,nt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":E()}],"scroll-mx":[{"scroll-mx":E()}],"scroll-my":[{"scroll-my":E()}],"scroll-ms":[{"scroll-ms":E()}],"scroll-me":[{"scroll-me":E()}],"scroll-mt":[{"scroll-mt":E()}],"scroll-mr":[{"scroll-mr":E()}],"scroll-mb":[{"scroll-mb":E()}],"scroll-ml":[{"scroll-ml":E()}],"scroll-p":[{"scroll-p":E()}],"scroll-px":[{"scroll-px":E()}],"scroll-py":[{"scroll-py":E()}],"scroll-ps":[{"scroll-ps":E()}],"scroll-pe":[{"scroll-pe":E()}],"scroll-pt":[{"scroll-pt":E()}],"scroll-pr":[{"scroll-pr":E()}],"scroll-pb":[{"scroll-pb":E()}],"scroll-pl":[{"scroll-pl":E()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",rt,nt]}],fill:[{fill:["none",...V()]}],"stroke-w":[{stroke:[ut,xe,ne,ln]}],stroke:[{stroke:["none",...V()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Bs=gs(Ls);function bt(...t){return Bs(Ti(t))}const Ps=Di("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),xt=z.forwardRef(({className:t,variant:n,size:e,asChild:o=!1,...i},r)=>{const a=o?Oo:"button";return I.jsx(a,{className:bt(Ps({variant:n,size:e,className:t})),ref:r,...i})});xt.displayName="Button";const Ms=/^(image\/(jpeg|png|webp|gif|avif|bmp|tiff))$/i;function Os(t){return Ms.test(t.type)}function Fs(t,n=36){const e=[];for(const o of t)if(Os(o)){if(e.length>=n)break;e.push({id:crypto.randomUUID(),url:URL.createObjectURL(o),name:o.name,size:o.size,type:o.type})}return e}function wr(t){for(const n of t)try{URL.revokeObjectURL(n.url)}catch{}}let Wt=null;function Oe(){if(!Wt)throw new Error("ConfigController: not initialized. Call Config.init().")}function xr(t){if(t.MAX_CARDS!=null&&(!Number.isInteger(t.MAX_CARDS)||t.MAX_CARDS<=0))throw new Error("MAX_CARDS must be a positive integer.");if(t.CARD_EXPORT_SIZE!=null&&(!Number.isInteger(t.CARD_EXPORT_SIZE)||t.CARD_EXPORT_SIZE<=0))throw new Error("CARD_EXPORT_SIZE must be a positive integer.");if(t.PREVIEW_EXACT_SIZE!=null&&(!Number.isInteger(t.PREVIEW_EXACT_SIZE)||t.PREVIEW_EXACT_SIZE<=0))throw new Error("PREVIEW_EXACT_SIZE must be a positive integer.");if(t.PREVIEW_FAST_SIZE!=null&&(!Number.isInteger(t.PREVIEW_FAST_SIZE)||t.PREVIEW_FAST_SIZE<=0))throw new Error("PREVIEW_FAST_SIZE must be a positive integer.");if(t.PDF_JPEG_QUALITY!=null&&(t.PDF_JPEG_QUALITY<0||t.PDF_JPEG_QUALITY>1))throw new Error("PDF_JPEG_QUALITY must be within [0..1].");if(t.IMAGE_FIT_MODE!=null&&t.IMAGE_FIT_MODE!=="cover"&&t.IMAGE_FIT_MODE!=="contain")throw new Error("IMAGE_FIT_MODE must be 'cover' or 'contain'.");if(t.INITIAL_ALIGN_X!=null&&!["center","left","right"].includes(t.INITIAL_ALIGN_X))throw new Error("INITIAL_ALIGN_X must be 'center' | 'left' | 'right'.");if(t.INITIAL_ALIGN_Y!=null&&!["center","top","bottom"].includes(t.INITIAL_ALIGN_Y))throw new Error("INITIAL_ALIGN_Y must be 'center' | 'top' | 'bottom'.");if(t.FONT_CATALOG!=null&&!Array.isArray(t.FONT_CATALOG))throw new Error("FONT_CATALOG must be an array.");if(t.DEFAULT_CARD_LAYERS!=null&&!Array.isArray(t.DEFAULT_CARD_LAYERS))throw new Error("DEFAULT_CARD_LAYERS must be an array.");if(t.DEFAULTS!=null&&(typeof t.DEFAULTS!="object"||Array.isArray(t.DEFAULTS)))throw new Error("DEFAULTS must be an object.");if(t.NEAR_SQUARE_TOLERANCE!=null&&(t.NEAR_SQUARE_TOLERANCE<0||t.NEAR_SQUARE_TOLERANCE>.5))throw new Error("NEAR_SQUARE_TOLERANCE must be within [0..0.5].");if(t.NEAR_SQUARE_SCALE!=null&&(t.NEAR_SQUARE_SCALE<=0||t.NEAR_SQUARE_SCALE>1))throw new Error("NEAR_SQUARE_SCALE must be within (0..1].");if(t.LAYER_PROFILES!=null){if(typeof t.LAYER_PROFILES!="object"||Array.isArray(t.LAYER_PROFILES))throw new Error("LAYER_PROFILES must be an object.");for(const[n,e]of Object.entries(t.LAYER_PROFILES)){if(e==null||typeof e!="object"||Array.isArray(e))throw new Error(`LAYER_PROFILES['${n}'] must be an object.`);if(e.on!=null&&typeof e.on!="boolean")throw new Error(`LAYER_PROFILES['${n}'].on must be boolean if provided.`);if(e.landscape!=null&&!Array.isArray(e.landscape))throw new Error(`LAYER_PROFILES['${n}'].landscape must be an array if provided.`);if(e.portrait!=null&&!Array.isArray(e.portrait))throw new Error(`LAYER_PROFILES['${n}'].portrait must be an array if provided.`);if(e.square!=null&&!Array.isArray(e.square))throw new Error(`LAYER_PROFILES['${n}'].square must be an array if provided.`)}}}const vt={init(t){Wt=Object.freeze({...t})},get(){return Oe(),Wt},update(t){return Oe(),xr(t),Wt=Object.freeze({...Wt,...t}),Wt},loadFromJson(t){Oe();const n=t;return xr(n),Wt=Object.freeze({...Wt,...n}),Wt},toJson(){return Oe(),{...Wt}},async loadFromUrl(t){const n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error(`Config.loadFromUrl failed: ${n.status}`);const e=await n.json(),{schemaVersion:o,...i}=e??{};return this.loadFromJson(i)}};vt.init({});const Us="/ss/configs/default.json";await vt.loadFromUrl(Us);const qi=vt.get().MAX_CARDS,Tt=vt.get().CARD_EXPORT_SIZE,Ge=vt.get().PREVIEW_EXACT_SIZE,Ws=vt.get().PREVIEW_FAST_SIZE,qs=vt.get().PDF_JPEG_QUALITY,Wn=vt.get().IMAGE_FIT_MODE,Gs=vt.get().INITIAL_ALIGN_X,Ys=vt.get().INITIAL_ALIGN_Y,Gi=vt.get().FONT_CATALOG;vt.get().NEAR_SQUARE_TOLERANCE;vt.get().NEAR_SQUARE_SCALE;vt.get().DEFAULTS;vt.get().DEFAULT_CARD_LAYERS;var le={},cn,_r;function Vs(){return _r||(_r=1,cn=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),cn}var dn={},Jt={},kr;function re(){if(kr)return Jt;kr=1;let t;const n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Jt.getSymbolSize=function(o){if(!o)throw new Error('"version" cannot be null or undefined');if(o<1||o>40)throw new Error('"version" should be in range from 1 to 40');return o*4+17},Jt.getSymbolTotalCodewords=function(o){return n[o]},Jt.getBCHDigit=function(e){let o=0;for(;e!==0;)o++,e>>>=1;return o},Jt.setToSJISFunction=function(o){if(typeof o!="function")throw new Error('"toSJISFunc" is not a valid function.');t=o},Jt.isKanjiModeEnabled=function(){return typeof t<"u"},Jt.toSJIS=function(o){return t(o)},Jt}var un={},Cr;function $n(){return Cr||(Cr=1,function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function n(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}t.isValid=function(o){return o&&typeof o.bit<"u"&&o.bit>=0&&o.bit<4},t.from=function(o,i){if(t.isValid(o))return o;try{return n(o)}catch{return i}}}(un)),un}var fn,Er;function Hs(){if(Er)return fn;Er=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(n){const e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let o=0;o<e;o++)this.putBit((n>>>e-o-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}},fn=t,fn}var hn,Sr;function Zs(){if(Sr)return hn;Sr=1;function t(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}return t.prototype.set=function(n,e,o,i){const r=n*this.size+e;this.data[r]=o,i&&(this.reservedBit[r]=!0)},t.prototype.get=function(n,e){return this.data[n*this.size+e]},t.prototype.xor=function(n,e,o){this.data[n*this.size+e]^=o},t.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]},hn=t,hn}var pn={},Rr;function $s(){return Rr||(Rr=1,function(t){const n=re().getSymbolSize;t.getRowColCoords=function(o){if(o===1)return[];const i=Math.floor(o/7)+2,r=n(o),a=r===145?26:Math.ceil((r-13)/(2*i-2))*2,s=[r-7];for(let l=1;l<i-1;l++)s[l]=s[l-1]-a;return s.push(6),s.reverse()},t.getPositions=function(o){const i=[],r=t.getRowColCoords(o),a=r.length;for(let s=0;s<a;s++)for(let l=0;l<a;l++)s===0&&l===0||s===0&&l===a-1||s===a-1&&l===0||i.push([r[s],r[l]]);return i}}(pn)),pn}var mn={},Ar;function Xs(){if(Ar)return mn;Ar=1;const t=re().getSymbolSize,n=7;return mn.getPositions=function(o){const i=t(o);return[[0,0],[i-n,0],[0,i-n]]},mn}var gn={},Nr;function Ks(){return Nr||(Nr=1,function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n={N1:3,N2:3,N3:40,N4:10};t.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},t.from=function(i){return t.isValid(i)?parseInt(i,10):void 0},t.getPenaltyN1=function(i){const r=i.size;let a=0,s=0,l=0,u=null,p=null;for(let m=0;m<r;m++){s=l=0,u=p=null;for(let g=0;g<r;g++){let d=i.get(m,g);d===u?s++:(s>=5&&(a+=n.N1+(s-5)),u=d,s=1),d=i.get(g,m),d===p?l++:(l>=5&&(a+=n.N1+(l-5)),p=d,l=1)}s>=5&&(a+=n.N1+(s-5)),l>=5&&(a+=n.N1+(l-5))}return a},t.getPenaltyN2=function(i){const r=i.size;let a=0;for(let s=0;s<r-1;s++)for(let l=0;l<r-1;l++){const u=i.get(s,l)+i.get(s,l+1)+i.get(s+1,l)+i.get(s+1,l+1);(u===4||u===0)&&a++}return a*n.N2},t.getPenaltyN3=function(i){const r=i.size;let a=0,s=0,l=0;for(let u=0;u<r;u++){s=l=0;for(let p=0;p<r;p++)s=s<<1&2047|i.get(u,p),p>=10&&(s===1488||s===93)&&a++,l=l<<1&2047|i.get(p,u),p>=10&&(l===1488||l===93)&&a++}return a*n.N3},t.getPenaltyN4=function(i){let r=0;const a=i.data.length;for(let l=0;l<a;l++)r+=i.data[l];return Math.abs(Math.ceil(r*100/a/5)-10)*n.N4};function e(o,i,r){switch(o){case t.Patterns.PATTERN000:return(i+r)%2===0;case t.Patterns.PATTERN001:return i%2===0;case t.Patterns.PATTERN010:return r%3===0;case t.Patterns.PATTERN011:return(i+r)%3===0;case t.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(r/3))%2===0;case t.Patterns.PATTERN101:return i*r%2+i*r%3===0;case t.Patterns.PATTERN110:return(i*r%2+i*r%3)%2===0;case t.Patterns.PATTERN111:return(i*r%3+(i+r)%2)%2===0;default:throw new Error("bad maskPattern:"+o)}}t.applyMask=function(i,r){const a=r.size;for(let s=0;s<a;s++)for(let l=0;l<a;l++)r.isReserved(l,s)||r.xor(l,s,e(i,l,s))},t.getBestMask=function(i,r){const a=Object.keys(t.Patterns).length;let s=0,l=1/0;for(let u=0;u<a;u++){r(u),t.applyMask(u,i);const p=t.getPenaltyN1(i)+t.getPenaltyN2(i)+t.getPenaltyN3(i)+t.getPenaltyN4(i);t.applyMask(u,i),p<l&&(l=p,s=u)}return s}}(gn)),gn}var Fe={},Ir;function Yi(){if(Ir)return Fe;Ir=1;const t=$n(),n=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],e=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Fe.getBlocksCount=function(i,r){switch(r){case t.L:return n[(i-1)*4+0];case t.M:return n[(i-1)*4+1];case t.Q:return n[(i-1)*4+2];case t.H:return n[(i-1)*4+3];default:return}},Fe.getTotalCodewordsCount=function(i,r){switch(r){case t.L:return e[(i-1)*4+0];case t.M:return e[(i-1)*4+1];case t.Q:return e[(i-1)*4+2];case t.H:return e[(i-1)*4+3];default:return}},Fe}var bn={},_e={},Tr;function Qs(){if(Tr)return _e;Tr=1;const t=new Uint8Array(512),n=new Uint8Array(256);return function(){let o=1;for(let i=0;i<255;i++)t[i]=o,n[o]=i,o<<=1,o&256&&(o^=285);for(let i=255;i<512;i++)t[i]=t[i-255]}(),_e.log=function(o){if(o<1)throw new Error("log("+o+")");return n[o]},_e.exp=function(o){return t[o]},_e.mul=function(o,i){return o===0||i===0?0:t[n[o]+n[i]]},_e}var Dr;function Js(){return Dr||(Dr=1,function(t){const n=Qs();t.mul=function(o,i){const r=new Uint8Array(o.length+i.length-1);for(let a=0;a<o.length;a++)for(let s=0;s<i.length;s++)r[a+s]^=n.mul(o[a],i[s]);return r},t.mod=function(o,i){let r=new Uint8Array(o);for(;r.length-i.length>=0;){const a=r[0];for(let l=0;l<i.length;l++)r[l]^=n.mul(i[l],a);let s=0;for(;s<r.length&&r[s]===0;)s++;r=r.slice(s)}return r},t.generateECPolynomial=function(o){let i=new Uint8Array([1]);for(let r=0;r<o;r++)i=t.mul(i,new Uint8Array([1,n.exp(r)]));return i}}(bn)),bn}var yn,zr;function ta(){if(zr)return yn;zr=1;const t=Js();function n(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}return n.prototype.initialize=function(o){this.degree=o,this.genPoly=t.generateECPolynomial(this.degree)},n.prototype.encode=function(o){if(!this.genPoly)throw new Error("Encoder not initialized");const i=new Uint8Array(o.length+this.degree);i.set(o);const r=t.mod(i,this.genPoly),a=this.degree-r.length;if(a>0){const s=new Uint8Array(this.degree);return s.set(r,a),s}return r},yn=n,yn}var vn={},wn={},xn={},jr;function Vi(){return jr||(jr=1,xn.isValid=function(n){return!isNaN(n)&&n>=1&&n<=40}),xn}var Ut={},Lr;function Hi(){if(Lr)return Ut;Lr=1;const t="[0-9]+",n="[A-Z $%*+\\-./:]+";let e="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";e=e.replace(/u/g,"\\u");const o="(?:(?![A-Z0-9 $%*+\\-./:]|"+e+`)(?:.|[\r
]))+`;Ut.KANJI=new RegExp(e,"g"),Ut.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Ut.BYTE=new RegExp(o,"g"),Ut.NUMERIC=new RegExp(t,"g"),Ut.ALPHANUMERIC=new RegExp(n,"g");const i=new RegExp("^"+e+"$"),r=new RegExp("^"+t+"$"),a=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Ut.testKanji=function(l){return i.test(l)},Ut.testNumeric=function(l){return r.test(l)},Ut.testAlphanumeric=function(l){return a.test(l)},Ut}var Br;function ie(){return Br||(Br=1,function(t){const n=Vi(),e=Hi();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(r,a){if(!r.ccBits)throw new Error("Invalid mode: "+r);if(!n.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?r.ccBits[0]:a<27?r.ccBits[1]:r.ccBits[2]},t.getBestModeForData=function(r){return e.testNumeric(r)?t.NUMERIC:e.testAlphanumeric(r)?t.ALPHANUMERIC:e.testKanji(r)?t.KANJI:t.BYTE},t.toString=function(r){if(r&&r.id)return r.id;throw new Error("Invalid mode")},t.isValid=function(r){return r&&r.bit&&r.ccBits};function o(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+i)}}t.from=function(r,a){if(t.isValid(r))return r;try{return o(r)}catch{return a}}}(wn)),wn}var Pr;function ea(){return Pr||(Pr=1,function(t){const n=re(),e=Yi(),o=$n(),i=ie(),r=Vi(),a=7973,s=n.getBCHDigit(a);function l(g,d,y){for(let f=1;f<=40;f++)if(d<=t.getCapacity(f,y,g))return f}function u(g,d){return i.getCharCountIndicator(g,d)+4}function p(g,d){let y=0;return g.forEach(function(f){const v=u(f.mode,d);y+=v+f.getBitsLength()}),y}function m(g,d){for(let y=1;y<=40;y++)if(p(g,y)<=t.getCapacity(y,d,i.MIXED))return y}t.from=function(d,y){return r.isValid(d)?parseInt(d,10):y},t.getCapacity=function(d,y,f){if(!r.isValid(d))throw new Error("Invalid QR Code version");typeof f>"u"&&(f=i.BYTE);const v=n.getSymbolTotalCodewords(d),b=e.getTotalCodewordsCount(d,y),x=(v-b)*8;if(f===i.MIXED)return x;const w=x-u(f,d);switch(f){case i.NUMERIC:return Math.floor(w/10*3);case i.ALPHANUMERIC:return Math.floor(w/11*2);case i.KANJI:return Math.floor(w/13);case i.BYTE:default:return Math.floor(w/8)}},t.getBestVersionForData=function(d,y){let f;const v=o.from(y,o.M);if(Array.isArray(d)){if(d.length>1)return m(d,v);if(d.length===0)return 1;f=d[0]}else f=d;return l(f.mode,f.getLength(),v)},t.getEncodedBits=function(d){if(!r.isValid(d)||d<7)throw new Error("Invalid QR Code version");let y=d<<12;for(;n.getBCHDigit(y)-s>=0;)y^=a<<n.getBCHDigit(y)-s;return d<<12|y}}(vn)),vn}var _n={},Mr;function na(){if(Mr)return _n;Mr=1;const t=re(),n=1335,e=21522,o=t.getBCHDigit(n);return _n.getEncodedBits=function(r,a){const s=r.bit<<3|a;let l=s<<10;for(;t.getBCHDigit(l)-o>=0;)l^=n<<t.getBCHDigit(l)-o;return(s<<10|l)^e},_n}var kn={},Cn,Or;function ra(){if(Or)return Cn;Or=1;const t=ie();function n(e){this.mode=t.NUMERIC,this.data=e.toString()}return n.getBitsLength=function(o){return 10*Math.floor(o/3)+(o%3?o%3*3+1:0)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(o){let i,r,a;for(i=0;i+3<=this.data.length;i+=3)r=this.data.substr(i,3),a=parseInt(r,10),o.put(a,10);const s=this.data.length-i;s>0&&(r=this.data.substr(i),a=parseInt(r,10),o.put(a,s*3+1))},Cn=n,Cn}var En,Fr;function ia(){if(Fr)return En;Fr=1;const t=ie(),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function e(o){this.mode=t.ALPHANUMERIC,this.data=o}return e.getBitsLength=function(i){return 11*Math.floor(i/2)+6*(i%2)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(i){let r;for(r=0;r+2<=this.data.length;r+=2){let a=n.indexOf(this.data[r])*45;a+=n.indexOf(this.data[r+1]),i.put(a,11)}this.data.length%2&&i.put(n.indexOf(this.data[r]),6)},En=e,En}var Sn,Ur;function oa(){if(Ur)return Sn;Ur=1;const t=ie();function n(e){this.mode=t.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}return n.getBitsLength=function(o){return o*8},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(e){for(let o=0,i=this.data.length;o<i;o++)e.put(this.data[o],8)},Sn=n,Sn}var Rn,Wr;function sa(){if(Wr)return Rn;Wr=1;const t=ie(),n=re();function e(o){this.mode=t.KANJI,this.data=o}return e.getBitsLength=function(i){return i*13},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(o){let i;for(i=0;i<this.data.length;i++){let r=n.toSJIS(this.data[i]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[i]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),o.put(r,13)}},Rn=e,Rn}var An={exports:{}},qr;function aa(){return qr||(qr=1,function(t){var n={single_source_shortest_paths:function(e,o,i){var r={},a={};a[o]=0;var s=n.PriorityQueue.make();s.push(o,0);for(var l,u,p,m,g,d,y,f,v;!s.empty();){l=s.pop(),u=l.value,m=l.cost,g=e[u]||{};for(p in g)g.hasOwnProperty(p)&&(d=g[p],y=m+d,f=a[p],v=typeof a[p]>"u",(v||f>y)&&(a[p]=y,s.push(p,y),r[p]=u))}if(typeof i<"u"&&typeof a[i]>"u"){var b=["Could not find a path from ",o," to ",i,"."].join("");throw new Error(b)}return r},extract_shortest_path_from_predecessor_list:function(e,o){for(var i=[],r=o;r;)i.push(r),e[r],r=e[r];return i.reverse(),i},find_path:function(e,o,i){var r=n.single_source_shortest_paths(e,o,i);return n.extract_shortest_path_from_predecessor_list(r,i)},PriorityQueue:{make:function(e){var o=n.PriorityQueue,i={},r;e=e||{};for(r in o)o.hasOwnProperty(r)&&(i[r]=o[r]);return i.queue=[],i.sorter=e.sorter||o.default_sorter,i},default_sorter:function(e,o){return e.cost-o.cost},push:function(e,o){var i={value:e,cost:o};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=n}(An)),An.exports}var Gr;function la(){return Gr||(Gr=1,function(t){const n=ie(),e=ra(),o=ia(),i=oa(),r=sa(),a=Hi(),s=re(),l=aa();function u(b){return unescape(encodeURIComponent(b)).length}function p(b,x,w){const _=[];let N;for(;(N=b.exec(w))!==null;)_.push({data:N[0],index:N.index,mode:x,length:N[0].length});return _}function m(b){const x=p(a.NUMERIC,n.NUMERIC,b),w=p(a.ALPHANUMERIC,n.ALPHANUMERIC,b);let _,N;return s.isKanjiModeEnabled()?(_=p(a.BYTE,n.BYTE,b),N=p(a.KANJI,n.KANJI,b)):(_=p(a.BYTE_KANJI,n.BYTE,b),N=[]),x.concat(w,_,N).sort(function(C,E){return C.index-E.index}).map(function(C){return{data:C.data,mode:C.mode,length:C.length}})}function g(b,x){switch(x){case n.NUMERIC:return e.getBitsLength(b);case n.ALPHANUMERIC:return o.getBitsLength(b);case n.KANJI:return r.getBitsLength(b);case n.BYTE:return i.getBitsLength(b)}}function d(b){return b.reduce(function(x,w){const _=x.length-1>=0?x[x.length-1]:null;return _&&_.mode===w.mode?(x[x.length-1].data+=w.data,x):(x.push(w),x)},[])}function y(b){const x=[];for(let w=0;w<b.length;w++){const _=b[w];switch(_.mode){case n.NUMERIC:x.push([_,{data:_.data,mode:n.ALPHANUMERIC,length:_.length},{data:_.data,mode:n.BYTE,length:_.length}]);break;case n.ALPHANUMERIC:x.push([_,{data:_.data,mode:n.BYTE,length:_.length}]);break;case n.KANJI:x.push([_,{data:_.data,mode:n.BYTE,length:u(_.data)}]);break;case n.BYTE:x.push([{data:_.data,mode:n.BYTE,length:u(_.data)}])}}return x}function f(b,x){const w={},_={start:{}};let N=["start"];for(let D=0;D<b.length;D++){const C=b[D],E=[];for(let R=0;R<C.length;R++){const B=C[R],F=""+D+R;E.push(F),w[F]={node:B,lastCount:0},_[F]={};for(let S=0;S<N.length;S++){const k=N[S];w[k]&&w[k].node.mode===B.mode?(_[k][F]=g(w[k].lastCount+B.length,B.mode)-g(w[k].lastCount,B.mode),w[k].lastCount+=B.length):(w[k]&&(w[k].lastCount=B.length),_[k][F]=g(B.length,B.mode)+4+n.getCharCountIndicator(B.mode,x))}}N=E}for(let D=0;D<N.length;D++)_[N[D]].end=0;return{map:_,table:w}}function v(b,x){let w;const _=n.getBestModeForData(b);if(w=n.from(x,_),w!==n.BYTE&&w.bit<_.bit)throw new Error('"'+b+'" cannot be encoded with mode '+n.toString(w)+`.
 Suggested mode is: `+n.toString(_));switch(w===n.KANJI&&!s.isKanjiModeEnabled()&&(w=n.BYTE),w){case n.NUMERIC:return new e(b);case n.ALPHANUMERIC:return new o(b);case n.KANJI:return new r(b);case n.BYTE:return new i(b)}}t.fromArray=function(x){return x.reduce(function(w,_){return typeof _=="string"?w.push(v(_,null)):_.data&&w.push(v(_.data,_.mode)),w},[])},t.fromString=function(x,w){const _=m(x,s.isKanjiModeEnabled()),N=y(_),D=f(N,w),C=l.find_path(D.map,"start","end"),E=[];for(let R=1;R<C.length-1;R++)E.push(D.table[C[R]].node);return t.fromArray(d(E))},t.rawSplit=function(x){return t.fromArray(m(x,s.isKanjiModeEnabled()))}}(kn)),kn}var Yr;function ca(){if(Yr)return dn;Yr=1;const t=re(),n=$n(),e=Hs(),o=Zs(),i=$s(),r=Xs(),a=Ks(),s=Yi(),l=ta(),u=ea(),p=na(),m=ie(),g=la();function d(D,C){const E=D.size,R=r.getPositions(C);for(let B=0;B<R.length;B++){const F=R[B][0],S=R[B][1];for(let k=-1;k<=7;k++)if(!(F+k<=-1||E<=F+k))for(let c=-1;c<=7;c++)S+c<=-1||E<=S+c||(k>=0&&k<=6&&(c===0||c===6)||c>=0&&c<=6&&(k===0||k===6)||k>=2&&k<=4&&c>=2&&c<=4?D.set(F+k,S+c,!0,!0):D.set(F+k,S+c,!1,!0))}}function y(D){const C=D.size;for(let E=8;E<C-8;E++){const R=E%2===0;D.set(E,6,R,!0),D.set(6,E,R,!0)}}function f(D,C){const E=i.getPositions(C);for(let R=0;R<E.length;R++){const B=E[R][0],F=E[R][1];for(let S=-2;S<=2;S++)for(let k=-2;k<=2;k++)S===-2||S===2||k===-2||k===2||S===0&&k===0?D.set(B+S,F+k,!0,!0):D.set(B+S,F+k,!1,!0)}}function v(D,C){const E=D.size,R=u.getEncodedBits(C);let B,F,S;for(let k=0;k<18;k++)B=Math.floor(k/3),F=k%3+E-8-3,S=(R>>k&1)===1,D.set(B,F,S,!0),D.set(F,B,S,!0)}function b(D,C,E){const R=D.size,B=p.getEncodedBits(C,E);let F,S;for(F=0;F<15;F++)S=(B>>F&1)===1,F<6?D.set(F,8,S,!0):F<8?D.set(F+1,8,S,!0):D.set(R-15+F,8,S,!0),F<8?D.set(8,R-F-1,S,!0):F<9?D.set(8,15-F-1+1,S,!0):D.set(8,15-F-1,S,!0);D.set(R-8,8,1,!0)}function x(D,C){const E=D.size;let R=-1,B=E-1,F=7,S=0;for(let k=E-1;k>0;k-=2)for(k===6&&k--;;){for(let c=0;c<2;c++)if(!D.isReserved(B,k-c)){let O=!1;S<C.length&&(O=(C[S]>>>F&1)===1),D.set(B,k-c,O),F--,F===-1&&(S++,F=7)}if(B+=R,B<0||E<=B){B-=R,R=-R;break}}}function w(D,C,E){const R=new e;E.forEach(function(c){R.put(c.mode.bit,4),R.put(c.getLength(),m.getCharCountIndicator(c.mode,D)),c.write(R)});const B=t.getSymbolTotalCodewords(D),F=s.getTotalCodewordsCount(D,C),S=(B-F)*8;for(R.getLengthInBits()+4<=S&&R.put(0,4);R.getLengthInBits()%8!==0;)R.putBit(0);const k=(S-R.getLengthInBits())/8;for(let c=0;c<k;c++)R.put(c%2?17:236,8);return _(R,D,C)}function _(D,C,E){const R=t.getSymbolTotalCodewords(C),B=s.getTotalCodewordsCount(C,E),F=R-B,S=s.getBlocksCount(C,E),k=R%S,c=S-k,O=Math.floor(R/S),K=Math.floor(F/S),q=K+1,V=O-K,U=new l(V);let et=0;const P=new Array(S),L=new Array(S);let J=0;const Z=new Uint8Array(D.buffer);for(let at=0;at<S;at++){const ot=at<c?K:q;P[at]=Z.slice(et,et+ot),L[at]=U.encode(P[at]),et+=ot,J=Math.max(J,ot)}const $=new Uint8Array(R);let dt=0,lt,it;for(lt=0;lt<J;lt++)for(it=0;it<S;it++)lt<P[it].length&&($[dt++]=P[it][lt]);for(lt=0;lt<V;lt++)for(it=0;it<S;it++)$[dt++]=L[it][lt];return $}function N(D,C,E,R){let B;if(Array.isArray(D))B=g.fromArray(D);else if(typeof D=="string"){let O=C;if(!O){const K=g.rawSplit(D);O=u.getBestVersionForData(K,E)}B=g.fromString(D,O||40)}else throw new Error("Invalid data");const F=u.getBestVersionForData(B,E);if(!F)throw new Error("The amount of data is too big to be stored in a QR Code");if(!C)C=F;else if(C<F)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+F+`.
`);const S=w(C,E,B),k=t.getSymbolSize(C),c=new o(k);return d(c,C),y(c),f(c,C),b(c,E,0),C>=7&&v(c,C),x(c,S),isNaN(R)&&(R=a.getBestMask(c,b.bind(null,c,E))),a.applyMask(R,c),b(c,E,R),{modules:c,version:C,errorCorrectionLevel:E,maskPattern:R,segments:B}}return dn.create=function(C,E){if(typeof C>"u"||C==="")throw new Error("No input text");let R=n.M,B,F;return typeof E<"u"&&(R=n.from(E.errorCorrectionLevel,n.M),B=u.from(E.version),F=a.from(E.maskPattern),E.toSJISFunc&&t.setToSJISFunction(E.toSJISFunc)),N(C,B,R,F)},dn}var Nn={},In={},Vr;function Zi(){return Vr||(Vr=1,function(t){function n(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let o=e.slice().replace("#","").split("");if(o.length<3||o.length===5||o.length>8)throw new Error("Invalid hex color: "+e);(o.length===3||o.length===4)&&(o=Array.prototype.concat.apply([],o.map(function(r){return[r,r]}))),o.length===6&&o.push("F","F");const i=parseInt(o.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+o.slice(0,6).join("")}}t.getOptions=function(o){o||(o={}),o.color||(o.color={});const i=typeof o.margin>"u"||o.margin===null||o.margin<0?4:o.margin,r=o.width&&o.width>=21?o.width:void 0,a=o.scale||4;return{width:r,scale:r?4:a,margin:i,color:{dark:n(o.color.dark||"#000000ff"),light:n(o.color.light||"#ffffffff")},type:o.type,rendererOpts:o.rendererOpts||{}}},t.getScale=function(o,i){return i.width&&i.width>=o+i.margin*2?i.width/(o+i.margin*2):i.scale},t.getImageWidth=function(o,i){const r=t.getScale(o,i);return Math.floor((o+i.margin*2)*r)},t.qrToImageData=function(o,i,r){const a=i.modules.size,s=i.modules.data,l=t.getScale(a,r),u=Math.floor((a+r.margin*2)*l),p=r.margin*l,m=[r.color.light,r.color.dark];for(let g=0;g<u;g++)for(let d=0;d<u;d++){let y=(g*u+d)*4,f=r.color.light;if(g>=p&&d>=p&&g<u-p&&d<u-p){const v=Math.floor((g-p)/l),b=Math.floor((d-p)/l);f=m[s[v*a+b]?1:0]}o[y++]=f.r,o[y++]=f.g,o[y++]=f.b,o[y]=f.a}}}(In)),In}var Hr;function da(){return Hr||(Hr=1,function(t){const n=Zi();function e(i,r,a){i.clearRect(0,0,r.width,r.height),r.style||(r.style={}),r.height=a,r.width=a,r.style.height=a+"px",r.style.width=a+"px"}function o(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(r,a,s){let l=s,u=a;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),a||(u=o()),l=n.getOptions(l);const p=n.getImageWidth(r.modules.size,l),m=u.getContext("2d"),g=m.createImageData(p,p);return n.qrToImageData(g.data,r,l),e(m,u,p),m.putImageData(g,0,0),u},t.renderToDataURL=function(r,a,s){let l=s;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),l||(l={});const u=t.render(r,a,l),p=l.type||"image/png",m=l.rendererOpts||{};return u.toDataURL(p,m.quality)}}(Nn)),Nn}var Tn={},Zr;function ua(){if(Zr)return Tn;Zr=1;const t=Zi();function n(i,r){const a=i.a/255,s=r+'="'+i.hex+'"';return a<1?s+" "+r+'-opacity="'+a.toFixed(2).slice(1)+'"':s}function e(i,r,a){let s=i+r;return typeof a<"u"&&(s+=" "+a),s}function o(i,r,a){let s="",l=0,u=!1,p=0;for(let m=0;m<i.length;m++){const g=Math.floor(m%r),d=Math.floor(m/r);!g&&!u&&(u=!0),i[m]?(p++,m>0&&g>0&&i[m-1]||(s+=u?e("M",g+a,.5+d+a):e("m",l,0),l=0,u=!1),g+1<r&&i[m+1]||(s+=e("h",p),p=0)):l++}return s}return Tn.render=function(r,a,s){const l=t.getOptions(a),u=r.modules.size,p=r.modules.data,m=u+l.margin*2,g=l.color.light.a?"<path "+n(l.color.light,"fill")+' d="M0 0h'+m+"v"+m+'H0z"/>':"",d="<path "+n(l.color.dark,"stroke")+' d="'+o(p,u,l.margin)+'"/>',y='viewBox="0 0 '+m+" "+m+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+y+' shape-rendering="crispEdges">'+g+d+`</svg>
`;return typeof s=="function"&&s(null,v),v},Tn}var $r;function fa(){if($r)return le;$r=1;const t=Vs(),n=ca(),e=da(),o=ua();function i(r,a,s,l,u){const p=[].slice.call(arguments,1),m=p.length,g=typeof p[m-1]=="function";if(!g&&!t())throw new Error("Callback required as last argument");if(g){if(m<2)throw new Error("Too few arguments provided");m===2?(u=s,s=a,a=l=void 0):m===3&&(a.getContext&&typeof u>"u"?(u=l,l=void 0):(u=l,l=s,s=a,a=void 0))}else{if(m<1)throw new Error("Too few arguments provided");return m===1?(s=a,a=l=void 0):m===2&&!a.getContext&&(l=s,s=a,a=void 0),new Promise(function(d,y){try{const f=n.create(s,l);d(r(f,a,l))}catch(f){y(f)}})}try{const d=n.create(s,l);u(null,r(d,a,l))}catch(d){u(d)}}return le.create=n.create,le.toCanvas=i.bind(null,e.render),le.toDataURL=i.bind(null,e.renderToDataURL),le.toString=i.bind(null,function(r,a,s){return o.render(r,s)}),le}var ha=fa();const pa=fi(ha);async function Xr(t,n=512,e=1){const o={errorCorrectionLevel:"M",type:"image/png",margin:e,width:n,color:{dark:"#000000",light:"#ffffff"}};return pa.toDataURL(t,o)}const Xn=(()=>{const t=vt.get().DEFAULTS?.BACKGROUND;return{color:typeof t?.color=="string"?t.color:"#ffffff",alpha:Math.max(0,Math.min(1,typeof t?.alpha=="number"?t.alpha:1))}})(),fe={scale:1,tx:0,ty:0},Dn=(t,n,e)=>Math.max(n,Math.min(e,t)),Vt=(t,n)=>typeof t=="number"?t:n;function ma(t){return new Promise((n,e)=>{const o=new Image;o.onload=()=>n({w:o.naturalWidth,h:o.naturalHeight}),o.onerror=e,o.src=t})}function ga(t,n,e,o,i,r,a=1){const s=e/t,l=e/n,u=(o==="cover"?Math.max(s,l):Math.min(s,l))*a,p=t*u,m=n*u,g=i==="left"?0:i==="right"?e-p:(e-p)/2,d=r==="top"?0:r==="bottom"?e-m:(e-m)/2,y=(g-(e-p)/2)/e*100,f=(d-(e-m)/2)/e*100;return{tx:Math.max(-100,Math.min(100,y)),ty:Math.max(-100,Math.min(100,f))}}const ht=To((t,n)=>({photos:[],max:qi,transforms:{},layersByPhoto:{},cardBackground:{},setCardBackground:(e,o)=>t(i=>{const r=i.cardBackground[e]??Xn,a={color:o.color??r.color,alpha:Math.max(0,Math.min(1,o.alpha??r.alpha))};return{cardBackground:{...i.cardBackground,[e]:a}}}),setTransform:(e,o)=>t(i=>{const r=i.transforms[e]??fe,a={scale:Dn(o.scale??r.scale,.5,4),tx:Dn(o.tx??r.tx,-100,100),ty:Dn(o.ty??r.ty,-100,100)};return{transforms:{...i.transforms,[e]:a}}}),resetTransform:e=>t(o=>{const{[e]:i,...r}=o.transforms;return{transforms:r}}),add:e=>{if(!e?.length)return;const{photos:o,max:i}=n(),r=Math.max(0,i-o.length);if(!r)return;const a=e.slice(0,r);t({photos:[...o,...a]});const s=vt.get().DEFAULT_CARD_LAYERS??[];if(s.length){for(const l of a)for(const u of s)if(u?.type==="text"){const p=Vt(u.y,Tt-140);n().addTextLayer(l.id,{x:typeof u.x=="number"?u.x:40,y:p,text:typeof u.text=="string"?u.text:void 0,fontFamily:typeof u.fontFamily=="string"?u.fontFamily:void 0,fontSize:typeof u.fontSize=="number"?u.fontSize:void 0,fontStyle:typeof u.fontStyle=="string"?u.fontStyle:void 0,fill:typeof u.fill=="string"?u.fill:void 0,align:["left","center","right"].includes(u.align)?u.align:void 0,lineHeight:typeof u.lineHeight=="number"?u.lineHeight:void 0,letterSpacing:typeof u.letterSpacing=="number"?u.letterSpacing:void 0,width:typeof u.width=="number"?u.width:void 0,rotation:typeof u.rotation=="number"?u.rotation:void 0})}else if(u?.type==="rect"){const p=Vt(u.y,40);n().addRectLayer(l.id,{x:typeof u.x=="number"?u.x:40,y:p,width:typeof u.width=="number"?u.width:void 0,height:typeof u.height=="number"?u.height:void 0,fill:typeof u.fill=="string"?u.fill:void 0,stroke:typeof u.stroke=="string"?u.stroke:void 0,strokeWidth:typeof u.strokeWidth=="number"?u.strokeWidth:void 0,cornerRadius:typeof u.cornerRadius=="number"?u.cornerRadius:void 0,opacity:typeof u.opacity=="number"?u.opacity:void 0})}else if(u?.type==="qr"){const p=Vt(u.y,40),m=Math.max(1,Math.round(typeof u.size=="number"?u.size:512));(async()=>{await n().addQrLayer(l.id,typeof u.text=="string"?u.text:"",m);const g=n().layersByPhoto[l.id]??[],d=g[g.length-1];d&&d.type==="image"&&n().updateLayer(l.id,d.id,{x:typeof u.x=="number"?u.x:40,y:p})})()}}for(const l of a)(async()=>{try{const{w:u,h:p}=await ma(l.url),m=vt.get(),g=Math.max(0,Number(m.NEAR_SQUARE_TOLERANCE??0)),d=Number(m.NEAR_SQUARE_SCALE??1),y=Wn==="contain",f=u/p,v=Math.abs(f-1)<=g,b=y&&v?d:1,{tx:x,ty:w}=ga(u,p,Tt,Wn,Gs,Ys,b);n().setTransform(l.id,{tx:x,ty:w,scale:Math.max(.5,Math.min(4,fe.scale*b))});const _=vt.get().LAYER_PROFILES?.orientation;if(_&&_.on!==!1){let N;f>1+g?N="landscape":f<1-g?N="portrait":N="square";const D=N==="landscape"?_.landscape??[]:N==="portrait"?_.portrait??[]:_.square??[];for(const C of D)if(!(!C||typeof C!="object")){if(C.type==="text"){const E=Vt(C.y,Tt-140);n().addTextLayer(l.id,{x:typeof C.x=="number"?C.x:40,y:E,text:typeof C.text=="string"?C.text:void 0,fontFamily:typeof C.fontFamily=="string"?C.fontFamily:void 0,fontSize:typeof C.fontSize=="number"?C.fontSize:void 0,fontStyle:typeof C.fontStyle=="string"?C.fontStyle:void 0,fill:typeof C.fill=="string"?C.fill:void 0,align:["left","center","right"].includes(C.align)?C.align:void 0,lineHeight:typeof C.lineHeight=="number"?C.lineHeight:void 0,letterSpacing:typeof C.letterSpacing=="number"?C.letterSpacing:void 0,width:typeof C.width=="number"?C.width:void 0,rotation:typeof C.rotation=="number"?C.rotation:void 0})}else if(C.type==="rect"){const E=Vt(C.y,40);n().addRectLayer(l.id,{x:typeof C.x=="number"?C.x:40,y:E,width:typeof C.width=="number"?C.width:void 0,height:typeof C.height=="number"?C.height:void 0,fill:typeof C.fill=="string"?C.fill:void 0,stroke:typeof C.stroke=="string"?C.stroke:void 0,strokeWidth:typeof C.strokeWidth=="number"?C.strokeWidth:void 0,cornerRadius:typeof C.cornerRadius=="number"?C.cornerRadius:void 0,opacity:typeof C.opacity=="number"?C.opacity:void 0,rotation:typeof C.rotation=="number"?C.rotation:void 0})}else if(C.type==="qr"){const E=Vt(C.y,40),R=Math.max(1,Math.round(typeof C.size=="number"?C.size:512)),B=await n().addQrLayer(l.id,typeof C.text=="string"?C.text:"",R);n().updateLayer(l.id,B,{x:typeof C.x=="number"?C.x:40,y:E,rotation:typeof C.rotation=="number"?C.rotation:void 0})}}}}catch{}})()},clear:()=>{const e=n().photos;e.length&&wr(e),t({photos:[],transforms:{},layersByPhoto:{},cardBackground:{}})},remove:e=>t(o=>{const i=o.photos.findIndex(l=>l.id===e);if(i===-1)return null;wr([o.photos[i]]);const{[e]:r,...a}=o.transforms,s={...o.layersByPhoto};return delete s[e],{photos:o.photos.filter(l=>l.id!==e),transforms:a,layersByPhoto:s}}),addTextLayer:(e,o={})=>{const i=crypto.randomUUID();return t(r=>{const a=r.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...o};delete l.id,delete l.type,delete l.z;const u=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const p=vt.get().DEFAULTS?.TEXT??{},m=Vt(p.y,Tt-140),g=u??m,d={id:i,type:"text",x:typeof p.x=="number"?p.x:40,y:g,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,text:typeof p.text=="string"?p.text:"New text",fontFamily:typeof p.fontFamily=="string"?p.fontFamily:"Georgia, serif",fontSize:typeof p.fontSize=="number"?p.fontSize:36,fontStyle:typeof p.fontStyle=="string"?p.fontStyle:"",fill:typeof p.fill=="string"?p.fill:"#111",align:["left","center","right"].includes(p.align)?p.align:"left",verticalAlign:["top","middle","bottom"].includes(p.verticalAlign)?p.verticalAlign:"top",padding:typeof p.padding=="number"?p.padding:0,lineHeight:typeof p.lineHeight=="number"?p.lineHeight:1.25,letterSpacing:typeof p.letterSpacing=="number"?p.letterSpacing:0,width:typeof p.width=="number"?p.width:void 0,...l};return{layersByPhoto:{...r.layersByPhoto,[e]:[...a,d]}}}),i},addRectLayer:(e,o={})=>{const i=crypto.randomUUID();return t(r=>{const a=r.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...o};delete l.id,delete l.type,delete l.z;const u=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const p=vt.get().DEFAULTS?.RECT??{},m=Vt(p.y,40),g=u??m,d={id:i,type:"rect",x:typeof p.x=="number"?p.x:40,y:g,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,width:typeof p.width=="number"?p.width:600,height:typeof p.height=="number"?p.height:300,fill:typeof p.fill=="string"?p.fill:"#ffffff",stroke:typeof p.stroke=="string"?p.stroke:void 0,strokeWidth:typeof p.strokeWidth=="number"?p.strokeWidth:0,cornerRadius:typeof p.cornerRadius=="number"?p.cornerRadius:0,opacity:typeof p.opacity=="number"?p.opacity:1,...l};return{layersByPhoto:{...r.layersByPhoto,[e]:[...a,d]}}}),i},addImageLayer:(e,o={})=>{const i=crypto.randomUUID();return t(r=>{const a=r.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...o};delete l.id,delete l.type,delete l.z;const u=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const p=vt.get().DEFAULTS?.IMAGE??{},m=Vt(p.y,40),g=u??m,d={id:i,type:"image",x:typeof p.x=="number"?p.x:40,y:g,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,src:"",w:typeof p.w=="number"?p.w:void 0,h:typeof p.h=="number"?p.h:void 0,...l};return{layersByPhoto:{...r.layersByPhoto,[e]:[...a,d]}}}),i},addQrLayer:async(e,o,i=512)=>{const r=vt.get().DEFAULTS?.QR??{},a=Math.max(1,Math.round(typeof i=="number"?i:r.size??512)),s=await Xr(o,a,1);return n().addImageLayer(e,{src:s,x:typeof r.x=="number"?r.x:40,y:typeof r.y=="number"?r.y:40,w:a,h:a,qrText:o})},updateQrLayer:async(e,o,i)=>{const a=n().layersByPhoto[e]??[],s=a.findIndex(g=>g.id===o&&g.type==="image");if(s===-1)return;const l=a[s];if(!l.qrText&&!i.text)return;const u=i.text??l.qrText??"",p=Math.max(1,Math.round(i.size??l.w??l.h??512)),m=await Xr(u,p,1);n().updateLayer(e,o,{src:m,w:p,h:p,...u?{qrText:u}:{}})},updateLayer:(e,o,i)=>t(r=>{const a=r.layersByPhoto[e]??[],s=a.findIndex(g=>g.id===o);if(s===-1)return null;const l=a[s],u={...i};delete u.id,delete u.type;const p={...l,...u},m=[...a];return m[s]=p,{layersByPhoto:{...r.layersByPhoto,[e]:m}}}),removeLayer:(e,o)=>t(i=>{const r=i.layersByPhoto[e]??[],a=r.filter(s=>s.id!==o);return a===r?null:{layersByPhoto:{...i.layersByPhoto,[e]:a}}}),bringToFront:(e,o)=>t(i=>{const r=i.layersByPhoto[e]??[];if(!r.length)return null;const a=Math.max(...r.map(l=>l.z)),s=r.map(l=>l.id===o?{...l,z:a+1}:l);return{layersByPhoto:{...i.layersByPhoto,[e]:s}}}),sendToBack:(e,o)=>t(i=>{const r=i.layersByPhoto[e]??[];if(!r.length)return null;const a=Math.min(...r.map(l=>l.z)),s=r.map(l=>l.id===o?{...l,z:a-1}:l);return{layersByPhoto:{...i.layersByPhoto,[e]:s}}}),setLayersOrder:(e,o)=>t(i=>{const r=i.layersByPhoto[e]??[];if(!r.length)return null;const a=new Map(r.map(u=>[u.id,u])),s=[];let l=1;for(const u of o){const p=a.get(u);p&&s.push({...p,z:l++})}for(const u of r)o.includes(u.id)||s.push({...u,z:l++});return{layersByPhoto:{...i.layersByPhoto,[e]:s}}}),reorderPhotos:e=>t(o=>{if(!Array.isArray(e)||!e.length)return null;const i=new Map(o.photos.map(a=>[a.id,a])),r=e.map(a=>i.get(a)).filter(Boolean);for(const a of o.photos)e.includes(a.id)||r.push(a);return{photos:r}})}));function ba(t){const n=t.replace(/^\uFEFF/,"").replace(/\r\n?/g,`
`).split(`
`).filter(Boolean);if(!n.length)return{rows:[],hasRelative:!1};const e=n[0].toLowerCase(),o=e.includes(";")&&!e.includes(",")?";":",",i=[],r=new RegExp(`\\s*(?:"([^"]*)"|([^${o}\\n]*))\\s*(?:${o}|$)`,"g");for(const s of n){const l=[];r.lastIndex=0;let u,p=0;for(;(u=r.exec(s))&&p++<1e3;){const d=(u[1]??u[2]??"").trim();if(l.push(d),u.index+u[0].length>=s.length)break}if(!l.length)continue;const m=(l[0]??"").trim();if(!m)continue;const g=(l[1]??"").trim()||void 0;i.push({url:m,caption:g})}i.length&&i[0].url.trim().toLowerCase()==="url"&&i.shift();const a=i.some(s=>ya(s.url));return{rows:i,hasRelative:a}}function $i(t){return/^https?:\/\//i.test(t)}function Xi(t){return/^data:/i.test(t)}function ya(t){return!($i(t)||Xi(t)||/^blob:/.test(t))}function Ue(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var zn={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Kr;function va(){return Kr||(Kr=1,function(t,n){(function(e){t.exports=e()})(function(){return function e(o,i,r){function a(u,p){if(!i[u]){if(!o[u]){var m=typeof Ue=="function"&&Ue;if(!p&&m)return m(u,!0);if(s)return s(u,!0);var g=new Error("Cannot find module '"+u+"'");throw g.code="MODULE_NOT_FOUND",g}var d=i[u]={exports:{}};o[u][0].call(d.exports,function(y){var f=o[u][1][y];return a(f||y)},d,d.exports,e,o,i,r)}return i[u].exports}for(var s=typeof Ue=="function"&&Ue,l=0;l<r.length;l++)a(r[l]);return a}({1:[function(e,o,i){var r=e("./utils"),a=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var u,p,m,g,d,y,f,v=[],b=0,x=l.length,w=x,_=r.getTypeOf(l)!=="string";b<l.length;)w=x-b,m=_?(u=l[b++],p=b<x?l[b++]:0,b<x?l[b++]:0):(u=l.charCodeAt(b++),p=b<x?l.charCodeAt(b++):0,b<x?l.charCodeAt(b++):0),g=u>>2,d=(3&u)<<4|p>>4,y=1<w?(15&p)<<2|m>>6:64,f=2<w?63&m:64,v.push(s.charAt(g)+s.charAt(d)+s.charAt(y)+s.charAt(f));return v.join("")},i.decode=function(l){var u,p,m,g,d,y,f=0,v=0,b="data:";if(l.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var x,w=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&w--,l.charAt(l.length-2)===s.charAt(64)&&w--,w%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=a.uint8array?new Uint8Array(0|w):new Array(0|w);f<l.length;)u=s.indexOf(l.charAt(f++))<<2|(g=s.indexOf(l.charAt(f++)))>>4,p=(15&g)<<4|(d=s.indexOf(l.charAt(f++)))>>2,m=(3&d)<<6|(y=s.indexOf(l.charAt(f++))),x[v++]=u,d!==64&&(x[v++]=p),y!==64&&(x[v++]=m);return x}},{"./support":30,"./utils":32}],2:[function(e,o,i){var r=e("./external"),a=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function u(p,m,g,d,y){this.compressedSize=p,this.uncompressedSize=m,this.crc32=g,this.compression=d,this.compressedContent=y}u.prototype={getContentWorker:function(){var p=new a(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),m=this;return p.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new a(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(p,m,g){return p.pipe(new s).pipe(new l("uncompressedSize")).pipe(m.compressWorker(g)).pipe(new l("compressedSize")).withStreamInfo("compression",m)},o.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,o,i){var r=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,o,i){var r=e("./utils"),a=function(){for(var s,l=[],u=0;u<256;u++){s=u;for(var p=0;p<8;p++)s=1&s?3988292384^s>>>1:s>>>1;l[u]=s}return l}();o.exports=function(s,l){return s!==void 0&&s.length?r.getTypeOf(s)!=="string"?function(u,p,m,g){var d=a,y=g+m;u^=-1;for(var f=g;f<y;f++)u=u>>>8^d[255&(u^p[f])];return-1^u}(0|l,s,s.length,0):function(u,p,m,g){var d=a,y=g+m;u^=-1;for(var f=g;f<y;f++)u=u>>>8^d[255&(u^p.charCodeAt(f))];return-1^u}(0|l,s,s.length,0):0}},{"./utils":32}],5:[function(e,o,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,o,i){var r=null;r=typeof Promise<"u"?Promise:e("lie"),o.exports={Promise:r}},{lie:37}],7:[function(e,o,i){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=e("pako"),s=e("./utils"),l=e("./stream/GenericWorker"),u=r?"uint8array":"array";function p(m,g){l.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=g,this.meta={}}i.magic="\b\0",s.inherits(p,l),p.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(u,m.data),!1)},p.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(g){m.push({data:g,meta:m.meta})}},i.compressWorker=function(m){return new p("Deflate",m)},i.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,o,i){function r(d,y){var f,v="";for(f=0;f<y;f++)v+=String.fromCharCode(255&d),d>>>=8;return v}function a(d,y,f,v,b,x){var w,_,N=d.file,D=d.compression,C=x!==u.utf8encode,E=s.transformTo("string",x(N.name)),R=s.transformTo("string",u.utf8encode(N.name)),B=N.comment,F=s.transformTo("string",x(B)),S=s.transformTo("string",u.utf8encode(B)),k=R.length!==N.name.length,c=S.length!==B.length,O="",K="",q="",V=N.dir,U=N.date,et={crc32:0,compressedSize:0,uncompressedSize:0};y&&!f||(et.crc32=d.crc32,et.compressedSize=d.compressedSize,et.uncompressedSize=d.uncompressedSize);var P=0;y&&(P|=8),C||!k&&!c||(P|=2048);var L=0,J=0;V&&(L|=16),b==="UNIX"?(J=798,L|=function($,dt){var lt=$;return $||(lt=dt?16893:33204),(65535&lt)<<16}(N.unixPermissions,V)):(J=20,L|=function($){return 63&($||0)}(N.dosPermissions)),w=U.getUTCHours(),w<<=6,w|=U.getUTCMinutes(),w<<=5,w|=U.getUTCSeconds()/2,_=U.getUTCFullYear()-1980,_<<=4,_|=U.getUTCMonth()+1,_<<=5,_|=U.getUTCDate(),k&&(K=r(1,1)+r(p(E),4)+R,O+="up"+r(K.length,2)+K),c&&(q=r(1,1)+r(p(F),4)+S,O+="uc"+r(q.length,2)+q);var Z="";return Z+=`
\0`,Z+=r(P,2),Z+=D.magic,Z+=r(w,2),Z+=r(_,2),Z+=r(et.crc32,4),Z+=r(et.compressedSize,4),Z+=r(et.uncompressedSize,4),Z+=r(E.length,2),Z+=r(O.length,2),{fileRecord:m.LOCAL_FILE_HEADER+Z+E+O,dirRecord:m.CENTRAL_FILE_HEADER+r(J,2)+Z+r(F.length,2)+"\0\0\0\0"+r(L,4)+r(v,4)+E+O+F}}var s=e("../utils"),l=e("../stream/GenericWorker"),u=e("../utf8"),p=e("../crc32"),m=e("../signature");function g(d,y,f,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=f,this.encodeFileName=v,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(g,l),g.prototype.push=function(d){var y=d.meta.percent||0,f=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,l.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:f?(y+100*(f-v-1))/f:100}}))},g.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var y=this.streamFiles&&!d.file.dir;if(y){var f=a(d,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(d){this.accumulate=!1;var y=this.streamFiles&&!d.file.dir,f=a(d,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),y)this.push({data:function(v){return m.DATA_DESCRIPTOR+r(v.crc32,4)+r(v.compressedSize,4)+r(v.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var d=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var f=this.bytesWritten-d,v=function(b,x,w,_,N){var D=s.transformTo("string",N(_));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(b,2)+r(b,2)+r(x,4)+r(w,4)+r(D.length,2)+D}(this.dirRecords.length,f,d,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(d){this._sources.push(d);var y=this;return d.on("data",function(f){y.processChunk(f)}),d.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),d.on("error",function(f){y.error(f)}),this},g.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(d){var y=this._sources;if(!l.prototype.error.call(this,d))return!1;for(var f=0;f<y.length;f++)try{y[f].error(d)}catch{}return!0},g.prototype.lock=function(){l.prototype.lock.call(this);for(var d=this._sources,y=0;y<d.length;y++)d[y].lock()},o.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,o,i){var r=e("../compressions"),a=e("./ZipFileWorker");i.generateWorker=function(s,l,u){var p=new a(l.streamFiles,u,l.platform,l.encodeFileName),m=0;try{s.forEach(function(g,d){m++;var y=function(x,w){var _=x||w,N=r[_];if(!N)throw new Error(_+" is not a valid compression method !");return N}(d.options.compression,l.compression),f=d.options.compressionOptions||l.compressionOptions||{},v=d.dir,b=d.date;d._compressWorker(y,f).withStreamInfo("file",{name:g,dir:v,date:b,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(p)}),p.entriesCount=m}catch(g){p.error(g)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,o,i){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new r;for(var s in this)typeof this[s]!="function"&&(a[s]=this[s]);return a}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(a,s){return new r().loadAsync(a,s)},r.external=e("./external"),o.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,o,i){var r=e("./utils"),a=e("./external"),s=e("./utf8"),l=e("./zipEntries"),u=e("./stream/Crc32Probe"),p=e("./nodejsUtils");function m(g){return new a.Promise(function(d,y){var f=g.decompressed.getContentWorker().pipe(new u);f.on("error",function(v){y(v)}).on("end",function(){f.streamInfo.crc32!==g.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}o.exports=function(g,d){var y=this;return d=r.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),p.isNode&&p.isStream(g)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",g,!0,d.optimizedBinaryString,d.base64).then(function(f){var v=new l(d);return v.load(f),v}).then(function(f){var v=[a.Promise.resolve(f)],b=f.files;if(d.checkCRC32)for(var x=0;x<b.length;x++)v.push(m(b[x]));return a.Promise.all(v)}).then(function(f){for(var v=f.shift(),b=v.files,x=0;x<b.length;x++){var w=b[x],_=w.fileNameStr,N=r.resolve(w.fileNameStr);y.file(N,w.decompressed,{binary:!0,optimizedBinaryString:!0,date:w.date,dir:w.dir,comment:w.fileCommentStr.length?w.fileCommentStr:null,unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions,createFolders:d.createFolders}),w.dir||(y.file(N).unsafeOriginalName=_)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,o,i){var r=e("../utils"),a=e("../stream/GenericWorker");function s(l,u){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}r.inherits(s,a),s.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(p){u.push({data:p,meta:{percent:0}})}).on("error",function(p){u.isPaused?this.generatedError=p:u.error(p)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},o.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,o,i){var r=e("readable-stream").Readable;function a(s,l,u){r.call(this,l),this._helper=s;var p=this;s.on("data",function(m,g){p.push(m)||p._helper.pause(),u&&u(g)}).on("error",function(m){p.emit("error",m)}).on("end",function(){p.push(null)})}e("../utils").inherits(a,r),a.prototype._read=function(){this._helper.resume()},o.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,o,i){o.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,a);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,a)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var a=new Buffer(r);return a.fill(0),a},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(e,o,i){function r(N,D,C){var E,R=s.getTypeOf(D),B=s.extend(C||{},p);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(N=b(N)),B.createFolders&&(E=v(N))&&x.call(this,E,!0);var F=R==="string"&&B.binary===!1&&B.base64===!1;C&&C.binary!==void 0||(B.binary=!F),(D instanceof m&&D.uncompressedSize===0||B.dir||!D||D.length===0)&&(B.base64=!1,B.binary=!0,D="",B.compression="STORE",R="string");var S=null;S=D instanceof m||D instanceof l?D:y.isNode&&y.isStream(D)?new f(N,D):s.prepareContent(N,D,B.binary,B.optimizedBinaryString,B.base64);var k=new g(N,S,B);this.files[N]=k}var a=e("./utf8"),s=e("./utils"),l=e("./stream/GenericWorker"),u=e("./stream/StreamHelper"),p=e("./defaults"),m=e("./compressedObject"),g=e("./zipObject"),d=e("./generate"),y=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),v=function(N){N.slice(-1)==="/"&&(N=N.substring(0,N.length-1));var D=N.lastIndexOf("/");return 0<D?N.substring(0,D):""},b=function(N){return N.slice(-1)!=="/"&&(N+="/"),N},x=function(N,D){return D=D!==void 0?D:p.createFolders,N=b(N),this.files[N]||r.call(this,N,null,{dir:!0,createFolders:D}),this.files[N]};function w(N){return Object.prototype.toString.call(N)==="[object RegExp]"}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(N){var D,C,E;for(D in this.files)E=this.files[D],(C=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&N(C,E)},filter:function(N){var D=[];return this.forEach(function(C,E){N(C,E)&&D.push(E)}),D},file:function(N,D,C){if(arguments.length!==1)return N=this.root+N,r.call(this,N,D,C),this;if(w(N)){var E=N;return this.filter(function(B,F){return!F.dir&&E.test(B)})}var R=this.files[this.root+N];return R&&!R.dir?R:null},folder:function(N){if(!N)return this;if(w(N))return this.filter(function(R,B){return B.dir&&N.test(R)});var D=this.root+N,C=x.call(this,D),E=this.clone();return E.root=C.name,E},remove:function(N){N=this.root+N;var D=this.files[N];if(D||(N.slice(-1)!=="/"&&(N+="/"),D=this.files[N]),D&&!D.dir)delete this.files[N];else for(var C=this.filter(function(R,B){return B.name.slice(0,N.length)===N}),E=0;E<C.length;E++)delete this.files[C[E].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(N){var D,C={};try{if((C=s.extend(N||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),C.type==="binarystring"&&(C.type="string"),!C.type)throw new Error("No output type specified.");s.checkSupport(C.type),C.platform!=="darwin"&&C.platform!=="freebsd"&&C.platform!=="linux"&&C.platform!=="sunos"||(C.platform="UNIX"),C.platform==="win32"&&(C.platform="DOS");var E=C.comment||this.comment||"";D=d.generateWorker(this,C,E)}catch(R){(D=new l("error")).error(R)}return new u(D,C.type||"string",C.mimeType)},generateAsync:function(N,D){return this.generateInternalStream(N).accumulate(D)},generateNodeStream:function(N,D){return(N=N||{}).type||(N.type="nodebuffer"),this.generateInternalStream(N).toNodejsStream(D)}};o.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,o,i){o.exports=e("stream")},{stream:void 0}],17:[function(e,o,i){var r=e("./DataReader");function a(s){r.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}e("../utils").inherits(a,r),a.prototype.byteAt=function(s){return this.data[this.zero+s]},a.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),u=s.charCodeAt(1),p=s.charCodeAt(2),m=s.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===l&&this.data[g+1]===u&&this.data[g+2]===p&&this.data[g+3]===m)return g-this.zero;return-1},a.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),u=s.charCodeAt(1),p=s.charCodeAt(2),m=s.charCodeAt(3),g=this.readData(4);return l===g[0]&&u===g[1]&&p===g[2]&&m===g[3]},a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},o.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,o,i){var r=e("../utils");function a(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var l,u=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=s,u},readString:function(s){return r.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},o.exports=a},{"../utils":32}],19:[function(e,o,i){var r=e("./Uint8ArrayReader");function a(s){r.call(this,s)}e("../utils").inherits(a,r),a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},o.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,o,i){var r=e("./DataReader");function a(s){r.call(this,s)}e("../utils").inherits(a,r),a.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},a.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},a.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},o.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,o,i){var r=e("./ArrayReader");function a(s){r.call(this,s)}e("../utils").inherits(a,r),a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},o.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,o,i){var r=e("../utils"),a=e("../support"),s=e("./ArrayReader"),l=e("./StringReader"),u=e("./NodeBufferReader"),p=e("./Uint8ArrayReader");o.exports=function(m){var g=r.getTypeOf(m);return r.checkSupport(g),g!=="string"||a.uint8array?g==="nodebuffer"?new u(m):a.uint8array?new p(r.transformTo("uint8array",m)):new s(r.transformTo("array",m)):new l(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,o,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,o,i){var r=e("./GenericWorker"),a=e("../utils");function s(l){r.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(s,r),s.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},o.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,o,i){var r=e("./GenericWorker"),a=e("../crc32");function s(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,r),s.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},o.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,o,i){var r=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}r.inherits(s,a),s.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}a.prototype.processChunk.call(this,l)},o.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,o,i){var r=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(p){u.dataIsReady=!0,u.data=p,u.max=p&&p.length||0,u.type=r.getTypeOf(p),u.isPaused||u._tickAndRepeat()},function(p){u.error(p)})}r.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},o.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,o,i){function r(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,s){return this._listeners[a].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,s){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,s)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var s=this;return a.on("data",function(l){s.processChunk(l)}),a.on("end",function(){s.end()}),a.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,s){return this.extraStreamInfo[a]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},o.exports=r},{}],29:[function(e,o,i){var r=e("../utils"),a=e("./ConvertWorker"),s=e("./GenericWorker"),l=e("../base64"),u=e("../support"),p=e("../external"),m=null;if(u.nodestream)try{m=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(y,f){return new p.Promise(function(v,b){var x=[],w=y._internalType,_=y._outputType,N=y._mimeType;y.on("data",function(D,C){x.push(D),f&&f(C)}).on("error",function(D){x=[],b(D)}).on("end",function(){try{var D=function(C,E,R){switch(C){case"blob":return r.newBlob(r.transformTo("arraybuffer",E),R);case"base64":return l.encode(E);default:return r.transformTo(C,E)}}(_,function(C,E){var R,B=0,F=null,S=0;for(R=0;R<E.length;R++)S+=E[R].length;switch(C){case"string":return E.join("");case"array":return Array.prototype.concat.apply([],E);case"uint8array":for(F=new Uint8Array(S),R=0;R<E.length;R++)F.set(E[R],B),B+=E[R].length;return F;case"nodebuffer":return Buffer.concat(E);default:throw new Error("concat : unsupported type '"+C+"'")}}(w,x),N);v(D)}catch(C){b(C)}x=[]}).resume()})}function d(y,f,v){var b=f;switch(f){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=f,this._mimeType=v,r.checkSupport(b),this._worker=y.pipe(new a(b)),y.lock()}catch(x){this._worker=new s("error"),this._worker.error(x)}}d.prototype={accumulate:function(y){return g(this,y)},on:function(y,f){var v=this;return y==="data"?this._worker.on(y,function(b){f.call(v,b.data,b.meta)}):this._worker.on(y,function(){r.delay(f,arguments,v)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},y)}},o.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,o,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var r=new ArrayBuffer(0);try{i.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(r),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,o,i){for(var r=e("./utils"),a=e("./support"),s=e("./nodejsUtils"),l=e("./stream/GenericWorker"),u=new Array(256),p=0;p<256;p++)u[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;u[254]=u[254]=1;function m(){l.call(this,"utf-8 decode"),this.leftOver=null}function g(){l.call(this,"utf-8 encode")}i.utf8encode=function(d){return a.nodebuffer?s.newBufferFrom(d,"utf-8"):function(y){var f,v,b,x,w,_=y.length,N=0;for(x=0;x<_;x++)(64512&(v=y.charCodeAt(x)))==55296&&x+1<_&&(64512&(b=y.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),x++),N+=v<128?1:v<2048?2:v<65536?3:4;for(f=a.uint8array?new Uint8Array(N):new Array(N),x=w=0;w<N;x++)(64512&(v=y.charCodeAt(x)))==55296&&x+1<_&&(64512&(b=y.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),x++),v<128?f[w++]=v:(v<2048?f[w++]=192|v>>>6:(v<65536?f[w++]=224|v>>>12:(f[w++]=240|v>>>18,f[w++]=128|v>>>12&63),f[w++]=128|v>>>6&63),f[w++]=128|63&v);return f}(d)},i.utf8decode=function(d){return a.nodebuffer?r.transformTo("nodebuffer",d).toString("utf-8"):function(y){var f,v,b,x,w=y.length,_=new Array(2*w);for(f=v=0;f<w;)if((b=y[f++])<128)_[v++]=b;else if(4<(x=u[b]))_[v++]=65533,f+=x-1;else{for(b&=x===2?31:x===3?15:7;1<x&&f<w;)b=b<<6|63&y[f++],x--;1<x?_[v++]=65533:b<65536?_[v++]=b:(b-=65536,_[v++]=55296|b>>10&1023,_[v++]=56320|1023&b)}return _.length!==v&&(_.subarray?_=_.subarray(0,v):_.length=v),r.applyFromCharCode(_)}(d=r.transformTo(a.uint8array?"uint8array":"array",d))},r.inherits(m,l),m.prototype.processChunk=function(d){var y=r.transformTo(a.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var f=y;(y=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),y.set(f,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(x,w){var _;for((w=w||x.length)>x.length&&(w=x.length),_=w-1;0<=_&&(192&x[_])==128;)_--;return _<0||_===0?w:_+u[x[_]]>w?_:w}(y),b=y;v!==y.length&&(a.uint8array?(b=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(b=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:i.utf8decode(b),meta:d.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=m,r.inherits(g,l),g.prototype.processChunk=function(d){this.push({data:i.utf8encode(d.data),meta:d.meta})},i.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,o,i){var r=e("./support"),a=e("./base64"),s=e("./nodejsUtils"),l=e("./external");function u(f){return f}function p(f,v){for(var b=0;b<f.length;++b)v[b]=255&f.charCodeAt(b);return v}e("setimmediate"),i.newBlob=function(f,v){i.checkSupport("blob");try{return new Blob([f],{type:v})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(f),b.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(f,v,b){var x=[],w=0,_=f.length;if(_<=b)return String.fromCharCode.apply(null,f);for(;w<_;)v==="array"||v==="nodebuffer"?x.push(String.fromCharCode.apply(null,f.slice(w,Math.min(w+b,_)))):x.push(String.fromCharCode.apply(null,f.subarray(w,Math.min(w+b,_)))),w+=b;return x.join("")},stringifyByChar:function(f){for(var v="",b=0;b<f.length;b++)v+=String.fromCharCode(f[b]);return v},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function g(f){var v=65536,b=i.getTypeOf(f),x=!0;if(b==="uint8array"?x=m.applyCanBeUsed.uint8array:b==="nodebuffer"&&(x=m.applyCanBeUsed.nodebuffer),x)for(;1<v;)try{return m.stringifyByChunk(f,b,v)}catch{v=Math.floor(v/2)}return m.stringifyByChar(f)}function d(f,v){for(var b=0;b<f.length;b++)v[b]=f[b];return v}i.applyFromCharCode=g;var y={};y.string={string:u,array:function(f){return p(f,new Array(f.length))},arraybuffer:function(f){return y.string.uint8array(f).buffer},uint8array:function(f){return p(f,new Uint8Array(f.length))},nodebuffer:function(f){return p(f,s.allocBuffer(f.length))}},y.array={string:g,array:u,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(f)}},y.arraybuffer={string:function(f){return g(new Uint8Array(f))},array:function(f){return d(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:u,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(new Uint8Array(f))}},y.uint8array={string:g,array:function(f){return d(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:u,nodebuffer:function(f){return s.newBufferFrom(f)}},y.nodebuffer={string:g,array:function(f){return d(f,new Array(f.length))},arraybuffer:function(f){return y.nodebuffer.uint8array(f).buffer},uint8array:function(f){return d(f,new Uint8Array(f.length))},nodebuffer:u},i.transformTo=function(f,v){if(v=v||"",!f)return v;i.checkSupport(f);var b=i.getTypeOf(v);return y[b][f](v)},i.resolve=function(f){for(var v=f.split("/"),b=[],x=0;x<v.length;x++){var w=v[x];w==="."||w===""&&x!==0&&x!==v.length-1||(w===".."?b.pop():b.push(w))}return b.join("/")},i.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":r.nodebuffer&&s.isBuffer(f)?"nodebuffer":r.uint8array&&f instanceof Uint8Array?"uint8array":r.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(f){if(!r[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(f){var v,b,x="";for(b=0;b<(f||"").length;b++)x+="\\x"+((v=f.charCodeAt(b))<16?"0":"")+v.toString(16).toUpperCase();return x},i.delay=function(f,v,b){setImmediate(function(){f.apply(b||null,v||[])})},i.inherits=function(f,v){function b(){}b.prototype=v.prototype,f.prototype=new b},i.extend=function(){var f,v,b={};for(f=0;f<arguments.length;f++)for(v in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],v)&&b[v]===void 0&&(b[v]=arguments[f][v]);return b},i.prepareContent=function(f,v,b,x,w){return l.Promise.resolve(v).then(function(_){return r.blob&&(_ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(_))!==-1)&&typeof FileReader<"u"?new l.Promise(function(N,D){var C=new FileReader;C.onload=function(E){N(E.target.result)},C.onerror=function(E){D(E.target.error)},C.readAsArrayBuffer(_)}):_}).then(function(_){var N=i.getTypeOf(_);return N?(N==="arraybuffer"?_=i.transformTo("uint8array",_):N==="string"&&(w?_=a.decode(_):b&&x!==!0&&(_=function(D){return p(D,r.uint8array?new Uint8Array(D.length):new Array(D.length))}(_))),_):l.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,o,i){var r=e("./reader/readerFor"),a=e("./utils"),s=e("./signature"),l=e("./zipEntry"),u=e("./support");function p(m){this.files=[],this.loadOptions=m}p.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(g)+", expected "+a.pretty(m)+")")}},isSignature:function(m,g){var d=this.reader.index;this.reader.setIndex(m);var y=this.reader.readString(4)===g;return this.reader.setIndex(d),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),g=u.uint8array?"uint8array":"array",d=a.transformTo(g,m);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,g,d,y=this.zip64EndOfCentralSize-44;0<y;)m=this.reader.readInt(2),g=this.reader.readInt(4),d=this.reader.readData(g),this.zip64ExtensibleData[m]={id:m,length:g,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,g;for(m=0;m<this.files.length;m++)g=this.files[m],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(m=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var g=m;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var y=g-d;if(0<y)this.isSignature(g,s.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(m){this.reader=r(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},o.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,o,i){var r=e("./reader/readerFor"),a=e("./utils"),s=e("./compressedObject"),l=e("./crc32"),u=e("./utf8"),p=e("./compressions"),m=e("./support");function g(d,y){this.options=d,this.loadOptions=y}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var y,f;if(d.skip(22),this.fileNameLength=d.readInt(2),f=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var b in p)if(Object.prototype.hasOwnProperty.call(p,b)&&p[b].magic===v)return p[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,y,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var y=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(y),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=r(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var y,f,v,b=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<b;)y=d.readInt(2),f=d.readInt(2),v=d.readData(f),this.extraFields[y]={id:y,length:f,value:v};d.setIndex(b)},handleUTF8:function(){var d=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var f=a.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var b=a.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var y=r(d.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:u.utf8decode(y.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var y=r(d.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:u.utf8decode(y.readData(d.length-5))}return null}},o.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,o,i){function r(y,f,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=f,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),l=e("./utf8"),u=e("./compressedObject"),p=e("./stream/GenericWorker");r.prototype={internalStream:function(y){var f=null,v="string";try{if(!y)throw new Error("No output type specified.");var b=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),f=this._decompressWorker();var x=!this._dataBinary;x&&!b&&(f=f.pipe(new l.Utf8EncodeWorker)),!x&&b&&(f=f.pipe(new l.Utf8DecodeWorker))}catch(w){(f=new p("error")).error(w)}return new a(f,v,"")},async:function(y,f){return this.internalStream(y).accumulate(f)},nodeStream:function(y,f){return this.internalStream(y||"nodebuffer").toNodejsStream(f)},_compressWorker:function(y,f){if(this._data instanceof u&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(v,y,f)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof p?this._data:new s(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<m.length;d++)r.prototype[m[d]]=g;o.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,o,i){(function(r){var a,s,l=r.MutationObserver||r.WebKitMutationObserver;if(l){var u=0,p=new l(y),m=r.document.createTextNode("");p.observe(m,{characterData:!0}),a=function(){m.data=u=++u%2}}else if(r.setImmediate||r.MessageChannel===void 0)a="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var f=r.document.createElement("script");f.onreadystatechange=function(){y(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},r.document.documentElement.appendChild(f)}:function(){setTimeout(y,0)};else{var g=new r.MessageChannel;g.port1.onmessage=y,a=function(){g.port2.postMessage(0)}}var d=[];function y(){var f,v;s=!0;for(var b=d.length;b;){for(v=d,d=[],f=-1;++f<b;)v[f]();b=d.length}s=!1}o.exports=function(f){d.push(f)!==1||s||a()}}).call(this,typeof Be<"u"?Be:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,o,i){var r=e("immediate");function a(){}var s={},l=["REJECTED"],u=["FULFILLED"],p=["PENDING"];function m(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,b!==a&&f(this,b)}function g(b,x,w){this.promise=b,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function d(b,x,w){r(function(){var _;try{_=x(w)}catch(N){return s.reject(b,N)}_===b?s.reject(b,new TypeError("Cannot resolve promise with itself")):s.resolve(b,_)})}function y(b){var x=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof x=="function")return function(){x.apply(b,arguments)}}function f(b,x){var w=!1;function _(C){w||(w=!0,s.reject(b,C))}function N(C){w||(w=!0,s.resolve(b,C))}var D=v(function(){x(N,_)});D.status==="error"&&_(D.value)}function v(b,x){var w={};try{w.value=b(x),w.status="success"}catch(_){w.status="error",w.value=_}return w}(o.exports=m).prototype.finally=function(b){if(typeof b!="function")return this;var x=this.constructor;return this.then(function(w){return x.resolve(b()).then(function(){return w})},function(w){return x.resolve(b()).then(function(){throw w})})},m.prototype.catch=function(b){return this.then(null,b)},m.prototype.then=function(b,x){if(typeof b!="function"&&this.state===u||typeof x!="function"&&this.state===l)return this;var w=new this.constructor(a);return this.state!==p?d(w,this.state===u?b:x,this.outcome):this.queue.push(new g(w,b,x)),w},g.prototype.callFulfilled=function(b){s.resolve(this.promise,b)},g.prototype.otherCallFulfilled=function(b){d(this.promise,this.onFulfilled,b)},g.prototype.callRejected=function(b){s.reject(this.promise,b)},g.prototype.otherCallRejected=function(b){d(this.promise,this.onRejected,b)},s.resolve=function(b,x){var w=v(y,x);if(w.status==="error")return s.reject(b,w.value);var _=w.value;if(_)f(b,_);else{b.state=u,b.outcome=x;for(var N=-1,D=b.queue.length;++N<D;)b.queue[N].callFulfilled(x)}return b},s.reject=function(b,x){b.state=l,b.outcome=x;for(var w=-1,_=b.queue.length;++w<_;)b.queue[w].callRejected(x);return b},m.resolve=function(b){return b instanceof this?b:s.resolve(new this(a),b)},m.reject=function(b){var x=new this(a);return s.reject(x,b)},m.all=function(b){var x=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=b.length,_=!1;if(!w)return this.resolve([]);for(var N=new Array(w),D=0,C=-1,E=new this(a);++C<w;)R(b[C],C);return E;function R(B,F){x.resolve(B).then(function(S){N[F]=S,++D!==w||_||(_=!0,s.resolve(E,N))},function(S){_||(_=!0,s.reject(E,S))})}},m.race=function(b){var x=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=b.length,_=!1;if(!w)return this.resolve([]);for(var N=-1,D=new this(a);++N<w;)C=b[N],x.resolve(C).then(function(E){_||(_=!0,s.resolve(D,E))},function(E){_||(_=!0,s.reject(D,E))});var C;return D}},{immediate:36}],38:[function(e,o,i){var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),o.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,o,i){var r=e("./zlib/deflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/messages"),u=e("./zlib/zstream"),p=Object.prototype.toString,m=0,g=-1,d=0,y=8;function f(b){if(!(this instanceof f))return new f(b);this.options=a.assign({level:g,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},b||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var w=r.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(w!==m)throw new Error(l[w]);if(x.header&&r.deflateSetHeader(this.strm,x.header),x.dictionary){var _;if(_=typeof x.dictionary=="string"?s.string2buf(x.dictionary):p.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(w=r.deflateSetDictionary(this.strm,_))!==m)throw new Error(l[w]);this._dict_set=!0}}function v(b,x){var w=new f(x);if(w.push(b,!0),w.err)throw w.msg||l[w.err];return w.result}f.prototype.push=function(b,x){var w,_,N=this.strm,D=this.options.chunkSize;if(this.ended)return!1;_=x===~~x?x:x===!0?4:0,typeof b=="string"?N.input=s.string2buf(b):p.call(b)==="[object ArrayBuffer]"?N.input=new Uint8Array(b):N.input=b,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new a.Buf8(D),N.next_out=0,N.avail_out=D),(w=r.deflate(N,_))!==1&&w!==m)return this.onEnd(w),!(this.ended=!0);N.avail_out!==0&&(N.avail_in!==0||_!==4&&_!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(a.shrinkBuf(N.output,N.next_out))):this.onData(a.shrinkBuf(N.output,N.next_out)))}while((0<N.avail_in||N.avail_out===0)&&w!==1);return _===4?(w=r.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===m):_!==2||(this.onEnd(m),!(N.avail_out=0))},f.prototype.onData=function(b){this.chunks.push(b)},f.prototype.onEnd=function(b){b===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},i.Deflate=f,i.deflate=v,i.deflateRaw=function(b,x){return(x=x||{}).raw=!0,v(b,x)},i.gzip=function(b,x){return(x=x||{}).gzip=!0,v(b,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,o,i){var r=e("./zlib/inflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/constants"),u=e("./zlib/messages"),p=e("./zlib/zstream"),m=e("./zlib/gzheader"),g=Object.prototype.toString;function d(f){if(!(this instanceof d))return new d(f);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},f||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||f&&f.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var b=r.inflateInit2(this.strm,v.windowBits);if(b!==l.Z_OK)throw new Error(u[b]);this.header=new m,r.inflateGetHeader(this.strm,this.header)}function y(f,v){var b=new d(v);if(b.push(f,!0),b.err)throw b.msg||u[b.err];return b.result}d.prototype.push=function(f,v){var b,x,w,_,N,D,C=this.strm,E=this.options.chunkSize,R=this.options.dictionary,B=!1;if(this.ended)return!1;x=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?C.input=s.binstring2buf(f):g.call(f)==="[object ArrayBuffer]"?C.input=new Uint8Array(f):C.input=f,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(E),C.next_out=0,C.avail_out=E),(b=r.inflate(C,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&R&&(D=typeof R=="string"?s.string2buf(R):g.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,b=r.inflateSetDictionary(this.strm,D)),b===l.Z_BUF_ERROR&&B===!0&&(b=l.Z_OK,B=!1),b!==l.Z_STREAM_END&&b!==l.Z_OK)return this.onEnd(b),!(this.ended=!0);C.next_out&&(C.avail_out!==0&&b!==l.Z_STREAM_END&&(C.avail_in!==0||x!==l.Z_FINISH&&x!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(w=s.utf8border(C.output,C.next_out),_=C.next_out-w,N=s.buf2string(C.output,w),C.next_out=_,C.avail_out=E-_,_&&a.arraySet(C.output,C.output,w,_,0),this.onData(N)):this.onData(a.shrinkBuf(C.output,C.next_out)))),C.avail_in===0&&C.avail_out===0&&(B=!0)}while((0<C.avail_in||C.avail_out===0)&&b!==l.Z_STREAM_END);return b===l.Z_STREAM_END&&(x=l.Z_FINISH),x===l.Z_FINISH?(b=r.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===l.Z_OK):x!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(C.avail_out=0))},d.prototype.onData=function(f){this.chunks.push(f)},d.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},i.Inflate=d,i.inflate=y,i.inflateRaw=function(f,v){return(v=v||{}).raw=!0,y(f,v)},i.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,o,i){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var p=u.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var m in p)p.hasOwnProperty(m)&&(l[m]=p[m])}}return l},i.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var a={arraySet:function(l,u,p,m,g){if(u.subarray&&l.subarray)l.set(u.subarray(p,p+m),g);else for(var d=0;d<m;d++)l[g+d]=u[p+d]},flattenChunks:function(l){var u,p,m,g,d,y;for(u=m=0,p=l.length;u<p;u++)m+=l[u].length;for(y=new Uint8Array(m),u=g=0,p=l.length;u<p;u++)d=l[u],y.set(d,g),g+=d.length;return y}},s={arraySet:function(l,u,p,m,g){for(var d=0;d<m;d++)l[g+d]=u[p+d]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,s))},i.setTyped(r)},{}],42:[function(e,o,i){var r=e("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new r.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function p(m,g){if(g<65537&&(m.subarray&&s||!m.subarray&&a))return String.fromCharCode.apply(null,r.shrinkBuf(m,g));for(var d="",y=0;y<g;y++)d+=String.fromCharCode(m[y]);return d}l[254]=l[254]=1,i.string2buf=function(m){var g,d,y,f,v,b=m.length,x=0;for(f=0;f<b;f++)(64512&(d=m.charCodeAt(f)))==55296&&f+1<b&&(64512&(y=m.charCodeAt(f+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),f++),x+=d<128?1:d<2048?2:d<65536?3:4;for(g=new r.Buf8(x),f=v=0;v<x;f++)(64512&(d=m.charCodeAt(f)))==55296&&f+1<b&&(64512&(y=m.charCodeAt(f+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),f++),d<128?g[v++]=d:(d<2048?g[v++]=192|d>>>6:(d<65536?g[v++]=224|d>>>12:(g[v++]=240|d>>>18,g[v++]=128|d>>>12&63),g[v++]=128|d>>>6&63),g[v++]=128|63&d);return g},i.buf2binstring=function(m){return p(m,m.length)},i.binstring2buf=function(m){for(var g=new r.Buf8(m.length),d=0,y=g.length;d<y;d++)g[d]=m.charCodeAt(d);return g},i.buf2string=function(m,g){var d,y,f,v,b=g||m.length,x=new Array(2*b);for(d=y=0;d<b;)if((f=m[d++])<128)x[y++]=f;else if(4<(v=l[f]))x[y++]=65533,d+=v-1;else{for(f&=v===2?31:v===3?15:7;1<v&&d<b;)f=f<<6|63&m[d++],v--;1<v?x[y++]=65533:f<65536?x[y++]=f:(f-=65536,x[y++]=55296|f>>10&1023,x[y++]=56320|1023&f)}return p(x,y)},i.utf8border=function(m,g){var d;for((g=g||m.length)>m.length&&(g=m.length),d=g-1;0<=d&&(192&m[d])==128;)d--;return d<0||d===0?g:d+l[m[d]]>g?d:g}},{"./common":41}],43:[function(e,o,i){o.exports=function(r,a,s,l){for(var u=65535&r|0,p=r>>>16&65535|0,m=0;s!==0;){for(s-=m=2e3<s?2e3:s;p=p+(u=u+a[l++]|0)|0,--m;);u%=65521,p%=65521}return u|p<<16|0}},{}],44:[function(e,o,i){o.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,o,i){var r=function(){for(var a,s=[],l=0;l<256;l++){a=l;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;s[l]=a}return s}();o.exports=function(a,s,l,u){var p=r,m=u+l;a^=-1;for(var g=u;g<m;g++)a=a>>>8^p[255&(a^s[g])];return-1^a}},{}],46:[function(e,o,i){var r,a=e("../utils/common"),s=e("./trees"),l=e("./adler32"),u=e("./crc32"),p=e("./messages"),m=0,g=4,d=0,y=-2,f=-1,v=4,b=2,x=8,w=9,_=286,N=30,D=19,C=2*_+1,E=15,R=3,B=258,F=B+R+1,S=42,k=113,c=1,O=2,K=3,q=4;function V(h,G){return h.msg=p[G],G}function U(h){return(h<<1)-(4<h?9:0)}function et(h){for(var G=h.length;0<=--G;)h[G]=0}function P(h){var G=h.state,W=G.pending;W>h.avail_out&&(W=h.avail_out),W!==0&&(a.arraySet(h.output,G.pending_buf,G.pending_out,W,h.next_out),h.next_out+=W,G.pending_out+=W,h.total_out+=W,h.avail_out-=W,G.pending-=W,G.pending===0&&(G.pending_out=0))}function L(h,G){s._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,G),h.block_start=h.strstart,P(h.strm)}function J(h,G){h.pending_buf[h.pending++]=G}function Z(h,G){h.pending_buf[h.pending++]=G>>>8&255,h.pending_buf[h.pending++]=255&G}function $(h,G){var W,T,A=h.max_chain_length,j=h.strstart,Y=h.prev_length,H=h.nice_match,M=h.strstart>h.w_size-F?h.strstart-(h.w_size-F):0,X=h.window,tt=h.w_mask,Q=h.prev,st=h.strstart+B,ft=X[j+Y-1],ct=X[j+Y];h.prev_length>=h.good_match&&(A>>=2),H>h.lookahead&&(H=h.lookahead);do if(X[(W=G)+Y]===ct&&X[W+Y-1]===ft&&X[W]===X[j]&&X[++W]===X[j+1]){j+=2,W++;do;while(X[++j]===X[++W]&&X[++j]===X[++W]&&X[++j]===X[++W]&&X[++j]===X[++W]&&X[++j]===X[++W]&&X[++j]===X[++W]&&X[++j]===X[++W]&&X[++j]===X[++W]&&j<st);if(T=B-(st-j),j=st-B,Y<T){if(h.match_start=G,H<=(Y=T))break;ft=X[j+Y-1],ct=X[j+Y]}}while((G=Q[G&tt])>M&&--A!=0);return Y<=h.lookahead?Y:h.lookahead}function dt(h){var G,W,T,A,j,Y,H,M,X,tt,Q=h.w_size;do{if(A=h.window_size-h.lookahead-h.strstart,h.strstart>=Q+(Q-F)){for(a.arraySet(h.window,h.window,Q,Q,0),h.match_start-=Q,h.strstart-=Q,h.block_start-=Q,G=W=h.hash_size;T=h.head[--G],h.head[G]=Q<=T?T-Q:0,--W;);for(G=W=Q;T=h.prev[--G],h.prev[G]=Q<=T?T-Q:0,--W;);A+=Q}if(h.strm.avail_in===0)break;if(Y=h.strm,H=h.window,M=h.strstart+h.lookahead,X=A,tt=void 0,tt=Y.avail_in,X<tt&&(tt=X),W=tt===0?0:(Y.avail_in-=tt,a.arraySet(H,Y.input,Y.next_in,tt,M),Y.state.wrap===1?Y.adler=l(Y.adler,H,tt,M):Y.state.wrap===2&&(Y.adler=u(Y.adler,H,tt,M)),Y.next_in+=tt,Y.total_in+=tt,tt),h.lookahead+=W,h.lookahead+h.insert>=R)for(j=h.strstart-h.insert,h.ins_h=h.window[j],h.ins_h=(h.ins_h<<h.hash_shift^h.window[j+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[j+R-1])&h.hash_mask,h.prev[j&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=j,j++,h.insert--,!(h.lookahead+h.insert<R)););}while(h.lookahead<F&&h.strm.avail_in!==0)}function lt(h,G){for(var W,T;;){if(h.lookahead<F){if(dt(h),h.lookahead<F&&G===m)return c;if(h.lookahead===0)break}if(W=0,h.lookahead>=R&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+R-1])&h.hash_mask,W=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),W!==0&&h.strstart-W<=h.w_size-F&&(h.match_length=$(h,W)),h.match_length>=R)if(T=s._tr_tally(h,h.strstart-h.match_start,h.match_length-R),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=R){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+R-1])&h.hash_mask,W=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else T=s._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(T&&(L(h,!1),h.strm.avail_out===0))return c}return h.insert=h.strstart<R-1?h.strstart:R-1,G===g?(L(h,!0),h.strm.avail_out===0?K:q):h.last_lit&&(L(h,!1),h.strm.avail_out===0)?c:O}function it(h,G){for(var W,T,A;;){if(h.lookahead<F){if(dt(h),h.lookahead<F&&G===m)return c;if(h.lookahead===0)break}if(W=0,h.lookahead>=R&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+R-1])&h.hash_mask,W=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=R-1,W!==0&&h.prev_length<h.max_lazy_match&&h.strstart-W<=h.w_size-F&&(h.match_length=$(h,W),h.match_length<=5&&(h.strategy===1||h.match_length===R&&4096<h.strstart-h.match_start)&&(h.match_length=R-1)),h.prev_length>=R&&h.match_length<=h.prev_length){for(A=h.strstart+h.lookahead-R,T=s._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-R),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=A&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+R-1])&h.hash_mask,W=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=R-1,h.strstart++,T&&(L(h,!1),h.strm.avail_out===0))return c}else if(h.match_available){if((T=s._tr_tally(h,0,h.window[h.strstart-1]))&&L(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return c}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(T=s._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<R-1?h.strstart:R-1,G===g?(L(h,!0),h.strm.avail_out===0?K:q):h.last_lit&&(L(h,!1),h.strm.avail_out===0)?c:O}function at(h,G,W,T,A){this.good_length=h,this.max_lazy=G,this.nice_length=W,this.max_chain=T,this.func=A}function ot(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*C),this.dyn_dtree=new a.Buf16(2*(2*N+1)),this.bl_tree=new a.Buf16(2*(2*D+1)),et(this.dyn_ltree),et(this.dyn_dtree),et(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(E+1),this.heap=new a.Buf16(2*_+1),et(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*_+1),et(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pt(h){var G;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=b,(G=h.state).pending=0,G.pending_out=0,G.wrap<0&&(G.wrap=-G.wrap),G.status=G.wrap?S:k,h.adler=G.wrap===2?0:1,G.last_flush=m,s._tr_init(G),d):V(h,y)}function gt(h){var G=pt(h);return G===d&&function(W){W.window_size=2*W.w_size,et(W.head),W.max_lazy_match=r[W.level].max_lazy,W.good_match=r[W.level].good_length,W.nice_match=r[W.level].nice_length,W.max_chain_length=r[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=R-1,W.match_available=0,W.ins_h=0}(h.state),G}function Et(h,G,W,T,A,j){if(!h)return y;var Y=1;if(G===f&&(G=6),T<0?(Y=0,T=-T):15<T&&(Y=2,T-=16),A<1||w<A||W!==x||T<8||15<T||G<0||9<G||j<0||v<j)return V(h,y);T===8&&(T=9);var H=new ot;return(h.state=H).strm=h,H.wrap=Y,H.gzhead=null,H.w_bits=T,H.w_size=1<<H.w_bits,H.w_mask=H.w_size-1,H.hash_bits=A+7,H.hash_size=1<<H.hash_bits,H.hash_mask=H.hash_size-1,H.hash_shift=~~((H.hash_bits+R-1)/R),H.window=new a.Buf8(2*H.w_size),H.head=new a.Buf16(H.hash_size),H.prev=new a.Buf16(H.w_size),H.lit_bufsize=1<<A+6,H.pending_buf_size=4*H.lit_bufsize,H.pending_buf=new a.Buf8(H.pending_buf_size),H.d_buf=1*H.lit_bufsize,H.l_buf=3*H.lit_bufsize,H.level=G,H.strategy=j,H.method=W,gt(h)}r=[new at(0,0,0,0,function(h,G){var W=65535;for(W>h.pending_buf_size-5&&(W=h.pending_buf_size-5);;){if(h.lookahead<=1){if(dt(h),h.lookahead===0&&G===m)return c;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var T=h.block_start+W;if((h.strstart===0||h.strstart>=T)&&(h.lookahead=h.strstart-T,h.strstart=T,L(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-F&&(L(h,!1),h.strm.avail_out===0))return c}return h.insert=0,G===g?(L(h,!0),h.strm.avail_out===0?K:q):(h.strstart>h.block_start&&(L(h,!1),h.strm.avail_out),c)}),new at(4,4,8,4,lt),new at(4,5,16,8,lt),new at(4,6,32,32,lt),new at(4,4,16,16,it),new at(8,16,32,32,it),new at(8,16,128,128,it),new at(8,32,128,256,it),new at(32,128,258,1024,it),new at(32,258,258,4096,it)],i.deflateInit=function(h,G){return Et(h,G,x,15,8,0)},i.deflateInit2=Et,i.deflateReset=gt,i.deflateResetKeep=pt,i.deflateSetHeader=function(h,G){return h&&h.state?h.state.wrap!==2?y:(h.state.gzhead=G,d):y},i.deflate=function(h,G){var W,T,A,j;if(!h||!h.state||5<G||G<0)return h?V(h,y):y;if(T=h.state,!h.output||!h.input&&h.avail_in!==0||T.status===666&&G!==g)return V(h,h.avail_out===0?-5:y);if(T.strm=h,W=T.last_flush,T.last_flush=G,T.status===S)if(T.wrap===2)h.adler=0,J(T,31),J(T,139),J(T,8),T.gzhead?(J(T,(T.gzhead.text?1:0)+(T.gzhead.hcrc?2:0)+(T.gzhead.extra?4:0)+(T.gzhead.name?8:0)+(T.gzhead.comment?16:0)),J(T,255&T.gzhead.time),J(T,T.gzhead.time>>8&255),J(T,T.gzhead.time>>16&255),J(T,T.gzhead.time>>24&255),J(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),J(T,255&T.gzhead.os),T.gzhead.extra&&T.gzhead.extra.length&&(J(T,255&T.gzhead.extra.length),J(T,T.gzhead.extra.length>>8&255)),T.gzhead.hcrc&&(h.adler=u(h.adler,T.pending_buf,T.pending,0)),T.gzindex=0,T.status=69):(J(T,0),J(T,0),J(T,0),J(T,0),J(T,0),J(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),J(T,3),T.status=k);else{var Y=x+(T.w_bits-8<<4)<<8;Y|=(2<=T.strategy||T.level<2?0:T.level<6?1:T.level===6?2:3)<<6,T.strstart!==0&&(Y|=32),Y+=31-Y%31,T.status=k,Z(T,Y),T.strstart!==0&&(Z(T,h.adler>>>16),Z(T,65535&h.adler)),h.adler=1}if(T.status===69)if(T.gzhead.extra){for(A=T.pending;T.gzindex<(65535&T.gzhead.extra.length)&&(T.pending!==T.pending_buf_size||(T.gzhead.hcrc&&T.pending>A&&(h.adler=u(h.adler,T.pending_buf,T.pending-A,A)),P(h),A=T.pending,T.pending!==T.pending_buf_size));)J(T,255&T.gzhead.extra[T.gzindex]),T.gzindex++;T.gzhead.hcrc&&T.pending>A&&(h.adler=u(h.adler,T.pending_buf,T.pending-A,A)),T.gzindex===T.gzhead.extra.length&&(T.gzindex=0,T.status=73)}else T.status=73;if(T.status===73)if(T.gzhead.name){A=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>A&&(h.adler=u(h.adler,T.pending_buf,T.pending-A,A)),P(h),A=T.pending,T.pending===T.pending_buf_size)){j=1;break}j=T.gzindex<T.gzhead.name.length?255&T.gzhead.name.charCodeAt(T.gzindex++):0,J(T,j)}while(j!==0);T.gzhead.hcrc&&T.pending>A&&(h.adler=u(h.adler,T.pending_buf,T.pending-A,A)),j===0&&(T.gzindex=0,T.status=91)}else T.status=91;if(T.status===91)if(T.gzhead.comment){A=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>A&&(h.adler=u(h.adler,T.pending_buf,T.pending-A,A)),P(h),A=T.pending,T.pending===T.pending_buf_size)){j=1;break}j=T.gzindex<T.gzhead.comment.length?255&T.gzhead.comment.charCodeAt(T.gzindex++):0,J(T,j)}while(j!==0);T.gzhead.hcrc&&T.pending>A&&(h.adler=u(h.adler,T.pending_buf,T.pending-A,A)),j===0&&(T.status=103)}else T.status=103;if(T.status===103&&(T.gzhead.hcrc?(T.pending+2>T.pending_buf_size&&P(h),T.pending+2<=T.pending_buf_size&&(J(T,255&h.adler),J(T,h.adler>>8&255),h.adler=0,T.status=k)):T.status=k),T.pending!==0){if(P(h),h.avail_out===0)return T.last_flush=-1,d}else if(h.avail_in===0&&U(G)<=U(W)&&G!==g)return V(h,-5);if(T.status===666&&h.avail_in!==0)return V(h,-5);if(h.avail_in!==0||T.lookahead!==0||G!==m&&T.status!==666){var H=T.strategy===2?function(M,X){for(var tt;;){if(M.lookahead===0&&(dt(M),M.lookahead===0)){if(X===m)return c;break}if(M.match_length=0,tt=s._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++,tt&&(L(M,!1),M.strm.avail_out===0))return c}return M.insert=0,X===g?(L(M,!0),M.strm.avail_out===0?K:q):M.last_lit&&(L(M,!1),M.strm.avail_out===0)?c:O}(T,G):T.strategy===3?function(M,X){for(var tt,Q,st,ft,ct=M.window;;){if(M.lookahead<=B){if(dt(M),M.lookahead<=B&&X===m)return c;if(M.lookahead===0)break}if(M.match_length=0,M.lookahead>=R&&0<M.strstart&&(Q=ct[st=M.strstart-1])===ct[++st]&&Q===ct[++st]&&Q===ct[++st]){ft=M.strstart+B;do;while(Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&st<ft);M.match_length=B-(ft-st),M.match_length>M.lookahead&&(M.match_length=M.lookahead)}if(M.match_length>=R?(tt=s._tr_tally(M,1,M.match_length-R),M.lookahead-=M.match_length,M.strstart+=M.match_length,M.match_length=0):(tt=s._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++),tt&&(L(M,!1),M.strm.avail_out===0))return c}return M.insert=0,X===g?(L(M,!0),M.strm.avail_out===0?K:q):M.last_lit&&(L(M,!1),M.strm.avail_out===0)?c:O}(T,G):r[T.level].func(T,G);if(H!==K&&H!==q||(T.status=666),H===c||H===K)return h.avail_out===0&&(T.last_flush=-1),d;if(H===O&&(G===1?s._tr_align(T):G!==5&&(s._tr_stored_block(T,0,0,!1),G===3&&(et(T.head),T.lookahead===0&&(T.strstart=0,T.block_start=0,T.insert=0))),P(h),h.avail_out===0))return T.last_flush=-1,d}return G!==g?d:T.wrap<=0?1:(T.wrap===2?(J(T,255&h.adler),J(T,h.adler>>8&255),J(T,h.adler>>16&255),J(T,h.adler>>24&255),J(T,255&h.total_in),J(T,h.total_in>>8&255),J(T,h.total_in>>16&255),J(T,h.total_in>>24&255)):(Z(T,h.adler>>>16),Z(T,65535&h.adler)),P(h),0<T.wrap&&(T.wrap=-T.wrap),T.pending!==0?d:1)},i.deflateEnd=function(h){var G;return h&&h.state?(G=h.state.status)!==S&&G!==69&&G!==73&&G!==91&&G!==103&&G!==k&&G!==666?V(h,y):(h.state=null,G===k?V(h,-3):d):y},i.deflateSetDictionary=function(h,G){var W,T,A,j,Y,H,M,X,tt=G.length;if(!h||!h.state||(j=(W=h.state).wrap)===2||j===1&&W.status!==S||W.lookahead)return y;for(j===1&&(h.adler=l(h.adler,G,tt,0)),W.wrap=0,tt>=W.w_size&&(j===0&&(et(W.head),W.strstart=0,W.block_start=0,W.insert=0),X=new a.Buf8(W.w_size),a.arraySet(X,G,tt-W.w_size,W.w_size,0),G=X,tt=W.w_size),Y=h.avail_in,H=h.next_in,M=h.input,h.avail_in=tt,h.next_in=0,h.input=G,dt(W);W.lookahead>=R;){for(T=W.strstart,A=W.lookahead-(R-1);W.ins_h=(W.ins_h<<W.hash_shift^W.window[T+R-1])&W.hash_mask,W.prev[T&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=T,T++,--A;);W.strstart=T,W.lookahead=R-1,dt(W)}return W.strstart+=W.lookahead,W.block_start=W.strstart,W.insert=W.lookahead,W.lookahead=0,W.match_length=W.prev_length=R-1,W.match_available=0,h.next_in=H,h.input=M,h.avail_in=Y,W.wrap=j,d},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,o,i){o.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,o,i){o.exports=function(r,a){var s,l,u,p,m,g,d,y,f,v,b,x,w,_,N,D,C,E,R,B,F,S,k,c,O;s=r.state,l=r.next_in,c=r.input,u=l+(r.avail_in-5),p=r.next_out,O=r.output,m=p-(a-r.avail_out),g=p+(r.avail_out-257),d=s.dmax,y=s.wsize,f=s.whave,v=s.wnext,b=s.window,x=s.hold,w=s.bits,_=s.lencode,N=s.distcode,D=(1<<s.lenbits)-1,C=(1<<s.distbits)-1;t:do{w<15&&(x+=c[l++]<<w,w+=8,x+=c[l++]<<w,w+=8),E=_[x&D];e:for(;;){if(x>>>=R=E>>>24,w-=R,(R=E>>>16&255)===0)O[p++]=65535&E;else{if(!(16&R)){if((64&R)==0){E=_[(65535&E)+(x&(1<<R)-1)];continue e}if(32&R){s.mode=12;break t}r.msg="invalid literal/length code",s.mode=30;break t}B=65535&E,(R&=15)&&(w<R&&(x+=c[l++]<<w,w+=8),B+=x&(1<<R)-1,x>>>=R,w-=R),w<15&&(x+=c[l++]<<w,w+=8,x+=c[l++]<<w,w+=8),E=N[x&C];n:for(;;){if(x>>>=R=E>>>24,w-=R,!(16&(R=E>>>16&255))){if((64&R)==0){E=N[(65535&E)+(x&(1<<R)-1)];continue n}r.msg="invalid distance code",s.mode=30;break t}if(F=65535&E,w<(R&=15)&&(x+=c[l++]<<w,(w+=8)<R&&(x+=c[l++]<<w,w+=8)),d<(F+=x&(1<<R)-1)){r.msg="invalid distance too far back",s.mode=30;break t}if(x>>>=R,w-=R,(R=p-m)<F){if(f<(R=F-R)&&s.sane){r.msg="invalid distance too far back",s.mode=30;break t}if(k=b,(S=0)===v){if(S+=y-R,R<B){for(B-=R;O[p++]=b[S++],--R;);S=p-F,k=O}}else if(v<R){if(S+=y+v-R,(R-=v)<B){for(B-=R;O[p++]=b[S++],--R;);if(S=0,v<B){for(B-=R=v;O[p++]=b[S++],--R;);S=p-F,k=O}}}else if(S+=v-R,R<B){for(B-=R;O[p++]=b[S++],--R;);S=p-F,k=O}for(;2<B;)O[p++]=k[S++],O[p++]=k[S++],O[p++]=k[S++],B-=3;B&&(O[p++]=k[S++],1<B&&(O[p++]=k[S++]))}else{for(S=p-F;O[p++]=O[S++],O[p++]=O[S++],O[p++]=O[S++],2<(B-=3););B&&(O[p++]=O[S++],1<B&&(O[p++]=O[S++]))}break}}break}}while(l<u&&p<g);l-=B=w>>3,x&=(1<<(w-=B<<3))-1,r.next_in=l,r.next_out=p,r.avail_in=l<u?u-l+5:5-(l-u),r.avail_out=p<g?g-p+257:257-(p-g),s.hold=x,s.bits=w}},{}],49:[function(e,o,i){var r=e("../utils/common"),a=e("./adler32"),s=e("./crc32"),l=e("./inffast"),u=e("./inftrees"),p=1,m=2,g=0,d=-2,y=1,f=852,v=592;function b(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(S){var k;return S&&S.state?(k=S.state,S.total_in=S.total_out=k.total=0,S.msg="",k.wrap&&(S.adler=1&k.wrap),k.mode=y,k.last=0,k.havedict=0,k.dmax=32768,k.head=null,k.hold=0,k.bits=0,k.lencode=k.lendyn=new r.Buf32(f),k.distcode=k.distdyn=new r.Buf32(v),k.sane=1,k.back=-1,g):d}function _(S){var k;return S&&S.state?((k=S.state).wsize=0,k.whave=0,k.wnext=0,w(S)):d}function N(S,k){var c,O;return S&&S.state?(O=S.state,k<0?(c=0,k=-k):(c=1+(k>>4),k<48&&(k&=15)),k&&(k<8||15<k)?d:(O.window!==null&&O.wbits!==k&&(O.window=null),O.wrap=c,O.wbits=k,_(S))):d}function D(S,k){var c,O;return S?(O=new x,(S.state=O).window=null,(c=N(S,k))!==g&&(S.state=null),c):d}var C,E,R=!0;function B(S){if(R){var k;for(C=new r.Buf32(512),E=new r.Buf32(32),k=0;k<144;)S.lens[k++]=8;for(;k<256;)S.lens[k++]=9;for(;k<280;)S.lens[k++]=7;for(;k<288;)S.lens[k++]=8;for(u(p,S.lens,0,288,C,0,S.work,{bits:9}),k=0;k<32;)S.lens[k++]=5;u(m,S.lens,0,32,E,0,S.work,{bits:5}),R=!1}S.lencode=C,S.lenbits=9,S.distcode=E,S.distbits=5}function F(S,k,c,O){var K,q=S.state;return q.window===null&&(q.wsize=1<<q.wbits,q.wnext=0,q.whave=0,q.window=new r.Buf8(q.wsize)),O>=q.wsize?(r.arraySet(q.window,k,c-q.wsize,q.wsize,0),q.wnext=0,q.whave=q.wsize):(O<(K=q.wsize-q.wnext)&&(K=O),r.arraySet(q.window,k,c-O,K,q.wnext),(O-=K)?(r.arraySet(q.window,k,c-O,O,0),q.wnext=O,q.whave=q.wsize):(q.wnext+=K,q.wnext===q.wsize&&(q.wnext=0),q.whave<q.wsize&&(q.whave+=K))),0}i.inflateReset=_,i.inflateReset2=N,i.inflateResetKeep=w,i.inflateInit=function(S){return D(S,15)},i.inflateInit2=D,i.inflate=function(S,k){var c,O,K,q,V,U,et,P,L,J,Z,$,dt,lt,it,at,ot,pt,gt,Et,h,G,W,T,A=0,j=new r.Buf8(4),Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return d;(c=S.state).mode===12&&(c.mode=13),V=S.next_out,K=S.output,et=S.avail_out,q=S.next_in,O=S.input,U=S.avail_in,P=c.hold,L=c.bits,J=U,Z=et,G=g;t:for(;;)switch(c.mode){case y:if(c.wrap===0){c.mode=13;break}for(;L<16;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}if(2&c.wrap&&P===35615){j[c.check=0]=255&P,j[1]=P>>>8&255,c.check=s(c.check,j,2,0),L=P=0,c.mode=2;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&P)<<8)+(P>>8))%31){S.msg="incorrect header check",c.mode=30;break}if((15&P)!=8){S.msg="unknown compression method",c.mode=30;break}if(L-=4,h=8+(15&(P>>>=4)),c.wbits===0)c.wbits=h;else if(h>c.wbits){S.msg="invalid window size",c.mode=30;break}c.dmax=1<<h,S.adler=c.check=1,c.mode=512&P?10:12,L=P=0;break;case 2:for(;L<16;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}if(c.flags=P,(255&c.flags)!=8){S.msg="unknown compression method",c.mode=30;break}if(57344&c.flags){S.msg="unknown header flags set",c.mode=30;break}c.head&&(c.head.text=P>>8&1),512&c.flags&&(j[0]=255&P,j[1]=P>>>8&255,c.check=s(c.check,j,2,0)),L=P=0,c.mode=3;case 3:for(;L<32;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}c.head&&(c.head.time=P),512&c.flags&&(j[0]=255&P,j[1]=P>>>8&255,j[2]=P>>>16&255,j[3]=P>>>24&255,c.check=s(c.check,j,4,0)),L=P=0,c.mode=4;case 4:for(;L<16;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}c.head&&(c.head.xflags=255&P,c.head.os=P>>8),512&c.flags&&(j[0]=255&P,j[1]=P>>>8&255,c.check=s(c.check,j,2,0)),L=P=0,c.mode=5;case 5:if(1024&c.flags){for(;L<16;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}c.length=P,c.head&&(c.head.extra_len=P),512&c.flags&&(j[0]=255&P,j[1]=P>>>8&255,c.check=s(c.check,j,2,0)),L=P=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(1024&c.flags&&(U<($=c.length)&&($=U),$&&(c.head&&(h=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),r.arraySet(c.head.extra,O,q,$,h)),512&c.flags&&(c.check=s(c.check,O,$,q)),U-=$,q+=$,c.length-=$),c.length))break t;c.length=0,c.mode=7;case 7:if(2048&c.flags){if(U===0)break t;for($=0;h=O[q+$++],c.head&&h&&c.length<65536&&(c.head.name+=String.fromCharCode(h)),h&&$<U;);if(512&c.flags&&(c.check=s(c.check,O,$,q)),U-=$,q+=$,h)break t}else c.head&&(c.head.name=null);c.length=0,c.mode=8;case 8:if(4096&c.flags){if(U===0)break t;for($=0;h=O[q+$++],c.head&&h&&c.length<65536&&(c.head.comment+=String.fromCharCode(h)),h&&$<U;);if(512&c.flags&&(c.check=s(c.check,O,$,q)),U-=$,q+=$,h)break t}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(512&c.flags){for(;L<16;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}if(P!==(65535&c.check)){S.msg="header crc mismatch",c.mode=30;break}L=P=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),S.adler=c.check=0,c.mode=12;break;case 10:for(;L<32;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}S.adler=c.check=b(P),L=P=0,c.mode=11;case 11:if(c.havedict===0)return S.next_out=V,S.avail_out=et,S.next_in=q,S.avail_in=U,c.hold=P,c.bits=L,2;S.adler=c.check=1,c.mode=12;case 12:if(k===5||k===6)break t;case 13:if(c.last){P>>>=7&L,L-=7&L,c.mode=27;break}for(;L<3;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}switch(c.last=1&P,L-=1,3&(P>>>=1)){case 0:c.mode=14;break;case 1:if(B(c),c.mode=20,k!==6)break;P>>>=2,L-=2;break t;case 2:c.mode=17;break;case 3:S.msg="invalid block type",c.mode=30}P>>>=2,L-=2;break;case 14:for(P>>>=7&L,L-=7&L;L<32;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}if((65535&P)!=(P>>>16^65535)){S.msg="invalid stored block lengths",c.mode=30;break}if(c.length=65535&P,L=P=0,c.mode=15,k===6)break t;case 15:c.mode=16;case 16:if($=c.length){if(U<$&&($=U),et<$&&($=et),$===0)break t;r.arraySet(K,O,q,$,V),U-=$,q+=$,et-=$,V+=$,c.length-=$;break}c.mode=12;break;case 17:for(;L<14;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}if(c.nlen=257+(31&P),P>>>=5,L-=5,c.ndist=1+(31&P),P>>>=5,L-=5,c.ncode=4+(15&P),P>>>=4,L-=4,286<c.nlen||30<c.ndist){S.msg="too many length or distance symbols",c.mode=30;break}c.have=0,c.mode=18;case 18:for(;c.have<c.ncode;){for(;L<3;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}c.lens[Y[c.have++]]=7&P,P>>>=3,L-=3}for(;c.have<19;)c.lens[Y[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,W={bits:c.lenbits},G=u(0,c.lens,0,19,c.lencode,0,c.work,W),c.lenbits=W.bits,G){S.msg="invalid code lengths set",c.mode=30;break}c.have=0,c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;at=(A=c.lencode[P&(1<<c.lenbits)-1])>>>16&255,ot=65535&A,!((it=A>>>24)<=L);){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}if(ot<16)P>>>=it,L-=it,c.lens[c.have++]=ot;else{if(ot===16){for(T=it+2;L<T;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}if(P>>>=it,L-=it,c.have===0){S.msg="invalid bit length repeat",c.mode=30;break}h=c.lens[c.have-1],$=3+(3&P),P>>>=2,L-=2}else if(ot===17){for(T=it+3;L<T;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}L-=it,h=0,$=3+(7&(P>>>=it)),P>>>=3,L-=3}else{for(T=it+7;L<T;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}L-=it,h=0,$=11+(127&(P>>>=it)),P>>>=7,L-=7}if(c.have+$>c.nlen+c.ndist){S.msg="invalid bit length repeat",c.mode=30;break}for(;$--;)c.lens[c.have++]=h}}if(c.mode===30)break;if(c.lens[256]===0){S.msg="invalid code -- missing end-of-block",c.mode=30;break}if(c.lenbits=9,W={bits:c.lenbits},G=u(p,c.lens,0,c.nlen,c.lencode,0,c.work,W),c.lenbits=W.bits,G){S.msg="invalid literal/lengths set",c.mode=30;break}if(c.distbits=6,c.distcode=c.distdyn,W={bits:c.distbits},G=u(m,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,W),c.distbits=W.bits,G){S.msg="invalid distances set",c.mode=30;break}if(c.mode=20,k===6)break t;case 20:c.mode=21;case 21:if(6<=U&&258<=et){S.next_out=V,S.avail_out=et,S.next_in=q,S.avail_in=U,c.hold=P,c.bits=L,l(S,Z),V=S.next_out,K=S.output,et=S.avail_out,q=S.next_in,O=S.input,U=S.avail_in,P=c.hold,L=c.bits,c.mode===12&&(c.back=-1);break}for(c.back=0;at=(A=c.lencode[P&(1<<c.lenbits)-1])>>>16&255,ot=65535&A,!((it=A>>>24)<=L);){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}if(at&&(240&at)==0){for(pt=it,gt=at,Et=ot;at=(A=c.lencode[Et+((P&(1<<pt+gt)-1)>>pt)])>>>16&255,ot=65535&A,!(pt+(it=A>>>24)<=L);){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}P>>>=pt,L-=pt,c.back+=pt}if(P>>>=it,L-=it,c.back+=it,c.length=ot,at===0){c.mode=26;break}if(32&at){c.back=-1,c.mode=12;break}if(64&at){S.msg="invalid literal/length code",c.mode=30;break}c.extra=15&at,c.mode=22;case 22:if(c.extra){for(T=c.extra;L<T;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}c.length+=P&(1<<c.extra)-1,P>>>=c.extra,L-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=23;case 23:for(;at=(A=c.distcode[P&(1<<c.distbits)-1])>>>16&255,ot=65535&A,!((it=A>>>24)<=L);){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}if((240&at)==0){for(pt=it,gt=at,Et=ot;at=(A=c.distcode[Et+((P&(1<<pt+gt)-1)>>pt)])>>>16&255,ot=65535&A,!(pt+(it=A>>>24)<=L);){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}P>>>=pt,L-=pt,c.back+=pt}if(P>>>=it,L-=it,c.back+=it,64&at){S.msg="invalid distance code",c.mode=30;break}c.offset=ot,c.extra=15&at,c.mode=24;case 24:if(c.extra){for(T=c.extra;L<T;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}c.offset+=P&(1<<c.extra)-1,P>>>=c.extra,L-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){S.msg="invalid distance too far back",c.mode=30;break}c.mode=25;case 25:if(et===0)break t;if($=Z-et,c.offset>$){if(($=c.offset-$)>c.whave&&c.sane){S.msg="invalid distance too far back",c.mode=30;break}dt=$>c.wnext?($-=c.wnext,c.wsize-$):c.wnext-$,$>c.length&&($=c.length),lt=c.window}else lt=K,dt=V-c.offset,$=c.length;for(et<$&&($=et),et-=$,c.length-=$;K[V++]=lt[dt++],--$;);c.length===0&&(c.mode=21);break;case 26:if(et===0)break t;K[V++]=c.length,et--,c.mode=21;break;case 27:if(c.wrap){for(;L<32;){if(U===0)break t;U--,P|=O[q++]<<L,L+=8}if(Z-=et,S.total_out+=Z,c.total+=Z,Z&&(S.adler=c.check=c.flags?s(c.check,K,Z,V-Z):a(c.check,K,Z,V-Z)),Z=et,(c.flags?P:b(P))!==c.check){S.msg="incorrect data check",c.mode=30;break}L=P=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;L<32;){if(U===0)break t;U--,P+=O[q++]<<L,L+=8}if(P!==(4294967295&c.total)){S.msg="incorrect length check",c.mode=30;break}L=P=0}c.mode=29;case 29:G=1;break t;case 30:G=-3;break t;case 31:return-4;case 32:default:return d}return S.next_out=V,S.avail_out=et,S.next_in=q,S.avail_in=U,c.hold=P,c.bits=L,(c.wsize||Z!==S.avail_out&&c.mode<30&&(c.mode<27||k!==4))&&F(S,S.output,S.next_out,Z-S.avail_out)?(c.mode=31,-4):(J-=S.avail_in,Z-=S.avail_out,S.total_in+=J,S.total_out+=Z,c.total+=Z,c.wrap&&Z&&(S.adler=c.check=c.flags?s(c.check,K,Z,S.next_out-Z):a(c.check,K,Z,S.next_out-Z)),S.data_type=c.bits+(c.last?64:0)+(c.mode===12?128:0)+(c.mode===20||c.mode===15?256:0),(J==0&&Z===0||k===4)&&G===g&&(G=-5),G)},i.inflateEnd=function(S){if(!S||!S.state)return d;var k=S.state;return k.window&&(k.window=null),S.state=null,g},i.inflateGetHeader=function(S,k){var c;return S&&S.state?(2&(c=S.state).wrap)==0?d:((c.head=k).done=!1,g):d},i.inflateSetDictionary=function(S,k){var c,O=k.length;return S&&S.state?(c=S.state).wrap!==0&&c.mode!==11?d:c.mode===11&&a(1,k,O,0)!==c.check?-3:F(S,k,O,O)?(c.mode=31,-4):(c.havedict=1,g):d},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,o,i){var r=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];o.exports=function(p,m,g,d,y,f,v,b){var x,w,_,N,D,C,E,R,B,F=b.bits,S=0,k=0,c=0,O=0,K=0,q=0,V=0,U=0,et=0,P=0,L=null,J=0,Z=new r.Buf16(16),$=new r.Buf16(16),dt=null,lt=0;for(S=0;S<=15;S++)Z[S]=0;for(k=0;k<d;k++)Z[m[g+k]]++;for(K=F,O=15;1<=O&&Z[O]===0;O--);if(O<K&&(K=O),O===0)return y[f++]=20971520,y[f++]=20971520,b.bits=1,0;for(c=1;c<O&&Z[c]===0;c++);for(K<c&&(K=c),S=U=1;S<=15;S++)if(U<<=1,(U-=Z[S])<0)return-1;if(0<U&&(p===0||O!==1))return-1;for($[1]=0,S=1;S<15;S++)$[S+1]=$[S]+Z[S];for(k=0;k<d;k++)m[g+k]!==0&&(v[$[m[g+k]]++]=k);if(C=p===0?(L=dt=v,19):p===1?(L=a,J-=257,dt=s,lt-=257,256):(L=l,dt=u,-1),S=c,D=f,V=k=P=0,_=-1,N=(et=1<<(q=K))-1,p===1&&852<et||p===2&&592<et)return 1;for(;;){for(E=S-V,B=v[k]<C?(R=0,v[k]):v[k]>C?(R=dt[lt+v[k]],L[J+v[k]]):(R=96,0),x=1<<S-V,c=w=1<<q;y[D+(P>>V)+(w-=x)]=E<<24|R<<16|B|0,w!==0;);for(x=1<<S-1;P&x;)x>>=1;if(x!==0?(P&=x-1,P+=x):P=0,k++,--Z[S]==0){if(S===O)break;S=m[g+v[k]]}if(K<S&&(P&N)!==_){for(V===0&&(V=K),D+=c,U=1<<(q=S-V);q+V<O&&!((U-=Z[q+V])<=0);)q++,U<<=1;if(et+=1<<q,p===1&&852<et||p===2&&592<et)return 1;y[_=P&N]=K<<24|q<<16|D-f|0}}return P!==0&&(y[D+P]=S-V<<24|64<<16|0),b.bits=K,0}},{"../utils/common":41}],51:[function(e,o,i){o.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,o,i){var r=e("../utils/common"),a=0,s=1;function l(A){for(var j=A.length;0<=--j;)A[j]=0}var u=0,p=29,m=256,g=m+1+p,d=30,y=19,f=2*g+1,v=15,b=16,x=7,w=256,_=16,N=17,D=18,C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],E=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=new Array(2*(g+2));l(F);var S=new Array(2*d);l(S);var k=new Array(512);l(k);var c=new Array(256);l(c);var O=new Array(p);l(O);var K,q,V,U=new Array(d);function et(A,j,Y,H,M){this.static_tree=A,this.extra_bits=j,this.extra_base=Y,this.elems=H,this.max_length=M,this.has_stree=A&&A.length}function P(A,j){this.dyn_tree=A,this.max_code=0,this.stat_desc=j}function L(A){return A<256?k[A]:k[256+(A>>>7)]}function J(A,j){A.pending_buf[A.pending++]=255&j,A.pending_buf[A.pending++]=j>>>8&255}function Z(A,j,Y){A.bi_valid>b-Y?(A.bi_buf|=j<<A.bi_valid&65535,J(A,A.bi_buf),A.bi_buf=j>>b-A.bi_valid,A.bi_valid+=Y-b):(A.bi_buf|=j<<A.bi_valid&65535,A.bi_valid+=Y)}function $(A,j,Y){Z(A,Y[2*j],Y[2*j+1])}function dt(A,j){for(var Y=0;Y|=1&A,A>>>=1,Y<<=1,0<--j;);return Y>>>1}function lt(A,j,Y){var H,M,X=new Array(v+1),tt=0;for(H=1;H<=v;H++)X[H]=tt=tt+Y[H-1]<<1;for(M=0;M<=j;M++){var Q=A[2*M+1];Q!==0&&(A[2*M]=dt(X[Q]++,Q))}}function it(A){var j;for(j=0;j<g;j++)A.dyn_ltree[2*j]=0;for(j=0;j<d;j++)A.dyn_dtree[2*j]=0;for(j=0;j<y;j++)A.bl_tree[2*j]=0;A.dyn_ltree[2*w]=1,A.opt_len=A.static_len=0,A.last_lit=A.matches=0}function at(A){8<A.bi_valid?J(A,A.bi_buf):0<A.bi_valid&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0}function ot(A,j,Y,H){var M=2*j,X=2*Y;return A[M]<A[X]||A[M]===A[X]&&H[j]<=H[Y]}function pt(A,j,Y){for(var H=A.heap[Y],M=Y<<1;M<=A.heap_len&&(M<A.heap_len&&ot(j,A.heap[M+1],A.heap[M],A.depth)&&M++,!ot(j,H,A.heap[M],A.depth));)A.heap[Y]=A.heap[M],Y=M,M<<=1;A.heap[Y]=H}function gt(A,j,Y){var H,M,X,tt,Q=0;if(A.last_lit!==0)for(;H=A.pending_buf[A.d_buf+2*Q]<<8|A.pending_buf[A.d_buf+2*Q+1],M=A.pending_buf[A.l_buf+Q],Q++,H===0?$(A,M,j):($(A,(X=c[M])+m+1,j),(tt=C[X])!==0&&Z(A,M-=O[X],tt),$(A,X=L(--H),Y),(tt=E[X])!==0&&Z(A,H-=U[X],tt)),Q<A.last_lit;);$(A,w,j)}function Et(A,j){var Y,H,M,X=j.dyn_tree,tt=j.stat_desc.static_tree,Q=j.stat_desc.has_stree,st=j.stat_desc.elems,ft=-1;for(A.heap_len=0,A.heap_max=f,Y=0;Y<st;Y++)X[2*Y]!==0?(A.heap[++A.heap_len]=ft=Y,A.depth[Y]=0):X[2*Y+1]=0;for(;A.heap_len<2;)X[2*(M=A.heap[++A.heap_len]=ft<2?++ft:0)]=1,A.depth[M]=0,A.opt_len--,Q&&(A.static_len-=tt[2*M+1]);for(j.max_code=ft,Y=A.heap_len>>1;1<=Y;Y--)pt(A,X,Y);for(M=st;Y=A.heap[1],A.heap[1]=A.heap[A.heap_len--],pt(A,X,1),H=A.heap[1],A.heap[--A.heap_max]=Y,A.heap[--A.heap_max]=H,X[2*M]=X[2*Y]+X[2*H],A.depth[M]=(A.depth[Y]>=A.depth[H]?A.depth[Y]:A.depth[H])+1,X[2*Y+1]=X[2*H+1]=M,A.heap[1]=M++,pt(A,X,1),2<=A.heap_len;);A.heap[--A.heap_max]=A.heap[1],function(ct,St){var Ht,_t,Zt,yt,oe,ee,Lt=St.dyn_tree,ze=St.max_code,je=St.stat_desc.static_tree,nn=St.stat_desc.has_stree,rn=St.stat_desc.extra_bits,Le=St.stat_desc.extra_base,wt=St.stat_desc.max_length,Rt=0;for(yt=0;yt<=v;yt++)ct.bl_count[yt]=0;for(Lt[2*ct.heap[ct.heap_max]+1]=0,Ht=ct.heap_max+1;Ht<f;Ht++)wt<(yt=Lt[2*Lt[2*(_t=ct.heap[Ht])+1]+1]+1)&&(yt=wt,Rt++),Lt[2*_t+1]=yt,ze<_t||(ct.bl_count[yt]++,oe=0,Le<=_t&&(oe=rn[_t-Le]),ee=Lt[2*_t],ct.opt_len+=ee*(yt+oe),nn&&(ct.static_len+=ee*(je[2*_t+1]+oe)));if(Rt!==0){do{for(yt=wt-1;ct.bl_count[yt]===0;)yt--;ct.bl_count[yt]--,ct.bl_count[yt+1]+=2,ct.bl_count[wt]--,Rt-=2}while(0<Rt);for(yt=wt;yt!==0;yt--)for(_t=ct.bl_count[yt];_t!==0;)ze<(Zt=ct.heap[--Ht])||(Lt[2*Zt+1]!==yt&&(ct.opt_len+=(yt-Lt[2*Zt+1])*Lt[2*Zt],Lt[2*Zt+1]=yt),_t--)}}(A,j),lt(X,ft,A.bl_count)}function h(A,j,Y){var H,M,X=-1,tt=j[1],Q=0,st=7,ft=4;for(tt===0&&(st=138,ft=3),j[2*(Y+1)+1]=65535,H=0;H<=Y;H++)M=tt,tt=j[2*(H+1)+1],++Q<st&&M===tt||(Q<ft?A.bl_tree[2*M]+=Q:M!==0?(M!==X&&A.bl_tree[2*M]++,A.bl_tree[2*_]++):Q<=10?A.bl_tree[2*N]++:A.bl_tree[2*D]++,X=M,ft=(Q=0)===tt?(st=138,3):M===tt?(st=6,3):(st=7,4))}function G(A,j,Y){var H,M,X=-1,tt=j[1],Q=0,st=7,ft=4;for(tt===0&&(st=138,ft=3),H=0;H<=Y;H++)if(M=tt,tt=j[2*(H+1)+1],!(++Q<st&&M===tt)){if(Q<ft)for(;$(A,M,A.bl_tree),--Q!=0;);else M!==0?(M!==X&&($(A,M,A.bl_tree),Q--),$(A,_,A.bl_tree),Z(A,Q-3,2)):Q<=10?($(A,N,A.bl_tree),Z(A,Q-3,3)):($(A,D,A.bl_tree),Z(A,Q-11,7));X=M,ft=(Q=0)===tt?(st=138,3):M===tt?(st=6,3):(st=7,4)}}l(U);var W=!1;function T(A,j,Y,H){Z(A,(u<<1)+(H?1:0),3),function(M,X,tt,Q){at(M),J(M,tt),J(M,~tt),r.arraySet(M.pending_buf,M.window,X,tt,M.pending),M.pending+=tt}(A,j,Y)}i._tr_init=function(A){W||(function(){var j,Y,H,M,X,tt=new Array(v+1);for(M=H=0;M<p-1;M++)for(O[M]=H,j=0;j<1<<C[M];j++)c[H++]=M;for(c[H-1]=M,M=X=0;M<16;M++)for(U[M]=X,j=0;j<1<<E[M];j++)k[X++]=M;for(X>>=7;M<d;M++)for(U[M]=X<<7,j=0;j<1<<E[M]-7;j++)k[256+X++]=M;for(Y=0;Y<=v;Y++)tt[Y]=0;for(j=0;j<=143;)F[2*j+1]=8,j++,tt[8]++;for(;j<=255;)F[2*j+1]=9,j++,tt[9]++;for(;j<=279;)F[2*j+1]=7,j++,tt[7]++;for(;j<=287;)F[2*j+1]=8,j++,tt[8]++;for(lt(F,g+1,tt),j=0;j<d;j++)S[2*j+1]=5,S[2*j]=dt(j,5);K=new et(F,C,m+1,g,v),q=new et(S,E,0,d,v),V=new et(new Array(0),R,0,y,x)}(),W=!0),A.l_desc=new P(A.dyn_ltree,K),A.d_desc=new P(A.dyn_dtree,q),A.bl_desc=new P(A.bl_tree,V),A.bi_buf=0,A.bi_valid=0,it(A)},i._tr_stored_block=T,i._tr_flush_block=function(A,j,Y,H){var M,X,tt=0;0<A.level?(A.strm.data_type===2&&(A.strm.data_type=function(Q){var st,ft=4093624447;for(st=0;st<=31;st++,ft>>>=1)if(1&ft&&Q.dyn_ltree[2*st]!==0)return a;if(Q.dyn_ltree[18]!==0||Q.dyn_ltree[20]!==0||Q.dyn_ltree[26]!==0)return s;for(st=32;st<m;st++)if(Q.dyn_ltree[2*st]!==0)return s;return a}(A)),Et(A,A.l_desc),Et(A,A.d_desc),tt=function(Q){var st;for(h(Q,Q.dyn_ltree,Q.l_desc.max_code),h(Q,Q.dyn_dtree,Q.d_desc.max_code),Et(Q,Q.bl_desc),st=y-1;3<=st&&Q.bl_tree[2*B[st]+1]===0;st--);return Q.opt_len+=3*(st+1)+5+5+4,st}(A),M=A.opt_len+3+7>>>3,(X=A.static_len+3+7>>>3)<=M&&(M=X)):M=X=Y+5,Y+4<=M&&j!==-1?T(A,j,Y,H):A.strategy===4||X===M?(Z(A,2+(H?1:0),3),gt(A,F,S)):(Z(A,4+(H?1:0),3),function(Q,st,ft,ct){var St;for(Z(Q,st-257,5),Z(Q,ft-1,5),Z(Q,ct-4,4),St=0;St<ct;St++)Z(Q,Q.bl_tree[2*B[St]+1],3);G(Q,Q.dyn_ltree,st-1),G(Q,Q.dyn_dtree,ft-1)}(A,A.l_desc.max_code+1,A.d_desc.max_code+1,tt+1),gt(A,A.dyn_ltree,A.dyn_dtree)),it(A),H&&at(A)},i._tr_tally=function(A,j,Y){return A.pending_buf[A.d_buf+2*A.last_lit]=j>>>8&255,A.pending_buf[A.d_buf+2*A.last_lit+1]=255&j,A.pending_buf[A.l_buf+A.last_lit]=255&Y,A.last_lit++,j===0?A.dyn_ltree[2*Y]++:(A.matches++,j--,A.dyn_ltree[2*(c[Y]+m+1)]++,A.dyn_dtree[2*L(j)]++),A.last_lit===A.lit_bufsize-1},i._tr_align=function(A){Z(A,2,3),$(A,w,F),function(j){j.bi_valid===16?(J(j,j.bi_buf),j.bi_buf=0,j.bi_valid=0):8<=j.bi_valid&&(j.pending_buf[j.pending++]=255&j.bi_buf,j.bi_buf>>=8,j.bi_valid-=8)}(A)}},{"../utils/common":41}],53:[function(e,o,i){o.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,o,i){(function(r){(function(a,s){if(!a.setImmediate){var l,u,p,m,g=1,d={},y=!1,f=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(_){process.nextTick(function(){x(_)})}:function(){if(a.postMessage&&!a.importScripts){var _=!0,N=a.onmessage;return a.onmessage=function(){_=!1},a.postMessage("","*"),a.onmessage=N,_}}()?(m="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",w,!1):a.attachEvent("onmessage",w),function(_){a.postMessage(m+_,"*")}):a.MessageChannel?((p=new MessageChannel).port1.onmessage=function(_){x(_.data)},function(_){p.port2.postMessage(_)}):f&&"onreadystatechange"in f.createElement("script")?(u=f.documentElement,function(_){var N=f.createElement("script");N.onreadystatechange=function(){x(_),N.onreadystatechange=null,u.removeChild(N),N=null},u.appendChild(N)}):function(_){setTimeout(x,0,_)},v.setImmediate=function(_){typeof _!="function"&&(_=new Function(""+_));for(var N=new Array(arguments.length-1),D=0;D<N.length;D++)N[D]=arguments[D+1];var C={callback:_,args:N};return d[g]=C,l(g),g++},v.clearImmediate=b}function b(_){delete d[_]}function x(_){if(y)setTimeout(x,0,_);else{var N=d[_];if(N){y=!0;try{(function(D){var C=D.callback,E=D.args;switch(E.length){case 0:C();break;case 1:C(E[0]);break;case 2:C(E[0],E[1]);break;case 3:C(E[0],E[1],E[2]);break;default:C.apply(s,E)}})(N)}finally{b(_),y=!1}}}}function w(_){_.source===a&&typeof _.data=="string"&&_.data.indexOf(m)===0&&x(+_.data.slice(m.length))}})(typeof self>"u"?r===void 0?this:r:self)}).call(this,typeof Be<"u"?Be:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(zn)),zn.exports}var wa=va();const Ki=fi(wa);function xa(t){const n=t?.toLowerCase()||"";return n.includes("jpeg")?"jpeg":n.includes("png")?"png":n.includes("webp")?"webp":n.includes("gif")?"gif":n.includes("bmp")?"bmp":n.includes("avif")?"avif":"jpg"}async function _a(t){try{const n=await fetch(t,{cache:"no-store"});if(n.ok){const e=await n.blob();return{blob:e,mime:e.type||"image/jpeg"}}}catch{}try{const n=await ka(t),{blob:e,mime:o}=await Ca(n);return{blob:e,mime:o}}catch{throw new Error("Unable to read image bytes (fetch/canvas failed).")}}function ka(t){return new Promise((n,e)=>{const o=new Image;o.crossOrigin="anonymous",o.onload=()=>n(o),o.onerror=e,o.src=t})}function Ca(t){return new Promise((n,e)=>{const o=Math.max(1,t.naturalWidth||t.width||1),i=Math.max(1,t.naturalHeight||t.height||1),r=document.createElement("canvas");r.width=o,r.height=i;const a=r.getContext("2d");if(!a)return e(new Error("Canvas2D unavailable"));a.drawImage(t,0,0,o,i),r.toBlob(s=>{if(!s)return e(new Error("Canvas toBlob failed (tainted?)"));n({blob:s,mime:s.type||"image/png"})},"image/png",.92)})}async function Ea(t){const n=t?.imageFormat??"jpeg",e=Math.max(.5,Math.min(.95,t?.quality??.8)),o=ht.getState(),i=o.photos,r=i.length;let a=0;const s=new Ki,l=s.folder("images");if(!l)throw new Error("ZIP: cannot create images/");const u={schemaVersion:1,createdAt:new Date().toISOString(),appConfigSnapshot:{MAX_CARDS:qi,CARD_EXPORT_SIZE:Tt,PREVIEW_EXACT_SIZE:Ge,PREVIEW_FAST_SIZE:Ws},images:[],cards:[]};for(let m=0;m<i.length;m++){const g=i[m];let d=null,y="image/jpeg";try{const _=await _a(g.url);d=_.blob,y=_.mime||y}catch{d=null}if(d){const _=(d.type||"").toLowerCase();if(n==="jpeg"){if(!/jpe?g/.test(_)||e!==.8)try{d=await Ra(d,e),y="image/jpeg"}catch{}}else if(n==="png"&&!/png/.test(_))try{d=await Aa(d),y="image/png"}catch{}}const f=xa(y),v=`images/${g.id}.${f}`;d?(l.file(`${g.id}.${f}`,d),u.images.push({id:g.id,path:v,mime:y,size:d.size,source:{type:"embedded"}})):u.images.push({id:g.id,path:v,mime:y,source:{type:"url"}});const b=o.transforms[g.id]??{scale:1,tx:0,ty:0},x=o.cardBackground?.[g.id],w=(o.layersByPhoto[g.id]??[]).map(Sa);u.cards.push({photoId:g.id,order:m,transform:b,background:x,layers:w}),a++,t?.onProgress?.({done:a,total:r})}return s.file("manifest.json",JSON.stringify(u,null,2)),await s.generateAsync({type:"blob",compression:"DEFLATE"})}function Sa(t){return{...t}}async function Qi(t){const n=URL.createObjectURL(t);try{return await new Promise((e,o)=>{const i=new Image;i.onload=()=>e(i),i.onerror=o,i.src=n})}finally{URL.revokeObjectURL(n)}}async function Ra(t,n){const e=await Qi(t),o=document.createElement("canvas");o.width=Math.max(1,e.naturalWidth||e.width||1),o.height=Math.max(1,e.naturalHeight||e.height||1);const i=o.getContext("2d");if(!i)throw new Error("Canvas2D unavailable");i.drawImage(e,0,0);const r=o.toDataURL("image/jpeg",n);return await(await fetch(r)).blob()}async function Aa(t){const n=await Qi(t),e=document.createElement("canvas");e.width=Math.max(1,n.naturalWidth||n.width||1),e.height=Math.max(1,n.naturalHeight||n.height||1);const o=e.getContext("2d");if(!o)throw new Error("Canvas2D unavailable");o.drawImage(n,0,0);const i=e.toDataURL("image/png");return await(await fetch(i)).blob()}async function Ji(t){const n=[],e=await Ki.loadAsync(t),o=e.file("manifest.json");if(!o)throw new Error("manifest.json not found in zip");const i=await o.async("string");let r;try{r=JSON.parse(i)}catch{throw new Error("manifest.json is not valid JSON")}if(r.schemaVersion!==1)throw new Error(`Unsupported schemaVersion: ${r.schemaVersion}`);const a=new Map;for(const g of r.images){const d=e.file(g.path);if(!d){n.push(`Image file missing in zip: ${g.path}`);continue}try{const y=await d.async("blob"),f=URL.createObjectURL(y);a.set(g.id,f)}catch{n.push(`Failed to read image: ${g.path}`)}}const s=[],l={},u={},p={},m=[...r.cards].sort((g,d)=>g.order-d.order);for(const g of m){const d=a.get(g.photoId);d?s.push({id:g.photoId,url:d}):(n.push(`Missing image for card photoId=${g.photoId}. Card will appear without photo.`),s.push({id:g.photoId,url:Na})),l[g.photoId]={...g.transform},g.background&&(p[g.photoId]={...g.background}),u[g.photoId]=Array.isArray(g.layers)?g.layers.slice():[]}return ht.setState({photos:s,transforms:l,layersByPhoto:u,cardBackground:p}),{warnings:n}}const Na="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=";function Ia(){const t=z.useRef(null),n=z.useRef(null),e=z.useRef(null),o=ht(g=>g.photos),i=ht(g=>g.max),r=ht(g=>g.add),a=ht(g=>g.clear),s=Math.max(0,i-o.length),l=z.useCallback(g=>{if(!g?.length)return;const d=Array.from(g).slice(0,s),y=Fs(d,s);r(y)},[r,s]),u=z.useCallback(g=>{l(g.target.files),g.target.value=""},[l]);async function p(g){const d=g.target.files?.[0];if(!d)return;const y=await d.text();g.target.value="";const{rows:f,hasRelative:v}=ba(y);if(f.length){if(v){alert("В этом CSV есть относительные пути. В текущей сборке локальная папка не поддерживается. Пожалуйста, используйте полные URL (http/https) или добавьте изображения кнопкой “Choose images”.");return}await m(f)}}async function m(g,d){const y=ht.getState().add,f=[];let v=0,b=0;for(const x of g)try{let w=null,_="image";if($i(x.url)){const C=await fetch(x.url,{mode:"cors"});if(!C.ok)throw new Error(`HTTP ${C.status}`);w=await C.blob(),_=x.url.split("/").pop()||_}else if(Xi(x.url))w=await(await fetch(x.url)).blob(),_="data.png";else throw new Error("Relative paths are disabled in this build");const N=URL.createObjectURL(w),D=crypto.randomUUID();f.push({id:D,url:N,name:_}),v++}catch(w){console.warn("CSV import skip:",x.url,w),b++}y(f),b&&alert(`CSV import: added ${v}, skipped ${b}`)}return I.jsx("section",{className:"mt-4 space-y-4",children:I.jsxs("div",{className:"flex items-center justify-between gap-2",children:[I.jsxs("div",{className:"text-sm opacity-80",children:["Cards: ",I.jsx("b",{children:o.length})," / ",i]}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx("input",{ref:t,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:u}),I.jsx("input",{ref:n,type:"file",accept:".csv,text/csv",className:"hidden",onChange:p}),I.jsx("input",{ref:e,type:"file",accept:".zip",className:"hidden",onChange:async()=>{const g=e.current,d=g?.files?.[0];if(d)try{await Ji(d)}finally{g&&(g.value="")}}}),I.jsx(xt,{variant:"secondary",onClick:()=>e.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Open collection (.zip)"}),I.jsx("button",{onClick:()=>n.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Import CSV"}),I.jsx("button",{onClick:()=>t.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Choose images"}),I.jsx(xt,{variant:"destructive",onClick:a,disabled:!o.length,children:"Clear"})]})]})})}const to=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("rounded-xl border bg-card text-card-foreground shadow",t),...n}));to.displayName="Card";const Ta=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("flex flex-col space-y-1.5 p-6",t),...n}));Ta.displayName="CardHeader";const Da=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("font-semibold leading-none tracking-tight",t),...n}));Da.displayName="CardTitle";const za=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("text-sm text-muted-foreground",t),...n}));za.displayName="CardDescription";const ja=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("p-6 pt-0",t),...n}));ja.displayName="CardContent";const La=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("flex items-center p-6 pt-0",t),...n}));La.displayName="CardFooter";const eo=z.forwardRef(({className:t,value:n,...e},o)=>I.jsx(gi,{ref:o,className:bt("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...e,children:I.jsx(Fo,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));eo.displayName=gi.displayName;const no=Vo,ro=Ho,Kn=z.forwardRef(({className:t,children:n,...e},o)=>I.jsxs(bi,{ref:o,className:bt("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...e,children:[n,I.jsx(Uo,{asChild:!0,children:I.jsx(hi,{className:"h-4 w-4 opacity-50"})})]}));Kn.displayName=bi.displayName;const io=z.forwardRef(({className:t,...n},e)=>I.jsx(yi,{ref:e,className:bt("flex cursor-default items-center justify-center py-1",t),...n,children:I.jsx(Do,{className:"h-4 w-4"})}));io.displayName=yi.displayName;const oo=z.forwardRef(({className:t,...n},e)=>I.jsx(vi,{ref:e,className:bt("flex cursor-default items-center justify-center py-1",t),...n,children:I.jsx(hi,{className:"h-4 w-4"})}));oo.displayName=vi.displayName;const Qn=z.forwardRef(({className:t,children:n,position:e="popper",...o},i)=>I.jsx(Wo,{children:I.jsxs(wi,{ref:i,className:bt("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:e,...o,children:[I.jsx(io,{}),I.jsx(qo,{className:bt("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),I.jsx(oo,{})]})}));Qn.displayName=wi.displayName;const Ba=z.forwardRef(({className:t,...n},e)=>I.jsx(xi,{ref:e,className:bt("px-2 py-1.5 text-sm font-semibold",t),...n}));Ba.displayName=xi.displayName;const de=z.forwardRef(({className:t,children:n,...e},o)=>I.jsxs(_i,{ref:o,className:bt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e,children:[I.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:I.jsx(Go,{children:I.jsx(zo,{className:"h-4 w-4"})})}),I.jsx(Yo,{children:n})]}));de.displayName=_i.displayName;const Pa=z.forwardRef(({className:t,...n},e)=>I.jsx(ki,{ref:e,className:bt("-mx-1 my-1 h-px bg-muted",t),...n}));Pa.displayName=ki.displayName;const Ma=[];function so(t,n=""){const[e,o]=z.useState(null),[i,r]=z.useState("idle");return z.useEffect(()=>{if(!t){o(null),r("idle");return}let a=!1;const s=new Image;return n&&(s.crossOrigin=n),r("loading"),s.onload=()=>{a||(o(s),r("loaded"))},s.onerror=()=>{a||(o(null),r("failed"))},s.src=t,()=>{a=!0}},[t,n]),[e,i]}function Oa({layer:t,k:n,onSelect:e,updateLayer:o,selectedId:i}){const[r]=so(t.src||"","anonymous"),a=i===t.id,s=z.useRef(null),l=t.x*n,u=t.y*n,p=r?.naturalWidth??0,m=r?.naturalHeight??0,g=Math.max(1,t.w?t.w*n:p*n||1),d=Math.max(1,t.h?t.h*n:m*n||1);return I.jsx(pi,{ref:a?s:void 0,draggable:!0,image:r??void 0,x:l,y:u,width:g,height:d,rotation:t.rotation,visible:t.visible,onMouseDown:()=>e(t.id),onTap:()=>e(t.id),onDragEnd:y=>{o(t.photoId,t.id,{x:y.target.x()/n,y:y.target.y()/n})},onTransformEnd:y=>{const f=y.target,v=typeof f.scaleX=="function"?f.scaleX():1,b=typeof f.scaleY=="function"?f.scaleY():1,x=typeof f.width=="function"?f.width():g,w=typeof f.height=="function"?f.height():d,_={x:f.x()/n,y:f.y()/n,rotation:f.rotation(),scaleX:1,scaleY:1,w:Math.max(1,Math.round(x*v/n)),h:Math.max(1,Math.round(w*b/n))};typeof f.scaleX=="function"&&f.scaleX(1),typeof f.scaleY=="function"&&f.scaleY(1),o(t.photoId,t.id,_)}},t.id)}const Qe=z.forwardRef(function({photoId:n,size:e,selectedId:o,onSelect:i,transformOverride:r},a){const l=z.useRef(null),u=ht(E=>E.photos.find(R=>R.id===n)?.url),p=ht(E=>E.transforms[n]??fe),m=r??p,g=ht(E=>E.layersByPhoto[n]??Ma,Object.is).map(E=>({...E,photoId:n})),d=ht(E=>E.updateLayer),y=ht(E=>E.cardBackground?.[n]??Xn,Object.is),[f,v]=so(u??"","anonymous"),b=v==="loaded";z.useImperativeHandle(a,()=>({toDataURL:E=>{const R=l.current;if(!R)return null;const B=E&&E>0?E/e:1;return R.toDataURL({pixelRatio:B,mimeType:"image/png"})},isReady:()=>!!l.current&&b}));const x=z.useRef(null),w=z.useRef(null);z.useEffect(()=>{const E=x.current,R=w.current;E&&R&&o&&(E.nodes([R]),E.getLayer()?.batchDraw())},[o]);const _=e/Tt,N=z.useMemo(()=>g.find(E=>E.id===o),[g,o]),D=!!(N?.type==="image"&&N?.qrText);function C(E,R,B,F){const S=R/E.width,k=R/E.height,O=(B==="cover"?Math.max(S,k):Math.min(S,k))*(F?.scale??1),K=E.width*O,q=E.height*O,V=(R-K)/2+(F?.tx??0)/100*R,U=(R-q)/2+(F?.ty??0)/100*R;return{x:V*_,y:U*_,width:K*_,height:q*_}}return I.jsx(jo,{ref:l,width:e,height:e,pixelRatio:1,listening:!0,style:{width:"100%",height:"100%"},onMouseDown:E=>{E.target===E.target.getStage()&&i(null)},onTouchStart:E=>{E.target===E.target.getStage()&&i(null)},children:I.jsxs(Lo,{children:[I.jsx(hr,{x:0,y:0,width:e,height:e,fill:y.color,opacity:y.alpha,listening:!1}),f?I.jsx(pi,{image:f,...C(f,Tt,Wn,m),listening:!1}):null,g.slice().sort((E,R)=>E.z-R.z).map(E=>{if(E.type==="text"){const R=E,F=o===R.id?w:void 0,S=R.x*_,k=R.y*_,c=(R.fontSize??16)*_,O=R.width?R.width*_:void 0,K=(R.padding??0)*_,q=(R.letterSpacing??0)*_;return I.jsx(Bo,{ref:F,draggable:!0,x:S,y:k,text:R.text,fontFamily:R.fontFamily||"Georgia, serif",fontSize:c,fontStyle:R.fontStyle,fill:R.fill,width:O,align:R.align,lineHeight:R.lineHeight??1.25,padding:K,letterSpacing:q,rotation:R.rotation,scaleX:1,scaleY:1,visible:R.visible,perfectDrawEnabled:!1,onTransform:V=>{const U=V.target,et=typeof U.scaleX=="function"?U.scaleX():1,P=typeof U.width=="function"?U.width():void 0;P!==void 0&&et&&et!==1&&(U.width(Math.max(4,Math.round(P*et))),typeof U.scaleX=="function"&&U.scaleX(1),typeof U.scaleY=="function"&&U.scaleY(1),U.getLayer()?.batchDraw())},onMouseDown:()=>i(R.id),onTap:()=>i(R.id),onDragEnd:V=>{d(n,R.id,{x:V.target.x()/_,y:V.target.y()/_})},onTransformEnd:V=>{const U=V.target,et=typeof U.scaleX=="function"?U.scaleX():1,P=typeof U.width=="function"?U.width():void 0,L={x:U.x()/_,y:U.y()/_,rotation:U.rotation(),scaleX:1,scaleY:1,width:P!==void 0?Math.max(4,Math.round(P*et/_)):void 0};typeof U.scaleX=="function"&&U.scaleX(1),typeof U.scaleY=="function"&&U.scaleY(1),d(n,R.id,L)}},R.id)}if(E.type==="rect"){const R=E,F=o===R.id?w:void 0,S=R.x*_,k=R.y*_,c=Math.max(1,(R.width??100)*_),O=Math.max(1,(R.height??100)*_),K=Math.max(0,(R.strokeWidth??0)*_),q=Math.max(0,(R.cornerRadius??0)*_);return I.jsx(hr,{ref:F,draggable:!0,x:S,y:k,width:c,height:O,rotation:R.rotation,fill:R.fill??"#ffffff",stroke:R.stroke,strokeWidth:K,cornerRadius:q,visible:R.visible,opacity:Math.max(0,Math.min(1,R.opacity??1)),onMouseDown:()=>i(R.id),onTap:()=>i(R.id),onDragEnd:V=>{d(n,R.id,{x:V.target.x()/_,y:V.target.y()/_})},onTransformEnd:V=>{const U=V.target,et=typeof U.scaleX=="function"?U.scaleX():1,P=typeof U.scaleY=="function"?U.scaleY():1,L=typeof U.width=="function"?U.width():c,J=typeof U.height=="function"?U.height():O,Z={x:U.x()/_,y:U.y()/_,rotation:U.rotation(),scaleX:1,scaleY:1,width:Math.max(1,Math.round(L*et/_)),height:Math.max(1,Math.round(J*P/_))};typeof U.scaleX=="function"&&U.scaleX(1),typeof U.scaleY=="function"&&U.scaleY(1),d(n,R.id,Z)}},R.id)}return E.type==="image"?I.jsx(Oa,{layer:E,k:_,selectedId:o,onSelect:i,updateLayer:d},E.id):null}),o&&I.jsx(Po,{ref:x,rotateEnabled:!0,enabledAnchors:["middle-left","middle-right","top-center","bottom-center","top-left","top-right","bottom-left","bottom-right"],borderStroke:"#fff",anchorStroke:"#fff",anchorFill:"#111",anchorSize:7,keepRatio:D,centeredScaling:!1,boundBoxFunc:(E,R)=>{const F=Math.max(6,R.width),S=Math.max(6,R.height);return{...R,width:F,height:S}}})]})})}),ao=Xo,Fa=Zo,lo=z.forwardRef(({className:t,...n},e)=>I.jsx(Ci,{ref:e,className:bt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));lo.displayName=Ci.displayName;const Jn=z.forwardRef(({className:t,children:n,...e},o)=>I.jsxs(Fa,{children:[I.jsx(lo,{}),I.jsxs(Ei,{ref:o,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e,children:[n,I.jsxs($o,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[I.jsx(Mo,{className:"h-4 w-4"}),I.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Jn.displayName=Ei.displayName;const tr=({className:t,...n})=>I.jsx("div",{className:bt("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});tr.displayName="DialogHeader";const er=({className:t,...n})=>I.jsx("div",{className:bt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});er.displayName="DialogFooter";const nr=z.forwardRef(({className:t,...n},e)=>I.jsx(Si,{ref:e,className:bt("text-lg font-semibold leading-none tracking-tight",t),...n}));nr.displayName=Si.displayName;const co=z.forwardRef(({className:t,...n},e)=>I.jsx(Ri,{ref:e,className:bt("text-sm text-muted-foreground",t),...n}));co.displayName=Ri.displayName;const Ua=Di("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ce=z.forwardRef(({className:t,...n},e)=>I.jsx(Ai,{ref:e,className:bt(Ua(),t),...n}));ce.displayName=Ai.displayName;const Ye=z.forwardRef(({className:t,...n},e)=>I.jsxs(Ni,{ref:e,className:bt("relative flex w-full touch-none select-none items-center",t),...n,children:[I.jsx(Ko,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:I.jsx(Qo,{className:"absolute h-full bg-primary"})}),I.jsx(Jo,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Ye.displayName=Ni.displayName;const jn=new Map;function He(t){const n=t.trim();if(n.startsWith('"')){const e=n.indexOf('"',1);return e>1?n.slice(1,e):n.replace(/["']/g,"")}return n.split(",")[0].replace(/["']/g,"").trim()}function Wa(t){const n=He(t);return Gi.find(e=>He(e.family).toLowerCase()===n.toLowerCase())}function qa(t,n){if(document.getElementById(n))return;const e=document.createElement("link");e.id=n,e.rel="stylesheet",e.href=t;const o=document.createElement("link");o.rel="preconnect",o.href="https://fonts.googleapis.com";const i=document.createElement("link");i.rel="preconnect",i.href="https://fonts.gstatic.com",i.crossOrigin="anonymous",document.head.appendChild(o),document.head.appendChild(i),document.head.appendChild(e)}function Ga(t){const n=He(t);if(jn.has(n))return jn.get(n);const e=(async()=>{const o=Wa(t);o&&o.cssHref&&qa(o.cssHref,`font-css-${o.id}`);try{const i=document;i?.fonts?.ready&&typeof i.fonts.ready.then=="function"&&await i.fonts.ready}catch{}try{document.fonts?.load&&await document.fonts.load(`1em ${He(t)}`)}catch{}})();return jn.set(n,e),e}const Ya=[],We="__none__";function Va({photoId:t,layer:n}){const e=ht(s=>s.updateQrLayer),[o,i]=z.useState(n.qrText??""),[r,a]=z.useState(Math.max(1,Math.round(n.w??n.h??512)));return z.useEffect(()=>{i(n.qrText??""),a(Math.max(1,Math.round(n.w??n.h??512)))},[n.id,n.qrText,n.w,n.h]),I.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-foreground/10",children:"QR"}),I.jsx("span",{className:"opacity-70 text-sm",children:"This layer is a QR code"})]}),I.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[I.jsx("label",{className:"text-xs opacity-70",children:"QR text / URL"}),I.jsx("input",{type:"text",value:o,onChange:s=>i(s.target.value),className:"flex-1 min-w-[16rem] rounded border px-2 py-1 text-sm",placeholder:"https://example.com"}),I.jsx("label",{className:"text-xs opacity-70",children:"Size (px)"}),I.jsx("input",{type:"number",min:1,max:Tt,step:1,value:r,onChange:s=>a(Math.max(1,Number(s.target.value)||1)),className:"w-28 rounded border px-2 py-1 text-sm",title:"QR side size in card pixels"}),I.jsx(xt,{variant:"secondary",onClick:async()=>{await e(t,n.id,{text:o.trim(),size:r})},children:"Update QR"})]})]})}function Ha({open:t,onOpenChange:n,photo:e,canvasRef:o}){const i=ht(k=>k.addTextLayer),r=ht(k=>k.addRectLayer),a=ht(k=>k.addQrLayer),s=ht(k=>k.transforms[e.id]??fe),l=ht(k=>k.setTransform),[u,p]=z.useState(s),[m,g]=z.useState(null),d=ht(k=>k.updateLayer),y=ht(k=>k.removeLayer),f=ht(k=>k.bringToFront),v=ht(k=>k.sendToBack),b=ht(k=>k.layersByPhoto[e.id]??Ya,Object.is),x=z.useRef(null),w=o??x,_=ht(k=>k.cardBackground?.[e.id]??Xn,Object.is),N=ht(k=>k.setCardBackground),D=(k,c)=>k.scale===c.scale&&k.tx===c.tx&&k.ty===c.ty,C=z.useRef(s);z.useEffect(()=>{t&&(C.current=s,p(s))},[t,s]);const E=z.useRef(null),[R,B]=z.useState(0),F=z.useCallback(()=>{const k=E.current;if(!k)return;const c=Math.round(k.clientWidth);c&&B(c)},[]);z.useEffect(()=>{const k=E.current;if(!k)return;const c=new ResizeObserver(F);return c.observe(k),F(),()=>c.disconnect()},[F]),z.useEffect(()=>{t&&(requestAnimationFrame(F),setTimeout(F,50))},[t,F]);const S=z.useCallback((k,c)=>{const O=k.id.slice(0,6);let K="Layer";return k.type==="text"?K="Text":k.type==="rect"?K="Rect":k.type==="image"&&k.qrText?K="QR":k.type==="image"&&(K="Image"),`${K} #${c+1} (${O})`},[]);return z.useEffect(()=>{if(!m)return;(b??[]).some(c=>c.id===m)||g(null)},[b,m]),I.jsx(ao,{open:t,onOpenChange:n,children:I.jsxs(Jn,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden flex flex-col",children:[I.jsxs(tr,{className:"shrink-0",children:[I.jsx(nr,{children:"Edit card"}),I.jsx(co,{className:"sr-only",children:"Adjust zoom/position and edit layers."})]}),I.jsx("div",{className:"flex-1 overflow-auto",children:I.jsxs("div",{className:"grid gap-4",children:[I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:I.jsx("div",{className:"relative aspect-square overflow-hidden rounded-xl",ref:E,children:R>0&&I.jsx("div",{className:"absolute inset-0 pointer-events-auto z-0",children:I.jsx(Qe,{"data-dnd-ignore":!0,ref:w,photoId:e.id,size:R,selectedId:m,onSelect:g,transformOverride:u})})})}),I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:I.jsxs("div",{className:"flex items-center gap-3",children:[I.jsx(ce,{className:"whitespace-nowrap",children:"Layers"}),I.jsxs(no,{value:m??We,onValueChange:k=>g(k===We?null:k),children:[I.jsx(Kn,{className:"w-[18rem]",children:I.jsx(ro,{placeholder:b.length?"Select a layer…":"No layers"})}),I.jsx(Qn,{children:b.length===0?I.jsx(de,{value:We,disabled:!0,children:"No layers"}):I.jsxs(I.Fragment,{children:[I.jsx(de,{value:We,disabled:!0,children:"Select a layer…"}),b.slice().sort((k,c)=>k.z-c.z).map((k,c)=>I.jsx(de,{value:k.id,children:S(k,c)},k.id))]})})]}),I.jsx("div",{className:"ml-auto"})]})}),m&&(()=>{const k=b.find(c=>c.id===m&&c.type==="text");return k?I.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[I.jsx("label",{className:"text-xs opacity-70",children:"Text"}),I.jsx("textarea",{value:k.text,onChange:c=>d(e.id,k.id,{text:c.target.value}),rows:3,className:"resize-y w-full rounded border px-2 py-1 text-sm bg-background"}),I.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[I.jsx("label",{className:"text-xs opacity-70",children:"Size"}),I.jsx("input",{type:"number",min:8,max:240,step:1,value:k.fontSize??36,onChange:c=>d(e.id,k.id,{fontSize:Number(c.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),I.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${k.fontStyle?.includes("bold")?"bg-foreground/10":""}`,onClick:()=>{const c=k.fontStyle?.includes("bold"),K=`${k.fontStyle?.includes("italic")?"italic":""} ${c?"":"bold"}`.trim();d(e.id,k.id,{fontStyle:K})},children:"Bold"}),I.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${k.fontStyle?.includes("italic")?"bg-foreground/10":""}`,onClick:()=>{const c=k.fontStyle?.includes("bold"),K=`${k.fontStyle?.includes("italic")?"":"italic"} ${c?"bold":""}`.trim();d(e.id,k.id,{fontStyle:K})},children:"Italic"}),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Color"}),I.jsx("input",{type:"color",value:k.fill??"#111111",onChange:c=>d(e.id,k.id,{fill:c.target.value}),className:"h-8 w-10 cursor-pointer"})]}),I.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[I.jsx("label",{className:"text-xs opacity-70",children:"Font"}),I.jsx("select",{value:k.fontFamily??"Georgia, serif",onChange:async c=>{const O=c.target.value;await Ga(O),d(e.id,k.id,{fontFamily:O})},className:"rounded border px-2 py-1 text-sm",children:Gi.map(c=>I.jsx("option",{value:c.family,children:c.label},c.id))})]}),I.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[I.jsx("label",{className:"text-xs opacity-70",children:"Align"}),["left","center","right"].map(c=>I.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${k.align===c?"bg-foreground/10":""}`,onClick:()=>d(e.id,k.id,{align:c}),children:c},c)),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Wrap width"}),I.jsx("input",{type:"number",min:0,max:Tt,step:10,value:k.width??0,onChange:c=>d(e.id,k.id,{width:Number(c.target.value)||void 0}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0 disables wrapping"}),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Padding"}),I.jsx("input",{type:"number",min:0,max:200,step:1,value:k.padding??0,onChange:c=>d(e.id,k.id,{padding:Number(c.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Line height"}),I.jsx("input",{type:"number",min:.8,max:2,step:.05,value:k.lineHeight??1.25,onChange:c=>d(e.id,k.id,{lineHeight:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Tracking"}),I.jsx("input",{type:"number",min:-5,max:20,step:.5,value:k.letterSpacing??0,onChange:c=>d(e.id,k.id,{letterSpacing:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Additional spacing between glyphs (px, card space)"})]})]}):null})(),m&&(()=>{const k=b.find(c=>c.id===m&&c.type==="image"&&c.qrText);return k?I.jsx(Va,{photoId:e.id,layer:k}):null})(),m&&(()=>{const k=b.find(c=>c.id===m&&c.type==="rect");return k?I.jsx("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:I.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[I.jsx("label",{className:"text-xs opacity-70",children:"Fill"}),I.jsx("input",{type:"color",value:k.fill??"#ffffff",onChange:c=>d(e.id,k.id,{fill:c.target.value}),className:"h-8 w-10 cursor-pointer"}),I.jsx("label",{className:"text-xs opacity-70",children:"Stroke"}),I.jsx("input",{type:"color",value:k.stroke??"#000000",onChange:c=>d(e.id,k.id,{stroke:c.target.value}),className:"h-8 w-10 cursor-pointer"}),I.jsx("label",{className:"text-xs opacity-70",children:"Stroke width"}),I.jsx("input",{type:"number",min:0,max:100,step:1,value:k.strokeWidth??0,onChange:c=>d(e.id,k.id,{strokeWidth:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Width in card pixels"}),I.jsx("label",{className:"text-xs opacity-70",children:"Radius"}),I.jsx("input",{type:"number",min:0,max:500,step:1,value:k.cornerRadius??0,onChange:c=>d(e.id,k.id,{cornerRadius:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Corner radius in card pixels"}),I.jsx("label",{className:"text-xs opacity-70",children:"Opacity"}),I.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((k.opacity??1)*100),onChange:c=>d(e.id,k.id,{opacity:Math.max(0,Math.min(1,Number(c.target.value)/100))}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0..100 %"}),I.jsx("label",{className:"text-xs opacity-70",children:"Width"}),I.jsx("input",{type:"number",min:1,max:Tt,step:1,value:k.width??1,onChange:c=>d(e.id,k.id,{width:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),I.jsx("label",{className:"text-xs opacity-70",children:"Height"}),I.jsx("input",{type:"number",min:1,max:Tt,step:1,value:k.height??1,onChange:c=>d(e.id,k.id,{height:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"})]})}):null})(),I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:I.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[I.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>{if(!m)return;const c=(ht.getState().layersByPhoto[e.id]??[]).find(q=>q.id===m);if(!c)return;const K=((c.rotation??0)-90)%360;d(e.id,m,{rotation:K<0?K+360:K})},children:"Rotate −90°"}),I.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>{if(!m)return;const c=(ht.getState().layersByPhoto[e.id]??[]).find(q=>q.id===m);if(!c)return;const K=((c.rotation??0)+90)%360;d(e.id,m,{rotation:K})},children:"Rotate +90°"}),I.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>m&&f(e.id,m),children:"Bring to front"}),I.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>m&&v(e.id,m),children:"Send to back"}),I.jsx(xt,{variant:"destructive",disabled:!m,onClick:()=>{m&&(y(e.id,m),g(null))},children:"Delete layer"})]})}),I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:I.jsxs("div",{className:"grid gap-3",children:[I.jsxs("div",{className:"grid gap-1.5",children:[I.jsxs("div",{className:"flex items-center justify-between text-sm",children:[I.jsx(ce,{children:"Zoom"}),I.jsxs("span",{className:"tabular-nums opacity-70",children:[u.scale.toFixed(2),"×"]})]}),I.jsx(Ye,{value:[u.scale],min:1,max:3,step:.01,onValueChange:([k])=>p(c=>({...c,scale:k}))})]}),I.jsxs("div",{className:"grid gap-1.5",children:[I.jsxs("div",{className:"flex items-center justify-between text-sm",children:[I.jsx(ce,{children:"Horizontal"}),I.jsxs("span",{className:"tabular-nums opacity-70",children:[u.tx.toFixed(0),"%"]})]}),I.jsx(Ye,{value:[u.tx],min:-100,max:100,step:.1,onValueChange:([k])=>p(c=>({...c,tx:k}))})]}),I.jsxs("div",{className:"grid gap-1.5",children:[I.jsxs("div",{className:"flex items-center justify-between text-sm",children:[I.jsx(ce,{children:"Vertical"}),I.jsxs("span",{className:"tabular-nums opacity-70",children:[u.ty.toFixed(0),"%"]})]}),I.jsx(Ye,{value:[u.ty],min:-100,max:100,step:.1,onValueChange:([k])=>p(c=>({...c,ty:k}))})]})]})}),I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:I.jsx("div",{className:"mt-3 grid gap-2 rounded-md border p-2 bg-background/60",children:I.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[I.jsx(ce,{className:"opacity-70",children:"Background"}),I.jsx("label",{className:"text-xs opacity-70",children:"Color"}),I.jsx("input",{type:"color",value:_.color,onChange:k=>N(e.id,{color:k.target.value}),className:"h-8 w-10 cursor-pointer"}),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Opacity"}),I.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((_.alpha??1)*100),onChange:k=>N(e.id,{alpha:Math.max(0,Math.min(1,Number(k.target.value)/100))}),className:"w-20 rounded border px-2 py-1 text-sm",title:"0..100 %"}),I.jsx("span",{className:"text-xs opacity-60",children:"(0% = transparent, 100% = solid)"})]})})})]})}),I.jsxs(er,{className:"shrink-0 space-y-2",children:[I.jsxs("div",{className:"flex items-center justify-between gap-2",children:[I.jsx(xt,{variant:"ghost",onClick:()=>{p(fe)},children:"Reset image"}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx(xt,{variant:"secondary",onClick:()=>{D(C.current,s)||l(e.id,C.current),n(!1)},children:"Cancel"}),I.jsx(xt,{onClick:()=>{D(u,s)||l(e.id,u),n(!1)},children:"Save"})]})]}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx(xt,{variant:"secondary",onClick:async()=>{const k=window.prompt("QR text / URL:","https://example.com")??"";if(!k.trim())return;const c=await a(e.id,k.trim());g(c)},children:"Add QR"}),I.jsx(xt,{variant:"secondary",onClick:()=>{const k=i(e.id);g(k)},children:"Add text layer"}),I.jsx(xt,{variant:"secondary",onClick:()=>{const k=r(e.id);g(k)},children:"Add rectangle"})]})]})]})})}function Za(t,n="card"){return(t.replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||n).slice(0,100)}function $a(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function Xa({open:t,onOpenChange:n,photo:e,transform:o,layers:i,snapshot:r,onEdit:a}){const[s,l]=z.useState(null),[u,p]=z.useState(!1),m=z.useRef(null),[g,d]=z.useState(0);z.useEffect(()=>{const w=m.current;if(!w)return;const _=()=>d(Math.round(w.clientWidth));_();const N=new ResizeObserver(_);return N.observe(w),()=>N.disconnect()},[]);const y=z.useRef(null),[f,v]=z.useState(Ge),b=z.useMemo(()=>t?I.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:f,height:f,overflow:"hidden"},children:I.jsx(Qe,{ref:y,photoId:e.id,size:f,selectedId:null,onSelect:()=>{}})}):null,[t,e.id,f]);async function x(w){v(w),await new Promise(N=>setTimeout(N,0));try{const N=document;N?.fonts?.ready&&typeof N.fonts.ready.then=="function"&&await N.fonts.ready}catch{}const _=Date.now()+1e3;for(;!y.current?.isReady?.()&&!(Date.now()>_);)await new Promise(N=>setTimeout(N,30));return y.current?.toDataURL(w)??null}return z.useEffect(()=>{let w=!1;if(!t){l(null);return}return(async()=>{p(!0);const _=Math.max(Ge,g||Ge);let N=null;r&&(N=r(_)),N||(N=await x(_)),!w&&(l(N),p(!1))})(),()=>{w=!0}},[t,g,e.id,o.scale,o.tx,o.ty,i,r]),I.jsxs(ao,{"data-dnd-ignore":!0,open:t,onOpenChange:n,children:[b,I.jsxs(Jn,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden",children:[I.jsx(tr,{children:I.jsx(ts,{asChild:!0,children:I.jsx(nr,{children:"Preview"})})}),I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:I.jsxs("div",{ref:m,className:"relative aspect-square overflow-hidden rounded-xl",children:[s?I.jsx("img",{src:s,alt:e.name,className:"absolute inset-0 w-full h-full object-contain"}):I.jsx("div",{className:"h-24"}),I.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${u?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!u,children:I.jsx("div",{className:"h-7 w-7 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]})}),I.jsxs(er,{className:"mt-2 gap-2",children:[I.jsx(xt,{variant:"secondary",onClick:()=>{n(!1),a?.()},children:"Edit"}),I.jsx(xt,{variant:"secondary",onClick:()=>n(!1),children:"Close"}),I.jsx(xt,{onClick:async()=>{const w=r&&r(Tt)||await x(Tt);w&&$a(w,`${Za(e.name||"card")}.png`)},children:"Save PNG"})]})]})]})}async function Ka(t,n=Tt){const e=document.createElement("div");e.style.position="fixed",e.style.left="-10000px",e.style.top="-10000px",e.style.width=`${n}px`,e.style.height=`${n}px`,document.body.appendChild(e);const o=z.createRef(),i=mi.createRoot(e);i.render(z.createElement(Qe,{ref:o,photoId:t,size:n,selectedId:null,onSelect:()=>{}})),await new Promise(s=>setTimeout(s,0));try{const s=document;s?.fonts?.ready&&typeof s.fonts.ready.then=="function"&&await s.fonts.ready}catch{}const r=Date.now()+1500;for(;!o.current?.isReady?.()&&!(Date.now()>r);)await new Promise(s=>setTimeout(s,25));const a=o.current?.toDataURL(n)??"";return i.unmount(),e.remove(),a}async function Qa(t,n=Tt){return Ka(t,n)}function Ja(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function tl({photo:t}){const n=ht(D=>D.remove),e=ht(D=>D.transforms[t.id]??fe),o=ht(D=>D.layersByPhoto),[i,r]=z.useState(!1),[a,s]=z.useState(!1),l=z.useRef(null),u=z.useRef(null),[p,m]=z.useState(0);z.useEffect(()=>{const D=u.current;if(!D)return;const C=()=>m(D.clientWidth);C();const E=new ResizeObserver(C);return E.observe(D),()=>E.disconnect()},[]);const g=z.useRef(null),[d,y]=z.useState(512),f=I.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:d,height:d,overflow:"hidden"},children:I.jsx(Qe,{ref:g,photoId:t.id,size:d,selectedId:null,onSelect:()=>{}})}),[v,b]=z.useState(null),[x,w]=z.useState(!0),_=z.useRef(null);z.useEffect(()=>{if(i)return;const D=window.devicePixelRatio||1,C=Math.max(384,Math.min(1024,Math.round((p||300)*D)));return y(C),_.current&&window.clearTimeout(_.current),_.current=window.setTimeout(async()=>{w(!0);try{const B=document;B?.fonts?.ready&&typeof B.fonts.ready.then=="function"&&await B.fonts.ready}catch{}const E=Date.now()+800;for(;!g.current?.isReady?.()&&!(Date.now()>E);)await new Promise(B=>setTimeout(B,25));const R=g.current?.toDataURL(C)??null;b(R),w(!1)},150),()=>{_.current&&(window.clearTimeout(_.current),_.current=null)}},[p,i,t.id,e.scale,e.tx,e.ty,o[t.id]]);const N=z.useCallback(async()=>{const D=await Qa(t.id,Tt);if(!D)return;const E=(t.name||"card").replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||"card";Ja(D,`${E}.png`)},[t.id,t.name]);return I.jsxs(I.Fragment,{children:[f,I.jsxs("div",{className:"overflow-hidden rounded-xl border border-foreground/15 bg-foreground/[0.02]",children:[I.jsxs("div",{ref:u,onClick:()=>s(!0),className:"relative aspect-square w-full overflow-hidden cursor-zoom-in",children:[I.jsx("button",{"aria-label":"Remove image",title:"Remove",onClick:D=>{D.stopPropagation(),n(t.id)},className:"absolute right-1 top-1 z-10 rounded-md bg-background/80 px-1.5 py-0.5 text-[11px] shadow hover:bg-background",children:"×"}),v?I.jsx("img",{src:v,alt:t.name,className:"h-full w-full object-cover"}):I.jsx("div",{className:"h-full w-full bg-foreground/[0.06]"}),I.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${x?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!x,children:I.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]}),I.jsxs("div",{className:"flex items-center justify-between gap-2 border-t bg-background/70 px-2 py-1.5 supports-[backdrop-filter]:bg-background/60",children:[I.jsx("button",{"aria-label":"Edit card",title:"Edit",onClick:D=>{D.stopPropagation(),r(!0)},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Edit"}),I.jsx("button",{"aria-label":"Save PNG",title:"Save PNG",onClick:D=>{D.stopPropagation(),N()},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Save PNG"})]})]}),I.jsx(Xa,{open:a,onOpenChange:s,photo:t,transform:e,layers:o[t.id],snapshot:D=>l.current?.toDataURL(D)??null,onEdit:()=>r(!0)}),I.jsx(Ha,{open:i,onOpenChange:r,photo:t,canvasRef:l})]})}function el(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return z.useMemo(()=>o=>{n.forEach(i=>i(o))},n)}const Je=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function me(t){const n=Object.prototype.toString.call(t);return n==="[object Window]"||n==="[object global]"}function rr(t){return"nodeType"in t}function Dt(t){var n,e;return t?me(t)?t:rr(t)&&(n=(e=t.ownerDocument)==null?void 0:e.defaultView)!=null?n:window:window}function ir(t){const{Document:n}=Dt(t);return t instanceof n}function Ie(t){return me(t)?!1:t instanceof Dt(t).HTMLElement}function uo(t){return t instanceof Dt(t).SVGElement}function ge(t){return t?me(t)?t.document:rr(t)?ir(t)?t:Ie(t)||uo(t)?t.ownerDocument:document:document:document}const qt=Je?z.useLayoutEffect:z.useEffect;function or(t){const n=z.useRef(t);return qt(()=>{n.current=t}),z.useCallback(function(){for(var e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return n.current==null?void 0:n.current(...o)},[])}function nl(){const t=z.useRef(null),n=z.useCallback((o,i)=>{t.current=setInterval(o,i)},[]),e=z.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[n,e]}function Re(t,n){n===void 0&&(n=[t]);const e=z.useRef(t);return qt(()=>{e.current!==t&&(e.current=t)},n),e}function Te(t,n){const e=z.useRef();return z.useMemo(()=>{const o=t(e.current);return e.current=o,o},[...n])}function Ze(t){const n=or(t),e=z.useRef(null),o=z.useCallback(i=>{i!==e.current&&n?.(i,e.current),e.current=i},[]);return[e,o]}function qn(t){const n=z.useRef();return z.useEffect(()=>{n.current=t},[t]),n.current}let Ln={};function De(t,n){return z.useMemo(()=>{if(n)return n;const e=Ln[t]==null?0:Ln[t]+1;return Ln[t]=e,t+"-"+e},[t,n])}function fo(t){return function(n){for(var e=arguments.length,o=new Array(e>1?e-1:0),i=1;i<e;i++)o[i-1]=arguments[i];return o.reduce((r,a)=>{const s=Object.entries(a);for(const[l,u]of s){const p=r[l];p!=null&&(r[l]=p+t*u)}return r},{...n})}}const ue=fo(1),$e=fo(-1);function rl(t){return"clientX"in t&&"clientY"in t}function sr(t){if(!t)return!1;const{KeyboardEvent:n}=Dt(t.target);return n&&t instanceof n}function il(t){if(!t)return!1;const{TouchEvent:n}=Dt(t.target);return n&&t instanceof n}function Gn(t){if(il(t)){if(t.touches&&t.touches.length){const{clientX:n,clientY:e}=t.touches[0];return{x:n,y:e}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:n,clientY:e}=t.changedTouches[0];return{x:n,y:e}}}return rl(t)?{x:t.clientX,y:t.clientY}:null}const Ae=Object.freeze({Translate:{toString(t){if(!t)return;const{x:n,y:e}=t;return"translate3d("+(n?Math.round(n):0)+"px, "+(e?Math.round(e):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:n,scaleY:e}=t;return"scaleX("+n+") scaleY("+e+")"}},Transform:{toString(t){if(t)return[Ae.Translate.toString(t),Ae.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:n,duration:e,easing:o}=t;return n+" "+e+"ms "+o}}}),Qr="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ol(t){return t.matches(Qr)?t:t.querySelector(Qr)}const sl={display:"none"};function al(t){let{id:n,value:e}=t;return It.createElement("div",{id:n,style:sl},e)}function ll(t){let{id:n,announcement:e,ariaLiveType:o="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return It.createElement("div",{id:n,style:i,role:"status","aria-live":o,"aria-atomic":!0},e)}function cl(){const[t,n]=z.useState("");return{announce:z.useCallback(o=>{o!=null&&n(o)},[]),announcement:t}}const ho=z.createContext(null);function dl(t){const n=z.useContext(ho);z.useEffect(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(t)},[t,n])}function ul(){const[t]=z.useState(()=>new Set),n=z.useCallback(o=>(t.add(o),()=>t.delete(o)),[t]);return[z.useCallback(o=>{let{type:i,event:r}=o;t.forEach(a=>{var s;return(s=a[i])==null?void 0:s.call(a,r)})},[t]),n]}const fl={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},hl={onDragStart(t){let{active:n}=t;return"Picked up draggable item "+n.id+"."},onDragOver(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was moved over droppable area "+e.id+".":"Draggable item "+n.id+" is no longer over a droppable area."},onDragEnd(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was dropped over droppable area "+e.id:"Draggable item "+n.id+" was dropped."},onDragCancel(t){let{active:n}=t;return"Dragging was cancelled. Draggable item "+n.id+" was dropped."}};function pl(t){let{announcements:n=hl,container:e,hiddenTextDescribedById:o,screenReaderInstructions:i=fl}=t;const{announce:r,announcement:a}=cl(),s=De("DndLiveRegion"),[l,u]=z.useState(!1);if(z.useEffect(()=>{u(!0)},[]),dl(z.useMemo(()=>({onDragStart(m){let{active:g}=m;r(n.onDragStart({active:g}))},onDragMove(m){let{active:g,over:d}=m;n.onDragMove&&r(n.onDragMove({active:g,over:d}))},onDragOver(m){let{active:g,over:d}=m;r(n.onDragOver({active:g,over:d}))},onDragEnd(m){let{active:g,over:d}=m;r(n.onDragEnd({active:g,over:d}))},onDragCancel(m){let{active:g,over:d}=m;r(n.onDragCancel({active:g,over:d}))}}),[r,n])),!l)return null;const p=It.createElement(It.Fragment,null,It.createElement(al,{id:o,value:i.draggable}),It.createElement(ll,{id:s,announcement:a}));return e?ke.createPortal(p,e):p}var Ct;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ct||(Ct={}));function Xe(){}function Jr(t,n){return z.useMemo(()=>({sensor:t,options:n??{}}),[t,n])}function ml(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return z.useMemo(()=>[...n].filter(o=>o!=null),[...n])}const Mt=Object.freeze({x:0,y:0});function gl(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function bl(t,n){let{data:{value:e}}=t,{data:{value:o}}=n;return e-o}function yl(t,n){let{data:{value:e}}=t,{data:{value:o}}=n;return o-e}function vl(t,n){if(!t||t.length===0)return null;const[e]=t;return e[n]}function ti(t,n,e){return n===void 0&&(n=t.left),e===void 0&&(e=t.top),{x:n+t.width*.5,y:e+t.height*.5}}const wl=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:o}=t;const i=ti(n,n.left,n.top),r=[];for(const a of o){const{id:s}=a,l=e.get(s);if(l){const u=gl(ti(l),i);r.push({id:s,data:{droppableContainer:a,value:u}})}}return r.sort(bl)};function xl(t,n){const e=Math.max(n.top,t.top),o=Math.max(n.left,t.left),i=Math.min(n.left+n.width,t.left+t.width),r=Math.min(n.top+n.height,t.top+t.height),a=i-o,s=r-e;if(o<i&&e<r){const l=n.width*n.height,u=t.width*t.height,p=a*s,m=p/(l+u-p);return Number(m.toFixed(4))}return 0}const _l=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:o}=t;const i=[];for(const r of o){const{id:a}=r,s=e.get(a);if(s){const l=xl(s,n);l>0&&i.push({id:a,data:{droppableContainer:r,value:l}})}}return i.sort(yl)};function kl(t,n,e){return{...t,scaleX:n&&e?n.width/e.width:1,scaleY:n&&e?n.height/e.height:1}}function po(t,n){return t&&n?{x:t.left-n.left,y:t.top-n.top}:Mt}function Cl(t){return function(e){for(var o=arguments.length,i=new Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];return i.reduce((a,s)=>({...a,top:a.top+t*s.y,bottom:a.bottom+t*s.y,left:a.left+t*s.x,right:a.right+t*s.x}),{...e})}}const El=Cl(1);function Sl(t){if(t.startsWith("matrix3d(")){const n=t.slice(9,-1).split(/, /);return{x:+n[12],y:+n[13],scaleX:+n[0],scaleY:+n[5]}}else if(t.startsWith("matrix(")){const n=t.slice(7,-1).split(/, /);return{x:+n[4],y:+n[5],scaleX:+n[0],scaleY:+n[3]}}return null}function Rl(t,n,e){const o=Sl(n);if(!o)return t;const{scaleX:i,scaleY:r,x:a,y:s}=o,l=t.left-a-(1-i)*parseFloat(e),u=t.top-s-(1-r)*parseFloat(e.slice(e.indexOf(" ")+1)),p=i?t.width/i:t.width,m=r?t.height/r:t.height;return{width:p,height:m,top:u,right:l+p,bottom:u+m,left:l}}const Al={ignoreTransform:!1};function be(t,n){n===void 0&&(n=Al);let e=t.getBoundingClientRect();if(n.ignoreTransform){const{transform:u,transformOrigin:p}=Dt(t).getComputedStyle(t);u&&(e=Rl(e,u,p))}const{top:o,left:i,width:r,height:a,bottom:s,right:l}=e;return{top:o,left:i,width:r,height:a,bottom:s,right:l}}function ei(t){return be(t,{ignoreTransform:!0})}function Nl(t){const n=t.innerWidth,e=t.innerHeight;return{top:0,left:0,right:n,bottom:e,width:n,height:e}}function Il(t,n){return n===void 0&&(n=Dt(t).getComputedStyle(t)),n.position==="fixed"}function Tl(t,n){n===void 0&&(n=Dt(t).getComputedStyle(t));const e=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const r=n[i];return typeof r=="string"?e.test(r):!1})}function ar(t,n){const e=[];function o(i){if(n!=null&&e.length>=n||!i)return e;if(ir(i)&&i.scrollingElement!=null&&!e.includes(i.scrollingElement))return e.push(i.scrollingElement),e;if(!Ie(i)||uo(i)||e.includes(i))return e;const r=Dt(t).getComputedStyle(i);return i!==t&&Tl(i,r)&&e.push(i),Il(i,r)?e:o(i.parentNode)}return t?o(t):e}function mo(t){const[n]=ar(t,1);return n??null}function Bn(t){return!Je||!t?null:me(t)?t:rr(t)?ir(t)||t===ge(t).scrollingElement?window:Ie(t)?t:null:null}function go(t){return me(t)?t.scrollX:t.scrollLeft}function bo(t){return me(t)?t.scrollY:t.scrollTop}function Yn(t){return{x:go(t),y:bo(t)}}var At;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(At||(At={}));function yo(t){return!Je||!t?!1:t===document.scrollingElement}function vo(t){const n={x:0,y:0},e=yo(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},o={x:t.scrollWidth-e.width,y:t.scrollHeight-e.height},i=t.scrollTop<=n.y,r=t.scrollLeft<=n.x,a=t.scrollTop>=o.y,s=t.scrollLeft>=o.x;return{isTop:i,isLeft:r,isBottom:a,isRight:s,maxScroll:o,minScroll:n}}const Dl={x:.2,y:.2};function zl(t,n,e,o,i){let{top:r,left:a,right:s,bottom:l}=e;o===void 0&&(o=10),i===void 0&&(i=Dl);const{isTop:u,isBottom:p,isLeft:m,isRight:g}=vo(t),d={x:0,y:0},y={x:0,y:0},f={height:n.height*i.y,width:n.width*i.x};return!u&&r<=n.top+f.height?(d.y=At.Backward,y.y=o*Math.abs((n.top+f.height-r)/f.height)):!p&&l>=n.bottom-f.height&&(d.y=At.Forward,y.y=o*Math.abs((n.bottom-f.height-l)/f.height)),!g&&s>=n.right-f.width?(d.x=At.Forward,y.x=o*Math.abs((n.right-f.width-s)/f.width)):!m&&a<=n.left+f.width&&(d.x=At.Backward,y.x=o*Math.abs((n.left+f.width-a)/f.width)),{direction:d,speed:y}}function jl(t){if(t===document.scrollingElement){const{innerWidth:r,innerHeight:a}=window;return{top:0,left:0,right:r,bottom:a,width:r,height:a}}const{top:n,left:e,right:o,bottom:i}=t.getBoundingClientRect();return{top:n,left:e,right:o,bottom:i,width:t.clientWidth,height:t.clientHeight}}function wo(t){return t.reduce((n,e)=>ue(n,Yn(e)),Mt)}function Ll(t){return t.reduce((n,e)=>n+go(e),0)}function Bl(t){return t.reduce((n,e)=>n+bo(e),0)}function Pl(t,n){if(n===void 0&&(n=be),!t)return;const{top:e,left:o,bottom:i,right:r}=n(t);mo(t)&&(i<=0||r<=0||e>=window.innerHeight||o>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const Ml=[["x",["left","right"],Ll],["y",["top","bottom"],Bl]];class lr{constructor(n,e){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const o=ar(e),i=wo(o);this.rect={...n},this.width=n.width,this.height=n.height;for(const[r,a,s]of Ml)for(const l of a)Object.defineProperty(this,l,{get:()=>{const u=s(o),p=i[r]-u;return this.rect[l]+p},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ce{constructor(n){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var o;return(o=this.target)==null?void 0:o.removeEventListener(...e)})},this.target=n}add(n,e,o){var i;(i=this.target)==null||i.addEventListener(n,e,o),this.listeners.push([n,e,o])}}function Ol(t){const{EventTarget:n}=Dt(t);return t instanceof n?t:ge(t)}function Pn(t,n){const e=Math.abs(t.x),o=Math.abs(t.y);return typeof n=="number"?Math.sqrt(e**2+o**2)>n:"x"in n&&"y"in n?e>n.x&&o>n.y:"x"in n?e>n.x:"y"in n?o>n.y:!1}var Pt;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Pt||(Pt={}));function ni(t){t.preventDefault()}function Fl(t){t.stopPropagation()}var mt;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(mt||(mt={}));const xo={start:[mt.Space,mt.Enter],cancel:[mt.Esc],end:[mt.Space,mt.Enter,mt.Tab]},Ul=(t,n)=>{let{currentCoordinates:e}=n;switch(t.code){case mt.Right:return{...e,x:e.x+25};case mt.Left:return{...e,x:e.x-25};case mt.Down:return{...e,y:e.y+25};case mt.Up:return{...e,y:e.y-25}}};class _o{constructor(n){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=n;const{event:{target:e}}=n;this.props=n,this.listeners=new Ce(ge(e)),this.windowListeners=new Ce(Dt(e)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Pt.Resize,this.handleCancel),this.windowListeners.add(Pt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Pt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:n,onStart:e}=this.props,o=n.node.current;o&&Pl(o),e(Mt)}handleKeyDown(n){if(sr(n)){const{active:e,context:o,options:i}=this.props,{keyboardCodes:r=xo,coordinateGetter:a=Ul,scrollBehavior:s="smooth"}=i,{code:l}=n;if(r.end.includes(l)){this.handleEnd(n);return}if(r.cancel.includes(l)){this.handleCancel(n);return}const{collisionRect:u}=o.current,p=u?{x:u.left,y:u.top}:Mt;this.referenceCoordinates||(this.referenceCoordinates=p);const m=a(n,{active:e,context:o.current,currentCoordinates:p});if(m){const g=$e(m,p),d={x:0,y:0},{scrollableAncestors:y}=o.current;for(const f of y){const v=n.code,{isTop:b,isRight:x,isLeft:w,isBottom:_,maxScroll:N,minScroll:D}=vo(f),C=jl(f),E={x:Math.min(v===mt.Right?C.right-C.width/2:C.right,Math.max(v===mt.Right?C.left:C.left+C.width/2,m.x)),y:Math.min(v===mt.Down?C.bottom-C.height/2:C.bottom,Math.max(v===mt.Down?C.top:C.top+C.height/2,m.y))},R=v===mt.Right&&!x||v===mt.Left&&!w,B=v===mt.Down&&!_||v===mt.Up&&!b;if(R&&E.x!==m.x){const F=f.scrollLeft+g.x,S=v===mt.Right&&F<=N.x||v===mt.Left&&F>=D.x;if(S&&!g.y){f.scrollTo({left:F,behavior:s});return}S?d.x=f.scrollLeft-F:d.x=v===mt.Right?f.scrollLeft-N.x:f.scrollLeft-D.x,d.x&&f.scrollBy({left:-d.x,behavior:s});break}else if(B&&E.y!==m.y){const F=f.scrollTop+g.y,S=v===mt.Down&&F<=N.y||v===mt.Up&&F>=D.y;if(S&&!g.x){f.scrollTo({top:F,behavior:s});return}S?d.y=f.scrollTop-F:d.y=v===mt.Down?f.scrollTop-N.y:f.scrollTop-D.y,d.y&&f.scrollBy({top:-d.y,behavior:s});break}}this.handleMove(n,ue($e(m,this.referenceCoordinates),d))}}}handleMove(n,e){const{onMove:o}=this.props;n.preventDefault(),o(e)}handleEnd(n){const{onEnd:e}=this.props;n.preventDefault(),this.detach(),e()}handleCancel(n){const{onCancel:e}=this.props;n.preventDefault(),this.detach(),e()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}_o.activators=[{eventName:"onKeyDown",handler:(t,n,e)=>{let{keyboardCodes:o=xo,onActivation:i}=n,{active:r}=e;const{code:a}=t.nativeEvent;if(o.start.includes(a)){const s=r.activatorNode.current;return s&&t.target!==s?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function ri(t){return!!(t&&"distance"in t)}function ii(t){return!!(t&&"delay"in t)}class cr{constructor(n,e,o){var i;o===void 0&&(o=Ol(n.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=n,this.events=e;const{event:r}=n,{target:a}=r;this.props=n,this.events=e,this.document=ge(a),this.documentListeners=new Ce(this.document),this.listeners=new Ce(o),this.windowListeners=new Ce(Dt(a)),this.initialCoordinates=(i=Gn(r))!=null?i:Mt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:n,props:{options:{activationConstraint:e,bypassActivationConstraint:o}}}=this;if(this.listeners.add(n.move.name,this.handleMove,{passive:!1}),this.listeners.add(n.end.name,this.handleEnd),n.cancel&&this.listeners.add(n.cancel.name,this.handleCancel),this.windowListeners.add(Pt.Resize,this.handleCancel),this.windowListeners.add(Pt.DragStart,ni),this.windowListeners.add(Pt.VisibilityChange,this.handleCancel),this.windowListeners.add(Pt.ContextMenu,ni),this.documentListeners.add(Pt.Keydown,this.handleKeydown),e){if(o!=null&&o({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(ii(e)){this.timeoutId=setTimeout(this.handleStart,e.delay),this.handlePending(e);return}if(ri(e)){this.handlePending(e);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(n,e){const{active:o,onPending:i}=this.props;i(o,n,this.initialCoordinates,e)}handleStart(){const{initialCoordinates:n}=this,{onStart:e}=this.props;n&&(this.activated=!0,this.documentListeners.add(Pt.Click,Fl,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Pt.SelectionChange,this.removeTextSelection),e(n))}handleMove(n){var e;const{activated:o,initialCoordinates:i,props:r}=this,{onMove:a,options:{activationConstraint:s}}=r;if(!i)return;const l=(e=Gn(n))!=null?e:Mt,u=$e(i,l);if(!o&&s){if(ri(s)){if(s.tolerance!=null&&Pn(u,s.tolerance))return this.handleCancel();if(Pn(u,s.distance))return this.handleStart()}if(ii(s)&&Pn(u,s.tolerance))return this.handleCancel();this.handlePending(s,u);return}n.cancelable&&n.preventDefault(),a(l)}handleEnd(){const{onAbort:n,onEnd:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleCancel(){const{onAbort:n,onCancel:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleKeydown(n){n.code===mt.Esc&&this.handleCancel()}removeTextSelection(){var n;(n=this.document.getSelection())==null||n.removeAllRanges()}}const Wl={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class dr extends cr{constructor(n){const{event:e}=n,o=ge(e.target);super(n,Wl,o)}}dr.activators=[{eventName:"onPointerDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:o}=n;return!e.isPrimary||e.button!==0?!1:(o?.({event:e}),!0)}}];const ql={move:{name:"mousemove"},end:{name:"mouseup"}};var Vn;(function(t){t[t.RightClick=2]="RightClick"})(Vn||(Vn={}));class Gl extends cr{constructor(n){super(n,ql,ge(n.event.target))}}Gl.activators=[{eventName:"onMouseDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:o}=n;return e.button===Vn.RightClick?!1:(o?.({event:e}),!0)}}];const Mn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ko extends cr{constructor(n){super(n,Mn)}static setup(){return window.addEventListener(Mn.move.name,n,{capture:!1,passive:!1}),function(){window.removeEventListener(Mn.move.name,n)};function n(){}}}ko.activators=[{eventName:"onTouchStart",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:o}=n;const{touches:i}=e;return i.length>1?!1:(o?.({event:e}),!0)}}];var Ee;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Ee||(Ee={}));var Ke;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ke||(Ke={}));function Yl(t){let{acceleration:n,activator:e=Ee.Pointer,canScroll:o,draggingRect:i,enabled:r,interval:a=5,order:s=Ke.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:p,delta:m,threshold:g}=t;const d=Hl({delta:m,disabled:!r}),[y,f]=nl(),v=z.useRef({x:0,y:0}),b=z.useRef({x:0,y:0}),x=z.useMemo(()=>{switch(e){case Ee.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Ee.DraggableRect:return i}},[e,i,l]),w=z.useRef(null),_=z.useCallback(()=>{const D=w.current;if(!D)return;const C=v.current.x*b.current.x,E=v.current.y*b.current.y;D.scrollBy(C,E)},[]),N=z.useMemo(()=>s===Ke.TreeOrder?[...u].reverse():u,[s,u]);z.useEffect(()=>{if(!r||!u.length||!x){f();return}for(const D of N){if(o?.(D)===!1)continue;const C=u.indexOf(D),E=p[C];if(!E)continue;const{direction:R,speed:B}=zl(D,E,x,n,g);for(const F of["x","y"])d[F][R[F]]||(B[F]=0,R[F]=0);if(B.x>0||B.y>0){f(),w.current=D,y(_,a),v.current=B,b.current=R;return}}v.current={x:0,y:0},b.current={x:0,y:0},f()},[n,_,o,f,r,a,JSON.stringify(x),JSON.stringify(d),y,u,N,p,JSON.stringify(g)])}const Vl={x:{[At.Backward]:!1,[At.Forward]:!1},y:{[At.Backward]:!1,[At.Forward]:!1}};function Hl(t){let{delta:n,disabled:e}=t;const o=qn(n);return Te(i=>{if(e||!o||!i)return Vl;const r={x:Math.sign(n.x-o.x),y:Math.sign(n.y-o.y)};return{x:{[At.Backward]:i.x[At.Backward]||r.x===-1,[At.Forward]:i.x[At.Forward]||r.x===1},y:{[At.Backward]:i.y[At.Backward]||r.y===-1,[At.Forward]:i.y[At.Forward]||r.y===1}}},[e,n,o])}function Zl(t,n){const e=n!=null?t.get(n):void 0,o=e?e.node.current:null;return Te(i=>{var r;return n==null?null:(r=o??i)!=null?r:null},[o,n])}function $l(t,n){return z.useMemo(()=>t.reduce((e,o)=>{const{sensor:i}=o,r=i.activators.map(a=>({eventName:a.eventName,handler:n(a.handler,o)}));return[...e,...r]},[]),[t,n])}var Ne;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Ne||(Ne={}));var Hn;(function(t){t.Optimized="optimized"})(Hn||(Hn={}));const oi=new Map;function Xl(t,n){let{dragging:e,dependencies:o,config:i}=n;const[r,a]=z.useState(null),{frequency:s,measure:l,strategy:u}=i,p=z.useRef(t),m=v(),g=Re(m),d=z.useCallback(function(b){b===void 0&&(b=[]),!g.current&&a(x=>x===null?b:x.concat(b.filter(w=>!x.includes(w))))},[g]),y=z.useRef(null),f=Te(b=>{if(m&&!e)return oi;if(!b||b===oi||p.current!==t||r!=null){const x=new Map;for(let w of t){if(!w)continue;if(r&&r.length>0&&!r.includes(w.id)&&w.rect.current){x.set(w.id,w.rect.current);continue}const _=w.node.current,N=_?new lr(l(_),_):null;w.rect.current=N,N&&x.set(w.id,N)}return x}return b},[t,r,e,m,l]);return z.useEffect(()=>{p.current=t},[t]),z.useEffect(()=>{m||d()},[e,m]),z.useEffect(()=>{r&&r.length>0&&a(null)},[JSON.stringify(r)]),z.useEffect(()=>{m||typeof s!="number"||y.current!==null||(y.current=setTimeout(()=>{d(),y.current=null},s))},[s,m,d,...o]),{droppableRects:f,measureDroppableContainers:d,measuringScheduled:r!=null};function v(){switch(u){case Ne.Always:return!1;case Ne.BeforeDragging:return e;default:return!e}}}function Co(t,n){return Te(e=>t?e||(typeof n=="function"?n(t):t):null,[n,t])}function Kl(t,n){return Co(t,n)}function Ql(t){let{callback:n,disabled:e}=t;const o=or(n),i=z.useMemo(()=>{if(e||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:r}=window;return new r(o)},[o,e]);return z.useEffect(()=>()=>i?.disconnect(),[i]),i}function tn(t){let{callback:n,disabled:e}=t;const o=or(n),i=z.useMemo(()=>{if(e||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:r}=window;return new r(o)},[e]);return z.useEffect(()=>()=>i?.disconnect(),[i]),i}function Jl(t){return new lr(be(t),t)}function si(t,n,e){n===void 0&&(n=Jl);const[o,i]=z.useState(null);function r(){i(l=>{if(!t)return null;if(t.isConnected===!1){var u;return(u=l??e)!=null?u:null}const p=n(t);return JSON.stringify(l)===JSON.stringify(p)?l:p})}const a=Ql({callback(l){if(t)for(const u of l){const{type:p,target:m}=u;if(p==="childList"&&m instanceof HTMLElement&&m.contains(t)){r();break}}}}),s=tn({callback:r});return qt(()=>{r(),t?(s?.observe(t),a?.observe(document.body,{childList:!0,subtree:!0})):(s?.disconnect(),a?.disconnect())},[t]),o}function tc(t){const n=Co(t);return po(t,n)}const ai=[];function ec(t){const n=z.useRef(t),e=Te(o=>t?o&&o!==ai&&t&&n.current&&t.parentNode===n.current.parentNode?o:ar(t):ai,[t]);return z.useEffect(()=>{n.current=t},[t]),e}function nc(t){const[n,e]=z.useState(null),o=z.useRef(t),i=z.useCallback(r=>{const a=Bn(r.target);a&&e(s=>s?(s.set(a,Yn(a)),new Map(s)):null)},[]);return z.useEffect(()=>{const r=o.current;if(t!==r){a(r);const s=t.map(l=>{const u=Bn(l);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,Yn(u)]):null}).filter(l=>l!=null);e(s.length?new Map(s):null),o.current=t}return()=>{a(t),a(r)};function a(s){s.forEach(l=>{const u=Bn(l);u?.removeEventListener("scroll",i)})}},[i,t]),z.useMemo(()=>t.length?n?Array.from(n.values()).reduce((r,a)=>ue(r,a),Mt):wo(t):Mt,[t,n])}function li(t,n){n===void 0&&(n=[]);const e=z.useRef(null);return z.useEffect(()=>{e.current=null},n),z.useEffect(()=>{const o=t!==Mt;o&&!e.current&&(e.current=t),!o&&e.current&&(e.current=null)},[t]),e.current?$e(t,e.current):Mt}function rc(t){z.useEffect(()=>{if(!Je)return;const n=t.map(e=>{let{sensor:o}=e;return o.setup==null?void 0:o.setup()});return()=>{for(const e of n)e?.()}},t.map(n=>{let{sensor:e}=n;return e}))}function ic(t,n){return z.useMemo(()=>t.reduce((e,o)=>{let{eventName:i,handler:r}=o;return e[i]=a=>{r(a,n)},e},{}),[t,n])}function Eo(t){return z.useMemo(()=>t?Nl(t):null,[t])}const ci=[];function oc(t,n){n===void 0&&(n=be);const[e]=t,o=Eo(e?Dt(e):null),[i,r]=z.useState(ci);function a(){r(()=>t.length?t.map(l=>yo(l)?o:new lr(n(l),l)):ci)}const s=tn({callback:a});return qt(()=>{s?.disconnect(),a(),t.forEach(l=>s?.observe(l))},[t]),i}function sc(t){if(!t)return null;if(t.children.length>1)return t;const n=t.children[0];return Ie(n)?n:t}function ac(t){let{measure:n}=t;const[e,o]=z.useState(null),i=z.useCallback(u=>{for(const{target:p}of u)if(Ie(p)){o(m=>{const g=n(p);return m?{...m,width:g.width,height:g.height}:g});break}},[n]),r=tn({callback:i}),a=z.useCallback(u=>{const p=sc(u);r?.disconnect(),p&&r?.observe(p),o(p?n(p):null)},[n,r]),[s,l]=Ze(a);return z.useMemo(()=>({nodeRef:s,rect:e,setRef:l}),[e,s,l])}const lc=[{sensor:dr,options:{}},{sensor:_o,options:{}}],cc={current:{}},Ve={draggable:{measure:ei},droppable:{measure:ei,strategy:Ne.WhileDragging,frequency:Hn.Optimized},dragOverlay:{measure:be}};class Se extends Map{get(n){var e;return n!=null&&(e=super.get(n))!=null?e:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(n=>{let{disabled:e}=n;return!e})}getNodeFor(n){var e,o;return(e=(o=this.get(n))==null?void 0:o.node.current)!=null?e:void 0}}const dc={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Se,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Xe},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ve,measureDroppableContainers:Xe,windowRect:null,measuringScheduled:!1},uc={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Xe,draggableNodes:new Map,over:null,measureDroppableContainers:Xe},en=z.createContext(uc),So=z.createContext(dc);function fc(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Se}}}function hc(t,n){switch(n.type){case Ct.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:n.initialCoordinates,active:n.active}};case Ct.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:n.coordinates.x-t.draggable.initialCoordinates.x,y:n.coordinates.y-t.draggable.initialCoordinates.y}}};case Ct.DragEnd:case Ct.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ct.RegisterDroppable:{const{element:e}=n,{id:o}=e,i=new Se(t.droppable.containers);return i.set(o,e),{...t,droppable:{...t.droppable,containers:i}}}case Ct.SetDroppableDisabled:{const{id:e,key:o,disabled:i}=n,r=t.droppable.containers.get(e);if(!r||o!==r.key)return t;const a=new Se(t.droppable.containers);return a.set(e,{...r,disabled:i}),{...t,droppable:{...t.droppable,containers:a}}}case Ct.UnregisterDroppable:{const{id:e,key:o}=n,i=t.droppable.containers.get(e);if(!i||o!==i.key)return t;const r=new Se(t.droppable.containers);return r.delete(e),{...t,droppable:{...t.droppable,containers:r}}}default:return t}}function pc(t){let{disabled:n}=t;const{active:e,activatorEvent:o,draggableNodes:i}=z.useContext(en),r=qn(o),a=qn(e?.id);return z.useEffect(()=>{if(!n&&!o&&r&&a!=null){if(!sr(r)||document.activeElement===r.target)return;const s=i.get(a);if(!s)return;const{activatorNode:l,node:u}=s;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const p of[l.current,u.current]){if(!p)continue;const m=ol(p);if(m){m.focus();break}}})}},[o,n,i,a,r]),null}function mc(t,n){let{transform:e,...o}=n;return t!=null&&t.length?t.reduce((i,r)=>r({transform:i,...o}),e):e}function gc(t){return z.useMemo(()=>({draggable:{...Ve.draggable,...t?.draggable},droppable:{...Ve.droppable,...t?.droppable},dragOverlay:{...Ve.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function bc(t){let{activeNode:n,measure:e,initialRect:o,config:i=!0}=t;const r=z.useRef(!1),{x:a,y:s}=typeof i=="boolean"?{x:i,y:i}:i;qt(()=>{if(!a&&!s||!n){r.current=!1;return}if(r.current||!o)return;const u=n?.node.current;if(!u||u.isConnected===!1)return;const p=e(u),m=po(p,o);if(a||(m.x=0),s||(m.y=0),r.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const g=mo(u);g&&g.scrollBy({top:m.y,left:m.x})}},[n,a,s,o,e])}const Ro=z.createContext({...Mt,scaleX:1,scaleY:1});var te;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(te||(te={}));const yc=z.memo(function(n){var e,o,i,r;let{id:a,accessibility:s,autoScroll:l=!0,children:u,sensors:p=lc,collisionDetection:m=_l,measuring:g,modifiers:d,...y}=n;const f=z.useReducer(hc,void 0,fc),[v,b]=f,[x,w]=ul(),[_,N]=z.useState(te.Uninitialized),D=_===te.Initialized,{draggable:{active:C,nodes:E,translate:R},droppable:{containers:B}}=v,F=C!=null?E.get(C):null,S=z.useRef({initial:null,translated:null}),k=z.useMemo(()=>{var wt;return C!=null?{id:C,data:(wt=F?.data)!=null?wt:cc,rect:S}:null},[C,F]),c=z.useRef(null),[O,K]=z.useState(null),[q,V]=z.useState(null),U=Re(y,Object.values(y)),et=De("DndDescribedBy",a),P=z.useMemo(()=>B.getEnabled(),[B]),L=gc(g),{droppableRects:J,measureDroppableContainers:Z,measuringScheduled:$}=Xl(P,{dragging:D,dependencies:[R.x,R.y],config:L.droppable}),dt=Zl(E,C),lt=z.useMemo(()=>q?Gn(q):null,[q]),it=Le(),at=Kl(dt,L.draggable.measure);bc({activeNode:C!=null?E.get(C):null,config:it.layoutShiftCompensation,initialRect:at,measure:L.draggable.measure});const ot=si(dt,L.draggable.measure,at),pt=si(dt?dt.parentElement:null),gt=z.useRef({activatorEvent:null,active:null,activeNode:dt,collisionRect:null,collisions:null,droppableRects:J,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:B,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Et=B.getNodeFor((e=gt.current.over)==null?void 0:e.id),h=ac({measure:L.dragOverlay.measure}),G=(o=h.nodeRef.current)!=null?o:dt,W=D?(i=h.rect)!=null?i:ot:null,T=!!(h.nodeRef.current&&h.rect),A=tc(T?null:ot),j=Eo(G?Dt(G):null),Y=ec(D?Et??dt:null),H=oc(Y),M=mc(d,{transform:{x:R.x-A.x,y:R.y-A.y,scaleX:1,scaleY:1},activatorEvent:q,active:k,activeNodeRect:ot,containerNodeRect:pt,draggingNodeRect:W,over:gt.current.over,overlayNodeRect:h.rect,scrollableAncestors:Y,scrollableAncestorRects:H,windowRect:j}),X=lt?ue(lt,R):null,tt=nc(Y),Q=li(tt),st=li(tt,[ot]),ft=ue(M,Q),ct=W?El(W,M):null,St=k&&ct?m({active:k,collisionRect:ct,droppableRects:J,droppableContainers:P,pointerCoordinates:X}):null,Ht=vl(St,"id"),[_t,Zt]=z.useState(null),yt=T?M:ue(M,st),oe=kl(yt,(r=_t?.rect)!=null?r:null,ot),ee=z.useRef(null),Lt=z.useCallback((wt,Rt)=>{let{sensor:zt,options:$t}=Rt;if(c.current==null)return;const Bt=E.get(c.current);if(!Bt)return;const jt=wt.nativeEvent,Ot=new zt({active:c.current,activeNode:Bt,event:jt,options:$t,context:gt,onAbort(Nt){if(!E.get(Nt))return;const{onDragAbort:Ft}=U.current,Gt={id:Nt};Ft?.(Gt),x({type:"onDragAbort",event:Gt})},onPending(Nt,Xt,Ft,Gt){if(!E.get(Nt))return;const{onDragPending:ve}=U.current,Kt={id:Nt,constraint:Xt,initialCoordinates:Ft,offset:Gt};ve?.(Kt),x({type:"onDragPending",event:Kt})},onStart(Nt){const Xt=c.current;if(Xt==null)return;const Ft=E.get(Xt);if(!Ft)return;const{onDragStart:Gt}=U.current,ye={activatorEvent:jt,active:{id:Xt,data:Ft.data,rect:S}};ke.unstable_batchedUpdates(()=>{Gt?.(ye),N(te.Initializing),b({type:Ct.DragStart,initialCoordinates:Nt,active:Xt}),x({type:"onDragStart",event:ye}),K(ee.current),V(jt)})},onMove(Nt){b({type:Ct.DragMove,coordinates:Nt})},onEnd:se(Ct.DragEnd),onCancel:se(Ct.DragCancel)});ee.current=Ot;function se(Nt){return async function(){const{active:Ft,collisions:Gt,over:ye,scrollAdjustedTranslate:ve}=gt.current;let Kt=null;if(Ft&&ve){const{cancelDrop:we}=U.current;Kt={activatorEvent:jt,active:Ft,collisions:Gt,delta:ve,over:ye},Nt===Ct.DragEnd&&typeof we=="function"&&await Promise.resolve(we(Kt))&&(Nt=Ct.DragCancel)}c.current=null,ke.unstable_batchedUpdates(()=>{b({type:Nt}),N(te.Uninitialized),Zt(null),K(null),V(null),ee.current=null;const we=Nt===Ct.DragEnd?"onDragEnd":"onDragCancel";if(Kt){const on=U.current[we];on?.(Kt),x({type:we,event:Kt})}})}}},[E]),ze=z.useCallback((wt,Rt)=>(zt,$t)=>{const Bt=zt.nativeEvent,jt=E.get($t);if(c.current!==null||!jt||Bt.dndKit||Bt.defaultPrevented)return;const Ot={active:jt};wt(zt,Rt.options,Ot)===!0&&(Bt.dndKit={capturedBy:Rt.sensor},c.current=$t,Lt(zt,Rt))},[E,Lt]),je=$l(p,ze);rc(p),qt(()=>{ot&&_===te.Initializing&&N(te.Initialized)},[ot,_]),z.useEffect(()=>{const{onDragMove:wt}=U.current,{active:Rt,activatorEvent:zt,collisions:$t,over:Bt}=gt.current;if(!Rt||!zt)return;const jt={active:Rt,activatorEvent:zt,collisions:$t,delta:{x:ft.x,y:ft.y},over:Bt};ke.unstable_batchedUpdates(()=>{wt?.(jt),x({type:"onDragMove",event:jt})})},[ft.x,ft.y]),z.useEffect(()=>{const{active:wt,activatorEvent:Rt,collisions:zt,droppableContainers:$t,scrollAdjustedTranslate:Bt}=gt.current;if(!wt||c.current==null||!Rt||!Bt)return;const{onDragOver:jt}=U.current,Ot=$t.get(Ht),se=Ot&&Ot.rect.current?{id:Ot.id,rect:Ot.rect.current,data:Ot.data,disabled:Ot.disabled}:null,Nt={active:wt,activatorEvent:Rt,collisions:zt,delta:{x:Bt.x,y:Bt.y},over:se};ke.unstable_batchedUpdates(()=>{Zt(se),jt?.(Nt),x({type:"onDragOver",event:Nt})})},[Ht]),qt(()=>{gt.current={activatorEvent:q,active:k,activeNode:dt,collisionRect:ct,collisions:St,droppableRects:J,draggableNodes:E,draggingNode:G,draggingNodeRect:W,droppableContainers:B,over:_t,scrollableAncestors:Y,scrollAdjustedTranslate:ft},S.current={initial:W,translated:ct}},[k,dt,St,ct,E,G,W,J,B,_t,Y,ft]),Yl({...it,delta:R,draggingRect:ct,pointerCoordinates:X,scrollableAncestors:Y,scrollableAncestorRects:H});const nn=z.useMemo(()=>({active:k,activeNode:dt,activeNodeRect:ot,activatorEvent:q,collisions:St,containerNodeRect:pt,dragOverlay:h,draggableNodes:E,droppableContainers:B,droppableRects:J,over:_t,measureDroppableContainers:Z,scrollableAncestors:Y,scrollableAncestorRects:H,measuringConfiguration:L,measuringScheduled:$,windowRect:j}),[k,dt,ot,q,St,pt,h,E,B,J,_t,Z,Y,H,L,$,j]),rn=z.useMemo(()=>({activatorEvent:q,activators:je,active:k,activeNodeRect:ot,ariaDescribedById:{draggable:et},dispatch:b,draggableNodes:E,over:_t,measureDroppableContainers:Z}),[q,je,k,ot,b,et,E,_t,Z]);return It.createElement(ho.Provider,{value:w},It.createElement(en.Provider,{value:rn},It.createElement(So.Provider,{value:nn},It.createElement(Ro.Provider,{value:oe},u)),It.createElement(pc,{disabled:s?.restoreFocus===!1})),It.createElement(pl,{...s,hiddenTextDescribedById:et}));function Le(){const wt=O?.autoScrollEnabled===!1,Rt=typeof l=="object"?l.enabled===!1:l===!1,zt=D&&!wt&&!Rt;return typeof l=="object"?{...l,enabled:zt}:{enabled:zt}}}),vc=z.createContext(null),di="button",wc="Draggable";function xc(t){let{id:n,data:e,disabled:o=!1,attributes:i}=t;const r=De(wc),{activators:a,activatorEvent:s,active:l,activeNodeRect:u,ariaDescribedById:p,draggableNodes:m,over:g}=z.useContext(en),{role:d=di,roleDescription:y="draggable",tabIndex:f=0}=i??{},v=l?.id===n,b=z.useContext(v?Ro:vc),[x,w]=Ze(),[_,N]=Ze(),D=ic(a,n),C=Re(e);qt(()=>(m.set(n,{id:n,key:r,node:x,activatorNode:_,data:C}),()=>{const R=m.get(n);R&&R.key===r&&m.delete(n)}),[m,n]);const E=z.useMemo(()=>({role:d,tabIndex:f,"aria-disabled":o,"aria-pressed":v&&d===di?!0:void 0,"aria-roledescription":y,"aria-describedby":p.draggable}),[o,d,f,v,y,p.draggable]);return{active:l,activatorEvent:s,activeNodeRect:u,attributes:E,isDragging:v,listeners:o?void 0:D,node:x,over:g,setNodeRef:w,setActivatorNodeRef:N,transform:b}}function _c(){return z.useContext(So)}const kc="Droppable",Cc={timeout:25};function Ec(t){let{data:n,disabled:e=!1,id:o,resizeObserverConfig:i}=t;const r=De(kc),{active:a,dispatch:s,over:l,measureDroppableContainers:u}=z.useContext(en),p=z.useRef({disabled:e}),m=z.useRef(!1),g=z.useRef(null),d=z.useRef(null),{disabled:y,updateMeasurementsFor:f,timeout:v}={...Cc,...i},b=Re(f??o),x=z.useCallback(()=>{if(!m.current){m.current=!0;return}d.current!=null&&clearTimeout(d.current),d.current=setTimeout(()=>{u(Array.isArray(b.current)?b.current:[b.current]),d.current=null},v)},[v]),w=tn({callback:x,disabled:y||!a}),_=z.useCallback((E,R)=>{w&&(R&&(w.unobserve(R),m.current=!1),E&&w.observe(E))},[w]),[N,D]=Ze(_),C=Re(n);return z.useEffect(()=>{!w||!N.current||(w.disconnect(),m.current=!1,w.observe(N.current))},[N,w]),z.useEffect(()=>(s({type:Ct.RegisterDroppable,element:{id:o,key:r,disabled:e,node:N,rect:g,data:C}}),()=>s({type:Ct.UnregisterDroppable,key:r,id:o})),[o]),z.useEffect(()=>{e!==p.current.disabled&&(s({type:Ct.SetDroppableDisabled,id:o,key:r,disabled:e}),p.current.disabled=e)},[o,r,e,s]),{active:a,rect:g,isOver:l?.id===o,node:N,over:l,setNodeRef:D}}function ur(t,n,e){const o=t.slice();return o.splice(e<0?o.length+e:e,0,o.splice(n,1)[0]),o}function Sc(t,n){return t.reduce((e,o,i)=>{const r=n.get(o);return r&&(e[i]=r),e},Array(t.length))}function qe(t){return t!==null&&t>=0}function Rc(t,n){if(t===n)return!0;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function Ac(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const fr=t=>{let{rects:n,activeIndex:e,overIndex:o,index:i}=t;const r=ur(n,o,e),a=n[i],s=r[i];return!s||!a?null:{x:s.left-a.left,y:s.top-a.top,scaleX:s.width/a.width,scaleY:s.height/a.height}},Ao="Sortable",No=It.createContext({activeIndex:-1,containerId:Ao,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:fr,disabled:{draggable:!1,droppable:!1}});function Nc(t){let{children:n,id:e,items:o,strategy:i=fr,disabled:r=!1}=t;const{active:a,dragOverlay:s,droppableRects:l,over:u,measureDroppableContainers:p}=_c(),m=De(Ao,e),g=s.rect!==null,d=z.useMemo(()=>o.map(D=>typeof D=="object"&&"id"in D?D.id:D),[o]),y=a!=null,f=a?d.indexOf(a.id):-1,v=u?d.indexOf(u.id):-1,b=z.useRef(d),x=!Rc(d,b.current),w=v!==-1&&f===-1||x,_=Ac(r);qt(()=>{x&&y&&p(d)},[x,d,y,p]),z.useEffect(()=>{b.current=d},[d]);const N=z.useMemo(()=>({activeIndex:f,containerId:m,disabled:_,disableTransforms:w,items:d,overIndex:v,useDragOverlay:g,sortedRects:Sc(d,l),strategy:i}),[f,m,_.draggable,_.droppable,w,d,v,l,g,i]);return It.createElement(No.Provider,{value:N},n)}const Ic=t=>{let{id:n,items:e,activeIndex:o,overIndex:i}=t;return ur(e,o,i).indexOf(n)},Tc=t=>{let{containerId:n,isSorting:e,wasDragging:o,index:i,items:r,newIndex:a,previousItems:s,previousContainerId:l,transition:u}=t;return!u||!o||s!==r&&i===a?!1:e?!0:a!==i&&n===l},Dc={duration:200,easing:"ease"},Io="transform",zc=Ae.Transition.toString({property:Io,duration:0,easing:"linear"}),jc={roleDescription:"sortable"};function Lc(t){let{disabled:n,index:e,node:o,rect:i}=t;const[r,a]=z.useState(null),s=z.useRef(e);return qt(()=>{if(!n&&e!==s.current&&o.current){const l=i.current;if(l){const u=be(o.current,{ignoreTransform:!0}),p={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(p.x||p.y)&&a(p)}}e!==s.current&&(s.current=e)},[n,e,o,i]),z.useEffect(()=>{r&&a(null)},[r]),r}function Bc(t){let{animateLayoutChanges:n=Tc,attributes:e,disabled:o,data:i,getNewIndex:r=Ic,id:a,strategy:s,resizeObserverConfig:l,transition:u=Dc}=t;const{items:p,containerId:m,activeIndex:g,disabled:d,disableTransforms:y,sortedRects:f,overIndex:v,useDragOverlay:b,strategy:x}=z.useContext(No),w=Pc(o,d),_=p.indexOf(a),N=z.useMemo(()=>({sortable:{containerId:m,index:_,items:p},...i}),[m,i,_,p]),D=z.useMemo(()=>p.slice(p.indexOf(a)),[p,a]),{rect:C,node:E,isOver:R,setNodeRef:B}=Ec({id:a,data:N,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:D,...l}}),{active:F,activatorEvent:S,activeNodeRect:k,attributes:c,setNodeRef:O,listeners:K,isDragging:q,over:V,setActivatorNodeRef:U,transform:et}=xc({id:a,data:N,attributes:{...jc,...e},disabled:w.draggable}),P=el(B,O),L=!!F,J=L&&!y&&qe(g)&&qe(v),Z=!b&&q,$=Z&&J?et:null,lt=J?$??(s??x)({rects:f,activeNodeRect:k,activeIndex:g,overIndex:v,index:_}):null,it=qe(g)&&qe(v)?r({id:a,items:p,activeIndex:g,overIndex:v}):_,at=F?.id,ot=z.useRef({activeId:at,items:p,newIndex:it,containerId:m}),pt=p!==ot.current.items,gt=n({active:F,containerId:m,isDragging:q,isSorting:L,id:a,index:_,items:p,newIndex:ot.current.newIndex,previousItems:ot.current.items,previousContainerId:ot.current.containerId,transition:u,wasDragging:ot.current.activeId!=null}),Et=Lc({disabled:!gt,index:_,node:E,rect:C});return z.useEffect(()=>{L&&ot.current.newIndex!==it&&(ot.current.newIndex=it),m!==ot.current.containerId&&(ot.current.containerId=m),p!==ot.current.items&&(ot.current.items=p)},[L,it,m,p]),z.useEffect(()=>{if(at===ot.current.activeId)return;if(at!=null&&ot.current.activeId==null){ot.current.activeId=at;return}const G=setTimeout(()=>{ot.current.activeId=at},50);return()=>clearTimeout(G)},[at]),{active:F,activeIndex:g,attributes:c,data:N,rect:C,index:_,newIndex:it,items:p,isOver:R,isSorting:L,isDragging:q,listeners:K,node:E,overIndex:v,over:V,setNodeRef:P,setActivatorNodeRef:U,setDroppableNodeRef:B,setDraggableNodeRef:O,transform:Et??lt,transition:h()};function h(){if(Et||pt&&ot.current.newIndex===_)return zc;if(!(Z&&!sr(S)||!u)&&(L||gt))return Ae.Transition.toString({...u,property:Io})}}function Pc(t,n){var e,o;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(e=t?.draggable)!=null?e:n.draggable,droppable:(o=t?.droppable)!=null?o:n.droppable}}mt.Down,mt.Right,mt.Up,mt.Left;function Mc({id:t,children:n}){const{attributes:e,listeners:o,setNodeRef:i,transform:r,transition:a,isDragging:s,isSorting:l}=Bc({id:t}),u={transform:Ae.Translate.toString(r),transition:a,position:"relative",zIndex:s?9999:l?2:1,cursor:s?"grabbing":"grab",touchAction:"none"};return I.jsx("div",{ref:i,style:u,...e,...o,children:n})}function ui(t){const n=t/1e3;return n<60?`${n.toFixed(1)}s`:`${Math.floor(n/60)}m ${(n%60).toFixed(0)}s`}class Oc extends dr{static activators=[{eventName:"onPointerDown",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}class Fc extends ko{static activators=[{eventName:"onTouchStart",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}function Uc(){const t=ht(w=>w.photos),n=ht(w=>w.reorderPhotos),[e,o]=z.useState(!1),[i,r]=z.useState(null),a=z.useRef(!1),[s,l]=z.useState("jpeg"),[u,p]=z.useState(qs*100),m=i?.pct??0,g=z.useMemo(()=>{if(!i)return"";const w=i.etaMs??0;return`Rendering ${i.done}/${i.total} • ${m}% • elapsed ${ui(i.elapsedMs)}${i.done<i.total?` • ETA ${ui(w)}`:""}`},[i,m]);z.useEffect(()=>{i&&i.done>=i.total&&r(null)},[i]);const d=z.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{o(!0);const{exportCardsToPdf:w}=await es(async()=>{const{exportCardsToPdf:E}=await import("./pdf-2P9C5zPN.js");return{exportCardsToPdf:E}},__vite__mapDeps([0,1,2,3])),_=await w(t,{format:s,quality:s==="jpeg"?u/100:void 0,onProgress:E=>r(E)}),N=new Blob([_],{type:"application/pdf"}),D=URL.createObjectURL(N),C=document.createElement("a");C.href=D,C.download="story-squares.pdf",document.body.appendChild(C),C.click(),C.remove(),URL.revokeObjectURL(D)}finally{o(!1),a.current=!1}}},[t,s,u]),y=z.useCallback(async()=>{o(!0);try{const w=await Ea({imageFormat:s,quality:s==="jpeg"?u/100:void 0,onProgress:({done:D,total:C})=>r({done:D,total:C,elapsedMs:0,pct:Math.round(D/C*100)})}),_=URL.createObjectURL(w),N=document.createElement("a");N.href=_,N.download="story-squares.zip",document.body.appendChild(N),N.click(),N.remove(),URL.revokeObjectURL(_)}finally{o(!1)}},[s,u]),f=It.useRef(null),v=z.useCallback(async w=>{try{const{warnings:_}=await Ji(w);_.length&&alert(`Import finished with warnings:
`+_.join(`
`))}catch(_){alert("Import failed: "+(_?.message||String(_)))}},[]),b=ml(Jr(Oc,{activationConstraint:{distance:6}}),Jr(Fc,{activationConstraint:{delay:120,tolerance:6}})),x=t.map(w=>w.id);return I.jsxs("section",{className:"space-y-3",children:[I.jsx(yc,{sensors:b,collisionDetection:wl,onDragEnd:({active:w,over:_})=>{if(!_||w.id===_.id)return;const N=x.indexOf(String(w.id)),D=x.indexOf(String(_.id));if(N===-1||D===-1)return;const C=ur(x,N,D);n(C)},children:I.jsx(Nc,{items:x,strategy:fr,children:I.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:t.map(w=>I.jsx(Mc,{id:w.id,children:I.jsx(tl,{photo:w})},w.id))})})}),t.length>0&&I.jsxs(to,{className:"p-4",children:[I.jsx("div",{className:"mb-3 text-sm font-medium",children:"Export the collection to..."}),i&&I.jsxs(I.Fragment,{children:[I.jsx(eo,{value:m,className:"mb-1 h-2"}),I.jsx("div",{className:"mb-3 text-xs opacity-70",children:g})]}),I.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("span",{className:"opacity-70",children:"Format"}),I.jsxs(no,{value:s,onValueChange:w=>l(w),children:[I.jsx(Kn,{className:"w-28 h-8",children:I.jsx(ro,{placeholder:"Format"})}),I.jsxs(Qn,{children:[I.jsx(de,{value:"jpeg",children:"JPEG (small)"}),I.jsx(de,{value:"png",children:"PNG (lossless)"})]})]})]}),s==="jpeg"&&I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("span",{className:"opacity-70",children:"Quality"}),I.jsx("input",{type:"range",min:50,max:95,step:5,value:u,onChange:w=>p(Number(w.target.value))}),I.jsxs("span",{className:"tabular-nums",children:[u,"%"]})]}),I.jsx("div",{className:"grow"}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx(xt,{type:"button",size:"sm",onClick:y,disabled:!t.length||e,children:"Save collection (.zip)"}),I.jsx("input",{ref:f,type:"file",accept:".zip,application/zip",className:"hidden",onChange:w=>{const _=w.currentTarget.files?.[0];_&&v(_),w.currentTarget.value=""}}),I.jsx(xt,{type:"button",size:"sm",onClick:d,disabled:!t.length||e,children:e?"Exporting…":"Export PDF"})]})]})]})]})}function Wc(){return ns(),I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"sticky top-0 z-10 w-full py-3 text-center text-3xl font-bold bg-background border-b border-gray-300",children:"Story Squares v1.1"}),I.jsxs("main",{className:"mx-auto max-w-screen-md px-4 space-y-5",children:[I.jsx(Ia,{}),I.jsx(Uc,{})]})]})}mi.createRoot(document.getElementById("root")).render(I.jsx(It.StrictMode,{children:I.jsx(Wc,{})}));export{Tt as C,qs as P,Qa as e};
