const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-VQF4wXTx.js","assets/jspdf-Cpx4AXLL.js","assets/vendor-react-CkEsgLSR.js","assets/vendor-ui-BqtEeXaX.js"])))=>i.map(i=>d[i]);
import{r as z,j as I,k as hi,m as Do,n as Be,C as pi,p as zo,q as jo,S as Lo,L as Bo,t as mr,I as mi,T as Mo,v as Po,X as Oo,w as gi,R as Tt,a as ke}from"./vendor-react-CkEsgLSR.js";import{S as Fo,R as bi,I as Uo,T as yi,a as Wo,b as vi,c as wi,P as qo,C as xi,V as Go,L as _i,d as ki,e as Yo,f as Vo,g as Ci,h as Ho,i as Zo,O as Ei,j as $o,k as Si,l as Xo,m as Ri,D as Ai,n as Ko,o as Ni,p as Ii,q as Qo,r as Jo,s as ts,t as es}from"./vendor-ui-BqtEeXaX.js";import{_ as ns}from"./jspdf-Cpx4AXLL.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}})();if(typeof window<"u"){const t=n=>{const e=n?.reason&&(n.reason.message||String(n.reason))||"Unknown async error";console.error("Unhandled promise rejection:",n?.reason),setTimeout(()=>alert(`Error: ${e}`),0)};window.addEventListener("unhandledrejection",t)}function sn(t){const n=document.documentElement,e=window.matchMedia("(prefers-color-scheme: dark)").matches,r=t==="dark"||t==="system"&&e;n.classList.toggle("dark",r)}function rs(){z.useEffect(()=>{const t=localStorage.getItem("theme")??"system";sn(t);const n=window.matchMedia("(prefers-color-scheme: dark)"),e=()=>{const o=localStorage.getItem("theme")??"system";o==="system"&&sn(o)};n.addEventListener("change",e);const r=o=>{if(o.key==="theme"){const i=o.newValue??"system";sn(i)}};return window.addEventListener("storage",r),()=>{n.removeEventListener("change",e),window.removeEventListener("storage",r)}},[])}function Ti(t){var n,e,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(n=0;n<o;n++)t[n]&&(e=Ti(t[n]))&&(r&&(r+=" "),r+=e)}else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Di(){for(var t,n,e=0,r="",o=arguments.length;e<o;e++)(t=arguments[e])&&(n=Ti(t))&&(r&&(r+=" "),r+=n);return r}const gr=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,br=Di,zi=(t,n)=>e=>{var r;if(n?.variants==null)return br(t,e?.class,e?.className);const{variants:o,defaultVariants:i}=n,a=Object.keys(o).map(d=>{const h=e?.[d],m=i?.[d];if(h===null)return null;const b=gr(h)||gr(m);return o[d][b]}),s=e&&Object.entries(e).reduce((d,h)=>{let[m,b]=h;return b===void 0||(d[m]=b),d},{}),l=n==null||(r=n.compoundVariants)===null||r===void 0?void 0:r.reduce((d,h)=>{let{class:m,className:b,...u}=h;return Object.entries(u).every(y=>{let[f,v]=y;return Array.isArray(v)?v.includes({...i,...s}[f]):{...i,...s}[f]===v})?[...d,m,b]:d},[]);return br(t,a,l,e?.class,e?.className)},$n="-",is=t=>{const n=ss(t),{conflictingClassGroups:e,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const s=a.split($n);return s[0]===""&&s.length!==1&&s.shift(),ji(s,n)||os(a)},getConflictingClassGroupIds:(a,s)=>{const l=e[a]||[];return s&&r[a]?[...l,...r[a]]:l}}},ji=(t,n)=>{if(t.length===0)return n.classGroupId;const e=t[0],r=n.nextPart.get(e),o=r?ji(t.slice(1),r):void 0;if(o)return o;if(n.validators.length===0)return;const i=t.join($n);return n.validators.find(({validator:a})=>a(i))?.classGroupId},yr=/^\[(.+)\]$/,os=t=>{if(yr.test(t)){const n=yr.exec(t)[1],e=n?.substring(0,n.indexOf(":"));if(e)return"arbitrary.."+e}},ss=t=>{const{theme:n,classGroups:e}=t,r={nextPart:new Map,validators:[]};for(const o in e)On(e[o],r,o,n);return r},On=(t,n,e,r)=>{t.forEach(o=>{if(typeof o=="string"){const i=o===""?n:vr(n,o);i.classGroupId=e;return}if(typeof o=="function"){if(as(o)){On(o(r),n,e,r);return}n.validators.push({validator:o,classGroupId:e});return}Object.entries(o).forEach(([i,a])=>{On(a,vr(n,i),e,r)})})},vr=(t,n)=>{let e=t;return n.split($n).forEach(r=>{e.nextPart.has(r)||e.nextPart.set(r,{nextPart:new Map,validators:[]}),e=e.nextPart.get(r)}),e},as=t=>t.isThemeGetter,ls=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,e=new Map,r=new Map;const o=(i,a)=>{e.set(i,a),n++,n>t&&(n=0,r=e,e=new Map)};return{get(i){let a=e.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return o(i,a),a},set(i,a){e.has(i)?e.set(i,a):o(i,a)}}},Fn="!",Un=":",cs=Un.length,ds=t=>{const{prefix:n,experimentalParseClassName:e}=t;let r=o=>{const i=[];let a=0,s=0,l=0,d;for(let y=0;y<o.length;y++){let f=o[y];if(a===0&&s===0){if(f===Un){i.push(o.slice(l,y)),l=y+cs;continue}if(f==="/"){d=y;continue}}f==="["?a++:f==="]"?a--:f==="("?s++:f===")"&&s--}const h=i.length===0?o:o.substring(l),m=us(h),b=m!==h,u=d&&d>l?d-l:void 0;return{modifiers:i,hasImportantModifier:b,baseClassName:m,maybePostfixModifierPosition:u}};if(n){const o=n+Un,i=r;r=a=>a.startsWith(o)?i(a.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(e){const o=r;r=i=>e({className:i,parseClassName:o})}return r},us=t=>t.endsWith(Fn)?t.substring(0,t.length-1):t.startsWith(Fn)?t.substring(1):t,fs=t=>{const n=Object.fromEntries(t.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const o=[];let i=[];return r.forEach(a=>{a[0]==="["||n[a]?(o.push(...i.sort(),a),i=[]):i.push(a)}),o.push(...i.sort()),o}},hs=t=>({cache:ls(t.cacheSize),parseClassName:ds(t),sortModifiers:fs(t),...is(t)}),ps=/\s+/,ms=(t,n)=>{const{parseClassName:e,getClassGroupId:r,getConflictingClassGroupIds:o,sortModifiers:i}=n,a=[],s=t.trim().split(ps);let l="";for(let d=s.length-1;d>=0;d-=1){const h=s[d],{isExternal:m,modifiers:b,hasImportantModifier:u,baseClassName:y,maybePostfixModifierPosition:f}=e(h);if(m){l=h+(l.length>0?" "+l:l);continue}let v=!!f,g=r(v?y.substring(0,f):y);if(!g){if(!v){l=h+(l.length>0?" "+l:l);continue}if(g=r(y),!g){l=h+(l.length>0?" "+l:l);continue}v=!1}const x=i(b).join(":"),k=u?x+Fn:x,w=k+g;if(a.includes(w))continue;a.push(w);const R=o(g,v);for(let T=0;T<R.length;++T){const _=R[T];a.push(k+_)}l=h+(l.length>0?" "+l:l)}return l};function gs(){let t=0,n,e,r="";for(;t<arguments.length;)(n=arguments[t++])&&(e=Li(n))&&(r&&(r+=" "),r+=e);return r}const Li=t=>{if(typeof t=="string")return t;let n,e="";for(let r=0;r<t.length;r++)t[r]&&(n=Li(t[r]))&&(e&&(e+=" "),e+=n);return e};function bs(t,...n){let e,r,o,i=a;function a(l){const d=n.reduce((h,m)=>m(h),t());return e=hs(d),r=e.cache.get,o=e.cache.set,i=s,s(l)}function s(l){const d=r(l);if(d)return d;const h=ms(l,e);return o(l,h),h}return function(){return i(gs.apply(null,arguments))}}const kt=t=>{const n=e=>e[t]||[];return n.isThemeGetter=!0,n},Bi=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Mi=/^\((?:(\w[\w-]*):)?(.+)\)$/i,ys=/^\d+\/\d+$/,vs=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ws=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,xs=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,_s=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ks=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ae=t=>ys.test(t),ut=t=>!!t&&!Number.isNaN(Number(t)),Qt=t=>!!t&&Number.isInteger(Number(t)),an=t=>t.endsWith("%")&&ut(t.slice(0,-1)),Yt=t=>vs.test(t),Cs=()=>!0,Es=t=>ws.test(t)&&!xs.test(t),Pi=()=>!1,Ss=t=>_s.test(t),Rs=t=>ks.test(t),As=t=>!nt(t)&&!rt(t),Ns=t=>he(t,Ui,Pi),nt=t=>Bi.test(t),ne=t=>he(t,Wi,Es),ln=t=>he(t,js,ut),wr=t=>he(t,Oi,Pi),Is=t=>he(t,Fi,Rs),Me=t=>he(t,qi,Ss),rt=t=>Mi.test(t),xe=t=>pe(t,Wi),Ts=t=>pe(t,Ls),xr=t=>pe(t,Oi),Ds=t=>pe(t,Ui),zs=t=>pe(t,Fi),Pe=t=>pe(t,qi,!0),he=(t,n,e)=>{const r=Bi.exec(t);return r?r[1]?n(r[1]):e(r[2]):!1},pe=(t,n,e=!1)=>{const r=Mi.exec(t);return r?r[1]?n(r[1]):e:!1},Oi=t=>t==="position"||t==="percentage",Fi=t=>t==="image"||t==="url",Ui=t=>t==="length"||t==="size"||t==="bg-size",Wi=t=>t==="length",js=t=>t==="number",Ls=t=>t==="family-name",qi=t=>t==="shadow",Bs=()=>{const t=kt("color"),n=kt("font"),e=kt("text"),r=kt("font-weight"),o=kt("tracking"),i=kt("leading"),a=kt("breakpoint"),s=kt("container"),l=kt("spacing"),d=kt("radius"),h=kt("shadow"),m=kt("inset-shadow"),b=kt("text-shadow"),u=kt("drop-shadow"),y=kt("blur"),f=kt("perspective"),v=kt("aspect"),g=kt("ease"),x=kt("animate"),k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],R=()=>[...w(),rt,nt],T=()=>["auto","hidden","clip","visible","scroll"],_=()=>["auto","contain","none"],E=()=>[rt,nt,l],S=()=>[ae,"full","auto",...E()],L=()=>[Qt,"none","subgrid",rt,nt],U=()=>["auto",{span:["full",Qt,rt,nt]},Qt,rt,nt],A=()=>[Qt,"auto",rt,nt],C=()=>["auto","min","max","fr",rt,nt],c=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],F=()=>["start","end","center","stretch","center-safe","end-safe"],Z=()=>["auto",...E()],q=()=>[ae,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...E()],Y=()=>[t,rt,nt],P=()=>[...w(),xr,wr,{position:[rt,nt]}],tt=()=>["no-repeat",{repeat:["","x","y","space","round"]}],M=()=>["auto","cover","contain",Ds,Ns,{size:[rt,nt]}],B=()=>[an,xe,ne],J=()=>["","none","full",d,rt,nt],$=()=>["",ut,xe,ne],X=()=>["solid","dashed","dotted","double"],dt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],lt=()=>[ut,an,xr,wr],it=()=>["","none",y,rt,nt],at=()=>["none",ut,rt,nt],ot=()=>["none",ut,rt,nt],pt=()=>[ut,rt,nt],gt=()=>[ae,"full",...E()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Yt],breakpoint:[Yt],color:[Cs],container:[Yt],"drop-shadow":[Yt],ease:["in","out","in-out"],font:[As],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Yt],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Yt],shadow:[Yt],spacing:["px",ut],text:[Yt],"text-shadow":[Yt],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ae,nt,rt,v]}],container:["container"],columns:[{columns:[ut,nt,rt,s]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:R()}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:_()}],"overscroll-x":[{"overscroll-x":_()}],"overscroll-y":[{"overscroll-y":_()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:S()}],"inset-x":[{"inset-x":S()}],"inset-y":[{"inset-y":S()}],start:[{start:S()}],end:[{end:S()}],top:[{top:S()}],right:[{right:S()}],bottom:[{bottom:S()}],left:[{left:S()}],visibility:["visible","invisible","collapse"],z:[{z:[Qt,"auto",rt,nt]}],basis:[{basis:[ae,"full","auto",s,...E()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ut,ae,"auto","initial","none",nt]}],grow:[{grow:["",ut,rt,nt]}],shrink:[{shrink:["",ut,rt,nt]}],order:[{order:[Qt,"first","last","none",rt,nt]}],"grid-cols":[{"grid-cols":L()}],"col-start-end":[{col:U()}],"col-start":[{"col-start":A()}],"col-end":[{"col-end":A()}],"grid-rows":[{"grid-rows":L()}],"row-start-end":[{row:U()}],"row-start":[{"row-start":A()}],"row-end":[{"row-end":A()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":C()}],"auto-rows":[{"auto-rows":C()}],gap:[{gap:E()}],"gap-x":[{"gap-x":E()}],"gap-y":[{"gap-y":E()}],"justify-content":[{justify:[...c(),"normal"]}],"justify-items":[{"justify-items":[...F(),"normal"]}],"justify-self":[{"justify-self":["auto",...F()]}],"align-content":[{content:["normal",...c()]}],"align-items":[{items:[...F(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...F(),{baseline:["","last"]}]}],"place-content":[{"place-content":c()}],"place-items":[{"place-items":[...F(),"baseline"]}],"place-self":[{"place-self":["auto",...F()]}],p:[{p:E()}],px:[{px:E()}],py:[{py:E()}],ps:[{ps:E()}],pe:[{pe:E()}],pt:[{pt:E()}],pr:[{pr:E()}],pb:[{pb:E()}],pl:[{pl:E()}],m:[{m:Z()}],mx:[{mx:Z()}],my:[{my:Z()}],ms:[{ms:Z()}],me:[{me:Z()}],mt:[{mt:Z()}],mr:[{mr:Z()}],mb:[{mb:Z()}],ml:[{ml:Z()}],"space-x":[{"space-x":E()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":E()}],"space-y-reverse":["space-y-reverse"],size:[{size:q()}],w:[{w:[s,"screen",...q()]}],"min-w":[{"min-w":[s,"screen","none",...q()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[a]},...q()]}],h:[{h:["screen","lh",...q()]}],"min-h":[{"min-h":["screen","lh","none",...q()]}],"max-h":[{"max-h":["screen","lh",...q()]}],"font-size":[{text:["base",e,xe,ne]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,rt,ln]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",an,nt]}],"font-family":[{font:[Ts,nt,n]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,rt,nt]}],"line-clamp":[{"line-clamp":[ut,"none",rt,ln]}],leading:[{leading:[i,...E()]}],"list-image":[{"list-image":["none",rt,nt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",rt,nt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Y()}],"text-color":[{text:Y()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:[ut,"from-font","auto",rt,ne]}],"text-decoration-color":[{decoration:Y()}],"underline-offset":[{"underline-offset":[ut,"auto",rt,nt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:E()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",rt,nt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",rt,nt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:P()}],"bg-repeat":[{bg:tt()}],"bg-size":[{bg:M()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Qt,rt,nt],radial:["",rt,nt],conic:[Qt,rt,nt]},zs,Is]}],"bg-color":[{bg:Y()}],"gradient-from-pos":[{from:B()}],"gradient-via-pos":[{via:B()}],"gradient-to-pos":[{to:B()}],"gradient-from":[{from:Y()}],"gradient-via":[{via:Y()}],"gradient-to":[{to:Y()}],rounded:[{rounded:J()}],"rounded-s":[{"rounded-s":J()}],"rounded-e":[{"rounded-e":J()}],"rounded-t":[{"rounded-t":J()}],"rounded-r":[{"rounded-r":J()}],"rounded-b":[{"rounded-b":J()}],"rounded-l":[{"rounded-l":J()}],"rounded-ss":[{"rounded-ss":J()}],"rounded-se":[{"rounded-se":J()}],"rounded-ee":[{"rounded-ee":J()}],"rounded-es":[{"rounded-es":J()}],"rounded-tl":[{"rounded-tl":J()}],"rounded-tr":[{"rounded-tr":J()}],"rounded-br":[{"rounded-br":J()}],"rounded-bl":[{"rounded-bl":J()}],"border-w":[{border:$()}],"border-w-x":[{"border-x":$()}],"border-w-y":[{"border-y":$()}],"border-w-s":[{"border-s":$()}],"border-w-e":[{"border-e":$()}],"border-w-t":[{"border-t":$()}],"border-w-r":[{"border-r":$()}],"border-w-b":[{"border-b":$()}],"border-w-l":[{"border-l":$()}],"divide-x":[{"divide-x":$()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":$()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...X(),"hidden","none"]}],"divide-style":[{divide:[...X(),"hidden","none"]}],"border-color":[{border:Y()}],"border-color-x":[{"border-x":Y()}],"border-color-y":[{"border-y":Y()}],"border-color-s":[{"border-s":Y()}],"border-color-e":[{"border-e":Y()}],"border-color-t":[{"border-t":Y()}],"border-color-r":[{"border-r":Y()}],"border-color-b":[{"border-b":Y()}],"border-color-l":[{"border-l":Y()}],"divide-color":[{divide:Y()}],"outline-style":[{outline:[...X(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ut,rt,nt]}],"outline-w":[{outline:["",ut,xe,ne]}],"outline-color":[{outline:Y()}],shadow:[{shadow:["","none",h,Pe,Me]}],"shadow-color":[{shadow:Y()}],"inset-shadow":[{"inset-shadow":["none",m,Pe,Me]}],"inset-shadow-color":[{"inset-shadow":Y()}],"ring-w":[{ring:$()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Y()}],"ring-offset-w":[{"ring-offset":[ut,ne]}],"ring-offset-color":[{"ring-offset":Y()}],"inset-ring-w":[{"inset-ring":$()}],"inset-ring-color":[{"inset-ring":Y()}],"text-shadow":[{"text-shadow":["none",b,Pe,Me]}],"text-shadow-color":[{"text-shadow":Y()}],opacity:[{opacity:[ut,rt,nt]}],"mix-blend":[{"mix-blend":[...dt(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":dt()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ut]}],"mask-image-linear-from-pos":[{"mask-linear-from":lt()}],"mask-image-linear-to-pos":[{"mask-linear-to":lt()}],"mask-image-linear-from-color":[{"mask-linear-from":Y()}],"mask-image-linear-to-color":[{"mask-linear-to":Y()}],"mask-image-t-from-pos":[{"mask-t-from":lt()}],"mask-image-t-to-pos":[{"mask-t-to":lt()}],"mask-image-t-from-color":[{"mask-t-from":Y()}],"mask-image-t-to-color":[{"mask-t-to":Y()}],"mask-image-r-from-pos":[{"mask-r-from":lt()}],"mask-image-r-to-pos":[{"mask-r-to":lt()}],"mask-image-r-from-color":[{"mask-r-from":Y()}],"mask-image-r-to-color":[{"mask-r-to":Y()}],"mask-image-b-from-pos":[{"mask-b-from":lt()}],"mask-image-b-to-pos":[{"mask-b-to":lt()}],"mask-image-b-from-color":[{"mask-b-from":Y()}],"mask-image-b-to-color":[{"mask-b-to":Y()}],"mask-image-l-from-pos":[{"mask-l-from":lt()}],"mask-image-l-to-pos":[{"mask-l-to":lt()}],"mask-image-l-from-color":[{"mask-l-from":Y()}],"mask-image-l-to-color":[{"mask-l-to":Y()}],"mask-image-x-from-pos":[{"mask-x-from":lt()}],"mask-image-x-to-pos":[{"mask-x-to":lt()}],"mask-image-x-from-color":[{"mask-x-from":Y()}],"mask-image-x-to-color":[{"mask-x-to":Y()}],"mask-image-y-from-pos":[{"mask-y-from":lt()}],"mask-image-y-to-pos":[{"mask-y-to":lt()}],"mask-image-y-from-color":[{"mask-y-from":Y()}],"mask-image-y-to-color":[{"mask-y-to":Y()}],"mask-image-radial":[{"mask-radial":[rt,nt]}],"mask-image-radial-from-pos":[{"mask-radial-from":lt()}],"mask-image-radial-to-pos":[{"mask-radial-to":lt()}],"mask-image-radial-from-color":[{"mask-radial-from":Y()}],"mask-image-radial-to-color":[{"mask-radial-to":Y()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[ut]}],"mask-image-conic-from-pos":[{"mask-conic-from":lt()}],"mask-image-conic-to-pos":[{"mask-conic-to":lt()}],"mask-image-conic-from-color":[{"mask-conic-from":Y()}],"mask-image-conic-to-color":[{"mask-conic-to":Y()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:P()}],"mask-repeat":[{mask:tt()}],"mask-size":[{mask:M()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",rt,nt]}],filter:[{filter:["","none",rt,nt]}],blur:[{blur:it()}],brightness:[{brightness:[ut,rt,nt]}],contrast:[{contrast:[ut,rt,nt]}],"drop-shadow":[{"drop-shadow":["","none",u,Pe,Me]}],"drop-shadow-color":[{"drop-shadow":Y()}],grayscale:[{grayscale:["",ut,rt,nt]}],"hue-rotate":[{"hue-rotate":[ut,rt,nt]}],invert:[{invert:["",ut,rt,nt]}],saturate:[{saturate:[ut,rt,nt]}],sepia:[{sepia:["",ut,rt,nt]}],"backdrop-filter":[{"backdrop-filter":["","none",rt,nt]}],"backdrop-blur":[{"backdrop-blur":it()}],"backdrop-brightness":[{"backdrop-brightness":[ut,rt,nt]}],"backdrop-contrast":[{"backdrop-contrast":[ut,rt,nt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ut,rt,nt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ut,rt,nt]}],"backdrop-invert":[{"backdrop-invert":["",ut,rt,nt]}],"backdrop-opacity":[{"backdrop-opacity":[ut,rt,nt]}],"backdrop-saturate":[{"backdrop-saturate":[ut,rt,nt]}],"backdrop-sepia":[{"backdrop-sepia":["",ut,rt,nt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":E()}],"border-spacing-x":[{"border-spacing-x":E()}],"border-spacing-y":[{"border-spacing-y":E()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",rt,nt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ut,"initial",rt,nt]}],ease:[{ease:["linear","initial",g,rt,nt]}],delay:[{delay:[ut,rt,nt]}],animate:[{animate:["none",x,rt,nt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[f,rt,nt]}],"perspective-origin":[{"perspective-origin":R()}],rotate:[{rotate:at()}],"rotate-x":[{"rotate-x":at()}],"rotate-y":[{"rotate-y":at()}],"rotate-z":[{"rotate-z":at()}],scale:[{scale:ot()}],"scale-x":[{"scale-x":ot()}],"scale-y":[{"scale-y":ot()}],"scale-z":[{"scale-z":ot()}],"scale-3d":["scale-3d"],skew:[{skew:pt()}],"skew-x":[{"skew-x":pt()}],"skew-y":[{"skew-y":pt()}],transform:[{transform:[rt,nt,"","none","gpu","cpu"]}],"transform-origin":[{origin:R()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:gt()}],"translate-x":[{"translate-x":gt()}],"translate-y":[{"translate-y":gt()}],"translate-z":[{"translate-z":gt()}],"translate-none":["translate-none"],accent:[{accent:Y()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Y()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",rt,nt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":E()}],"scroll-mx":[{"scroll-mx":E()}],"scroll-my":[{"scroll-my":E()}],"scroll-ms":[{"scroll-ms":E()}],"scroll-me":[{"scroll-me":E()}],"scroll-mt":[{"scroll-mt":E()}],"scroll-mr":[{"scroll-mr":E()}],"scroll-mb":[{"scroll-mb":E()}],"scroll-ml":[{"scroll-ml":E()}],"scroll-p":[{"scroll-p":E()}],"scroll-px":[{"scroll-px":E()}],"scroll-py":[{"scroll-py":E()}],"scroll-ps":[{"scroll-ps":E()}],"scroll-pe":[{"scroll-pe":E()}],"scroll-pt":[{"scroll-pt":E()}],"scroll-pr":[{"scroll-pr":E()}],"scroll-pb":[{"scroll-pb":E()}],"scroll-pl":[{"scroll-pl":E()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",rt,nt]}],fill:[{fill:["none",...Y()]}],"stroke-w":[{stroke:[ut,xe,ne,ln]}],stroke:[{stroke:["none",...Y()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Ms=bs(Bs);function bt(...t){return Ms(Di(t))}const Ps=zi("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),xt=z.forwardRef(({className:t,variant:n,size:e,asChild:r=!1,...o},i)=>{const a=r?Fo:"button";return I.jsx(a,{className:bt(Ps({variant:n,size:e,className:t})),ref:i,...o})});xt.displayName="Button";const Os=/^(image\/(jpeg|png|webp|gif|avif|bmp|tiff))$/i;function Fs(t){return Os.test(t.type)}function Us(t,n=36){const e=[];for(const r of t)if(Fs(r)){if(e.length>=n)break;e.push({id:crypto.randomUUID(),url:URL.createObjectURL(r),name:r.name,size:r.size,type:r.type})}return e}function _r(t){for(const n of t)try{URL.revokeObjectURL(n.url)}catch{}}let Wt=null;function Oe(){if(!Wt)throw new Error("ConfigController: not initialized. Call Config.init().")}function kr(t){if(t.MAX_CARDS!=null&&(!Number.isInteger(t.MAX_CARDS)||t.MAX_CARDS<=0))throw new Error("MAX_CARDS must be a positive integer.");if(t.CARD_EXPORT_SIZE!=null&&(!Number.isInteger(t.CARD_EXPORT_SIZE)||t.CARD_EXPORT_SIZE<=0))throw new Error("CARD_EXPORT_SIZE must be a positive integer.");if(t.PREVIEW_EXACT_SIZE!=null&&(!Number.isInteger(t.PREVIEW_EXACT_SIZE)||t.PREVIEW_EXACT_SIZE<=0))throw new Error("PREVIEW_EXACT_SIZE must be a positive integer.");if(t.PREVIEW_FAST_SIZE!=null&&(!Number.isInteger(t.PREVIEW_FAST_SIZE)||t.PREVIEW_FAST_SIZE<=0))throw new Error("PREVIEW_FAST_SIZE must be a positive integer.");if(t.PDF_JPEG_QUALITY!=null&&(t.PDF_JPEG_QUALITY<0||t.PDF_JPEG_QUALITY>1))throw new Error("PDF_JPEG_QUALITY must be within [0..1].");if(t.IMAGE_FIT_MODE!=null&&t.IMAGE_FIT_MODE!=="cover"&&t.IMAGE_FIT_MODE!=="contain")throw new Error("IMAGE_FIT_MODE must be 'cover' or 'contain'.");if(t.INITIAL_ALIGN_X!=null&&!["center","left","right"].includes(t.INITIAL_ALIGN_X))throw new Error("INITIAL_ALIGN_X must be 'center' | 'left' | 'right'.");if(t.INITIAL_ALIGN_Y!=null&&!["center","top","bottom"].includes(t.INITIAL_ALIGN_Y))throw new Error("INITIAL_ALIGN_Y must be 'center' | 'top' | 'bottom'.");if(t.FONT_CATALOG!=null&&!Array.isArray(t.FONT_CATALOG))throw new Error("FONT_CATALOG must be an array.");if(t.DEFAULT_CARD_LAYERS!=null&&!Array.isArray(t.DEFAULT_CARD_LAYERS))throw new Error("DEFAULT_CARD_LAYERS must be an array.");if(t.DEFAULTS!=null&&(typeof t.DEFAULTS!="object"||Array.isArray(t.DEFAULTS)))throw new Error("DEFAULTS must be an object.");if(t.NEAR_SQUARE_TOLERANCE!=null&&(t.NEAR_SQUARE_TOLERANCE<0||t.NEAR_SQUARE_TOLERANCE>.5))throw new Error("NEAR_SQUARE_TOLERANCE must be within [0..0.5].");if(t.NEAR_SQUARE_SCALE!=null&&(t.NEAR_SQUARE_SCALE<=0||t.NEAR_SQUARE_SCALE>1))throw new Error("NEAR_SQUARE_SCALE must be within (0..1].");if(t.LAYER_PROFILES!=null){if(typeof t.LAYER_PROFILES!="object"||Array.isArray(t.LAYER_PROFILES))throw new Error("LAYER_PROFILES must be an object.");for(const[n,e]of Object.entries(t.LAYER_PROFILES)){if(e==null||typeof e!="object"||Array.isArray(e))throw new Error(`LAYER_PROFILES['${n}'] must be an object.`);if(e.on!=null&&typeof e.on!="boolean")throw new Error(`LAYER_PROFILES['${n}'].on must be boolean if provided.`);if(e.landscape!=null&&!Array.isArray(e.landscape))throw new Error(`LAYER_PROFILES['${n}'].landscape must be an array if provided.`);if(e.portrait!=null&&!Array.isArray(e.portrait))throw new Error(`LAYER_PROFILES['${n}'].portrait must be an array if provided.`);if(e.square!=null&&!Array.isArray(e.square))throw new Error(`LAYER_PROFILES['${n}'].square must be an array if provided.`)}}}const vt={init(t){Wt=Object.freeze({...t})},get(){return Oe(),Wt},update(t){return Oe(),kr(t),Wt=Object.freeze({...Wt,...t}),Wt},loadFromJson(t){Oe();const n=t;return kr(n),Wt=Object.freeze({...Wt,...n}),Wt},toJson(){return Oe(),{...Wt}},async loadFromUrl(t){const n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error(`Config.loadFromUrl failed: ${n.status}`);const e=await n.json(),{schemaVersion:r,...o}=e??{};return this.loadFromJson(o)}};vt.init({});const Ws="/ss/configs/default.json";await vt.loadFromUrl(Ws);const Gi=vt.get().MAX_CARDS,It=vt.get().CARD_EXPORT_SIZE,Ge=vt.get().PREVIEW_EXACT_SIZE,qs=vt.get().PREVIEW_FAST_SIZE,Gs=vt.get().PDF_JPEG_QUALITY,Wn=vt.get().IMAGE_FIT_MODE,Ys=vt.get().INITIAL_ALIGN_X,Vs=vt.get().INITIAL_ALIGN_Y,Yi=vt.get().FONT_CATALOG;vt.get().NEAR_SQUARE_TOLERANCE;vt.get().NEAR_SQUARE_SCALE;vt.get().DEFAULTS;vt.get().DEFAULT_CARD_LAYERS;var le={},cn,Cr;function Hs(){return Cr||(Cr=1,cn=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),cn}var dn={},Jt={},Er;function re(){if(Er)return Jt;Er=1;let t;const n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Jt.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17},Jt.getSymbolTotalCodewords=function(r){return n[r]},Jt.getBCHDigit=function(e){let r=0;for(;e!==0;)r++,e>>>=1;return r},Jt.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');t=r},Jt.isKanjiModeEnabled=function(){return typeof t<"u"},Jt.toSJIS=function(r){return t(r)},Jt}var un={},Sr;function Xn(){return Sr||(Sr=1,function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function n(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}t.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},t.from=function(r,o){if(t.isValid(r))return r;try{return n(r)}catch{return o}}}(un)),un}var fn,Rr;function Zs(){if(Rr)return fn;Rr=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(n){const e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let r=0;r<e;r++)this.putBit((n>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}},fn=t,fn}var hn,Ar;function $s(){if(Ar)return hn;Ar=1;function t(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}return t.prototype.set=function(n,e,r,o){const i=n*this.size+e;this.data[i]=r,o&&(this.reservedBit[i]=!0)},t.prototype.get=function(n,e){return this.data[n*this.size+e]},t.prototype.xor=function(n,e,r){this.data[n*this.size+e]^=r},t.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]},hn=t,hn}var pn={},Nr;function Xs(){return Nr||(Nr=1,function(t){const n=re().getSymbolSize;t.getRowColCoords=function(r){if(r===1)return[];const o=Math.floor(r/7)+2,i=n(r),a=i===145?26:Math.ceil((i-13)/(2*o-2))*2,s=[i-7];for(let l=1;l<o-1;l++)s[l]=s[l-1]-a;return s.push(6),s.reverse()},t.getPositions=function(r){const o=[],i=t.getRowColCoords(r),a=i.length;for(let s=0;s<a;s++)for(let l=0;l<a;l++)s===0&&l===0||s===0&&l===a-1||s===a-1&&l===0||o.push([i[s],i[l]]);return o}}(pn)),pn}var mn={},Ir;function Ks(){if(Ir)return mn;Ir=1;const t=re().getSymbolSize,n=7;return mn.getPositions=function(r){const o=t(r);return[[0,0],[o-n,0],[0,o-n]]},mn}var gn={},Tr;function Qs(){return Tr||(Tr=1,function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n={N1:3,N2:3,N3:40,N4:10};t.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},t.from=function(o){return t.isValid(o)?parseInt(o,10):void 0},t.getPenaltyN1=function(o){const i=o.size;let a=0,s=0,l=0,d=null,h=null;for(let m=0;m<i;m++){s=l=0,d=h=null;for(let b=0;b<i;b++){let u=o.get(m,b);u===d?s++:(s>=5&&(a+=n.N1+(s-5)),d=u,s=1),u=o.get(b,m),u===h?l++:(l>=5&&(a+=n.N1+(l-5)),h=u,l=1)}s>=5&&(a+=n.N1+(s-5)),l>=5&&(a+=n.N1+(l-5))}return a},t.getPenaltyN2=function(o){const i=o.size;let a=0;for(let s=0;s<i-1;s++)for(let l=0;l<i-1;l++){const d=o.get(s,l)+o.get(s,l+1)+o.get(s+1,l)+o.get(s+1,l+1);(d===4||d===0)&&a++}return a*n.N2},t.getPenaltyN3=function(o){const i=o.size;let a=0,s=0,l=0;for(let d=0;d<i;d++){s=l=0;for(let h=0;h<i;h++)s=s<<1&2047|o.get(d,h),h>=10&&(s===1488||s===93)&&a++,l=l<<1&2047|o.get(h,d),h>=10&&(l===1488||l===93)&&a++}return a*n.N3},t.getPenaltyN4=function(o){let i=0;const a=o.data.length;for(let l=0;l<a;l++)i+=o.data[l];return Math.abs(Math.ceil(i*100/a/5)-10)*n.N4};function e(r,o,i){switch(r){case t.Patterns.PATTERN000:return(o+i)%2===0;case t.Patterns.PATTERN001:return o%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(o+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return o*i%2+o*i%3===0;case t.Patterns.PATTERN110:return(o*i%2+o*i%3)%2===0;case t.Patterns.PATTERN111:return(o*i%3+(o+i)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}t.applyMask=function(o,i){const a=i.size;for(let s=0;s<a;s++)for(let l=0;l<a;l++)i.isReserved(l,s)||i.xor(l,s,e(o,l,s))},t.getBestMask=function(o,i){const a=Object.keys(t.Patterns).length;let s=0,l=1/0;for(let d=0;d<a;d++){i(d),t.applyMask(d,o);const h=t.getPenaltyN1(o)+t.getPenaltyN2(o)+t.getPenaltyN3(o)+t.getPenaltyN4(o);t.applyMask(d,o),h<l&&(l=h,s=d)}return s}}(gn)),gn}var Fe={},Dr;function Vi(){if(Dr)return Fe;Dr=1;const t=Xn(),n=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],e=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Fe.getBlocksCount=function(o,i){switch(i){case t.L:return n[(o-1)*4+0];case t.M:return n[(o-1)*4+1];case t.Q:return n[(o-1)*4+2];case t.H:return n[(o-1)*4+3];default:return}},Fe.getTotalCodewordsCount=function(o,i){switch(i){case t.L:return e[(o-1)*4+0];case t.M:return e[(o-1)*4+1];case t.Q:return e[(o-1)*4+2];case t.H:return e[(o-1)*4+3];default:return}},Fe}var bn={},_e={},zr;function Js(){if(zr)return _e;zr=1;const t=new Uint8Array(512),n=new Uint8Array(256);return function(){let r=1;for(let o=0;o<255;o++)t[o]=r,n[r]=o,r<<=1,r&256&&(r^=285);for(let o=255;o<512;o++)t[o]=t[o-255]}(),_e.log=function(r){if(r<1)throw new Error("log("+r+")");return n[r]},_e.exp=function(r){return t[r]},_e.mul=function(r,o){return r===0||o===0?0:t[n[r]+n[o]]},_e}var jr;function ta(){return jr||(jr=1,function(t){const n=Js();t.mul=function(r,o){const i=new Uint8Array(r.length+o.length-1);for(let a=0;a<r.length;a++)for(let s=0;s<o.length;s++)i[a+s]^=n.mul(r[a],o[s]);return i},t.mod=function(r,o){let i=new Uint8Array(r);for(;i.length-o.length>=0;){const a=i[0];for(let l=0;l<o.length;l++)i[l]^=n.mul(o[l],a);let s=0;for(;s<i.length&&i[s]===0;)s++;i=i.slice(s)}return i},t.generateECPolynomial=function(r){let o=new Uint8Array([1]);for(let i=0;i<r;i++)o=t.mul(o,new Uint8Array([1,n.exp(i)]));return o}}(bn)),bn}var yn,Lr;function ea(){if(Lr)return yn;Lr=1;const t=ta();function n(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}return n.prototype.initialize=function(r){this.degree=r,this.genPoly=t.generateECPolynomial(this.degree)},n.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(r.length+this.degree);o.set(r);const i=t.mod(o,this.genPoly),a=this.degree-i.length;if(a>0){const s=new Uint8Array(this.degree);return s.set(i,a),s}return i},yn=n,yn}var vn={},wn={},xn={},Br;function Hi(){return Br||(Br=1,xn.isValid=function(n){return!isNaN(n)&&n>=1&&n<=40}),xn}var Ut={},Mr;function Zi(){if(Mr)return Ut;Mr=1;const t="[0-9]+",n="[A-Z $%*+\\-./:]+";let e="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";e=e.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+e+`)(?:.|[\r
]))+`;Ut.KANJI=new RegExp(e,"g"),Ut.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Ut.BYTE=new RegExp(r,"g"),Ut.NUMERIC=new RegExp(t,"g"),Ut.ALPHANUMERIC=new RegExp(n,"g");const o=new RegExp("^"+e+"$"),i=new RegExp("^"+t+"$"),a=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Ut.testKanji=function(l){return o.test(l)},Ut.testNumeric=function(l){return i.test(l)},Ut.testAlphanumeric=function(l){return a.test(l)},Ut}var Pr;function ie(){return Pr||(Pr=1,function(t){const n=Hi(),e=Zi();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,a){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!n.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?i.ccBits[0]:a<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return e.testNumeric(i)?t.NUMERIC:e.testAlphanumeric(i)?t.ALPHANUMERIC:e.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function r(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+o)}}t.from=function(i,a){if(t.isValid(i))return i;try{return r(i)}catch{return a}}}(wn)),wn}var Or;function na(){return Or||(Or=1,function(t){const n=re(),e=Vi(),r=Xn(),o=ie(),i=Hi(),a=7973,s=n.getBCHDigit(a);function l(b,u,y){for(let f=1;f<=40;f++)if(u<=t.getCapacity(f,y,b))return f}function d(b,u){return o.getCharCountIndicator(b,u)+4}function h(b,u){let y=0;return b.forEach(function(f){const v=d(f.mode,u);y+=v+f.getBitsLength()}),y}function m(b,u){for(let y=1;y<=40;y++)if(h(b,y)<=t.getCapacity(y,u,o.MIXED))return y}t.from=function(u,y){return i.isValid(u)?parseInt(u,10):y},t.getCapacity=function(u,y,f){if(!i.isValid(u))throw new Error("Invalid QR Code version");typeof f>"u"&&(f=o.BYTE);const v=n.getSymbolTotalCodewords(u),g=e.getTotalCodewordsCount(u,y),x=(v-g)*8;if(f===o.MIXED)return x;const k=x-d(f,u);switch(f){case o.NUMERIC:return Math.floor(k/10*3);case o.ALPHANUMERIC:return Math.floor(k/11*2);case o.KANJI:return Math.floor(k/13);case o.BYTE:default:return Math.floor(k/8)}},t.getBestVersionForData=function(u,y){let f;const v=r.from(y,r.M);if(Array.isArray(u)){if(u.length>1)return m(u,v);if(u.length===0)return 1;f=u[0]}else f=u;return l(f.mode,f.getLength(),v)},t.getEncodedBits=function(u){if(!i.isValid(u)||u<7)throw new Error("Invalid QR Code version");let y=u<<12;for(;n.getBCHDigit(y)-s>=0;)y^=a<<n.getBCHDigit(y)-s;return u<<12|y}}(vn)),vn}var _n={},Fr;function ra(){if(Fr)return _n;Fr=1;const t=re(),n=1335,e=21522,r=t.getBCHDigit(n);return _n.getEncodedBits=function(i,a){const s=i.bit<<3|a;let l=s<<10;for(;t.getBCHDigit(l)-r>=0;)l^=n<<t.getBCHDigit(l)-r;return(s<<10|l)^e},_n}var kn={},Cn,Ur;function ia(){if(Ur)return Cn;Ur=1;const t=ie();function n(e){this.mode=t.NUMERIC,this.data=e.toString()}return n.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let o,i,a;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),a=parseInt(i,10),r.put(a,10);const s=this.data.length-o;s>0&&(i=this.data.substr(o),a=parseInt(i,10),r.put(a,s*3+1))},Cn=n,Cn}var En,Wr;function oa(){if(Wr)return En;Wr=1;const t=ie(),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function e(r){this.mode=t.ALPHANUMERIC,this.data=r}return e.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(o){let i;for(i=0;i+2<=this.data.length;i+=2){let a=n.indexOf(this.data[i])*45;a+=n.indexOf(this.data[i+1]),o.put(a,11)}this.data.length%2&&o.put(n.indexOf(this.data[i]),6)},En=e,En}var Sn,qr;function sa(){if(qr)return Sn;qr=1;const t=ie();function n(e){this.mode=t.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}return n.getBitsLength=function(r){return r*8},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(e){for(let r=0,o=this.data.length;r<o;r++)e.put(this.data[r],8)},Sn=n,Sn}var Rn,Gr;function aa(){if(Gr)return Rn;Gr=1;const t=ie(),n=re();function e(r){this.mode=t.KANJI,this.data=r}return e.getBitsLength=function(o){return o*13},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(r){let o;for(o=0;o<this.data.length;o++){let i=n.toSJIS(this.data[o]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),r.put(i,13)}},Rn=e,Rn}var An={exports:{}},Yr;function la(){return Yr||(Yr=1,function(t){var n={single_source_shortest_paths:function(e,r,o){var i={},a={};a[r]=0;var s=n.PriorityQueue.make();s.push(r,0);for(var l,d,h,m,b,u,y,f,v;!s.empty();){l=s.pop(),d=l.value,m=l.cost,b=e[d]||{};for(h in b)b.hasOwnProperty(h)&&(u=b[h],y=m+u,f=a[h],v=typeof a[h]>"u",(v||f>y)&&(a[h]=y,s.push(h,y),i[h]=d))}if(typeof o<"u"&&typeof a[o]>"u"){var g=["Could not find a path from ",r," to ",o,"."].join("");throw new Error(g)}return i},extract_shortest_path_from_predecessor_list:function(e,r){for(var o=[],i=r;i;)o.push(i),e[i],i=e[i];return o.reverse(),o},find_path:function(e,r,o){var i=n.single_source_shortest_paths(e,r,o);return n.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(e){var r=n.PriorityQueue,o={},i;e=e||{};for(i in r)r.hasOwnProperty(i)&&(o[i]=r[i]);return o.queue=[],o.sorter=e.sorter||r.default_sorter,o},default_sorter:function(e,r){return e.cost-r.cost},push:function(e,r){var o={value:e,cost:r};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=n}(An)),An.exports}var Vr;function ca(){return Vr||(Vr=1,function(t){const n=ie(),e=ia(),r=oa(),o=sa(),i=aa(),a=Zi(),s=re(),l=la();function d(g){return unescape(encodeURIComponent(g)).length}function h(g,x,k){const w=[];let R;for(;(R=g.exec(k))!==null;)w.push({data:R[0],index:R.index,mode:x,length:R[0].length});return w}function m(g){const x=h(a.NUMERIC,n.NUMERIC,g),k=h(a.ALPHANUMERIC,n.ALPHANUMERIC,g);let w,R;return s.isKanjiModeEnabled()?(w=h(a.BYTE,n.BYTE,g),R=h(a.KANJI,n.KANJI,g)):(w=h(a.BYTE_KANJI,n.BYTE,g),R=[]),x.concat(k,w,R).sort(function(_,E){return _.index-E.index}).map(function(_){return{data:_.data,mode:_.mode,length:_.length}})}function b(g,x){switch(x){case n.NUMERIC:return e.getBitsLength(g);case n.ALPHANUMERIC:return r.getBitsLength(g);case n.KANJI:return i.getBitsLength(g);case n.BYTE:return o.getBitsLength(g)}}function u(g){return g.reduce(function(x,k){const w=x.length-1>=0?x[x.length-1]:null;return w&&w.mode===k.mode?(x[x.length-1].data+=k.data,x):(x.push(k),x)},[])}function y(g){const x=[];for(let k=0;k<g.length;k++){const w=g[k];switch(w.mode){case n.NUMERIC:x.push([w,{data:w.data,mode:n.ALPHANUMERIC,length:w.length},{data:w.data,mode:n.BYTE,length:w.length}]);break;case n.ALPHANUMERIC:x.push([w,{data:w.data,mode:n.BYTE,length:w.length}]);break;case n.KANJI:x.push([w,{data:w.data,mode:n.BYTE,length:d(w.data)}]);break;case n.BYTE:x.push([{data:w.data,mode:n.BYTE,length:d(w.data)}])}}return x}function f(g,x){const k={},w={start:{}};let R=["start"];for(let T=0;T<g.length;T++){const _=g[T],E=[];for(let S=0;S<_.length;S++){const L=_[S],U=""+T+S;E.push(U),k[U]={node:L,lastCount:0},w[U]={};for(let A=0;A<R.length;A++){const C=R[A];k[C]&&k[C].node.mode===L.mode?(w[C][U]=b(k[C].lastCount+L.length,L.mode)-b(k[C].lastCount,L.mode),k[C].lastCount+=L.length):(k[C]&&(k[C].lastCount=L.length),w[C][U]=b(L.length,L.mode)+4+n.getCharCountIndicator(L.mode,x))}}R=E}for(let T=0;T<R.length;T++)w[R[T]].end=0;return{map:w,table:k}}function v(g,x){let k;const w=n.getBestModeForData(g);if(k=n.from(x,w),k!==n.BYTE&&k.bit<w.bit)throw new Error('"'+g+'" cannot be encoded with mode '+n.toString(k)+`.
 Suggested mode is: `+n.toString(w));switch(k===n.KANJI&&!s.isKanjiModeEnabled()&&(k=n.BYTE),k){case n.NUMERIC:return new e(g);case n.ALPHANUMERIC:return new r(g);case n.KANJI:return new i(g);case n.BYTE:return new o(g)}}t.fromArray=function(x){return x.reduce(function(k,w){return typeof w=="string"?k.push(v(w,null)):w.data&&k.push(v(w.data,w.mode)),k},[])},t.fromString=function(x,k){const w=m(x,s.isKanjiModeEnabled()),R=y(w),T=f(R,k),_=l.find_path(T.map,"start","end"),E=[];for(let S=1;S<_.length-1;S++)E.push(T.table[_[S]].node);return t.fromArray(u(E))},t.rawSplit=function(x){return t.fromArray(m(x,s.isKanjiModeEnabled()))}}(kn)),kn}var Hr;function da(){if(Hr)return dn;Hr=1;const t=re(),n=Xn(),e=Zs(),r=$s(),o=Xs(),i=Ks(),a=Qs(),s=Vi(),l=ea(),d=na(),h=ra(),m=ie(),b=ca();function u(T,_){const E=T.size,S=i.getPositions(_);for(let L=0;L<S.length;L++){const U=S[L][0],A=S[L][1];for(let C=-1;C<=7;C++)if(!(U+C<=-1||E<=U+C))for(let c=-1;c<=7;c++)A+c<=-1||E<=A+c||(C>=0&&C<=6&&(c===0||c===6)||c>=0&&c<=6&&(C===0||C===6)||C>=2&&C<=4&&c>=2&&c<=4?T.set(U+C,A+c,!0,!0):T.set(U+C,A+c,!1,!0))}}function y(T){const _=T.size;for(let E=8;E<_-8;E++){const S=E%2===0;T.set(E,6,S,!0),T.set(6,E,S,!0)}}function f(T,_){const E=o.getPositions(_);for(let S=0;S<E.length;S++){const L=E[S][0],U=E[S][1];for(let A=-2;A<=2;A++)for(let C=-2;C<=2;C++)A===-2||A===2||C===-2||C===2||A===0&&C===0?T.set(L+A,U+C,!0,!0):T.set(L+A,U+C,!1,!0)}}function v(T,_){const E=T.size,S=d.getEncodedBits(_);let L,U,A;for(let C=0;C<18;C++)L=Math.floor(C/3),U=C%3+E-8-3,A=(S>>C&1)===1,T.set(L,U,A,!0),T.set(U,L,A,!0)}function g(T,_,E){const S=T.size,L=h.getEncodedBits(_,E);let U,A;for(U=0;U<15;U++)A=(L>>U&1)===1,U<6?T.set(U,8,A,!0):U<8?T.set(U+1,8,A,!0):T.set(S-15+U,8,A,!0),U<8?T.set(8,S-U-1,A,!0):U<9?T.set(8,15-U-1+1,A,!0):T.set(8,15-U-1,A,!0);T.set(S-8,8,1,!0)}function x(T,_){const E=T.size;let S=-1,L=E-1,U=7,A=0;for(let C=E-1;C>0;C-=2)for(C===6&&C--;;){for(let c=0;c<2;c++)if(!T.isReserved(L,C-c)){let F=!1;A<_.length&&(F=(_[A]>>>U&1)===1),T.set(L,C-c,F),U--,U===-1&&(A++,U=7)}if(L+=S,L<0||E<=L){L-=S,S=-S;break}}}function k(T,_,E){const S=new e;E.forEach(function(c){S.put(c.mode.bit,4),S.put(c.getLength(),m.getCharCountIndicator(c.mode,T)),c.write(S)});const L=t.getSymbolTotalCodewords(T),U=s.getTotalCodewordsCount(T,_),A=(L-U)*8;for(S.getLengthInBits()+4<=A&&S.put(0,4);S.getLengthInBits()%8!==0;)S.putBit(0);const C=(A-S.getLengthInBits())/8;for(let c=0;c<C;c++)S.put(c%2?17:236,8);return w(S,T,_)}function w(T,_,E){const S=t.getSymbolTotalCodewords(_),L=s.getTotalCodewordsCount(_,E),U=S-L,A=s.getBlocksCount(_,E),C=S%A,c=A-C,F=Math.floor(S/A),Z=Math.floor(U/A),q=Z+1,Y=F-Z,P=new l(Y);let tt=0;const M=new Array(A),B=new Array(A);let J=0;const $=new Uint8Array(T.buffer);for(let at=0;at<A;at++){const ot=at<c?Z:q;M[at]=$.slice(tt,tt+ot),B[at]=P.encode(M[at]),tt+=ot,J=Math.max(J,ot)}const X=new Uint8Array(S);let dt=0,lt,it;for(lt=0;lt<J;lt++)for(it=0;it<A;it++)lt<M[it].length&&(X[dt++]=M[it][lt]);for(lt=0;lt<Y;lt++)for(it=0;it<A;it++)X[dt++]=B[it][lt];return X}function R(T,_,E,S){let L;if(Array.isArray(T))L=b.fromArray(T);else if(typeof T=="string"){let F=_;if(!F){const Z=b.rawSplit(T);F=d.getBestVersionForData(Z,E)}L=b.fromString(T,F||40)}else throw new Error("Invalid data");const U=d.getBestVersionForData(L,E);if(!U)throw new Error("The amount of data is too big to be stored in a QR Code");if(!_)_=U;else if(_<U)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+U+`.
`);const A=k(_,E,L),C=t.getSymbolSize(_),c=new r(C);return u(c,_),y(c),f(c,_),g(c,E,0),_>=7&&v(c,_),x(c,A),isNaN(S)&&(S=a.getBestMask(c,g.bind(null,c,E))),a.applyMask(S,c),g(c,E,S),{modules:c,version:_,errorCorrectionLevel:E,maskPattern:S,segments:L}}return dn.create=function(_,E){if(typeof _>"u"||_==="")throw new Error("No input text");let S=n.M,L,U;return typeof E<"u"&&(S=n.from(E.errorCorrectionLevel,n.M),L=d.from(E.version),U=a.from(E.maskPattern),E.toSJISFunc&&t.setToSJISFunction(E.toSJISFunc)),R(_,L,S,U)},dn}var Nn={},In={},Zr;function $i(){return Zr||(Zr=1,function(t){function n(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let r=e.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+e);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(i){return[i,i]}))),r.length===6&&r.push("F","F");const o=parseInt(r.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+r.slice(0,6).join("")}}t.getOptions=function(r){r||(r={}),r.color||(r.color={});const o=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,i=r.width&&r.width>=21?r.width:void 0,a=r.scale||4;return{width:i,scale:i?4:a,margin:o,color:{dark:n(r.color.dark||"#000000ff"),light:n(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},t.getScale=function(r,o){return o.width&&o.width>=r+o.margin*2?o.width/(r+o.margin*2):o.scale},t.getImageWidth=function(r,o){const i=t.getScale(r,o);return Math.floor((r+o.margin*2)*i)},t.qrToImageData=function(r,o,i){const a=o.modules.size,s=o.modules.data,l=t.getScale(a,i),d=Math.floor((a+i.margin*2)*l),h=i.margin*l,m=[i.color.light,i.color.dark];for(let b=0;b<d;b++)for(let u=0;u<d;u++){let y=(b*d+u)*4,f=i.color.light;if(b>=h&&u>=h&&b<d-h&&u<d-h){const v=Math.floor((b-h)/l),g=Math.floor((u-h)/l);f=m[s[v*a+g]?1:0]}r[y++]=f.r,r[y++]=f.g,r[y++]=f.b,r[y]=f.a}}}(In)),In}var $r;function ua(){return $r||($r=1,function(t){const n=$i();function e(o,i,a){o.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=a,i.width=a,i.style.height=a+"px",i.style.width=a+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,a,s){let l=s,d=a;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),a||(d=r()),l=n.getOptions(l);const h=n.getImageWidth(i.modules.size,l),m=d.getContext("2d"),b=m.createImageData(h,h);return n.qrToImageData(b.data,i,l),e(m,d,h),m.putImageData(b,0,0),d},t.renderToDataURL=function(i,a,s){let l=s;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),l||(l={});const d=t.render(i,a,l),h=l.type||"image/png",m=l.rendererOpts||{};return d.toDataURL(h,m.quality)}}(Nn)),Nn}var Tn={},Xr;function fa(){if(Xr)return Tn;Xr=1;const t=$i();function n(o,i){const a=o.a/255,s=i+'="'+o.hex+'"';return a<1?s+" "+i+'-opacity="'+a.toFixed(2).slice(1)+'"':s}function e(o,i,a){let s=o+i;return typeof a<"u"&&(s+=" "+a),s}function r(o,i,a){let s="",l=0,d=!1,h=0;for(let m=0;m<o.length;m++){const b=Math.floor(m%i),u=Math.floor(m/i);!b&&!d&&(d=!0),o[m]?(h++,m>0&&b>0&&o[m-1]||(s+=d?e("M",b+a,.5+u+a):e("m",l,0),l=0,d=!1),b+1<i&&o[m+1]||(s+=e("h",h),h=0)):l++}return s}return Tn.render=function(i,a,s){const l=t.getOptions(a),d=i.modules.size,h=i.modules.data,m=d+l.margin*2,b=l.color.light.a?"<path "+n(l.color.light,"fill")+' d="M0 0h'+m+"v"+m+'H0z"/>':"",u="<path "+n(l.color.dark,"stroke")+' d="'+r(h,d,l.margin)+'"/>',y='viewBox="0 0 '+m+" "+m+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+y+' shape-rendering="crispEdges">'+b+u+`</svg>
`;return typeof s=="function"&&s(null,v),v},Tn}var Kr;function ha(){if(Kr)return le;Kr=1;const t=Hs(),n=da(),e=ua(),r=fa();function o(i,a,s,l,d){const h=[].slice.call(arguments,1),m=h.length,b=typeof h[m-1]=="function";if(!b&&!t())throw new Error("Callback required as last argument");if(b){if(m<2)throw new Error("Too few arguments provided");m===2?(d=s,s=a,a=l=void 0):m===3&&(a.getContext&&typeof d>"u"?(d=l,l=void 0):(d=l,l=s,s=a,a=void 0))}else{if(m<1)throw new Error("Too few arguments provided");return m===1?(s=a,a=l=void 0):m===2&&!a.getContext&&(l=s,s=a,a=void 0),new Promise(function(u,y){try{const f=n.create(s,l);u(i(f,a,l))}catch(f){y(f)}})}try{const u=n.create(s,l);d(null,i(u,a,l))}catch(u){d(u)}}return le.create=n.create,le.toCanvas=o.bind(null,e.render),le.toDataURL=o.bind(null,e.renderToDataURL),le.toString=o.bind(null,function(i,a,s){return r.render(i,s)}),le}var pa=ha();const ma=hi(pa);async function qn(t,n=512,e=1){const r={errorCorrectionLevel:"M",type:"image/png",margin:e,width:n,color:{dark:"#000000",light:"#ffffff"}};return ma.toDataURL(t,r)}const Kn=(()=>{const t=vt.get().DEFAULTS?.BACKGROUND;return{color:typeof t?.color=="string"?t.color:"#ffffff",alpha:Math.max(0,Math.min(1,typeof t?.alpha=="number"?t.alpha:1))}})(),fe={scale:1,tx:0,ty:0},Dn=(t,n,e)=>Math.max(n,Math.min(e,t)),Vt=(t,n)=>typeof t=="number"?t:n;function ga(t){return new Promise((n,e)=>{const r=new Image;r.onload=()=>n({w:r.naturalWidth,h:r.naturalHeight}),r.onerror=e,r.src=t})}function ba(t,n,e,r,o,i,a=1){const s=e/t,l=e/n,d=(r==="cover"?Math.max(s,l):Math.min(s,l))*a,h=t*d,m=n*d,b=o==="left"?0:o==="right"?e-h:(e-h)/2,u=i==="top"?0:i==="bottom"?e-m:(e-m)/2,y=(b-(e-h)/2)/e*100,f=(u-(e-m)/2)/e*100;return{tx:Math.max(-100,Math.min(100,y)),ty:Math.max(-100,Math.min(100,f))}}const ft=Do((t,n)=>({photos:[],max:Gi,transforms:{},layersByPhoto:{},cardBackground:{},setCardBackground:(e,r)=>t(o=>{const i=o.cardBackground[e]??Kn,a={color:r.color??i.color,alpha:Math.max(0,Math.min(1,r.alpha??i.alpha))};return{cardBackground:{...o.cardBackground,[e]:a}}}),setTransform:(e,r)=>t(o=>{const i=o.transforms[e]??fe,a={scale:Dn(r.scale??i.scale,.5,4),tx:Dn(r.tx??i.tx,-100,100),ty:Dn(r.ty??i.ty,-100,100)};return{transforms:{...o.transforms,[e]:a}}}),resetTransform:e=>t(r=>{const{[e]:o,...i}=r.transforms;return{transforms:i}}),add:e=>{if(!e?.length)return;const{photos:r,max:o}=n(),i=Math.max(0,o-r.length);if(!i)return;const a=e.slice(0,i);t({photos:[...r,...a]});const s=vt.get().DEFAULT_CARD_LAYERS??[];if(s.length){for(const l of a)for(const d of s)if(d?.type==="text"){const h=Vt(d.y,It-140);n().addTextLayer(l.id,{x:typeof d.x=="number"?d.x:40,y:h,text:typeof d.text=="string"?d.text:void 0,fontFamily:typeof d.fontFamily=="string"?d.fontFamily:void 0,fontSize:typeof d.fontSize=="number"?d.fontSize:void 0,fontStyle:typeof d.fontStyle=="string"?d.fontStyle:void 0,fill:typeof d.fill=="string"?d.fill:void 0,align:["left","center","right"].includes(d.align)?d.align:void 0,lineHeight:typeof d.lineHeight=="number"?d.lineHeight:void 0,letterSpacing:typeof d.letterSpacing=="number"?d.letterSpacing:void 0,width:typeof d.width=="number"?d.width:void 0,rotation:typeof d.rotation=="number"?d.rotation:void 0,name:typeof d.name=="string"?d.name:void 0})}else if(d?.type==="rect"){const h=Vt(d.y,40);n().addRectLayer(l.id,{x:typeof d.x=="number"?d.x:40,y:h,width:typeof d.width=="number"?d.width:void 0,height:typeof d.height=="number"?d.height:void 0,fill:typeof d.fill=="string"?d.fill:void 0,stroke:typeof d.stroke=="string"?d.stroke:void 0,strokeWidth:typeof d.strokeWidth=="number"?d.strokeWidth:void 0,cornerRadius:typeof d.cornerRadius=="number"?d.cornerRadius:void 0,opacity:typeof d.opacity=="number"?d.opacity:void 0,rotation:typeof d.rotation=="number"?d.rotation:void 0,name:typeof d.name=="string"?d.name:void 0})}else if(d?.type==="qr"){const h=Vt(d.y,40),m=Math.max(1,Math.round(typeof d.size=="number"?d.size:512));(async()=>{await n().addQrLayer(l.id,typeof d.text=="string"?d.text:"",m);const b=n().layersByPhoto[l.id]??[],u=b[b.length-1];u&&u.type==="image"&&n().updateLayer(l.id,u.id,{x:typeof d.x=="number"?d.x:40,y:h,name:typeof d.name=="string"?d.name:void 0})})()}}for(const l of a)(async()=>{try{const{w:d,h}=await ga(l.url),m=vt.get(),b=Math.max(0,Number(m.NEAR_SQUARE_TOLERANCE??0)),u=Number(m.NEAR_SQUARE_SCALE??1),y=Wn==="contain",f=d/h,v=Math.abs(f-1)<=b,g=y&&v?u:1,{tx:x,ty:k}=ba(d,h,It,Wn,Ys,Vs,g);n().setTransform(l.id,{tx:x,ty:k,scale:Math.max(.5,Math.min(4,fe.scale*g))});const w=vt.get().LAYER_PROFILES?.orientation;if(w&&w.on!==!1){let R;f>1+b?R="landscape":f<1-b?R="portrait":R="square";const T=R==="landscape"?w.landscape??[]:R==="portrait"?w.portrait??[]:w.square??[];for(const _ of T)if(!(!_||typeof _!="object")){if(_.type==="text"){const E=Vt(_.y,It-140);n().addTextLayer(l.id,{x:typeof _.x=="number"?_.x:40,y:E,text:typeof _.text=="string"?_.text:void 0,fontFamily:typeof _.fontFamily=="string"?_.fontFamily:void 0,fontSize:typeof _.fontSize=="number"?_.fontSize:void 0,fontStyle:typeof _.fontStyle=="string"?_.fontStyle:void 0,fill:typeof _.fill=="string"?_.fill:void 0,align:["left","center","right"].includes(_.align)?_.align:void 0,lineHeight:typeof _.lineHeight=="number"?_.lineHeight:void 0,letterSpacing:typeof _.letterSpacing=="number"?_.letterSpacing:void 0,width:typeof _.width=="number"?_.width:void 0,rotation:typeof _.rotation=="number"?_.rotation:void 0,name:typeof _.name=="string"?_.name:void 0})}else if(_.type==="rect"){const E=Vt(_.y,40);n().addRectLayer(l.id,{x:typeof _.x=="number"?_.x:40,y:E,width:typeof _.width=="number"?_.width:void 0,height:typeof _.height=="number"?_.height:void 0,fill:typeof _.fill=="string"?_.fill:void 0,stroke:typeof _.stroke=="string"?_.stroke:void 0,strokeWidth:typeof _.strokeWidth=="number"?_.strokeWidth:void 0,cornerRadius:typeof _.cornerRadius=="number"?_.cornerRadius:void 0,opacity:typeof _.opacity=="number"?_.opacity:void 0,rotation:typeof _.rotation=="number"?_.rotation:void 0,name:typeof _.name=="string"?_.name:void 0})}else if(_.type==="qr"){const E=Vt(_.y,40),S=Math.max(1,Math.round(typeof _.size=="number"?_.size:512)),L=await n().addQrLayer(l.id,typeof _.text=="string"?_.text:"",S);n().updateLayer(l.id,L,{x:typeof _.x=="number"?_.x:40,y:E,rotation:typeof _.rotation=="number"?_.rotation:void 0,name:typeof _.name=="string"?_.name:void 0})}}}}catch{}})()},clear:()=>{const e=n().photos;e.length&&_r(e),t({photos:[],transforms:{},layersByPhoto:{},cardBackground:{}})},remove:e=>t(r=>{const o=r.photos.findIndex(l=>l.id===e);if(o===-1)return null;_r([r.photos[o]]);const{[e]:i,...a}=r.transforms,s={...r.layersByPhoto};return delete s[e],{photos:r.photos.filter(l=>l.id!==e),transforms:a,layersByPhoto:s}}),addTextLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const d=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const h=vt.get().DEFAULTS?.TEXT??{},m=Vt(h.y,It-140),b=d??m,u={id:o,type:"text",x:typeof h.x=="number"?h.x:40,y:b,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,text:typeof h.text=="string"?h.text:"New text",fontFamily:typeof h.fontFamily=="string"?h.fontFamily:"Georgia, serif",fontSize:typeof h.fontSize=="number"?h.fontSize:36,fontStyle:typeof h.fontStyle=="string"?h.fontStyle:"",fill:typeof h.fill=="string"?h.fill:"#111",align:["left","center","right"].includes(h.align)?h.align:"left",verticalAlign:["top","middle","bottom"].includes(h.verticalAlign)?h.verticalAlign:"top",padding:typeof h.padding=="number"?h.padding:0,lineHeight:typeof h.lineHeight=="number"?h.lineHeight:1.25,letterSpacing:typeof h.letterSpacing=="number"?h.letterSpacing:0,width:typeof h.width=="number"?h.width:void 0,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,u]}}}),o},addRectLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const d=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const h=vt.get().DEFAULTS?.RECT??{},m=Vt(h.y,40),b=d??m,u={id:o,type:"rect",x:typeof h.x=="number"?h.x:40,y:b,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,width:typeof h.width=="number"?h.width:600,height:typeof h.height=="number"?h.height:300,fill:typeof h.fill=="string"?h.fill:"#ffffff",stroke:typeof h.stroke=="string"?h.stroke:void 0,strokeWidth:typeof h.strokeWidth=="number"?h.strokeWidth:0,cornerRadius:typeof h.cornerRadius=="number"?h.cornerRadius:0,opacity:typeof h.opacity=="number"?h.opacity:1,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,u]}}}),o},addImageLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const d=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const h=vt.get().DEFAULTS?.IMAGE??{},m=Vt(h.y,40),b=d??m,u={id:o,type:"image",x:typeof h.x=="number"?h.x:40,y:b,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,src:"",w:typeof h.w=="number"?h.w:void 0,h:typeof h.h=="number"?h.h:void 0,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,u]}}}),o},addQrLayer:async(e,r,o=512)=>{const i=vt.get().DEFAULTS?.QR??{},a=Math.max(1,Math.round(typeof o=="number"?o:i.size??512)),s=await qn(r,a,1);return n().addImageLayer(e,{src:s,x:typeof i.x=="number"?i.x:40,y:typeof i.y=="number"?i.y:40,w:a,h:a,qrText:r})},updateQrLayer:async(e,r,o)=>{const a=n().layersByPhoto[e]??[],s=a.findIndex(b=>b.id===r&&b.type==="image");if(s===-1)return;const l=a[s];if(!l.qrText&&!o.text)return;const d=o.text??l.qrText??"",h=Math.max(1,Math.round(o.size??l.w??l.h??512)),m=await qn(d,h,1);n().updateLayer(e,r,{src:m,w:h,h,...d?{qrText:d}:{}})},updateLayer:(e,r,o)=>t(i=>{const a=i.layersByPhoto[e]??[],s=a.findIndex(b=>b.id===r);if(s===-1)return null;const l=a[s],d={...o};delete d.id,delete d.type;const h={...l,...d},m=[...a];return m[s]=h,{layersByPhoto:{...i.layersByPhoto,[e]:m}}}),removeLayer:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[],a=i.filter(s=>s.id!==r);return a===i?null:{layersByPhoto:{...o.layersByPhoto,[e]:a}}}),bringToFront:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=Math.max(...i.map(l=>l.z)),s=i.map(l=>l.id===r?{...l,z:a+1}:l);return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),sendToBack:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=Math.min(...i.map(l=>l.z)),s=i.map(l=>l.id===r?{...l,z:a-1}:l);return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),setLayersOrder:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=new Map(i.map(d=>[d.id,d])),s=[];let l=1;for(const d of r){const h=a.get(d);h&&s.push({...h,z:l++})}for(const d of i)r.includes(d.id)||s.push({...d,z:l++});return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),reorderPhotos:e=>t(r=>{if(!Array.isArray(e)||!e.length)return null;const o=new Map(r.photos.map(a=>[a.id,a])),i=e.map(a=>o.get(a)).filter(Boolean);for(const a of r.photos)e.includes(a.id)||i.push(a);return{photos:i}})}));function ya(t){const n=t.replace(/^\uFEFF/,"").replace(/\r\n?/g,`
`).split(`
`).filter(Boolean);if(!n.length)return{rows:[],hasRelative:!1};const e=n[0].toLowerCase(),r=e.includes(";")&&!e.includes(",")?";":",",o=new RegExp(`\\s*(?:"([^"]*)"|([^${r}\\n]*))\\s*(?:${r}|$)`,"g");let i=null;{const l=n[0].toLowerCase();if(/\burl\b/.test(l)){o.lastIndex=0;const d=[];let h;for(;h=o.exec(n[0]);){const m=(h[1]??h[2]??"").trim();if(m&&d.push(m),h.index+h[0].length>=n[0].length)break}i=d}}const a=[];for(let l=0;l<n.length;l++){const d=n[l];if(!d.trim()||l===0&&i)continue;const h=[];o.lastIndex=0;let m,b=0;for(;(m=o.exec(d))&&b++<1e3;){const g=(m[1]??m[2]??"").trim();if(h.push(g),m.index+m[0].length>=d.length)break}if(!h.length)continue;if(!i){const g=(h[0]??"").trim();if(!g)continue;const x=(h[1]??"").trim()||void 0;a.push({url:g,caption:x});continue}const u={};i.forEach((g,x)=>u[g.trim().toLowerCase()]=h[x]??"");const y=(u.url??"").trim();if(!y)continue;const f=(u.caption??"").trim()||void 0,v={};for(const[g,x]of Object.entries(u)){const k=x?.trim(),w=/^layer_([^_]+)_(.+)$/i.exec(g.trim());if(w&&k){const R=`layer_${w[1]}`.toLowerCase(),T=w[2].toLowerCase();v[R]||(v[R]={}),v[R][T]=k}}a.push({url:y,caption:f,layers:Object.keys(v).length?v:void 0})}const s=a.some(l=>va(l.url));return{rows:a,hasRelative:s}}function Xi(t){return/^https?:\/\//i.test(t)}function Ki(t){return/^data:/i.test(t)}function va(t){return!(Xi(t)||Ki(t)||/^blob:/.test(t))}function Ue(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var zn={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Qr;function wa(){return Qr||(Qr=1,function(t,n){(function(e){t.exports=e()})(function(){return function e(r,o,i){function a(d,h){if(!o[d]){if(!r[d]){var m=typeof Ue=="function"&&Ue;if(!h&&m)return m(d,!0);if(s)return s(d,!0);var b=new Error("Cannot find module '"+d+"'");throw b.code="MODULE_NOT_FOUND",b}var u=o[d]={exports:{}};r[d][0].call(u.exports,function(y){var f=r[d][1][y];return a(f||y)},u,u.exports,e,r,o,i)}return o[d].exports}for(var s=typeof Ue=="function"&&Ue,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(e,r,o){var i=e("./utils"),a=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(l){for(var d,h,m,b,u,y,f,v=[],g=0,x=l.length,k=x,w=i.getTypeOf(l)!=="string";g<l.length;)k=x-g,m=w?(d=l[g++],h=g<x?l[g++]:0,g<x?l[g++]:0):(d=l.charCodeAt(g++),h=g<x?l.charCodeAt(g++):0,g<x?l.charCodeAt(g++):0),b=d>>2,u=(3&d)<<4|h>>4,y=1<k?(15&h)<<2|m>>6:64,f=2<k?63&m:64,v.push(s.charAt(b)+s.charAt(u)+s.charAt(y)+s.charAt(f));return v.join("")},o.decode=function(l){var d,h,m,b,u,y,f=0,v=0,g="data:";if(l.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var x,k=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&k--,l.charAt(l.length-2)===s.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=a.uint8array?new Uint8Array(0|k):new Array(0|k);f<l.length;)d=s.indexOf(l.charAt(f++))<<2|(b=s.indexOf(l.charAt(f++)))>>4,h=(15&b)<<4|(u=s.indexOf(l.charAt(f++)))>>2,m=(3&u)<<6|(y=s.indexOf(l.charAt(f++))),x[v++]=d,u!==64&&(x[v++]=h),y!==64&&(x[v++]=m);return x}},{"./support":30,"./utils":32}],2:[function(e,r,o){var i=e("./external"),a=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function d(h,m,b,u,y){this.compressedSize=h,this.uncompressedSize=m,this.crc32=b,this.compression=u,this.compressedContent=y}d.prototype={getContentWorker:function(){var h=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),m=this;return h.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(h,m,b){return h.pipe(new s).pipe(new l("uncompressedSize")).pipe(m.compressWorker(b)).pipe(new l("compressedSize")).withStreamInfo("compression",m)},r.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,o){var i=e("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},o.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,o){var i=e("./utils"),a=function(){for(var s,l=[],d=0;d<256;d++){s=d;for(var h=0;h<8;h++)s=1&s?3988292384^s>>>1:s>>>1;l[d]=s}return l}();r.exports=function(s,l){return s!==void 0&&s.length?i.getTypeOf(s)!=="string"?function(d,h,m,b){var u=a,y=b+m;d^=-1;for(var f=b;f<y;f++)d=d>>>8^u[255&(d^h[f])];return-1^d}(0|l,s,s.length,0):function(d,h,m,b){var u=a,y=b+m;d^=-1;for(var f=b;f<y;f++)d=d>>>8^u[255&(d^h.charCodeAt(f))];return-1^d}(0|l,s,s.length,0):0}},{"./utils":32}],5:[function(e,r,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(e,r,o){var i=null;i=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:i}},{lie:37}],7:[function(e,r,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=e("pako"),s=e("./utils"),l=e("./stream/GenericWorker"),d=i?"uint8array":"array";function h(m,b){l.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=b,this.meta={}}o.magic="\b\0",s.inherits(h,l),h.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(d,m.data),!1)},h.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(b){m.push({data:b,meta:m.meta})}},o.compressWorker=function(m){return new h("Deflate",m)},o.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,o){function i(u,y){var f,v="";for(f=0;f<y;f++)v+=String.fromCharCode(255&u),u>>>=8;return v}function a(u,y,f,v,g,x){var k,w,R=u.file,T=u.compression,_=x!==d.utf8encode,E=s.transformTo("string",x(R.name)),S=s.transformTo("string",d.utf8encode(R.name)),L=R.comment,U=s.transformTo("string",x(L)),A=s.transformTo("string",d.utf8encode(L)),C=S.length!==R.name.length,c=A.length!==L.length,F="",Z="",q="",Y=R.dir,P=R.date,tt={crc32:0,compressedSize:0,uncompressedSize:0};y&&!f||(tt.crc32=u.crc32,tt.compressedSize=u.compressedSize,tt.uncompressedSize=u.uncompressedSize);var M=0;y&&(M|=8),_||!C&&!c||(M|=2048);var B=0,J=0;Y&&(B|=16),g==="UNIX"?(J=798,B|=function(X,dt){var lt=X;return X||(lt=dt?16893:33204),(65535&lt)<<16}(R.unixPermissions,Y)):(J=20,B|=function(X){return 63&(X||0)}(R.dosPermissions)),k=P.getUTCHours(),k<<=6,k|=P.getUTCMinutes(),k<<=5,k|=P.getUTCSeconds()/2,w=P.getUTCFullYear()-1980,w<<=4,w|=P.getUTCMonth()+1,w<<=5,w|=P.getUTCDate(),C&&(Z=i(1,1)+i(h(E),4)+S,F+="up"+i(Z.length,2)+Z),c&&(q=i(1,1)+i(h(U),4)+A,F+="uc"+i(q.length,2)+q);var $="";return $+=`
\0`,$+=i(M,2),$+=T.magic,$+=i(k,2),$+=i(w,2),$+=i(tt.crc32,4),$+=i(tt.compressedSize,4),$+=i(tt.uncompressedSize,4),$+=i(E.length,2),$+=i(F.length,2),{fileRecord:m.LOCAL_FILE_HEADER+$+E+F,dirRecord:m.CENTRAL_FILE_HEADER+i(J,2)+$+i(U.length,2)+"\0\0\0\0"+i(B,4)+i(v,4)+E+F+U}}var s=e("../utils"),l=e("../stream/GenericWorker"),d=e("../utf8"),h=e("../crc32"),m=e("../signature");function b(u,y,f,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=f,this.encodeFileName=v,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(b,l),b.prototype.push=function(u){var y=u.meta.percent||0,f=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,l.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:f?(y+100*(f-v-1))/f:100}}))},b.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var y=this.streamFiles&&!u.file.dir;if(y){var f=a(u,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},b.prototype.closedSource=function(u){this.accumulate=!1;var y=this.streamFiles&&!u.file.dir,f=a(u,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),y)this.push({data:function(v){return m.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},b.prototype.flush=function(){for(var u=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var f=this.bytesWritten-u,v=function(g,x,k,w,R){var T=s.transformTo("string",R(w));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(g,2)+i(g,2)+i(x,4)+i(k,4)+i(T.length,2)+T}(this.dirRecords.length,f,u,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},b.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},b.prototype.registerPrevious=function(u){this._sources.push(u);var y=this;return u.on("data",function(f){y.processChunk(f)}),u.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),u.on("error",function(f){y.error(f)}),this},b.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},b.prototype.error=function(u){var y=this._sources;if(!l.prototype.error.call(this,u))return!1;for(var f=0;f<y.length;f++)try{y[f].error(u)}catch{}return!0},b.prototype.lock=function(){l.prototype.lock.call(this);for(var u=this._sources,y=0;y<u.length;y++)u[y].lock()},r.exports=b},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,o){var i=e("../compressions"),a=e("./ZipFileWorker");o.generateWorker=function(s,l,d){var h=new a(l.streamFiles,d,l.platform,l.encodeFileName),m=0;try{s.forEach(function(b,u){m++;var y=function(x,k){var w=x||k,R=i[w];if(!R)throw new Error(w+" is not a valid compression method !");return R}(u.options.compression,l.compression),f=u.options.compressionOptions||l.compressionOptions||{},v=u.dir,g=u.date;u._compressWorker(y,f).withStreamInfo("file",{name:b,dir:v,date:g,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(h)}),h.entriesCount=m}catch(b){h.error(b)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,o){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var s in this)typeof this[s]!="function"&&(a[s]=this[s]);return a}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(a,s){return new i().loadAsync(a,s)},i.external=e("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,o){var i=e("./utils"),a=e("./external"),s=e("./utf8"),l=e("./zipEntries"),d=e("./stream/Crc32Probe"),h=e("./nodejsUtils");function m(b){return new a.Promise(function(u,y){var f=b.decompressed.getContentWorker().pipe(new d);f.on("error",function(v){y(v)}).on("end",function(){f.streamInfo.crc32!==b.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}r.exports=function(b,u){var y=this;return u=i.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),h.isNode&&h.isStream(b)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",b,!0,u.optimizedBinaryString,u.base64).then(function(f){var v=new l(u);return v.load(f),v}).then(function(f){var v=[a.Promise.resolve(f)],g=f.files;if(u.checkCRC32)for(var x=0;x<g.length;x++)v.push(m(g[x]));return a.Promise.all(v)}).then(function(f){for(var v=f.shift(),g=v.files,x=0;x<g.length;x++){var k=g[x],w=k.fileNameStr,R=i.resolve(k.fileNameStr);y.file(R,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:u.createFolders}),k.dir||(y.file(R).unsafeOriginalName=w)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,o){var i=e("../utils"),a=e("../stream/GenericWorker");function s(l,d){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(d)}i.inherits(s,a),s.prototype._bindStream=function(l){var d=this;(this._stream=l).pause(),l.on("data",function(h){d.push({data:h,meta:{percent:0}})}).on("error",function(h){d.isPaused?this.generatedError=h:d.error(h)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,o){var i=e("readable-stream").Readable;function a(s,l,d){i.call(this,l),this._helper=s;var h=this;s.on("data",function(m,b){h.push(m)||h._helper.pause(),d&&d(b)}).on("error",function(m){h.emit("error",m)}).on("end",function(){h.push(null)})}e("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,r,o){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,a)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var a=new Buffer(i);return a.fill(0),a},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(e,r,o){function i(R,T,_){var E,S=s.getTypeOf(T),L=s.extend(_||{},h);L.date=L.date||new Date,L.compression!==null&&(L.compression=L.compression.toUpperCase()),typeof L.unixPermissions=="string"&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&16384&L.unixPermissions&&(L.dir=!0),L.dosPermissions&&16&L.dosPermissions&&(L.dir=!0),L.dir&&(R=g(R)),L.createFolders&&(E=v(R))&&x.call(this,E,!0);var U=S==="string"&&L.binary===!1&&L.base64===!1;_&&_.binary!==void 0||(L.binary=!U),(T instanceof m&&T.uncompressedSize===0||L.dir||!T||T.length===0)&&(L.base64=!1,L.binary=!0,T="",L.compression="STORE",S="string");var A=null;A=T instanceof m||T instanceof l?T:y.isNode&&y.isStream(T)?new f(R,T):s.prepareContent(R,T,L.binary,L.optimizedBinaryString,L.base64);var C=new b(R,A,L);this.files[R]=C}var a=e("./utf8"),s=e("./utils"),l=e("./stream/GenericWorker"),d=e("./stream/StreamHelper"),h=e("./defaults"),m=e("./compressedObject"),b=e("./zipObject"),u=e("./generate"),y=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),v=function(R){R.slice(-1)==="/"&&(R=R.substring(0,R.length-1));var T=R.lastIndexOf("/");return 0<T?R.substring(0,T):""},g=function(R){return R.slice(-1)!=="/"&&(R+="/"),R},x=function(R,T){return T=T!==void 0?T:h.createFolders,R=g(R),this.files[R]||i.call(this,R,null,{dir:!0,createFolders:T}),this.files[R]};function k(R){return Object.prototype.toString.call(R)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(R){var T,_,E;for(T in this.files)E=this.files[T],(_=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&R(_,E)},filter:function(R){var T=[];return this.forEach(function(_,E){R(_,E)&&T.push(E)}),T},file:function(R,T,_){if(arguments.length!==1)return R=this.root+R,i.call(this,R,T,_),this;if(k(R)){var E=R;return this.filter(function(L,U){return!U.dir&&E.test(L)})}var S=this.files[this.root+R];return S&&!S.dir?S:null},folder:function(R){if(!R)return this;if(k(R))return this.filter(function(S,L){return L.dir&&R.test(S)});var T=this.root+R,_=x.call(this,T),E=this.clone();return E.root=_.name,E},remove:function(R){R=this.root+R;var T=this.files[R];if(T||(R.slice(-1)!=="/"&&(R+="/"),T=this.files[R]),T&&!T.dir)delete this.files[R];else for(var _=this.filter(function(S,L){return L.name.slice(0,R.length)===R}),E=0;E<_.length;E++)delete this.files[_[E].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(R){var T,_={};try{if((_=s.extend(R||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=_.type.toLowerCase(),_.compression=_.compression.toUpperCase(),_.type==="binarystring"&&(_.type="string"),!_.type)throw new Error("No output type specified.");s.checkSupport(_.type),_.platform!=="darwin"&&_.platform!=="freebsd"&&_.platform!=="linux"&&_.platform!=="sunos"||(_.platform="UNIX"),_.platform==="win32"&&(_.platform="DOS");var E=_.comment||this.comment||"";T=u.generateWorker(this,_,E)}catch(S){(T=new l("error")).error(S)}return new d(T,_.type||"string",_.mimeType)},generateAsync:function(R,T){return this.generateInternalStream(R).accumulate(T)},generateNodeStream:function(R,T){return(R=R||{}).type||(R.type="nodebuffer"),this.generateInternalStream(R).toNodejsStream(T)}};r.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,o){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,o){var i=e("./DataReader");function a(s){i.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}e("../utils").inherits(a,i),a.prototype.byteAt=function(s){return this.data[this.zero+s]},a.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),d=s.charCodeAt(1),h=s.charCodeAt(2),m=s.charCodeAt(3),b=this.length-4;0<=b;--b)if(this.data[b]===l&&this.data[b+1]===d&&this.data[b+2]===h&&this.data[b+3]===m)return b-this.zero;return-1},a.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),d=s.charCodeAt(1),h=s.charCodeAt(2),m=s.charCodeAt(3),b=this.readData(4);return l===b[0]&&d===b[1]&&h===b[2]&&m===b[3]},a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,r,o){var i=e("../utils");function a(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var l,d=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)d=(d<<8)+this.byteAt(l);return this.index+=s,d},readString:function(s){return i.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},r.exports=a},{"../utils":32}],19:[function(e,r,o){var i=e("./Uint8ArrayReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,o){var i=e("./DataReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},a.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},a.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,r,o){var i=e("./ArrayReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,o){var i=e("../utils"),a=e("../support"),s=e("./ArrayReader"),l=e("./StringReader"),d=e("./NodeBufferReader"),h=e("./Uint8ArrayReader");r.exports=function(m){var b=i.getTypeOf(m);return i.checkSupport(b),b!=="string"||a.uint8array?b==="nodebuffer"?new d(m):a.uint8array?new h(i.transformTo("uint8array",m)):new s(i.transformTo("array",m)):new l(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,o){var i=e("./GenericWorker"),a=e("../utils");function s(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(s,i),s.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,o){var i=e("./GenericWorker"),a=e("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,i),s.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,o){var i=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(s,a),s.prototype.processChunk=function(l){if(l){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,o){var i=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(h){d.dataIsReady=!0,d.data=h,d.max=h&&h.length||0,d.type=i.getTypeOf(h),d.isPaused||d._tickAndRepeat()},function(h){d.error(h)})}i.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,d);break;case"uint8array":l=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":l=this.data.slice(this.index,d)}return this.index=d,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,o){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,s){return this._listeners[a].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,s){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,s)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var s=this;return a.on("data",function(l){s.processChunk(l)}),a.on("end",function(){s.end()}),a.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,s){return this.extraStreamInfo[a]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(e,r,o){var i=e("../utils"),a=e("./ConvertWorker"),s=e("./GenericWorker"),l=e("../base64"),d=e("../support"),h=e("../external"),m=null;if(d.nodestream)try{m=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(y,f){return new h.Promise(function(v,g){var x=[],k=y._internalType,w=y._outputType,R=y._mimeType;y.on("data",function(T,_){x.push(T),f&&f(_)}).on("error",function(T){x=[],g(T)}).on("end",function(){try{var T=function(_,E,S){switch(_){case"blob":return i.newBlob(i.transformTo("arraybuffer",E),S);case"base64":return l.encode(E);default:return i.transformTo(_,E)}}(w,function(_,E){var S,L=0,U=null,A=0;for(S=0;S<E.length;S++)A+=E[S].length;switch(_){case"string":return E.join("");case"array":return Array.prototype.concat.apply([],E);case"uint8array":for(U=new Uint8Array(A),S=0;S<E.length;S++)U.set(E[S],L),L+=E[S].length;return U;case"nodebuffer":return Buffer.concat(E);default:throw new Error("concat : unsupported type '"+_+"'")}}(k,x),R);v(T)}catch(_){g(_)}x=[]}).resume()})}function u(y,f,v){var g=f;switch(f){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=f,this._mimeType=v,i.checkSupport(g),this._worker=y.pipe(new a(g)),y.lock()}catch(x){this._worker=new s("error"),this._worker.error(x)}}u.prototype={accumulate:function(y){return b(this,y)},on:function(y,f){var v=this;return y==="data"?this._worker.on(y,function(g){f.call(v,g.data,g.meta)}):this._worker.on(y,function(){i.delay(f,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var i=new ArrayBuffer(0);try{o.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),o.blob=a.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!e("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,o){for(var i=e("./utils"),a=e("./support"),s=e("./nodejsUtils"),l=e("./stream/GenericWorker"),d=new Array(256),h=0;h<256;h++)d[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;d[254]=d[254]=1;function m(){l.call(this,"utf-8 decode"),this.leftOver=null}function b(){l.call(this,"utf-8 encode")}o.utf8encode=function(u){return a.nodebuffer?s.newBufferFrom(u,"utf-8"):function(y){var f,v,g,x,k,w=y.length,R=0;for(x=0;x<w;x++)(64512&(v=y.charCodeAt(x)))==55296&&x+1<w&&(64512&(g=y.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(g-56320),x++),R+=v<128?1:v<2048?2:v<65536?3:4;for(f=a.uint8array?new Uint8Array(R):new Array(R),x=k=0;k<R;x++)(64512&(v=y.charCodeAt(x)))==55296&&x+1<w&&(64512&(g=y.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(g-56320),x++),v<128?f[k++]=v:(v<2048?f[k++]=192|v>>>6:(v<65536?f[k++]=224|v>>>12:(f[k++]=240|v>>>18,f[k++]=128|v>>>12&63),f[k++]=128|v>>>6&63),f[k++]=128|63&v);return f}(u)},o.utf8decode=function(u){return a.nodebuffer?i.transformTo("nodebuffer",u).toString("utf-8"):function(y){var f,v,g,x,k=y.length,w=new Array(2*k);for(f=v=0;f<k;)if((g=y[f++])<128)w[v++]=g;else if(4<(x=d[g]))w[v++]=65533,f+=x-1;else{for(g&=x===2?31:x===3?15:7;1<x&&f<k;)g=g<<6|63&y[f++],x--;1<x?w[v++]=65533:g<65536?w[v++]=g:(g-=65536,w[v++]=55296|g>>10&1023,w[v++]=56320|1023&g)}return w.length!==v&&(w.subarray?w=w.subarray(0,v):w.length=v),i.applyFromCharCode(w)}(u=i.transformTo(a.uint8array?"uint8array":"array",u))},i.inherits(m,l),m.prototype.processChunk=function(u){var y=i.transformTo(a.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var f=y;(y=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),y.set(f,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(x,k){var w;for((k=k||x.length)>x.length&&(k=x.length),w=k-1;0<=w&&(192&x[w])==128;)w--;return w<0||w===0?k:w+d[x[w]]>k?w:k}(y),g=y;v!==y.length&&(a.uint8array?(g=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(g=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:o.utf8decode(g),meta:u.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=m,i.inherits(b,l),b.prototype.processChunk=function(u){this.push({data:o.utf8encode(u.data),meta:u.meta})},o.Utf8EncodeWorker=b},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,o){var i=e("./support"),a=e("./base64"),s=e("./nodejsUtils"),l=e("./external");function d(f){return f}function h(f,v){for(var g=0;g<f.length;++g)v[g]=255&f.charCodeAt(g);return v}e("setimmediate"),o.newBlob=function(f,v){o.checkSupport("blob");try{return new Blob([f],{type:v})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(f),g.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(f,v,g){var x=[],k=0,w=f.length;if(w<=g)return String.fromCharCode.apply(null,f);for(;k<w;)v==="array"||v==="nodebuffer"?x.push(String.fromCharCode.apply(null,f.slice(k,Math.min(k+g,w)))):x.push(String.fromCharCode.apply(null,f.subarray(k,Math.min(k+g,w)))),k+=g;return x.join("")},stringifyByChar:function(f){for(var v="",g=0;g<f.length;g++)v+=String.fromCharCode(f[g]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function b(f){var v=65536,g=o.getTypeOf(f),x=!0;if(g==="uint8array"?x=m.applyCanBeUsed.uint8array:g==="nodebuffer"&&(x=m.applyCanBeUsed.nodebuffer),x)for(;1<v;)try{return m.stringifyByChunk(f,g,v)}catch{v=Math.floor(v/2)}return m.stringifyByChar(f)}function u(f,v){for(var g=0;g<f.length;g++)v[g]=f[g];return v}o.applyFromCharCode=b;var y={};y.string={string:d,array:function(f){return h(f,new Array(f.length))},arraybuffer:function(f){return y.string.uint8array(f).buffer},uint8array:function(f){return h(f,new Uint8Array(f.length))},nodebuffer:function(f){return h(f,s.allocBuffer(f.length))}},y.array={string:b,array:d,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(f)}},y.arraybuffer={string:function(f){return b(new Uint8Array(f))},array:function(f){return u(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:d,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(new Uint8Array(f))}},y.uint8array={string:b,array:function(f){return u(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:d,nodebuffer:function(f){return s.newBufferFrom(f)}},y.nodebuffer={string:b,array:function(f){return u(f,new Array(f.length))},arraybuffer:function(f){return y.nodebuffer.uint8array(f).buffer},uint8array:function(f){return u(f,new Uint8Array(f.length))},nodebuffer:d},o.transformTo=function(f,v){if(v=v||"",!f)return v;o.checkSupport(f);var g=o.getTypeOf(v);return y[g][f](v)},o.resolve=function(f){for(var v=f.split("/"),g=[],x=0;x<v.length;x++){var k=v[x];k==="."||k===""&&x!==0&&x!==v.length-1||(k===".."?g.pop():g.push(k))}return g.join("/")},o.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":i.nodebuffer&&s.isBuffer(f)?"nodebuffer":i.uint8array&&f instanceof Uint8Array?"uint8array":i.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(f){if(!i[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(f){var v,g,x="";for(g=0;g<(f||"").length;g++)x+="\\x"+((v=f.charCodeAt(g))<16?"0":"")+v.toString(16).toUpperCase();return x},o.delay=function(f,v,g){setImmediate(function(){f.apply(g||null,v||[])})},o.inherits=function(f,v){function g(){}g.prototype=v.prototype,f.prototype=new g},o.extend=function(){var f,v,g={};for(f=0;f<arguments.length;f++)for(v in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],v)&&g[v]===void 0&&(g[v]=arguments[f][v]);return g},o.prepareContent=function(f,v,g,x,k){return l.Promise.resolve(v).then(function(w){return i.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new l.Promise(function(R,T){var _=new FileReader;_.onload=function(E){R(E.target.result)},_.onerror=function(E){T(E.target.error)},_.readAsArrayBuffer(w)}):w}).then(function(w){var R=o.getTypeOf(w);return R?(R==="arraybuffer"?w=o.transformTo("uint8array",w):R==="string"&&(k?w=a.decode(w):g&&x!==!0&&(w=function(T){return h(T,i.uint8array?new Uint8Array(T.length):new Array(T.length))}(w))),w):l.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,o){var i=e("./reader/readerFor"),a=e("./utils"),s=e("./signature"),l=e("./zipEntry"),d=e("./support");function h(m){this.files=[],this.loadOptions=m}h.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(b)+", expected "+a.pretty(m)+")")}},isSignature:function(m,b){var u=this.reader.index;this.reader.setIndex(m);var y=this.reader.readString(4)===b;return this.reader.setIndex(u),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),b=d.uint8array?"uint8array":"array",u=a.transformTo(b,m);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,b,u,y=this.zip64EndOfCentralSize-44;0<y;)m=this.reader.readInt(2),b=this.reader.readInt(4),u=this.reader.readData(b),this.zip64ExtensibleData[m]={id:m,length:b,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,b;for(m=0;m<this.files.length;m++)b=this.files[m],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(m=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var b=m;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var y=b-u;if(0<y)this.isSignature(b,s.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(m){this.reader=i(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,o){var i=e("./reader/readerFor"),a=e("./utils"),s=e("./compressedObject"),l=e("./crc32"),d=e("./utf8"),h=e("./compressions"),m=e("./support");function b(u,y){this.options=u,this.loadOptions=y}b.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var y,f;if(u.skip(22),this.fileNameLength=u.readInt(2),f=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var g in h)if(Object.prototype.hasOwnProperty.call(h,g)&&h[g].magic===v)return h[g];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,y,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var y=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(y),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var y,f,v,g=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<g;)y=u.readInt(2),f=u.readInt(2),v=u.readData(f),this.extraFields[y]={id:y,length:f,value:v};u.setIndex(g)},handleUTF8:function(){var u=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var f=a.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var g=a.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var y=i(u.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:d.utf8decode(y.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var y=i(u.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:d.utf8decode(y.readData(u.length-5))}return null}},r.exports=b},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,o){function i(y,f,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=f,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),l=e("./utf8"),d=e("./compressedObject"),h=e("./stream/GenericWorker");i.prototype={internalStream:function(y){var f=null,v="string";try{if(!y)throw new Error("No output type specified.");var g=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),f=this._decompressWorker();var x=!this._dataBinary;x&&!g&&(f=f.pipe(new l.Utf8EncodeWorker)),!x&&g&&(f=f.pipe(new l.Utf8DecodeWorker))}catch(k){(f=new h("error")).error(k)}return new a(f,v,"")},async:function(y,f){return this.internalStream(y).accumulate(f)},nodeStream:function(y,f){return this.internalStream(y||"nodebuffer").toNodejsStream(f)},_compressWorker:function(y,f){if(this._data instanceof d&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),d.createWorkerFrom(v,y,f)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof h?this._data:new s(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<m.length;u++)i.prototype[m[u]]=b;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,o){(function(i){var a,s,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var d=0,h=new l(y),m=i.document.createTextNode("");h.observe(m,{characterData:!0}),a=function(){m.data=d=++d%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var f=i.document.createElement("script");f.onreadystatechange=function(){y(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},i.document.documentElement.appendChild(f)}:function(){setTimeout(y,0)};else{var b=new i.MessageChannel;b.port1.onmessage=y,a=function(){b.port2.postMessage(0)}}var u=[];function y(){var f,v;s=!0;for(var g=u.length;g;){for(v=u,u=[],f=-1;++f<g;)v[f]();g=u.length}s=!1}r.exports=function(f){u.push(f)!==1||s||a()}}).call(this,typeof Be<"u"?Be:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,o){var i=e("immediate");function a(){}var s={},l=["REJECTED"],d=["FULFILLED"],h=["PENDING"];function m(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,g!==a&&f(this,g)}function b(g,x,k){this.promise=g,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function u(g,x,k){i(function(){var w;try{w=x(k)}catch(R){return s.reject(g,R)}w===g?s.reject(g,new TypeError("Cannot resolve promise with itself")):s.resolve(g,w)})}function y(g){var x=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof x=="function")return function(){x.apply(g,arguments)}}function f(g,x){var k=!1;function w(_){k||(k=!0,s.reject(g,_))}function R(_){k||(k=!0,s.resolve(g,_))}var T=v(function(){x(R,w)});T.status==="error"&&w(T.value)}function v(g,x){var k={};try{k.value=g(x),k.status="success"}catch(w){k.status="error",k.value=w}return k}(r.exports=m).prototype.finally=function(g){if(typeof g!="function")return this;var x=this.constructor;return this.then(function(k){return x.resolve(g()).then(function(){return k})},function(k){return x.resolve(g()).then(function(){throw k})})},m.prototype.catch=function(g){return this.then(null,g)},m.prototype.then=function(g,x){if(typeof g!="function"&&this.state===d||typeof x!="function"&&this.state===l)return this;var k=new this.constructor(a);return this.state!==h?u(k,this.state===d?g:x,this.outcome):this.queue.push(new b(k,g,x)),k},b.prototype.callFulfilled=function(g){s.resolve(this.promise,g)},b.prototype.otherCallFulfilled=function(g){u(this.promise,this.onFulfilled,g)},b.prototype.callRejected=function(g){s.reject(this.promise,g)},b.prototype.otherCallRejected=function(g){u(this.promise,this.onRejected,g)},s.resolve=function(g,x){var k=v(y,x);if(k.status==="error")return s.reject(g,k.value);var w=k.value;if(w)f(g,w);else{g.state=d,g.outcome=x;for(var R=-1,T=g.queue.length;++R<T;)g.queue[R].callFulfilled(x)}return g},s.reject=function(g,x){g.state=l,g.outcome=x;for(var k=-1,w=g.queue.length;++k<w;)g.queue[k].callRejected(x);return g},m.resolve=function(g){return g instanceof this?g:s.resolve(new this(a),g)},m.reject=function(g){var x=new this(a);return s.reject(x,g)},m.all=function(g){var x=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=g.length,w=!1;if(!k)return this.resolve([]);for(var R=new Array(k),T=0,_=-1,E=new this(a);++_<k;)S(g[_],_);return E;function S(L,U){x.resolve(L).then(function(A){R[U]=A,++T!==k||w||(w=!0,s.resolve(E,R))},function(A){w||(w=!0,s.reject(E,A))})}},m.race=function(g){var x=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=g.length,w=!1;if(!k)return this.resolve([]);for(var R=-1,T=new this(a);++R<k;)_=g[R],x.resolve(_).then(function(E){w||(w=!0,s.resolve(T,E))},function(E){w||(w=!0,s.reject(T,E))});var _;return T}},{immediate:36}],38:[function(e,r,o){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,o){var i=e("./zlib/deflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/messages"),d=e("./zlib/zstream"),h=Object.prototype.toString,m=0,b=-1,u=0,y=8;function f(g){if(!(this instanceof f))return new f(g);this.options=a.assign({level:b,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},g||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var k=i.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(k!==m)throw new Error(l[k]);if(x.header&&i.deflateSetHeader(this.strm,x.header),x.dictionary){var w;if(w=typeof x.dictionary=="string"?s.string2buf(x.dictionary):h.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(k=i.deflateSetDictionary(this.strm,w))!==m)throw new Error(l[k]);this._dict_set=!0}}function v(g,x){var k=new f(x);if(k.push(g,!0),k.err)throw k.msg||l[k.err];return k.result}f.prototype.push=function(g,x){var k,w,R=this.strm,T=this.options.chunkSize;if(this.ended)return!1;w=x===~~x?x:x===!0?4:0,typeof g=="string"?R.input=s.string2buf(g):h.call(g)==="[object ArrayBuffer]"?R.input=new Uint8Array(g):R.input=g,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new a.Buf8(T),R.next_out=0,R.avail_out=T),(k=i.deflate(R,w))!==1&&k!==m)return this.onEnd(k),!(this.ended=!0);R.avail_out!==0&&(R.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(a.shrinkBuf(R.output,R.next_out))):this.onData(a.shrinkBuf(R.output,R.next_out)))}while((0<R.avail_in||R.avail_out===0)&&k!==1);return w===4?(k=i.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===m):w!==2||(this.onEnd(m),!(R.avail_out=0))},f.prototype.onData=function(g){this.chunks.push(g)},f.prototype.onEnd=function(g){g===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},o.Deflate=f,o.deflate=v,o.deflateRaw=function(g,x){return(x=x||{}).raw=!0,v(g,x)},o.gzip=function(g,x){return(x=x||{}).gzip=!0,v(g,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,o){var i=e("./zlib/inflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/constants"),d=e("./zlib/messages"),h=e("./zlib/zstream"),m=e("./zlib/gzheader"),b=Object.prototype.toString;function u(f){if(!(this instanceof u))return new u(f);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},f||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||f&&f.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var g=i.inflateInit2(this.strm,v.windowBits);if(g!==l.Z_OK)throw new Error(d[g]);this.header=new m,i.inflateGetHeader(this.strm,this.header)}function y(f,v){var g=new u(v);if(g.push(f,!0),g.err)throw g.msg||d[g.err];return g.result}u.prototype.push=function(f,v){var g,x,k,w,R,T,_=this.strm,E=this.options.chunkSize,S=this.options.dictionary,L=!1;if(this.ended)return!1;x=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?_.input=s.binstring2buf(f):b.call(f)==="[object ArrayBuffer]"?_.input=new Uint8Array(f):_.input=f,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new a.Buf8(E),_.next_out=0,_.avail_out=E),(g=i.inflate(_,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&S&&(T=typeof S=="string"?s.string2buf(S):b.call(S)==="[object ArrayBuffer]"?new Uint8Array(S):S,g=i.inflateSetDictionary(this.strm,T)),g===l.Z_BUF_ERROR&&L===!0&&(g=l.Z_OK,L=!1),g!==l.Z_STREAM_END&&g!==l.Z_OK)return this.onEnd(g),!(this.ended=!0);_.next_out&&(_.avail_out!==0&&g!==l.Z_STREAM_END&&(_.avail_in!==0||x!==l.Z_FINISH&&x!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=s.utf8border(_.output,_.next_out),w=_.next_out-k,R=s.buf2string(_.output,k),_.next_out=w,_.avail_out=E-w,w&&a.arraySet(_.output,_.output,k,w,0),this.onData(R)):this.onData(a.shrinkBuf(_.output,_.next_out)))),_.avail_in===0&&_.avail_out===0&&(L=!0)}while((0<_.avail_in||_.avail_out===0)&&g!==l.Z_STREAM_END);return g===l.Z_STREAM_END&&(x=l.Z_FINISH),x===l.Z_FINISH?(g=i.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===l.Z_OK):x!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(_.avail_out=0))},u.prototype.onData=function(f){this.chunks.push(f)},u.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},o.Inflate=u,o.inflate=y,o.inflateRaw=function(f,v){return(v=v||{}).raw=!0,y(f,v)},o.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(l){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var h=d.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var m in h)h.hasOwnProperty(m)&&(l[m]=h[m])}}return l},o.shrinkBuf=function(l,d){return l.length===d?l:l.subarray?l.subarray(0,d):(l.length=d,l)};var a={arraySet:function(l,d,h,m,b){if(d.subarray&&l.subarray)l.set(d.subarray(h,h+m),b);else for(var u=0;u<m;u++)l[b+u]=d[h+u]},flattenChunks:function(l){var d,h,m,b,u,y;for(d=m=0,h=l.length;d<h;d++)m+=l[d].length;for(y=new Uint8Array(m),d=b=0,h=l.length;d<h;d++)u=l[d],y.set(u,b),b+=u.length;return y}},s={arraySet:function(l,d,h,m,b){for(var u=0;u<m;u++)l[b+u]=d[h+u]},flattenChunks:function(l){return[].concat.apply([],l)}};o.setTyped=function(l){l?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,a)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,s))},o.setTyped(i)},{}],42:[function(e,r,o){var i=e("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new i.Buf8(256),d=0;d<256;d++)l[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function h(m,b){if(b<65537&&(m.subarray&&s||!m.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(m,b));for(var u="",y=0;y<b;y++)u+=String.fromCharCode(m[y]);return u}l[254]=l[254]=1,o.string2buf=function(m){var b,u,y,f,v,g=m.length,x=0;for(f=0;f<g;f++)(64512&(u=m.charCodeAt(f)))==55296&&f+1<g&&(64512&(y=m.charCodeAt(f+1)))==56320&&(u=65536+(u-55296<<10)+(y-56320),f++),x+=u<128?1:u<2048?2:u<65536?3:4;for(b=new i.Buf8(x),f=v=0;v<x;f++)(64512&(u=m.charCodeAt(f)))==55296&&f+1<g&&(64512&(y=m.charCodeAt(f+1)))==56320&&(u=65536+(u-55296<<10)+(y-56320),f++),u<128?b[v++]=u:(u<2048?b[v++]=192|u>>>6:(u<65536?b[v++]=224|u>>>12:(b[v++]=240|u>>>18,b[v++]=128|u>>>12&63),b[v++]=128|u>>>6&63),b[v++]=128|63&u);return b},o.buf2binstring=function(m){return h(m,m.length)},o.binstring2buf=function(m){for(var b=new i.Buf8(m.length),u=0,y=b.length;u<y;u++)b[u]=m.charCodeAt(u);return b},o.buf2string=function(m,b){var u,y,f,v,g=b||m.length,x=new Array(2*g);for(u=y=0;u<g;)if((f=m[u++])<128)x[y++]=f;else if(4<(v=l[f]))x[y++]=65533,u+=v-1;else{for(f&=v===2?31:v===3?15:7;1<v&&u<g;)f=f<<6|63&m[u++],v--;1<v?x[y++]=65533:f<65536?x[y++]=f:(f-=65536,x[y++]=55296|f>>10&1023,x[y++]=56320|1023&f)}return h(x,y)},o.utf8border=function(m,b){var u;for((b=b||m.length)>m.length&&(b=m.length),u=b-1;0<=u&&(192&m[u])==128;)u--;return u<0||u===0?b:u+l[m[u]]>b?u:b}},{"./common":41}],43:[function(e,r,o){r.exports=function(i,a,s,l){for(var d=65535&i|0,h=i>>>16&65535|0,m=0;s!==0;){for(s-=m=2e3<s?2e3:s;h=h+(d=d+a[l++]|0)|0,--m;);d%=65521,h%=65521}return d|h<<16|0}},{}],44:[function(e,r,o){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,o){var i=function(){for(var a,s=[],l=0;l<256;l++){a=l;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;s[l]=a}return s}();r.exports=function(a,s,l,d){var h=i,m=d+l;a^=-1;for(var b=d;b<m;b++)a=a>>>8^h[255&(a^s[b])];return-1^a}},{}],46:[function(e,r,o){var i,a=e("../utils/common"),s=e("./trees"),l=e("./adler32"),d=e("./crc32"),h=e("./messages"),m=0,b=4,u=0,y=-2,f=-1,v=4,g=2,x=8,k=9,w=286,R=30,T=19,_=2*w+1,E=15,S=3,L=258,U=L+S+1,A=42,C=113,c=1,F=2,Z=3,q=4;function Y(p,G){return p.msg=h[G],G}function P(p){return(p<<1)-(4<p?9:0)}function tt(p){for(var G=p.length;0<=--G;)p[G]=0}function M(p){var G=p.state,W=G.pending;W>p.avail_out&&(W=p.avail_out),W!==0&&(a.arraySet(p.output,G.pending_buf,G.pending_out,W,p.next_out),p.next_out+=W,G.pending_out+=W,p.total_out+=W,p.avail_out-=W,G.pending-=W,G.pending===0&&(G.pending_out=0))}function B(p,G){s._tr_flush_block(p,0<=p.block_start?p.block_start:-1,p.strstart-p.block_start,G),p.block_start=p.strstart,M(p.strm)}function J(p,G){p.pending_buf[p.pending++]=G}function $(p,G){p.pending_buf[p.pending++]=G>>>8&255,p.pending_buf[p.pending++]=255&G}function X(p,G){var W,D,N=p.max_chain_length,j=p.strstart,V=p.prev_length,H=p.nice_match,O=p.strstart>p.w_size-U?p.strstart-(p.w_size-U):0,K=p.window,et=p.w_mask,Q=p.prev,st=p.strstart+L,ht=K[j+V-1],ct=K[j+V];p.prev_length>=p.good_match&&(N>>=2),H>p.lookahead&&(H=p.lookahead);do if(K[(W=G)+V]===ct&&K[W+V-1]===ht&&K[W]===K[j]&&K[++W]===K[j+1]){j+=2,W++;do;while(K[++j]===K[++W]&&K[++j]===K[++W]&&K[++j]===K[++W]&&K[++j]===K[++W]&&K[++j]===K[++W]&&K[++j]===K[++W]&&K[++j]===K[++W]&&K[++j]===K[++W]&&j<st);if(D=L-(st-j),j=st-L,V<D){if(p.match_start=G,H<=(V=D))break;ht=K[j+V-1],ct=K[j+V]}}while((G=Q[G&et])>O&&--N!=0);return V<=p.lookahead?V:p.lookahead}function dt(p){var G,W,D,N,j,V,H,O,K,et,Q=p.w_size;do{if(N=p.window_size-p.lookahead-p.strstart,p.strstart>=Q+(Q-U)){for(a.arraySet(p.window,p.window,Q,Q,0),p.match_start-=Q,p.strstart-=Q,p.block_start-=Q,G=W=p.hash_size;D=p.head[--G],p.head[G]=Q<=D?D-Q:0,--W;);for(G=W=Q;D=p.prev[--G],p.prev[G]=Q<=D?D-Q:0,--W;);N+=Q}if(p.strm.avail_in===0)break;if(V=p.strm,H=p.window,O=p.strstart+p.lookahead,K=N,et=void 0,et=V.avail_in,K<et&&(et=K),W=et===0?0:(V.avail_in-=et,a.arraySet(H,V.input,V.next_in,et,O),V.state.wrap===1?V.adler=l(V.adler,H,et,O):V.state.wrap===2&&(V.adler=d(V.adler,H,et,O)),V.next_in+=et,V.total_in+=et,et),p.lookahead+=W,p.lookahead+p.insert>=S)for(j=p.strstart-p.insert,p.ins_h=p.window[j],p.ins_h=(p.ins_h<<p.hash_shift^p.window[j+1])&p.hash_mask;p.insert&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[j+S-1])&p.hash_mask,p.prev[j&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=j,j++,p.insert--,!(p.lookahead+p.insert<S)););}while(p.lookahead<U&&p.strm.avail_in!==0)}function lt(p,G){for(var W,D;;){if(p.lookahead<U){if(dt(p),p.lookahead<U&&G===m)return c;if(p.lookahead===0)break}if(W=0,p.lookahead>=S&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+S-1])&p.hash_mask,W=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),W!==0&&p.strstart-W<=p.w_size-U&&(p.match_length=X(p,W)),p.match_length>=S)if(D=s._tr_tally(p,p.strstart-p.match_start,p.match_length-S),p.lookahead-=p.match_length,p.match_length<=p.max_lazy_match&&p.lookahead>=S){for(p.match_length--;p.strstart++,p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+S-1])&p.hash_mask,W=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart,--p.match_length!=0;);p.strstart++}else p.strstart+=p.match_length,p.match_length=0,p.ins_h=p.window[p.strstart],p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+1])&p.hash_mask;else D=s._tr_tally(p,0,p.window[p.strstart]),p.lookahead--,p.strstart++;if(D&&(B(p,!1),p.strm.avail_out===0))return c}return p.insert=p.strstart<S-1?p.strstart:S-1,G===b?(B(p,!0),p.strm.avail_out===0?Z:q):p.last_lit&&(B(p,!1),p.strm.avail_out===0)?c:F}function it(p,G){for(var W,D,N;;){if(p.lookahead<U){if(dt(p),p.lookahead<U&&G===m)return c;if(p.lookahead===0)break}if(W=0,p.lookahead>=S&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+S-1])&p.hash_mask,W=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),p.prev_length=p.match_length,p.prev_match=p.match_start,p.match_length=S-1,W!==0&&p.prev_length<p.max_lazy_match&&p.strstart-W<=p.w_size-U&&(p.match_length=X(p,W),p.match_length<=5&&(p.strategy===1||p.match_length===S&&4096<p.strstart-p.match_start)&&(p.match_length=S-1)),p.prev_length>=S&&p.match_length<=p.prev_length){for(N=p.strstart+p.lookahead-S,D=s._tr_tally(p,p.strstart-1-p.prev_match,p.prev_length-S),p.lookahead-=p.prev_length-1,p.prev_length-=2;++p.strstart<=N&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+S-1])&p.hash_mask,W=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),--p.prev_length!=0;);if(p.match_available=0,p.match_length=S-1,p.strstart++,D&&(B(p,!1),p.strm.avail_out===0))return c}else if(p.match_available){if((D=s._tr_tally(p,0,p.window[p.strstart-1]))&&B(p,!1),p.strstart++,p.lookahead--,p.strm.avail_out===0)return c}else p.match_available=1,p.strstart++,p.lookahead--}return p.match_available&&(D=s._tr_tally(p,0,p.window[p.strstart-1]),p.match_available=0),p.insert=p.strstart<S-1?p.strstart:S-1,G===b?(B(p,!0),p.strm.avail_out===0?Z:q):p.last_lit&&(B(p,!1),p.strm.avail_out===0)?c:F}function at(p,G,W,D,N){this.good_length=p,this.max_lazy=G,this.nice_length=W,this.max_chain=D,this.func=N}function ot(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*_),this.dyn_dtree=new a.Buf16(2*(2*R+1)),this.bl_tree=new a.Buf16(2*(2*T+1)),tt(this.dyn_ltree),tt(this.dyn_dtree),tt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(E+1),this.heap=new a.Buf16(2*w+1),tt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*w+1),tt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pt(p){var G;return p&&p.state?(p.total_in=p.total_out=0,p.data_type=g,(G=p.state).pending=0,G.pending_out=0,G.wrap<0&&(G.wrap=-G.wrap),G.status=G.wrap?A:C,p.adler=G.wrap===2?0:1,G.last_flush=m,s._tr_init(G),u):Y(p,y)}function gt(p){var G=pt(p);return G===u&&function(W){W.window_size=2*W.w_size,tt(W.head),W.max_lazy_match=i[W.level].max_lazy,W.good_match=i[W.level].good_length,W.nice_match=i[W.level].nice_length,W.max_chain_length=i[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=S-1,W.match_available=0,W.ins_h=0}(p.state),G}function Et(p,G,W,D,N,j){if(!p)return y;var V=1;if(G===f&&(G=6),D<0?(V=0,D=-D):15<D&&(V=2,D-=16),N<1||k<N||W!==x||D<8||15<D||G<0||9<G||j<0||v<j)return Y(p,y);D===8&&(D=9);var H=new ot;return(p.state=H).strm=p,H.wrap=V,H.gzhead=null,H.w_bits=D,H.w_size=1<<H.w_bits,H.w_mask=H.w_size-1,H.hash_bits=N+7,H.hash_size=1<<H.hash_bits,H.hash_mask=H.hash_size-1,H.hash_shift=~~((H.hash_bits+S-1)/S),H.window=new a.Buf8(2*H.w_size),H.head=new a.Buf16(H.hash_size),H.prev=new a.Buf16(H.w_size),H.lit_bufsize=1<<N+6,H.pending_buf_size=4*H.lit_bufsize,H.pending_buf=new a.Buf8(H.pending_buf_size),H.d_buf=1*H.lit_bufsize,H.l_buf=3*H.lit_bufsize,H.level=G,H.strategy=j,H.method=W,gt(p)}i=[new at(0,0,0,0,function(p,G){var W=65535;for(W>p.pending_buf_size-5&&(W=p.pending_buf_size-5);;){if(p.lookahead<=1){if(dt(p),p.lookahead===0&&G===m)return c;if(p.lookahead===0)break}p.strstart+=p.lookahead,p.lookahead=0;var D=p.block_start+W;if((p.strstart===0||p.strstart>=D)&&(p.lookahead=p.strstart-D,p.strstart=D,B(p,!1),p.strm.avail_out===0)||p.strstart-p.block_start>=p.w_size-U&&(B(p,!1),p.strm.avail_out===0))return c}return p.insert=0,G===b?(B(p,!0),p.strm.avail_out===0?Z:q):(p.strstart>p.block_start&&(B(p,!1),p.strm.avail_out),c)}),new at(4,4,8,4,lt),new at(4,5,16,8,lt),new at(4,6,32,32,lt),new at(4,4,16,16,it),new at(8,16,32,32,it),new at(8,16,128,128,it),new at(8,32,128,256,it),new at(32,128,258,1024,it),new at(32,258,258,4096,it)],o.deflateInit=function(p,G){return Et(p,G,x,15,8,0)},o.deflateInit2=Et,o.deflateReset=gt,o.deflateResetKeep=pt,o.deflateSetHeader=function(p,G){return p&&p.state?p.state.wrap!==2?y:(p.state.gzhead=G,u):y},o.deflate=function(p,G){var W,D,N,j;if(!p||!p.state||5<G||G<0)return p?Y(p,y):y;if(D=p.state,!p.output||!p.input&&p.avail_in!==0||D.status===666&&G!==b)return Y(p,p.avail_out===0?-5:y);if(D.strm=p,W=D.last_flush,D.last_flush=G,D.status===A)if(D.wrap===2)p.adler=0,J(D,31),J(D,139),J(D,8),D.gzhead?(J(D,(D.gzhead.text?1:0)+(D.gzhead.hcrc?2:0)+(D.gzhead.extra?4:0)+(D.gzhead.name?8:0)+(D.gzhead.comment?16:0)),J(D,255&D.gzhead.time),J(D,D.gzhead.time>>8&255),J(D,D.gzhead.time>>16&255),J(D,D.gzhead.time>>24&255),J(D,D.level===9?2:2<=D.strategy||D.level<2?4:0),J(D,255&D.gzhead.os),D.gzhead.extra&&D.gzhead.extra.length&&(J(D,255&D.gzhead.extra.length),J(D,D.gzhead.extra.length>>8&255)),D.gzhead.hcrc&&(p.adler=d(p.adler,D.pending_buf,D.pending,0)),D.gzindex=0,D.status=69):(J(D,0),J(D,0),J(D,0),J(D,0),J(D,0),J(D,D.level===9?2:2<=D.strategy||D.level<2?4:0),J(D,3),D.status=C);else{var V=x+(D.w_bits-8<<4)<<8;V|=(2<=D.strategy||D.level<2?0:D.level<6?1:D.level===6?2:3)<<6,D.strstart!==0&&(V|=32),V+=31-V%31,D.status=C,$(D,V),D.strstart!==0&&($(D,p.adler>>>16),$(D,65535&p.adler)),p.adler=1}if(D.status===69)if(D.gzhead.extra){for(N=D.pending;D.gzindex<(65535&D.gzhead.extra.length)&&(D.pending!==D.pending_buf_size||(D.gzhead.hcrc&&D.pending>N&&(p.adler=d(p.adler,D.pending_buf,D.pending-N,N)),M(p),N=D.pending,D.pending!==D.pending_buf_size));)J(D,255&D.gzhead.extra[D.gzindex]),D.gzindex++;D.gzhead.hcrc&&D.pending>N&&(p.adler=d(p.adler,D.pending_buf,D.pending-N,N)),D.gzindex===D.gzhead.extra.length&&(D.gzindex=0,D.status=73)}else D.status=73;if(D.status===73)if(D.gzhead.name){N=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>N&&(p.adler=d(p.adler,D.pending_buf,D.pending-N,N)),M(p),N=D.pending,D.pending===D.pending_buf_size)){j=1;break}j=D.gzindex<D.gzhead.name.length?255&D.gzhead.name.charCodeAt(D.gzindex++):0,J(D,j)}while(j!==0);D.gzhead.hcrc&&D.pending>N&&(p.adler=d(p.adler,D.pending_buf,D.pending-N,N)),j===0&&(D.gzindex=0,D.status=91)}else D.status=91;if(D.status===91)if(D.gzhead.comment){N=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>N&&(p.adler=d(p.adler,D.pending_buf,D.pending-N,N)),M(p),N=D.pending,D.pending===D.pending_buf_size)){j=1;break}j=D.gzindex<D.gzhead.comment.length?255&D.gzhead.comment.charCodeAt(D.gzindex++):0,J(D,j)}while(j!==0);D.gzhead.hcrc&&D.pending>N&&(p.adler=d(p.adler,D.pending_buf,D.pending-N,N)),j===0&&(D.status=103)}else D.status=103;if(D.status===103&&(D.gzhead.hcrc?(D.pending+2>D.pending_buf_size&&M(p),D.pending+2<=D.pending_buf_size&&(J(D,255&p.adler),J(D,p.adler>>8&255),p.adler=0,D.status=C)):D.status=C),D.pending!==0){if(M(p),p.avail_out===0)return D.last_flush=-1,u}else if(p.avail_in===0&&P(G)<=P(W)&&G!==b)return Y(p,-5);if(D.status===666&&p.avail_in!==0)return Y(p,-5);if(p.avail_in!==0||D.lookahead!==0||G!==m&&D.status!==666){var H=D.strategy===2?function(O,K){for(var et;;){if(O.lookahead===0&&(dt(O),O.lookahead===0)){if(K===m)return c;break}if(O.match_length=0,et=s._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++,et&&(B(O,!1),O.strm.avail_out===0))return c}return O.insert=0,K===b?(B(O,!0),O.strm.avail_out===0?Z:q):O.last_lit&&(B(O,!1),O.strm.avail_out===0)?c:F}(D,G):D.strategy===3?function(O,K){for(var et,Q,st,ht,ct=O.window;;){if(O.lookahead<=L){if(dt(O),O.lookahead<=L&&K===m)return c;if(O.lookahead===0)break}if(O.match_length=0,O.lookahead>=S&&0<O.strstart&&(Q=ct[st=O.strstart-1])===ct[++st]&&Q===ct[++st]&&Q===ct[++st]){ht=O.strstart+L;do;while(Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&Q===ct[++st]&&st<ht);O.match_length=L-(ht-st),O.match_length>O.lookahead&&(O.match_length=O.lookahead)}if(O.match_length>=S?(et=s._tr_tally(O,1,O.match_length-S),O.lookahead-=O.match_length,O.strstart+=O.match_length,O.match_length=0):(et=s._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++),et&&(B(O,!1),O.strm.avail_out===0))return c}return O.insert=0,K===b?(B(O,!0),O.strm.avail_out===0?Z:q):O.last_lit&&(B(O,!1),O.strm.avail_out===0)?c:F}(D,G):i[D.level].func(D,G);if(H!==Z&&H!==q||(D.status=666),H===c||H===Z)return p.avail_out===0&&(D.last_flush=-1),u;if(H===F&&(G===1?s._tr_align(D):G!==5&&(s._tr_stored_block(D,0,0,!1),G===3&&(tt(D.head),D.lookahead===0&&(D.strstart=0,D.block_start=0,D.insert=0))),M(p),p.avail_out===0))return D.last_flush=-1,u}return G!==b?u:D.wrap<=0?1:(D.wrap===2?(J(D,255&p.adler),J(D,p.adler>>8&255),J(D,p.adler>>16&255),J(D,p.adler>>24&255),J(D,255&p.total_in),J(D,p.total_in>>8&255),J(D,p.total_in>>16&255),J(D,p.total_in>>24&255)):($(D,p.adler>>>16),$(D,65535&p.adler)),M(p),0<D.wrap&&(D.wrap=-D.wrap),D.pending!==0?u:1)},o.deflateEnd=function(p){var G;return p&&p.state?(G=p.state.status)!==A&&G!==69&&G!==73&&G!==91&&G!==103&&G!==C&&G!==666?Y(p,y):(p.state=null,G===C?Y(p,-3):u):y},o.deflateSetDictionary=function(p,G){var W,D,N,j,V,H,O,K,et=G.length;if(!p||!p.state||(j=(W=p.state).wrap)===2||j===1&&W.status!==A||W.lookahead)return y;for(j===1&&(p.adler=l(p.adler,G,et,0)),W.wrap=0,et>=W.w_size&&(j===0&&(tt(W.head),W.strstart=0,W.block_start=0,W.insert=0),K=new a.Buf8(W.w_size),a.arraySet(K,G,et-W.w_size,W.w_size,0),G=K,et=W.w_size),V=p.avail_in,H=p.next_in,O=p.input,p.avail_in=et,p.next_in=0,p.input=G,dt(W);W.lookahead>=S;){for(D=W.strstart,N=W.lookahead-(S-1);W.ins_h=(W.ins_h<<W.hash_shift^W.window[D+S-1])&W.hash_mask,W.prev[D&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=D,D++,--N;);W.strstart=D,W.lookahead=S-1,dt(W)}return W.strstart+=W.lookahead,W.block_start=W.strstart,W.insert=W.lookahead,W.lookahead=0,W.match_length=W.prev_length=S-1,W.match_available=0,p.next_in=H,p.input=O,p.avail_in=V,W.wrap=j,u},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,o){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,o){r.exports=function(i,a){var s,l,d,h,m,b,u,y,f,v,g,x,k,w,R,T,_,E,S,L,U,A,C,c,F;s=i.state,l=i.next_in,c=i.input,d=l+(i.avail_in-5),h=i.next_out,F=i.output,m=h-(a-i.avail_out),b=h+(i.avail_out-257),u=s.dmax,y=s.wsize,f=s.whave,v=s.wnext,g=s.window,x=s.hold,k=s.bits,w=s.lencode,R=s.distcode,T=(1<<s.lenbits)-1,_=(1<<s.distbits)-1;t:do{k<15&&(x+=c[l++]<<k,k+=8,x+=c[l++]<<k,k+=8),E=w[x&T];e:for(;;){if(x>>>=S=E>>>24,k-=S,(S=E>>>16&255)===0)F[h++]=65535&E;else{if(!(16&S)){if((64&S)==0){E=w[(65535&E)+(x&(1<<S)-1)];continue e}if(32&S){s.mode=12;break t}i.msg="invalid literal/length code",s.mode=30;break t}L=65535&E,(S&=15)&&(k<S&&(x+=c[l++]<<k,k+=8),L+=x&(1<<S)-1,x>>>=S,k-=S),k<15&&(x+=c[l++]<<k,k+=8,x+=c[l++]<<k,k+=8),E=R[x&_];n:for(;;){if(x>>>=S=E>>>24,k-=S,!(16&(S=E>>>16&255))){if((64&S)==0){E=R[(65535&E)+(x&(1<<S)-1)];continue n}i.msg="invalid distance code",s.mode=30;break t}if(U=65535&E,k<(S&=15)&&(x+=c[l++]<<k,(k+=8)<S&&(x+=c[l++]<<k,k+=8)),u<(U+=x&(1<<S)-1)){i.msg="invalid distance too far back",s.mode=30;break t}if(x>>>=S,k-=S,(S=h-m)<U){if(f<(S=U-S)&&s.sane){i.msg="invalid distance too far back",s.mode=30;break t}if(C=g,(A=0)===v){if(A+=y-S,S<L){for(L-=S;F[h++]=g[A++],--S;);A=h-U,C=F}}else if(v<S){if(A+=y+v-S,(S-=v)<L){for(L-=S;F[h++]=g[A++],--S;);if(A=0,v<L){for(L-=S=v;F[h++]=g[A++],--S;);A=h-U,C=F}}}else if(A+=v-S,S<L){for(L-=S;F[h++]=g[A++],--S;);A=h-U,C=F}for(;2<L;)F[h++]=C[A++],F[h++]=C[A++],F[h++]=C[A++],L-=3;L&&(F[h++]=C[A++],1<L&&(F[h++]=C[A++]))}else{for(A=h-U;F[h++]=F[A++],F[h++]=F[A++],F[h++]=F[A++],2<(L-=3););L&&(F[h++]=F[A++],1<L&&(F[h++]=F[A++]))}break}}break}}while(l<d&&h<b);l-=L=k>>3,x&=(1<<(k-=L<<3))-1,i.next_in=l,i.next_out=h,i.avail_in=l<d?d-l+5:5-(l-d),i.avail_out=h<b?b-h+257:257-(h-b),s.hold=x,s.bits=k}},{}],49:[function(e,r,o){var i=e("../utils/common"),a=e("./adler32"),s=e("./crc32"),l=e("./inffast"),d=e("./inftrees"),h=1,m=2,b=0,u=-2,y=1,f=852,v=592;function g(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(A){var C;return A&&A.state?(C=A.state,A.total_in=A.total_out=C.total=0,A.msg="",C.wrap&&(A.adler=1&C.wrap),C.mode=y,C.last=0,C.havedict=0,C.dmax=32768,C.head=null,C.hold=0,C.bits=0,C.lencode=C.lendyn=new i.Buf32(f),C.distcode=C.distdyn=new i.Buf32(v),C.sane=1,C.back=-1,b):u}function w(A){var C;return A&&A.state?((C=A.state).wsize=0,C.whave=0,C.wnext=0,k(A)):u}function R(A,C){var c,F;return A&&A.state?(F=A.state,C<0?(c=0,C=-C):(c=1+(C>>4),C<48&&(C&=15)),C&&(C<8||15<C)?u:(F.window!==null&&F.wbits!==C&&(F.window=null),F.wrap=c,F.wbits=C,w(A))):u}function T(A,C){var c,F;return A?(F=new x,(A.state=F).window=null,(c=R(A,C))!==b&&(A.state=null),c):u}var _,E,S=!0;function L(A){if(S){var C;for(_=new i.Buf32(512),E=new i.Buf32(32),C=0;C<144;)A.lens[C++]=8;for(;C<256;)A.lens[C++]=9;for(;C<280;)A.lens[C++]=7;for(;C<288;)A.lens[C++]=8;for(d(h,A.lens,0,288,_,0,A.work,{bits:9}),C=0;C<32;)A.lens[C++]=5;d(m,A.lens,0,32,E,0,A.work,{bits:5}),S=!1}A.lencode=_,A.lenbits=9,A.distcode=E,A.distbits=5}function U(A,C,c,F){var Z,q=A.state;return q.window===null&&(q.wsize=1<<q.wbits,q.wnext=0,q.whave=0,q.window=new i.Buf8(q.wsize)),F>=q.wsize?(i.arraySet(q.window,C,c-q.wsize,q.wsize,0),q.wnext=0,q.whave=q.wsize):(F<(Z=q.wsize-q.wnext)&&(Z=F),i.arraySet(q.window,C,c-F,Z,q.wnext),(F-=Z)?(i.arraySet(q.window,C,c-F,F,0),q.wnext=F,q.whave=q.wsize):(q.wnext+=Z,q.wnext===q.wsize&&(q.wnext=0),q.whave<q.wsize&&(q.whave+=Z))),0}o.inflateReset=w,o.inflateReset2=R,o.inflateResetKeep=k,o.inflateInit=function(A){return T(A,15)},o.inflateInit2=T,o.inflate=function(A,C){var c,F,Z,q,Y,P,tt,M,B,J,$,X,dt,lt,it,at,ot,pt,gt,Et,p,G,W,D,N=0,j=new i.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&A.avail_in!==0)return u;(c=A.state).mode===12&&(c.mode=13),Y=A.next_out,Z=A.output,tt=A.avail_out,q=A.next_in,F=A.input,P=A.avail_in,M=c.hold,B=c.bits,J=P,$=tt,G=b;t:for(;;)switch(c.mode){case y:if(c.wrap===0){c.mode=13;break}for(;B<16;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}if(2&c.wrap&&M===35615){j[c.check=0]=255&M,j[1]=M>>>8&255,c.check=s(c.check,j,2,0),B=M=0,c.mode=2;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&M)<<8)+(M>>8))%31){A.msg="incorrect header check",c.mode=30;break}if((15&M)!=8){A.msg="unknown compression method",c.mode=30;break}if(B-=4,p=8+(15&(M>>>=4)),c.wbits===0)c.wbits=p;else if(p>c.wbits){A.msg="invalid window size",c.mode=30;break}c.dmax=1<<p,A.adler=c.check=1,c.mode=512&M?10:12,B=M=0;break;case 2:for(;B<16;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}if(c.flags=M,(255&c.flags)!=8){A.msg="unknown compression method",c.mode=30;break}if(57344&c.flags){A.msg="unknown header flags set",c.mode=30;break}c.head&&(c.head.text=M>>8&1),512&c.flags&&(j[0]=255&M,j[1]=M>>>8&255,c.check=s(c.check,j,2,0)),B=M=0,c.mode=3;case 3:for(;B<32;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}c.head&&(c.head.time=M),512&c.flags&&(j[0]=255&M,j[1]=M>>>8&255,j[2]=M>>>16&255,j[3]=M>>>24&255,c.check=s(c.check,j,4,0)),B=M=0,c.mode=4;case 4:for(;B<16;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}c.head&&(c.head.xflags=255&M,c.head.os=M>>8),512&c.flags&&(j[0]=255&M,j[1]=M>>>8&255,c.check=s(c.check,j,2,0)),B=M=0,c.mode=5;case 5:if(1024&c.flags){for(;B<16;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}c.length=M,c.head&&(c.head.extra_len=M),512&c.flags&&(j[0]=255&M,j[1]=M>>>8&255,c.check=s(c.check,j,2,0)),B=M=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(1024&c.flags&&(P<(X=c.length)&&(X=P),X&&(c.head&&(p=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),i.arraySet(c.head.extra,F,q,X,p)),512&c.flags&&(c.check=s(c.check,F,X,q)),P-=X,q+=X,c.length-=X),c.length))break t;c.length=0,c.mode=7;case 7:if(2048&c.flags){if(P===0)break t;for(X=0;p=F[q+X++],c.head&&p&&c.length<65536&&(c.head.name+=String.fromCharCode(p)),p&&X<P;);if(512&c.flags&&(c.check=s(c.check,F,X,q)),P-=X,q+=X,p)break t}else c.head&&(c.head.name=null);c.length=0,c.mode=8;case 8:if(4096&c.flags){if(P===0)break t;for(X=0;p=F[q+X++],c.head&&p&&c.length<65536&&(c.head.comment+=String.fromCharCode(p)),p&&X<P;);if(512&c.flags&&(c.check=s(c.check,F,X,q)),P-=X,q+=X,p)break t}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(512&c.flags){for(;B<16;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}if(M!==(65535&c.check)){A.msg="header crc mismatch",c.mode=30;break}B=M=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),A.adler=c.check=0,c.mode=12;break;case 10:for(;B<32;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}A.adler=c.check=g(M),B=M=0,c.mode=11;case 11:if(c.havedict===0)return A.next_out=Y,A.avail_out=tt,A.next_in=q,A.avail_in=P,c.hold=M,c.bits=B,2;A.adler=c.check=1,c.mode=12;case 12:if(C===5||C===6)break t;case 13:if(c.last){M>>>=7&B,B-=7&B,c.mode=27;break}for(;B<3;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}switch(c.last=1&M,B-=1,3&(M>>>=1)){case 0:c.mode=14;break;case 1:if(L(c),c.mode=20,C!==6)break;M>>>=2,B-=2;break t;case 2:c.mode=17;break;case 3:A.msg="invalid block type",c.mode=30}M>>>=2,B-=2;break;case 14:for(M>>>=7&B,B-=7&B;B<32;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}if((65535&M)!=(M>>>16^65535)){A.msg="invalid stored block lengths",c.mode=30;break}if(c.length=65535&M,B=M=0,c.mode=15,C===6)break t;case 15:c.mode=16;case 16:if(X=c.length){if(P<X&&(X=P),tt<X&&(X=tt),X===0)break t;i.arraySet(Z,F,q,X,Y),P-=X,q+=X,tt-=X,Y+=X,c.length-=X;break}c.mode=12;break;case 17:for(;B<14;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}if(c.nlen=257+(31&M),M>>>=5,B-=5,c.ndist=1+(31&M),M>>>=5,B-=5,c.ncode=4+(15&M),M>>>=4,B-=4,286<c.nlen||30<c.ndist){A.msg="too many length or distance symbols",c.mode=30;break}c.have=0,c.mode=18;case 18:for(;c.have<c.ncode;){for(;B<3;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}c.lens[V[c.have++]]=7&M,M>>>=3,B-=3}for(;c.have<19;)c.lens[V[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,W={bits:c.lenbits},G=d(0,c.lens,0,19,c.lencode,0,c.work,W),c.lenbits=W.bits,G){A.msg="invalid code lengths set",c.mode=30;break}c.have=0,c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;at=(N=c.lencode[M&(1<<c.lenbits)-1])>>>16&255,ot=65535&N,!((it=N>>>24)<=B);){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}if(ot<16)M>>>=it,B-=it,c.lens[c.have++]=ot;else{if(ot===16){for(D=it+2;B<D;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}if(M>>>=it,B-=it,c.have===0){A.msg="invalid bit length repeat",c.mode=30;break}p=c.lens[c.have-1],X=3+(3&M),M>>>=2,B-=2}else if(ot===17){for(D=it+3;B<D;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}B-=it,p=0,X=3+(7&(M>>>=it)),M>>>=3,B-=3}else{for(D=it+7;B<D;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}B-=it,p=0,X=11+(127&(M>>>=it)),M>>>=7,B-=7}if(c.have+X>c.nlen+c.ndist){A.msg="invalid bit length repeat",c.mode=30;break}for(;X--;)c.lens[c.have++]=p}}if(c.mode===30)break;if(c.lens[256]===0){A.msg="invalid code -- missing end-of-block",c.mode=30;break}if(c.lenbits=9,W={bits:c.lenbits},G=d(h,c.lens,0,c.nlen,c.lencode,0,c.work,W),c.lenbits=W.bits,G){A.msg="invalid literal/lengths set",c.mode=30;break}if(c.distbits=6,c.distcode=c.distdyn,W={bits:c.distbits},G=d(m,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,W),c.distbits=W.bits,G){A.msg="invalid distances set",c.mode=30;break}if(c.mode=20,C===6)break t;case 20:c.mode=21;case 21:if(6<=P&&258<=tt){A.next_out=Y,A.avail_out=tt,A.next_in=q,A.avail_in=P,c.hold=M,c.bits=B,l(A,$),Y=A.next_out,Z=A.output,tt=A.avail_out,q=A.next_in,F=A.input,P=A.avail_in,M=c.hold,B=c.bits,c.mode===12&&(c.back=-1);break}for(c.back=0;at=(N=c.lencode[M&(1<<c.lenbits)-1])>>>16&255,ot=65535&N,!((it=N>>>24)<=B);){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}if(at&&(240&at)==0){for(pt=it,gt=at,Et=ot;at=(N=c.lencode[Et+((M&(1<<pt+gt)-1)>>pt)])>>>16&255,ot=65535&N,!(pt+(it=N>>>24)<=B);){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}M>>>=pt,B-=pt,c.back+=pt}if(M>>>=it,B-=it,c.back+=it,c.length=ot,at===0){c.mode=26;break}if(32&at){c.back=-1,c.mode=12;break}if(64&at){A.msg="invalid literal/length code",c.mode=30;break}c.extra=15&at,c.mode=22;case 22:if(c.extra){for(D=c.extra;B<D;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}c.length+=M&(1<<c.extra)-1,M>>>=c.extra,B-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=23;case 23:for(;at=(N=c.distcode[M&(1<<c.distbits)-1])>>>16&255,ot=65535&N,!((it=N>>>24)<=B);){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}if((240&at)==0){for(pt=it,gt=at,Et=ot;at=(N=c.distcode[Et+((M&(1<<pt+gt)-1)>>pt)])>>>16&255,ot=65535&N,!(pt+(it=N>>>24)<=B);){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}M>>>=pt,B-=pt,c.back+=pt}if(M>>>=it,B-=it,c.back+=it,64&at){A.msg="invalid distance code",c.mode=30;break}c.offset=ot,c.extra=15&at,c.mode=24;case 24:if(c.extra){for(D=c.extra;B<D;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}c.offset+=M&(1<<c.extra)-1,M>>>=c.extra,B-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){A.msg="invalid distance too far back",c.mode=30;break}c.mode=25;case 25:if(tt===0)break t;if(X=$-tt,c.offset>X){if((X=c.offset-X)>c.whave&&c.sane){A.msg="invalid distance too far back",c.mode=30;break}dt=X>c.wnext?(X-=c.wnext,c.wsize-X):c.wnext-X,X>c.length&&(X=c.length),lt=c.window}else lt=Z,dt=Y-c.offset,X=c.length;for(tt<X&&(X=tt),tt-=X,c.length-=X;Z[Y++]=lt[dt++],--X;);c.length===0&&(c.mode=21);break;case 26:if(tt===0)break t;Z[Y++]=c.length,tt--,c.mode=21;break;case 27:if(c.wrap){for(;B<32;){if(P===0)break t;P--,M|=F[q++]<<B,B+=8}if($-=tt,A.total_out+=$,c.total+=$,$&&(A.adler=c.check=c.flags?s(c.check,Z,$,Y-$):a(c.check,Z,$,Y-$)),$=tt,(c.flags?M:g(M))!==c.check){A.msg="incorrect data check",c.mode=30;break}B=M=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;B<32;){if(P===0)break t;P--,M+=F[q++]<<B,B+=8}if(M!==(4294967295&c.total)){A.msg="incorrect length check",c.mode=30;break}B=M=0}c.mode=29;case 29:G=1;break t;case 30:G=-3;break t;case 31:return-4;case 32:default:return u}return A.next_out=Y,A.avail_out=tt,A.next_in=q,A.avail_in=P,c.hold=M,c.bits=B,(c.wsize||$!==A.avail_out&&c.mode<30&&(c.mode<27||C!==4))&&U(A,A.output,A.next_out,$-A.avail_out)?(c.mode=31,-4):(J-=A.avail_in,$-=A.avail_out,A.total_in+=J,A.total_out+=$,c.total+=$,c.wrap&&$&&(A.adler=c.check=c.flags?s(c.check,Z,$,A.next_out-$):a(c.check,Z,$,A.next_out-$)),A.data_type=c.bits+(c.last?64:0)+(c.mode===12?128:0)+(c.mode===20||c.mode===15?256:0),(J==0&&$===0||C===4)&&G===b&&(G=-5),G)},o.inflateEnd=function(A){if(!A||!A.state)return u;var C=A.state;return C.window&&(C.window=null),A.state=null,b},o.inflateGetHeader=function(A,C){var c;return A&&A.state?(2&(c=A.state).wrap)==0?u:((c.head=C).done=!1,b):u},o.inflateSetDictionary=function(A,C){var c,F=C.length;return A&&A.state?(c=A.state).wrap!==0&&c.mode!==11?u:c.mode===11&&a(1,C,F,0)!==c.check?-3:U(A,C,F,F)?(c.mode=31,-4):(c.havedict=1,b):u},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,o){var i=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(h,m,b,u,y,f,v,g){var x,k,w,R,T,_,E,S,L,U=g.bits,A=0,C=0,c=0,F=0,Z=0,q=0,Y=0,P=0,tt=0,M=0,B=null,J=0,$=new i.Buf16(16),X=new i.Buf16(16),dt=null,lt=0;for(A=0;A<=15;A++)$[A]=0;for(C=0;C<u;C++)$[m[b+C]]++;for(Z=U,F=15;1<=F&&$[F]===0;F--);if(F<Z&&(Z=F),F===0)return y[f++]=20971520,y[f++]=20971520,g.bits=1,0;for(c=1;c<F&&$[c]===0;c++);for(Z<c&&(Z=c),A=P=1;A<=15;A++)if(P<<=1,(P-=$[A])<0)return-1;if(0<P&&(h===0||F!==1))return-1;for(X[1]=0,A=1;A<15;A++)X[A+1]=X[A]+$[A];for(C=0;C<u;C++)m[b+C]!==0&&(v[X[m[b+C]]++]=C);if(_=h===0?(B=dt=v,19):h===1?(B=a,J-=257,dt=s,lt-=257,256):(B=l,dt=d,-1),A=c,T=f,Y=C=M=0,w=-1,R=(tt=1<<(q=Z))-1,h===1&&852<tt||h===2&&592<tt)return 1;for(;;){for(E=A-Y,L=v[C]<_?(S=0,v[C]):v[C]>_?(S=dt[lt+v[C]],B[J+v[C]]):(S=96,0),x=1<<A-Y,c=k=1<<q;y[T+(M>>Y)+(k-=x)]=E<<24|S<<16|L|0,k!==0;);for(x=1<<A-1;M&x;)x>>=1;if(x!==0?(M&=x-1,M+=x):M=0,C++,--$[A]==0){if(A===F)break;A=m[b+v[C]]}if(Z<A&&(M&R)!==w){for(Y===0&&(Y=Z),T+=c,P=1<<(q=A-Y);q+Y<F&&!((P-=$[q+Y])<=0);)q++,P<<=1;if(tt+=1<<q,h===1&&852<tt||h===2&&592<tt)return 1;y[w=M&R]=Z<<24|q<<16|T-f|0}}return M!==0&&(y[T+M]=A-Y<<24|64<<16|0),g.bits=Z,0}},{"../utils/common":41}],51:[function(e,r,o){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,o){var i=e("../utils/common"),a=0,s=1;function l(N){for(var j=N.length;0<=--j;)N[j]=0}var d=0,h=29,m=256,b=m+1+h,u=30,y=19,f=2*b+1,v=15,g=16,x=7,k=256,w=16,R=17,T=18,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],E=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=new Array(2*(b+2));l(U);var A=new Array(2*u);l(A);var C=new Array(512);l(C);var c=new Array(256);l(c);var F=new Array(h);l(F);var Z,q,Y,P=new Array(u);function tt(N,j,V,H,O){this.static_tree=N,this.extra_bits=j,this.extra_base=V,this.elems=H,this.max_length=O,this.has_stree=N&&N.length}function M(N,j){this.dyn_tree=N,this.max_code=0,this.stat_desc=j}function B(N){return N<256?C[N]:C[256+(N>>>7)]}function J(N,j){N.pending_buf[N.pending++]=255&j,N.pending_buf[N.pending++]=j>>>8&255}function $(N,j,V){N.bi_valid>g-V?(N.bi_buf|=j<<N.bi_valid&65535,J(N,N.bi_buf),N.bi_buf=j>>g-N.bi_valid,N.bi_valid+=V-g):(N.bi_buf|=j<<N.bi_valid&65535,N.bi_valid+=V)}function X(N,j,V){$(N,V[2*j],V[2*j+1])}function dt(N,j){for(var V=0;V|=1&N,N>>>=1,V<<=1,0<--j;);return V>>>1}function lt(N,j,V){var H,O,K=new Array(v+1),et=0;for(H=1;H<=v;H++)K[H]=et=et+V[H-1]<<1;for(O=0;O<=j;O++){var Q=N[2*O+1];Q!==0&&(N[2*O]=dt(K[Q]++,Q))}}function it(N){var j;for(j=0;j<b;j++)N.dyn_ltree[2*j]=0;for(j=0;j<u;j++)N.dyn_dtree[2*j]=0;for(j=0;j<y;j++)N.bl_tree[2*j]=0;N.dyn_ltree[2*k]=1,N.opt_len=N.static_len=0,N.last_lit=N.matches=0}function at(N){8<N.bi_valid?J(N,N.bi_buf):0<N.bi_valid&&(N.pending_buf[N.pending++]=N.bi_buf),N.bi_buf=0,N.bi_valid=0}function ot(N,j,V,H){var O=2*j,K=2*V;return N[O]<N[K]||N[O]===N[K]&&H[j]<=H[V]}function pt(N,j,V){for(var H=N.heap[V],O=V<<1;O<=N.heap_len&&(O<N.heap_len&&ot(j,N.heap[O+1],N.heap[O],N.depth)&&O++,!ot(j,H,N.heap[O],N.depth));)N.heap[V]=N.heap[O],V=O,O<<=1;N.heap[V]=H}function gt(N,j,V){var H,O,K,et,Q=0;if(N.last_lit!==0)for(;H=N.pending_buf[N.d_buf+2*Q]<<8|N.pending_buf[N.d_buf+2*Q+1],O=N.pending_buf[N.l_buf+Q],Q++,H===0?X(N,O,j):(X(N,(K=c[O])+m+1,j),(et=_[K])!==0&&$(N,O-=F[K],et),X(N,K=B(--H),V),(et=E[K])!==0&&$(N,H-=P[K],et)),Q<N.last_lit;);X(N,k,j)}function Et(N,j){var V,H,O,K=j.dyn_tree,et=j.stat_desc.static_tree,Q=j.stat_desc.has_stree,st=j.stat_desc.elems,ht=-1;for(N.heap_len=0,N.heap_max=f,V=0;V<st;V++)K[2*V]!==0?(N.heap[++N.heap_len]=ht=V,N.depth[V]=0):K[2*V+1]=0;for(;N.heap_len<2;)K[2*(O=N.heap[++N.heap_len]=ht<2?++ht:0)]=1,N.depth[O]=0,N.opt_len--,Q&&(N.static_len-=et[2*O+1]);for(j.max_code=ht,V=N.heap_len>>1;1<=V;V--)pt(N,K,V);for(O=st;V=N.heap[1],N.heap[1]=N.heap[N.heap_len--],pt(N,K,1),H=N.heap[1],N.heap[--N.heap_max]=V,N.heap[--N.heap_max]=H,K[2*O]=K[2*V]+K[2*H],N.depth[O]=(N.depth[V]>=N.depth[H]?N.depth[V]:N.depth[H])+1,K[2*V+1]=K[2*H+1]=O,N.heap[1]=O++,pt(N,K,1),2<=N.heap_len;);N.heap[--N.heap_max]=N.heap[1],function(ct,St){var Ht,_t,Zt,yt,oe,ee,Lt=St.dyn_tree,ze=St.max_code,je=St.stat_desc.static_tree,nn=St.stat_desc.has_stree,rn=St.stat_desc.extra_bits,Le=St.stat_desc.extra_base,wt=St.stat_desc.max_length,Rt=0;for(yt=0;yt<=v;yt++)ct.bl_count[yt]=0;for(Lt[2*ct.heap[ct.heap_max]+1]=0,Ht=ct.heap_max+1;Ht<f;Ht++)wt<(yt=Lt[2*Lt[2*(_t=ct.heap[Ht])+1]+1]+1)&&(yt=wt,Rt++),Lt[2*_t+1]=yt,ze<_t||(ct.bl_count[yt]++,oe=0,Le<=_t&&(oe=rn[_t-Le]),ee=Lt[2*_t],ct.opt_len+=ee*(yt+oe),nn&&(ct.static_len+=ee*(je[2*_t+1]+oe)));if(Rt!==0){do{for(yt=wt-1;ct.bl_count[yt]===0;)yt--;ct.bl_count[yt]--,ct.bl_count[yt+1]+=2,ct.bl_count[wt]--,Rt-=2}while(0<Rt);for(yt=wt;yt!==0;yt--)for(_t=ct.bl_count[yt];_t!==0;)ze<(Zt=ct.heap[--Ht])||(Lt[2*Zt+1]!==yt&&(ct.opt_len+=(yt-Lt[2*Zt+1])*Lt[2*Zt],Lt[2*Zt+1]=yt),_t--)}}(N,j),lt(K,ht,N.bl_count)}function p(N,j,V){var H,O,K=-1,et=j[1],Q=0,st=7,ht=4;for(et===0&&(st=138,ht=3),j[2*(V+1)+1]=65535,H=0;H<=V;H++)O=et,et=j[2*(H+1)+1],++Q<st&&O===et||(Q<ht?N.bl_tree[2*O]+=Q:O!==0?(O!==K&&N.bl_tree[2*O]++,N.bl_tree[2*w]++):Q<=10?N.bl_tree[2*R]++:N.bl_tree[2*T]++,K=O,ht=(Q=0)===et?(st=138,3):O===et?(st=6,3):(st=7,4))}function G(N,j,V){var H,O,K=-1,et=j[1],Q=0,st=7,ht=4;for(et===0&&(st=138,ht=3),H=0;H<=V;H++)if(O=et,et=j[2*(H+1)+1],!(++Q<st&&O===et)){if(Q<ht)for(;X(N,O,N.bl_tree),--Q!=0;);else O!==0?(O!==K&&(X(N,O,N.bl_tree),Q--),X(N,w,N.bl_tree),$(N,Q-3,2)):Q<=10?(X(N,R,N.bl_tree),$(N,Q-3,3)):(X(N,T,N.bl_tree),$(N,Q-11,7));K=O,ht=(Q=0)===et?(st=138,3):O===et?(st=6,3):(st=7,4)}}l(P);var W=!1;function D(N,j,V,H){$(N,(d<<1)+(H?1:0),3),function(O,K,et,Q){at(O),J(O,et),J(O,~et),i.arraySet(O.pending_buf,O.window,K,et,O.pending),O.pending+=et}(N,j,V)}o._tr_init=function(N){W||(function(){var j,V,H,O,K,et=new Array(v+1);for(O=H=0;O<h-1;O++)for(F[O]=H,j=0;j<1<<_[O];j++)c[H++]=O;for(c[H-1]=O,O=K=0;O<16;O++)for(P[O]=K,j=0;j<1<<E[O];j++)C[K++]=O;for(K>>=7;O<u;O++)for(P[O]=K<<7,j=0;j<1<<E[O]-7;j++)C[256+K++]=O;for(V=0;V<=v;V++)et[V]=0;for(j=0;j<=143;)U[2*j+1]=8,j++,et[8]++;for(;j<=255;)U[2*j+1]=9,j++,et[9]++;for(;j<=279;)U[2*j+1]=7,j++,et[7]++;for(;j<=287;)U[2*j+1]=8,j++,et[8]++;for(lt(U,b+1,et),j=0;j<u;j++)A[2*j+1]=5,A[2*j]=dt(j,5);Z=new tt(U,_,m+1,b,v),q=new tt(A,E,0,u,v),Y=new tt(new Array(0),S,0,y,x)}(),W=!0),N.l_desc=new M(N.dyn_ltree,Z),N.d_desc=new M(N.dyn_dtree,q),N.bl_desc=new M(N.bl_tree,Y),N.bi_buf=0,N.bi_valid=0,it(N)},o._tr_stored_block=D,o._tr_flush_block=function(N,j,V,H){var O,K,et=0;0<N.level?(N.strm.data_type===2&&(N.strm.data_type=function(Q){var st,ht=4093624447;for(st=0;st<=31;st++,ht>>>=1)if(1&ht&&Q.dyn_ltree[2*st]!==0)return a;if(Q.dyn_ltree[18]!==0||Q.dyn_ltree[20]!==0||Q.dyn_ltree[26]!==0)return s;for(st=32;st<m;st++)if(Q.dyn_ltree[2*st]!==0)return s;return a}(N)),Et(N,N.l_desc),Et(N,N.d_desc),et=function(Q){var st;for(p(Q,Q.dyn_ltree,Q.l_desc.max_code),p(Q,Q.dyn_dtree,Q.d_desc.max_code),Et(Q,Q.bl_desc),st=y-1;3<=st&&Q.bl_tree[2*L[st]+1]===0;st--);return Q.opt_len+=3*(st+1)+5+5+4,st}(N),O=N.opt_len+3+7>>>3,(K=N.static_len+3+7>>>3)<=O&&(O=K)):O=K=V+5,V+4<=O&&j!==-1?D(N,j,V,H):N.strategy===4||K===O?($(N,2+(H?1:0),3),gt(N,U,A)):($(N,4+(H?1:0),3),function(Q,st,ht,ct){var St;for($(Q,st-257,5),$(Q,ht-1,5),$(Q,ct-4,4),St=0;St<ct;St++)$(Q,Q.bl_tree[2*L[St]+1],3);G(Q,Q.dyn_ltree,st-1),G(Q,Q.dyn_dtree,ht-1)}(N,N.l_desc.max_code+1,N.d_desc.max_code+1,et+1),gt(N,N.dyn_ltree,N.dyn_dtree)),it(N),H&&at(N)},o._tr_tally=function(N,j,V){return N.pending_buf[N.d_buf+2*N.last_lit]=j>>>8&255,N.pending_buf[N.d_buf+2*N.last_lit+1]=255&j,N.pending_buf[N.l_buf+N.last_lit]=255&V,N.last_lit++,j===0?N.dyn_ltree[2*V]++:(N.matches++,j--,N.dyn_ltree[2*(c[V]+m+1)]++,N.dyn_dtree[2*B(j)]++),N.last_lit===N.lit_bufsize-1},o._tr_align=function(N){$(N,2,3),X(N,k,U),function(j){j.bi_valid===16?(J(j,j.bi_buf),j.bi_buf=0,j.bi_valid=0):8<=j.bi_valid&&(j.pending_buf[j.pending++]=255&j.bi_buf,j.bi_buf>>=8,j.bi_valid-=8)}(N)}},{"../utils/common":41}],53:[function(e,r,o){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,o){(function(i){(function(a,s){if(!a.setImmediate){var l,d,h,m,b=1,u={},y=!1,f=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(w){process.nextTick(function(){x(w)})}:function(){if(a.postMessage&&!a.importScripts){var w=!0,R=a.onmessage;return a.onmessage=function(){w=!1},a.postMessage("","*"),a.onmessage=R,w}}()?(m="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",k,!1):a.attachEvent("onmessage",k),function(w){a.postMessage(m+w,"*")}):a.MessageChannel?((h=new MessageChannel).port1.onmessage=function(w){x(w.data)},function(w){h.port2.postMessage(w)}):f&&"onreadystatechange"in f.createElement("script")?(d=f.documentElement,function(w){var R=f.createElement("script");R.onreadystatechange=function(){x(w),R.onreadystatechange=null,d.removeChild(R),R=null},d.appendChild(R)}):function(w){setTimeout(x,0,w)},v.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var R=new Array(arguments.length-1),T=0;T<R.length;T++)R[T]=arguments[T+1];var _={callback:w,args:R};return u[b]=_,l(b),b++},v.clearImmediate=g}function g(w){delete u[w]}function x(w){if(y)setTimeout(x,0,w);else{var R=u[w];if(R){y=!0;try{(function(T){var _=T.callback,E=T.args;switch(E.length){case 0:_();break;case 1:_(E[0]);break;case 2:_(E[0],E[1]);break;case 3:_(E[0],E[1],E[2]);break;default:_.apply(s,E)}})(R)}finally{g(w),y=!1}}}}function k(w){w.source===a&&typeof w.data=="string"&&w.data.indexOf(m)===0&&x(+w.data.slice(m.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Be<"u"?Be:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(zn)),zn.exports}var xa=wa();const Qn=hi(xa);function _a(t){const n=t?.toLowerCase()||"";return n.includes("jpeg")?"jpeg":n.includes("png")?"png":n.includes("webp")?"webp":n.includes("gif")?"gif":n.includes("bmp")?"bmp":n.includes("avif")?"avif":"jpg"}async function ka(t){try{const n=await fetch(t,{cache:"no-store"});if(n.ok){const e=await n.blob();return{blob:e,mime:e.type||"image/jpeg"}}}catch{}try{const n=await Ca(t),{blob:e,mime:r}=await Ea(n);return{blob:e,mime:r}}catch{throw new Error("Unable to read image bytes (fetch/canvas failed).")}}function Ca(t){return new Promise((n,e)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>n(r),r.onerror=e,r.src=t})}function Ea(t){return new Promise((n,e)=>{const r=Math.max(1,t.naturalWidth||t.width||1),o=Math.max(1,t.naturalHeight||t.height||1),i=document.createElement("canvas");i.width=r,i.height=o;const a=i.getContext("2d");if(!a)return e(new Error("Canvas2D unavailable"));a.drawImage(t,0,0,r,o),i.toBlob(s=>{if(!s)return e(new Error("Canvas toBlob failed (tainted?)"));n({blob:s,mime:s.type||"image/png"})},"image/png",.92)})}async function Sa(t){const n=t?.imageFormat??"jpeg",e=Math.max(.5,Math.min(.95,t?.quality??.8)),r=ft.getState(),o=r.photos,i=o.length;let a=0;const s=new Qn,l=s.folder("images");if(!l)throw new Error("ZIP: cannot create images/");const d={schemaVersion:1,createdAt:new Date().toISOString(),appConfigSnapshot:{MAX_CARDS:Gi,CARD_EXPORT_SIZE:It,PREVIEW_EXACT_SIZE:Ge,PREVIEW_FAST_SIZE:qs},images:[],cards:[]};for(let m=0;m<o.length;m++){const b=o[m];let u=null,y="image/jpeg";try{const w=await ka(b.url);u=w.blob,y=w.mime||y}catch{u=null}if(u){const w=(u.type||"").toLowerCase();if(n==="jpeg"){if(!/jpe?g/.test(w)||e!==.8)try{u=await Aa(u,e),y="image/jpeg"}catch{}}else if(n==="png"&&!/png/.test(w))try{u=await Na(u),y="image/png"}catch{}}const f=_a(y),v=`images/${b.id}.${f}`;u?(l.file(`${b.id}.${f}`,u),d.images.push({id:b.id,path:v,mime:y,size:u.size,source:{type:"embedded"}})):d.images.push({id:b.id,path:v,mime:y,source:{type:"url"}});const g=r.transforms[b.id]??{scale:1,tx:0,ty:0},x=r.cardBackground?.[b.id],k=(r.layersByPhoto[b.id]??[]).map(Ra);d.cards.push({photoId:b.id,order:m,transform:g,background:x,layers:k}),a++,t?.onProgress?.({done:a,total:i})}return s.file("manifest.json",JSON.stringify(d,null,2)),await s.generateAsync({type:"blob",compression:"DEFLATE"})}function Ra(t){if(!t)return t;if(t.type==="image"&&t.qrText){const{src:n,...e}=t;return e}if(t.type==="image"&&typeof t.src=="string"&&t.src.startsWith("data:")){const{src:n,...e}=t;return e}return{...t}}async function Qi(t){const n=URL.createObjectURL(t);try{return await new Promise((e,r)=>{const o=new Image;o.onload=()=>e(o),o.onerror=r,o.src=n})}finally{URL.revokeObjectURL(n)}}async function Aa(t,n){const e=await Qi(t),r=document.createElement("canvas");r.width=Math.max(1,e.naturalWidth||e.width||1),r.height=Math.max(1,e.naturalHeight||e.height||1);const o=r.getContext("2d");if(!o)throw new Error("Canvas2D unavailable");o.drawImage(e,0,0);const i=r.toDataURL("image/jpeg",n);return await(await fetch(i)).blob()}async function Na(t){const n=await Qi(t),e=document.createElement("canvas");e.width=Math.max(1,n.naturalWidth||n.width||1),e.height=Math.max(1,n.naturalHeight||n.height||1);const r=e.getContext("2d");if(!r)throw new Error("Canvas2D unavailable");r.drawImage(n,0,0);const o=e.toDataURL("image/png");return await(await fetch(o)).blob()}async function Ji(t){const n=[],e=await Qn.loadAsync(t),r=e.file("manifest.json");if(!r)throw new Error("manifest.json not found in zip");const o=await r.async("string");let i;try{i=JSON.parse(o)}catch{throw new Error("manifest.json is not valid JSON")}if(i.schemaVersion!==1)throw new Error(`Unsupported schemaVersion: ${i.schemaVersion}`);const a=new Map;for(const b of i.images){const u=e.file(b.path);if(!u){n.push(`Image file missing in zip: ${b.path}`);continue}try{const y=await u.async("blob"),f=URL.createObjectURL(y);a.set(b.id,f)}catch{n.push(`Failed to read image: ${b.path}`)}}const s=[],l={},d={},h={},m=[...i.cards].sort((b,u)=>b.order-u.order);for(const b of m){const u=a.get(b.photoId);u?s.push({id:b.photoId,url:u}):(n.push(`Missing image for card photoId=${b.photoId}. Card will appear without photo.`),s.push({id:b.photoId,url:Ia})),l[b.photoId]={...b.transform},b.background&&(h[b.photoId]={...b.background});const y=Array.isArray(b.layers)?b.layers.slice():[];for(const f of y)if(f&&f.type==="image"&&f.qrText&&!f.src){const v=Math.max(1,Math.round(f.w??f.h??512));f.src=await qn(f.qrText,v,1),f.w==null&&(f.w=v),f.h==null&&(f.h=v)}d[b.photoId]=y}return ft.setState({photos:s,transforms:l,layersByPhoto:d,cardBackground:h}),{warnings:n}}const Ia="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=";function Ta(){const t=z.useRef(null),n=z.useRef(null),e=z.useRef(null),r=ft(y=>y.photos),o=ft(y=>y.max),i=ft(y=>y.add),a=ft(y=>y.clear),s=Math.max(0,o-r.length),l=z.useCallback(y=>{if(!y?.length)return;const f=Array.from(y).slice(0,s),v=Us(f,s);i(v)},[i,s]),d=z.useCallback(y=>{l(y.target.files),y.target.value=""},[l]);async function h(y){const f=y.target.files?.[0];if(!f)return;const v=await f.text();y.target.value="";const{rows:g,hasRelative:x}=ya(v);if(g.length){if(x){alert("В этом CSV есть относительные пути. В текущей сборке локальная папка не поддерживается. Пожалуйста, используйте полные URL (http/https) или добавьте изображения кнопкой “Choose images”.");return}await u(g)}}function m(y){return new Promise(f=>setTimeout(f,y))}async function b(y,f,v=2e3,g=50){const x=Date.now()+v,k=f.map(w=>w.toLowerCase());for(;Date.now()<x;){const R=ft.getState().layersByPhoto[y]??[],T=new Set(R.map(_=>typeof _?.name=="string"?_.name.toLowerCase():"").filter(Boolean));if(k.every(_=>T.has(_)))return;await m(g)}}async function u(y,f){const v=ft.getState().add,g=[];let x=0,k=0;for(const R of y)try{let T=null,_="image";if(Xi(R.url)){const L=await fetch(R.url,{mode:"cors"});if(!L.ok)throw new Error(`HTTP ${L.status}`);T=await L.blob(),_=R.url.split("/").pop()||_}else if(Ki(R.url))T=await(await fetch(R.url)).blob(),_="data.png";else throw new Error("Relative paths are disabled in this build");const E=URL.createObjectURL(T),S=crypto.randomUUID();g.push({id:S,url:E,name:_}),x++}catch(T){console.warn("CSV import skip:",R.url,T),k++}v(g);const w=g.map(R=>R.id);for(let R=0;R<y.length&&R<w.length;R++){const T=y[R],_=w[R];if(!T.layers)continue;const E=Object.keys(T.layers).map(A=>A.toLowerCase());await b(_,E,2e3,50);const S=ft.getState(),L=S.layersByPhoto[_]??[],U=A=>["x","y","w","h","width","height","fontSize","rotation","letterSpacing","lineHeight","padding","opacity","strokeWidth"].includes(A);for(const[A,C]of Object.entries(T.layers)){const c=String(A).toLowerCase(),F=L.filter(Z=>typeof Z?.name=="string"&&Z.name.toLowerCase()===c);if(F.length)for(const Z of F)for(const[q,Y]of Object.entries(C)){const P=q.toLowerCase();if(Z.type==="image"&&Z.qrText!==void 0){if(P==="text"){await S.updateQrLayer(_,Z.id,{text:Y});continue}if(P==="size"){const M=parseInt(Y,10);Number.isNaN(M)||await S.updateQrLayer(_,Z.id,{size:M});continue}}const tt={};if(P==="text"?tt.text=Y:P==="fill"?tt.fill=Y:P==="align"?tt.align=Y:P==="vertical_align"||P==="verticalalign"?tt.verticalAlign=Y:P==="fontfamily"||P==="font_family"?tt.fontFamily=Y:(P==="fontstyle"||P==="font_style")&&(tt.fontStyle=Y),U(P)){const M=parseFloat(Y);Number.isNaN(M)||(tt[P]=M)}Object.keys(tt).length&&S.updateLayer(_,Z.id,tt)}}}k&&alert(`CSV import: added ${x}, skipped ${k}`)}return I.jsx("section",{className:"mt-4 space-y-4",children:I.jsxs("div",{className:"flex items-center justify-between gap-2",children:[I.jsxs("div",{className:"text-sm opacity-80",children:["Cards: ",I.jsx("b",{children:r.length})," / ",o]}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx("input",{ref:t,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:d}),I.jsx("input",{ref:n,type:"file",accept:".csv,text/csv",className:"hidden",onChange:h}),I.jsx("input",{ref:e,type:"file",accept:".zip,application/zip",className:"hidden",onChange:async y=>{const f=y.currentTarget,v=f.files?.[0];if(f.value="",!!v)try{const{warnings:g}=await Ji(v);g.length&&alert(`Import finished with warnings:
`+g.join(`
`))}catch(g){setTimeout(()=>{alert(`Cannot open .zip: ${g?.message??String(g)}`)},0)}}}),I.jsx(xt,{variant:"secondary",onClick:()=>e.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Open collection (.zip)"}),I.jsx("button",{onClick:()=>n.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Import CSV"}),I.jsx("button",{onClick:()=>t.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Choose images"}),I.jsx(xt,{variant:"destructive",onClick:a,disabled:!r.length,children:"Clear"})]})]})})}const to=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("rounded-xl border bg-card text-card-foreground shadow",t),...n}));to.displayName="Card";const Da=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("flex flex-col space-y-1.5 p-6",t),...n}));Da.displayName="CardHeader";const za=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("font-semibold leading-none tracking-tight",t),...n}));za.displayName="CardTitle";const ja=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("text-sm text-muted-foreground",t),...n}));ja.displayName="CardDescription";const La=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("p-6 pt-0",t),...n}));La.displayName="CardContent";const Ba=z.forwardRef(({className:t,...n},e)=>I.jsx("div",{ref:e,className:bt("flex items-center p-6 pt-0",t),...n}));Ba.displayName="CardFooter";const eo=z.forwardRef(({className:t,value:n,...e},r)=>I.jsx(bi,{ref:r,className:bt("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...e,children:I.jsx(Uo,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));eo.displayName=bi.displayName;const no=Ho,ro=Zo,Jn=z.forwardRef(({className:t,children:n,...e},r)=>I.jsxs(yi,{ref:r,className:bt("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...e,children:[n,I.jsx(Wo,{asChild:!0,children:I.jsx(pi,{className:"h-4 w-4 opacity-50"})})]}));Jn.displayName=yi.displayName;const io=z.forwardRef(({className:t,...n},e)=>I.jsx(vi,{ref:e,className:bt("flex cursor-default items-center justify-center py-1",t),...n,children:I.jsx(zo,{className:"h-4 w-4"})}));io.displayName=vi.displayName;const oo=z.forwardRef(({className:t,...n},e)=>I.jsx(wi,{ref:e,className:bt("flex cursor-default items-center justify-center py-1",t),...n,children:I.jsx(pi,{className:"h-4 w-4"})}));oo.displayName=wi.displayName;const tr=z.forwardRef(({className:t,children:n,position:e="popper",...r},o)=>I.jsx(qo,{children:I.jsxs(xi,{ref:o,className:bt("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:e,...r,children:[I.jsx(io,{}),I.jsx(Go,{className:bt("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),I.jsx(oo,{})]})}));tr.displayName=xi.displayName;const Ma=z.forwardRef(({className:t,...n},e)=>I.jsx(_i,{ref:e,className:bt("px-2 py-1.5 text-sm font-semibold",t),...n}));Ma.displayName=_i.displayName;const de=z.forwardRef(({className:t,children:n,...e},r)=>I.jsxs(ki,{ref:r,className:bt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e,children:[I.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:I.jsx(Yo,{children:I.jsx(jo,{className:"h-4 w-4"})})}),I.jsx(Vo,{children:n})]}));de.displayName=ki.displayName;const Pa=z.forwardRef(({className:t,...n},e)=>I.jsx(Ci,{ref:e,className:bt("-mx-1 my-1 h-px bg-muted",t),...n}));Pa.displayName=Ci.displayName;const Oa=[];function so(t,n=""){const[e,r]=z.useState(null),[o,i]=z.useState("idle");return z.useEffect(()=>{if(!t){r(null),i("idle");return}let a=!1;const s=new Image;return n&&(s.crossOrigin=n),i("loading"),s.onload=()=>{a||(r(s),i("loaded"))},s.onerror=()=>{a||(r(null),i("failed"))},s.src=t,()=>{a=!0}},[t,n]),[e,o]}function Fa({layer:t,k:n,onSelect:e,updateLayer:r,selectedId:o}){const[i]=so(t.src||"","anonymous"),a=o===t.id,s=z.useRef(null),l=t.x*n,d=t.y*n,h=i?.naturalWidth??0,m=i?.naturalHeight??0,b=Math.max(1,t.w?t.w*n:h*n||1),u=Math.max(1,t.h?t.h*n:m*n||1);return I.jsx(mi,{ref:a?s:void 0,draggable:!0,image:i??void 0,x:l,y:d,width:b,height:u,rotation:t.rotation,visible:t.visible,onMouseDown:()=>e(t.id),onTap:()=>e(t.id),onDragEnd:y=>{r(t.photoId,t.id,{x:y.target.x()/n,y:y.target.y()/n})},onTransformEnd:y=>{const f=y.target,v=typeof f.scaleX=="function"?f.scaleX():1,g=typeof f.scaleY=="function"?f.scaleY():1,x=typeof f.width=="function"?f.width():b,k=typeof f.height=="function"?f.height():u,w={x:f.x()/n,y:f.y()/n,rotation:f.rotation(),scaleX:1,scaleY:1,w:Math.max(1,Math.round(x*v/n)),h:Math.max(1,Math.round(k*g/n))};typeof f.scaleX=="function"&&f.scaleX(1),typeof f.scaleY=="function"&&f.scaleY(1),r(t.photoId,t.id,w)}},t.id)}const Qe=z.forwardRef(function({photoId:n,size:e,selectedId:r,onSelect:o,transformOverride:i},a){const l=z.useRef(null),d=ft(E=>E.photos.find(S=>S.id===n)?.url),h=ft(E=>E.transforms[n]??fe),m=i??h,b=ft(E=>E.layersByPhoto[n]??Oa,Object.is).map(E=>({...E,photoId:n})),u=ft(E=>E.updateLayer),y=ft(E=>E.cardBackground?.[n]??Kn,Object.is),[f,v]=so(d??"","anonymous"),g=v==="loaded";z.useImperativeHandle(a,()=>({toDataURL:E=>{const S=l.current;if(!S)return null;const L=E&&E>0?E/e:1;return S.toDataURL({pixelRatio:L,mimeType:"image/png"})},isReady:()=>!!l.current&&g}));const x=z.useRef(null),k=z.useRef(null);z.useEffect(()=>{const E=x.current,S=k.current;E&&S&&r&&(E.nodes([S]),E.getLayer()?.batchDraw())},[r]);const w=e/It,R=z.useMemo(()=>b.find(E=>E.id===r),[b,r]),T=!!(R?.type==="image"&&R?.qrText);function _(E,S,L,U){const A=S/E.width,C=S/E.height,F=(L==="cover"?Math.max(A,C):Math.min(A,C))*(U?.scale??1),Z=E.width*F,q=E.height*F,Y=(S-Z)/2+(U?.tx??0)/100*S,P=(S-q)/2+(U?.ty??0)/100*S;return{x:Y*w,y:P*w,width:Z*w,height:q*w}}return I.jsx(Lo,{ref:l,width:e,height:e,pixelRatio:1,listening:!0,style:{width:"100%",height:"100%"},onMouseDown:E=>{E.target===E.target.getStage()&&o(null)},onTouchStart:E=>{E.target===E.target.getStage()&&o(null)},children:I.jsxs(Bo,{children:[I.jsx(mr,{x:0,y:0,width:e,height:e,fill:y.color,opacity:y.alpha,listening:!1}),f?I.jsx(mi,{image:f,..._(f,It,Wn,m),listening:!1}):null,b.slice().sort((E,S)=>E.z-S.z).map(E=>{if(E.type==="text"){const S=E,U=r===S.id?k:void 0,A=S.x*w,C=S.y*w,c=(S.fontSize??16)*w,F=S.width?S.width*w:void 0,Z=(S.padding??0)*w,q=(S.letterSpacing??0)*w;return I.jsx(Mo,{ref:U,draggable:!0,x:A,y:C,text:S.text,fontFamily:S.fontFamily||"Georgia, serif",fontSize:c,fontStyle:S.fontStyle,fill:S.fill,width:F,align:S.align,lineHeight:S.lineHeight??1.25,padding:Z,letterSpacing:q,rotation:S.rotation,scaleX:1,scaleY:1,visible:S.visible,perfectDrawEnabled:!1,onTransform:Y=>{const P=Y.target,tt=typeof P.scaleX=="function"?P.scaleX():1,M=typeof P.width=="function"?P.width():void 0;M!==void 0&&tt&&tt!==1&&(P.width(Math.max(4,Math.round(M*tt))),typeof P.scaleX=="function"&&P.scaleX(1),typeof P.scaleY=="function"&&P.scaleY(1),P.getLayer()?.batchDraw())},onMouseDown:()=>o(S.id),onTap:()=>o(S.id),onDragEnd:Y=>{u(n,S.id,{x:Y.target.x()/w,y:Y.target.y()/w})},onTransformEnd:Y=>{const P=Y.target,tt=typeof P.scaleX=="function"?P.scaleX():1,M=typeof P.width=="function"?P.width():void 0,B={x:P.x()/w,y:P.y()/w,rotation:P.rotation(),scaleX:1,scaleY:1,width:M!==void 0?Math.max(4,Math.round(M*tt/w)):void 0};typeof P.scaleX=="function"&&P.scaleX(1),typeof P.scaleY=="function"&&P.scaleY(1),u(n,S.id,B)}},S.id)}if(E.type==="rect"){const S=E,U=r===S.id?k:void 0,A=S.x*w,C=S.y*w,c=Math.max(1,(S.width??100)*w),F=Math.max(1,(S.height??100)*w),Z=Math.max(0,(S.strokeWidth??0)*w),q=Math.max(0,(S.cornerRadius??0)*w);return I.jsx(mr,{ref:U,draggable:!0,x:A,y:C,width:c,height:F,rotation:S.rotation,fill:S.fill??"#ffffff",stroke:S.stroke,strokeWidth:Z,cornerRadius:q,visible:S.visible,opacity:Math.max(0,Math.min(1,S.opacity??1)),onMouseDown:()=>o(S.id),onTap:()=>o(S.id),onDragEnd:Y=>{u(n,S.id,{x:Y.target.x()/w,y:Y.target.y()/w})},onTransformEnd:Y=>{const P=Y.target,tt=typeof P.scaleX=="function"?P.scaleX():1,M=typeof P.scaleY=="function"?P.scaleY():1,B=typeof P.width=="function"?P.width():c,J=typeof P.height=="function"?P.height():F,$={x:P.x()/w,y:P.y()/w,rotation:P.rotation(),scaleX:1,scaleY:1,width:Math.max(1,Math.round(B*tt/w)),height:Math.max(1,Math.round(J*M/w))};typeof P.scaleX=="function"&&P.scaleX(1),typeof P.scaleY=="function"&&P.scaleY(1),u(n,S.id,$)}},S.id)}return E.type==="image"?I.jsx(Fa,{layer:E,k:w,selectedId:r,onSelect:o,updateLayer:u},E.id):null}),r&&I.jsx(Po,{ref:x,rotateEnabled:!0,enabledAnchors:["middle-left","middle-right","top-center","bottom-center","top-left","top-right","bottom-left","bottom-right"],borderStroke:"#fff",anchorStroke:"#fff",anchorFill:"#111",anchorSize:7,keepRatio:T,centeredScaling:!1,boundBoxFunc:(E,S)=>{const U=Math.max(6,S.width),A=Math.max(6,S.height);return{...S,width:U,height:A}}})]})})}),ao=Ko,Ua=$o,lo=z.forwardRef(({className:t,...n},e)=>I.jsx(Ei,{ref:e,className:bt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));lo.displayName=Ei.displayName;const er=z.forwardRef(({className:t,children:n,...e},r)=>I.jsxs(Ua,{children:[I.jsx(lo,{}),I.jsxs(Si,{ref:r,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e,children:[n,I.jsxs(Xo,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[I.jsx(Oo,{className:"h-4 w-4"}),I.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));er.displayName=Si.displayName;const nr=({className:t,...n})=>I.jsx("div",{className:bt("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});nr.displayName="DialogHeader";const rr=({className:t,...n})=>I.jsx("div",{className:bt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});rr.displayName="DialogFooter";const ir=z.forwardRef(({className:t,...n},e)=>I.jsx(Ri,{ref:e,className:bt("text-lg font-semibold leading-none tracking-tight",t),...n}));ir.displayName=Ri.displayName;const co=z.forwardRef(({className:t,...n},e)=>I.jsx(Ai,{ref:e,className:bt("text-sm text-muted-foreground",t),...n}));co.displayName=Ai.displayName;const Wa=zi("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ce=z.forwardRef(({className:t,...n},e)=>I.jsx(Ni,{ref:e,className:bt(Wa(),t),...n}));ce.displayName=Ni.displayName;const Ye=z.forwardRef(({className:t,...n},e)=>I.jsxs(Ii,{ref:e,className:bt("relative flex w-full touch-none select-none items-center",t),...n,children:[I.jsx(Qo,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:I.jsx(Jo,{className:"absolute h-full bg-primary"})}),I.jsx(ts,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Ye.displayName=Ii.displayName;const jn=new Map;function He(t){const n=t.trim();if(n.startsWith('"')){const e=n.indexOf('"',1);return e>1?n.slice(1,e):n.replace(/["']/g,"")}return n.split(",")[0].replace(/["']/g,"").trim()}function qa(t){const n=He(t);return Yi.find(e=>He(e.family).toLowerCase()===n.toLowerCase())}function Ga(t,n){if(document.getElementById(n))return;const e=document.createElement("link");e.id=n,e.rel="stylesheet",e.href=t;const r=document.createElement("link");r.rel="preconnect",r.href="https://fonts.googleapis.com";const o=document.createElement("link");o.rel="preconnect",o.href="https://fonts.gstatic.com",o.crossOrigin="anonymous",document.head.appendChild(r),document.head.appendChild(o),document.head.appendChild(e)}function Ya(t){const n=He(t);if(jn.has(n))return jn.get(n);const e=(async()=>{const r=qa(t);r&&r.cssHref&&Ga(r.cssHref,`font-css-${r.id}`);try{const o=document;o?.fonts?.ready&&typeof o.fonts.ready.then=="function"&&await o.fonts.ready}catch{}try{document.fonts?.load&&await document.fonts.load(`1em ${He(t)}`)}catch{}})();return jn.set(n,e),e}const Va=[],We="__none__";function Ha({photoId:t,layer:n}){const e=ft(s=>s.updateQrLayer),[r,o]=z.useState(n.qrText??""),[i,a]=z.useState(Math.max(1,Math.round(n.w??n.h??512)));return z.useEffect(()=>{o(n.qrText??""),a(Math.max(1,Math.round(n.w??n.h??512)))},[n.id,n.qrText,n.w,n.h]),I.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-foreground/10",children:"QR"}),I.jsx("span",{className:"opacity-70 text-sm",children:"This layer is a QR code"})]}),I.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[I.jsx("label",{className:"text-xs opacity-70",children:"QR text / URL"}),I.jsx("input",{type:"text",value:r,onChange:s=>o(s.target.value),className:"flex-1 min-w-[16rem] rounded border px-2 py-1 text-sm",placeholder:"https://example.com"}),I.jsx("label",{className:"text-xs opacity-70",children:"Size (px)"}),I.jsx("input",{type:"number",min:1,max:It,step:1,value:i,onChange:s=>a(Math.max(1,Number(s.target.value)||1)),className:"w-28 rounded border px-2 py-1 text-sm",title:"QR side size in card pixels"}),I.jsx(xt,{variant:"secondary",onClick:async()=>{await e(t,n.id,{text:r.trim(),size:i})},children:"Update QR"})]})]})}function Za({open:t,onOpenChange:n,photo:e,canvasRef:r}){const o=ft(C=>C.addTextLayer),i=ft(C=>C.addRectLayer),a=ft(C=>C.addQrLayer),s=ft(C=>C.transforms[e.id]??fe),l=ft(C=>C.setTransform),[d,h]=z.useState(s),[m,b]=z.useState(null),u=ft(C=>C.updateLayer),y=ft(C=>C.removeLayer),f=ft(C=>C.bringToFront),v=ft(C=>C.sendToBack),g=ft(C=>C.layersByPhoto[e.id]??Va,Object.is),x=z.useRef(null),k=r??x,w=ft(C=>C.cardBackground?.[e.id]??Kn,Object.is),R=ft(C=>C.setCardBackground),T=(C,c)=>C.scale===c.scale&&C.tx===c.tx&&C.ty===c.ty,_=z.useRef(s);z.useEffect(()=>{t&&(_.current=s,h(s))},[t,s]);const E=z.useRef(null),[S,L]=z.useState(0),U=z.useCallback(()=>{const C=E.current;if(!C)return;const c=Math.round(C.clientWidth);c&&L(c)},[]);z.useEffect(()=>{const C=E.current;if(!C)return;const c=new ResizeObserver(U);return c.observe(C),U(),()=>c.disconnect()},[U]),z.useEffect(()=>{t&&(requestAnimationFrame(U),setTimeout(U,50))},[t,U]);const A=z.useCallback((C,c)=>{const F=C.id.slice(0,6);let Z="Layer";return C.type==="text"?Z="Text":C.type==="rect"?Z="Rect":C.type==="image"&&C.qrText?Z="QR":C.type==="image"&&(Z="Image"),`${Z} #${c+1} (${F})`},[]);return z.useEffect(()=>{if(!m)return;(g??[]).some(c=>c.id===m)||b(null)},[g,m]),I.jsx(ao,{open:t,onOpenChange:n,children:I.jsxs(er,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden flex flex-col",children:[I.jsxs(nr,{className:"shrink-0",children:[I.jsx(ir,{children:"Edit card"}),I.jsx(co,{className:"sr-only",children:"Adjust zoom/position and edit layers."})]}),I.jsx("div",{className:"flex-1 overflow-auto",children:I.jsxs("div",{className:"grid gap-4",children:[I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:I.jsx("div",{className:"relative aspect-square overflow-hidden rounded-xl",ref:E,children:S>0&&I.jsx("div",{className:"absolute inset-0 pointer-events-auto z-0",children:I.jsx(Qe,{"data-dnd-ignore":!0,ref:k,photoId:e.id,size:S,selectedId:m,onSelect:b,transformOverride:d})})})}),I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:I.jsxs("div",{className:"flex items-center gap-3",children:[I.jsx(ce,{className:"whitespace-nowrap",children:"Layers"}),I.jsxs(no,{value:m??We,onValueChange:C=>b(C===We?null:C),children:[I.jsx(Jn,{className:"w-[18rem]",children:I.jsx(ro,{placeholder:g.length?"Select a layer…":"No layers"})}),I.jsx(tr,{children:g.length===0?I.jsx(de,{value:We,disabled:!0,children:"No layers"}):I.jsxs(I.Fragment,{children:[I.jsx(de,{value:We,disabled:!0,children:"Select a layer…"}),g.slice().sort((C,c)=>C.z-c.z).map((C,c)=>I.jsx(de,{value:C.id,children:A(C,c)},C.id))]})})]}),I.jsx("div",{className:"ml-auto"})]})}),m&&(()=>{const C=g.find(c=>c.id===m&&c.type==="text");return C?I.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[I.jsx("label",{className:"text-xs opacity-70",children:"Text"}),I.jsx("textarea",{value:C.text,onChange:c=>u(e.id,C.id,{text:c.target.value}),rows:3,className:"resize-y w-full rounded border px-2 py-1 text-sm bg-background"}),I.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[I.jsx("label",{className:"text-xs opacity-70",children:"Size"}),I.jsx("input",{type:"number",min:8,max:240,step:1,value:C.fontSize??36,onChange:c=>u(e.id,C.id,{fontSize:Number(c.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),I.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${C.fontStyle?.includes("bold")?"bg-foreground/10":""}`,onClick:()=>{const c=C.fontStyle?.includes("bold"),Z=`${C.fontStyle?.includes("italic")?"italic":""} ${c?"":"bold"}`.trim();u(e.id,C.id,{fontStyle:Z})},children:"Bold"}),I.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${C.fontStyle?.includes("italic")?"bg-foreground/10":""}`,onClick:()=>{const c=C.fontStyle?.includes("bold"),Z=`${C.fontStyle?.includes("italic")?"":"italic"} ${c?"bold":""}`.trim();u(e.id,C.id,{fontStyle:Z})},children:"Italic"}),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Color"}),I.jsx("input",{type:"color",value:C.fill??"#111111",onChange:c=>u(e.id,C.id,{fill:c.target.value}),className:"h-8 w-10 cursor-pointer"})]}),I.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[I.jsx("label",{className:"text-xs opacity-70",children:"Font"}),I.jsx("select",{value:C.fontFamily??"Georgia, serif",onChange:async c=>{const F=c.target.value;await Ya(F),u(e.id,C.id,{fontFamily:F})},className:"rounded border px-2 py-1 text-sm",children:Yi.map(c=>I.jsx("option",{value:c.family,children:c.label},c.id))})]}),I.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[I.jsx("label",{className:"text-xs opacity-70",children:"Align"}),["left","center","right"].map(c=>I.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${C.align===c?"bg-foreground/10":""}`,onClick:()=>u(e.id,C.id,{align:c}),children:c},c)),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Wrap width"}),I.jsx("input",{type:"number",min:0,max:It,step:10,value:C.width??0,onChange:c=>u(e.id,C.id,{width:Number(c.target.value)||void 0}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0 disables wrapping"}),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Padding"}),I.jsx("input",{type:"number",min:0,max:200,step:1,value:C.padding??0,onChange:c=>u(e.id,C.id,{padding:Number(c.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Line height"}),I.jsx("input",{type:"number",min:.8,max:2,step:.05,value:C.lineHeight??1.25,onChange:c=>u(e.id,C.id,{lineHeight:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Tracking"}),I.jsx("input",{type:"number",min:-5,max:20,step:.5,value:C.letterSpacing??0,onChange:c=>u(e.id,C.id,{letterSpacing:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Additional spacing between glyphs (px, card space)"})]})]}):null})(),m&&(()=>{const C=g.find(c=>c.id===m&&c.type==="image"&&c.qrText);return C?I.jsx(Ha,{photoId:e.id,layer:C}):null})(),m&&(()=>{const C=g.find(c=>c.id===m&&c.type==="rect");return C?I.jsx("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:I.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[I.jsx("label",{className:"text-xs opacity-70",children:"Fill"}),I.jsx("input",{type:"color",value:C.fill??"#ffffff",onChange:c=>u(e.id,C.id,{fill:c.target.value}),className:"h-8 w-10 cursor-pointer"}),I.jsx("label",{className:"text-xs opacity-70",children:"Stroke"}),I.jsx("input",{type:"color",value:C.stroke??"#000000",onChange:c=>u(e.id,C.id,{stroke:c.target.value}),className:"h-8 w-10 cursor-pointer"}),I.jsx("label",{className:"text-xs opacity-70",children:"Stroke width"}),I.jsx("input",{type:"number",min:0,max:100,step:1,value:C.strokeWidth??0,onChange:c=>u(e.id,C.id,{strokeWidth:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Width in card pixels"}),I.jsx("label",{className:"text-xs opacity-70",children:"Radius"}),I.jsx("input",{type:"number",min:0,max:500,step:1,value:C.cornerRadius??0,onChange:c=>u(e.id,C.id,{cornerRadius:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Corner radius in card pixels"}),I.jsx("label",{className:"text-xs opacity-70",children:"Opacity"}),I.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((C.opacity??1)*100),onChange:c=>u(e.id,C.id,{opacity:Math.max(0,Math.min(1,Number(c.target.value)/100))}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0..100 %"}),I.jsx("label",{className:"text-xs opacity-70",children:"Width"}),I.jsx("input",{type:"number",min:1,max:It,step:1,value:C.width??1,onChange:c=>u(e.id,C.id,{width:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),I.jsx("label",{className:"text-xs opacity-70",children:"Height"}),I.jsx("input",{type:"number",min:1,max:It,step:1,value:C.height??1,onChange:c=>u(e.id,C.id,{height:Number(c.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"})]})}):null})(),I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:I.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[I.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>{if(!m)return;const c=(ft.getState().layersByPhoto[e.id]??[]).find(q=>q.id===m);if(!c)return;const Z=((c.rotation??0)-90)%360;u(e.id,m,{rotation:Z<0?Z+360:Z})},children:"Rotate −90°"}),I.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>{if(!m)return;const c=(ft.getState().layersByPhoto[e.id]??[]).find(q=>q.id===m);if(!c)return;const Z=((c.rotation??0)+90)%360;u(e.id,m,{rotation:Z})},children:"Rotate +90°"}),I.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>m&&f(e.id,m),children:"Bring to front"}),I.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>m&&v(e.id,m),children:"Send to back"}),I.jsx(xt,{variant:"destructive",disabled:!m,onClick:()=>{m&&(y(e.id,m),b(null))},children:"Delete layer"})]})}),I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:I.jsxs("div",{className:"grid gap-3",children:[I.jsxs("div",{className:"grid gap-1.5",children:[I.jsxs("div",{className:"flex items-center justify-between text-sm",children:[I.jsx(ce,{children:"Zoom"}),I.jsxs("span",{className:"tabular-nums opacity-70",children:[d.scale.toFixed(2),"×"]})]}),I.jsx(Ye,{value:[d.scale],min:1,max:3,step:.01,onValueChange:([C])=>h(c=>({...c,scale:C}))})]}),I.jsxs("div",{className:"grid gap-1.5",children:[I.jsxs("div",{className:"flex items-center justify-between text-sm",children:[I.jsx(ce,{children:"Horizontal"}),I.jsxs("span",{className:"tabular-nums opacity-70",children:[d.tx.toFixed(0),"%"]})]}),I.jsx(Ye,{value:[d.tx],min:-100,max:100,step:.1,onValueChange:([C])=>h(c=>({...c,tx:C}))})]}),I.jsxs("div",{className:"grid gap-1.5",children:[I.jsxs("div",{className:"flex items-center justify-between text-sm",children:[I.jsx(ce,{children:"Vertical"}),I.jsxs("span",{className:"tabular-nums opacity-70",children:[d.ty.toFixed(0),"%"]})]}),I.jsx(Ye,{value:[d.ty],min:-100,max:100,step:.1,onValueChange:([C])=>h(c=>({...c,ty:C}))})]})]})}),I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:I.jsx("div",{className:"mt-3 grid gap-2 rounded-md border p-2 bg-background/60",children:I.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[I.jsx(ce,{className:"opacity-70",children:"Background"}),I.jsx("label",{className:"text-xs opacity-70",children:"Color"}),I.jsx("input",{type:"color",value:w.color,onChange:C=>R(e.id,{color:C.target.value}),className:"h-8 w-10 cursor-pointer"}),I.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Opacity"}),I.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((w.alpha??1)*100),onChange:C=>R(e.id,{alpha:Math.max(0,Math.min(1,Number(C.target.value)/100))}),className:"w-20 rounded border px-2 py-1 text-sm",title:"0..100 %"}),I.jsx("span",{className:"text-xs opacity-60",children:"(0% = transparent, 100% = solid)"})]})})})]})}),I.jsxs(rr,{className:"shrink-0 space-y-2",children:[I.jsxs("div",{className:"flex items-center justify-between gap-2",children:[I.jsx(xt,{variant:"ghost",onClick:()=>{h(fe)},children:"Reset image"}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx(xt,{variant:"secondary",onClick:()=>{T(_.current,s)||l(e.id,_.current),n(!1)},children:"Cancel"}),I.jsx(xt,{onClick:()=>{T(d,s)||l(e.id,d),n(!1)},children:"Save"})]})]}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx(xt,{variant:"secondary",onClick:async()=>{const C=window.prompt("QR text / URL:","https://example.com")??"";if(!C.trim())return;const c=await a(e.id,C.trim());b(c)},children:"Add QR"}),I.jsx(xt,{variant:"secondary",onClick:()=>{const C=o(e.id);b(C)},children:"Add text layer"}),I.jsx(xt,{variant:"secondary",onClick:()=>{const C=i(e.id);b(C)},children:"Add rectangle"})]})]})]})})}function $a(t,n="card"){return(t.replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||n).slice(0,100)}function Xa(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function Ka({open:t,onOpenChange:n,photo:e,transform:r,layers:o,snapshot:i,onEdit:a}){const[s,l]=z.useState(null),[d,h]=z.useState(!1),m=z.useRef(null),[b,u]=z.useState(0);z.useEffect(()=>{const k=m.current;if(!k)return;const w=()=>u(Math.round(k.clientWidth));w();const R=new ResizeObserver(w);return R.observe(k),()=>R.disconnect()},[]);const y=z.useRef(null),[f,v]=z.useState(Ge),g=z.useMemo(()=>t?I.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:f,height:f,overflow:"hidden"},children:I.jsx(Qe,{ref:y,photoId:e.id,size:f,selectedId:null,onSelect:()=>{}})}):null,[t,e.id,f]);async function x(k){v(k),await new Promise(R=>setTimeout(R,0));try{const R=document;R?.fonts?.ready&&typeof R.fonts.ready.then=="function"&&await R.fonts.ready}catch{}const w=Date.now()+1e3;for(;!y.current?.isReady?.()&&!(Date.now()>w);)await new Promise(R=>setTimeout(R,30));return y.current?.toDataURL(k)??null}return z.useEffect(()=>{let k=!1;if(!t){l(null);return}return(async()=>{h(!0);const w=Math.max(Ge,b||Ge);let R=null;i&&(R=i(w)),R||(R=await x(w)),!k&&(l(R),h(!1))})(),()=>{k=!0}},[t,b,e.id,r.scale,r.tx,r.ty,o,i]),I.jsxs(ao,{"data-dnd-ignore":!0,open:t,onOpenChange:n,children:[g,I.jsxs(er,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden",children:[I.jsx(nr,{children:I.jsx(es,{asChild:!0,children:I.jsx(ir,{children:"Preview"})})}),I.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:I.jsxs("div",{ref:m,className:"relative aspect-square overflow-hidden rounded-xl",children:[s?I.jsx("img",{src:s,alt:e.name,className:"absolute inset-0 w-full h-full object-contain"}):I.jsx("div",{className:"h-24"}),I.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${d?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!d,children:I.jsx("div",{className:"h-7 w-7 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]})}),I.jsxs(rr,{className:"mt-2 gap-2",children:[I.jsx(xt,{variant:"secondary",onClick:()=>{n(!1),a?.()},children:"Edit"}),I.jsx(xt,{variant:"secondary",onClick:()=>n(!1),children:"Close"}),I.jsx(xt,{onClick:async()=>{const k=i&&i(It)||await x(It);k&&Xa(k,`${$a(e.name||"card")}.png`)},children:"Save PNG"})]})]})]})}async function Qa(t,n=It){const e=document.createElement("div");e.style.position="fixed",e.style.left="-10000px",e.style.top="-10000px",e.style.width=`${n}px`,e.style.height=`${n}px`,document.body.appendChild(e);const r=z.createRef(),o=gi.createRoot(e);o.render(z.createElement(Qe,{ref:r,photoId:t,size:n,selectedId:null,onSelect:()=>{}})),await new Promise(s=>setTimeout(s,0));try{const s=document;s?.fonts?.ready&&typeof s.fonts.ready.then=="function"&&await s.fonts.ready}catch{}const i=Date.now()+1500;for(;!r.current?.isReady?.()&&!(Date.now()>i);)await new Promise(s=>setTimeout(s,25));const a=r.current?.toDataURL(n)??"";return o.unmount(),e.remove(),a}async function uo(t,n=It){return Qa(t,n)}function Ja(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function tl({photo:t}){const n=ft(T=>T.remove),e=ft(T=>T.transforms[t.id]??fe),r=ft(T=>T.layersByPhoto),[o,i]=z.useState(!1),[a,s]=z.useState(!1),l=z.useRef(null),d=z.useRef(null),[h,m]=z.useState(0);z.useEffect(()=>{const T=d.current;if(!T)return;const _=()=>m(T.clientWidth);_();const E=new ResizeObserver(_);return E.observe(T),()=>E.disconnect()},[]);const b=z.useRef(null),[u,y]=z.useState(512),f=I.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:u,height:u,overflow:"hidden"},children:I.jsx(Qe,{ref:b,photoId:t.id,size:u,selectedId:null,onSelect:()=>{}})}),[v,g]=z.useState(null),[x,k]=z.useState(!0),w=z.useRef(null);z.useEffect(()=>{if(o)return;const T=window.devicePixelRatio||1,_=Math.max(384,Math.min(1024,Math.round((h||300)*T)));return y(_),w.current&&window.clearTimeout(w.current),w.current=window.setTimeout(async()=>{k(!0);try{const L=document;L?.fonts?.ready&&typeof L.fonts.ready.then=="function"&&await L.fonts.ready}catch{}const E=Date.now()+800;for(;!b.current?.isReady?.()&&!(Date.now()>E);)await new Promise(L=>setTimeout(L,25));const S=b.current?.toDataURL(_)??null;g(S),k(!1)},150),()=>{w.current&&(window.clearTimeout(w.current),w.current=null)}},[h,o,t.id,e.scale,e.tx,e.ty,r[t.id]]);const R=z.useCallback(async()=>{const T=await uo(t.id,It);if(!T)return;const E=(t.name||"card").replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||"card";Ja(T,`${E}.png`)},[t.id,t.name]);return I.jsxs(I.Fragment,{children:[f,I.jsxs("div",{className:"overflow-hidden rounded-xl border border-foreground/15 bg-foreground/[0.02]",children:[I.jsxs("div",{ref:d,onClick:()=>s(!0),className:"relative aspect-square w-full overflow-hidden cursor-zoom-in",children:[I.jsx("button",{"aria-label":"Remove image",title:"Remove",onClick:T=>{T.stopPropagation(),n(t.id)},className:"absolute right-1 top-1 z-10 rounded-md bg-background/80 px-1.5 py-0.5 text-[11px] shadow hover:bg-background",children:"×"}),v?I.jsx("img",{src:v,alt:t.name,className:"h-full w-full object-cover"}):I.jsx("div",{className:"h-full w-full bg-foreground/[0.06]"}),I.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${x?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!x,children:I.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]}),I.jsxs("div",{className:"flex items-center justify-between gap-2 border-t bg-background/70 px-2 py-1.5 supports-[backdrop-filter]:bg-background/60",children:[I.jsx("button",{"aria-label":"Edit card",title:"Edit",onClick:T=>{T.stopPropagation(),i(!0)},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Edit"}),I.jsx("button",{"aria-label":"Save PNG",title:"Save PNG",onClick:T=>{T.stopPropagation(),R()},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Save PNG"})]})]}),I.jsx(Ka,{open:a,onOpenChange:s,photo:t,transform:e,layers:r[t.id],snapshot:T=>l.current?.toDataURL(T)??null,onEdit:()=>i(!0)}),I.jsx(Za,{open:o,onOpenChange:i,photo:t,canvasRef:l})]})}function el(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return z.useMemo(()=>r=>{n.forEach(o=>o(r))},n)}const Je=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function me(t){const n=Object.prototype.toString.call(t);return n==="[object Window]"||n==="[object global]"}function or(t){return"nodeType"in t}function Dt(t){var n,e;return t?me(t)?t:or(t)&&(n=(e=t.ownerDocument)==null?void 0:e.defaultView)!=null?n:window:window}function sr(t){const{Document:n}=Dt(t);return t instanceof n}function Ie(t){return me(t)?!1:t instanceof Dt(t).HTMLElement}function fo(t){return t instanceof Dt(t).SVGElement}function ge(t){return t?me(t)?t.document:or(t)?sr(t)?t:Ie(t)||fo(t)?t.ownerDocument:document:document:document}const qt=Je?z.useLayoutEffect:z.useEffect;function ar(t){const n=z.useRef(t);return qt(()=>{n.current=t}),z.useCallback(function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return n.current==null?void 0:n.current(...r)},[])}function nl(){const t=z.useRef(null),n=z.useCallback((r,o)=>{t.current=setInterval(r,o)},[]),e=z.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[n,e]}function Re(t,n){n===void 0&&(n=[t]);const e=z.useRef(t);return qt(()=>{e.current!==t&&(e.current=t)},n),e}function Te(t,n){const e=z.useRef();return z.useMemo(()=>{const r=t(e.current);return e.current=r,r},[...n])}function Ze(t){const n=ar(t),e=z.useRef(null),r=z.useCallback(o=>{o!==e.current&&n?.(o,e.current),e.current=o},[]);return[e,r]}function Gn(t){const n=z.useRef();return z.useEffect(()=>{n.current=t},[t]),n.current}let Ln={};function De(t,n){return z.useMemo(()=>{if(n)return n;const e=Ln[t]==null?0:Ln[t]+1;return Ln[t]=e,t+"-"+e},[t,n])}function ho(t){return function(n){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return r.reduce((i,a)=>{const s=Object.entries(a);for(const[l,d]of s){const h=i[l];h!=null&&(i[l]=h+t*d)}return i},{...n})}}const ue=ho(1),$e=ho(-1);function rl(t){return"clientX"in t&&"clientY"in t}function lr(t){if(!t)return!1;const{KeyboardEvent:n}=Dt(t.target);return n&&t instanceof n}function il(t){if(!t)return!1;const{TouchEvent:n}=Dt(t.target);return n&&t instanceof n}function Yn(t){if(il(t)){if(t.touches&&t.touches.length){const{clientX:n,clientY:e}=t.touches[0];return{x:n,y:e}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:n,clientY:e}=t.changedTouches[0];return{x:n,y:e}}}return rl(t)?{x:t.clientX,y:t.clientY}:null}const Ae=Object.freeze({Translate:{toString(t){if(!t)return;const{x:n,y:e}=t;return"translate3d("+(n?Math.round(n):0)+"px, "+(e?Math.round(e):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:n,scaleY:e}=t;return"scaleX("+n+") scaleY("+e+")"}},Transform:{toString(t){if(t)return[Ae.Translate.toString(t),Ae.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:n,duration:e,easing:r}=t;return n+" "+e+"ms "+r}}}),Jr="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ol(t){return t.matches(Jr)?t:t.querySelector(Jr)}const sl={display:"none"};function al(t){let{id:n,value:e}=t;return Tt.createElement("div",{id:n,style:sl},e)}function ll(t){let{id:n,announcement:e,ariaLiveType:r="assertive"}=t;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Tt.createElement("div",{id:n,style:o,role:"status","aria-live":r,"aria-atomic":!0},e)}function cl(){const[t,n]=z.useState("");return{announce:z.useCallback(r=>{r!=null&&n(r)},[]),announcement:t}}const po=z.createContext(null);function dl(t){const n=z.useContext(po);z.useEffect(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(t)},[t,n])}function ul(){const[t]=z.useState(()=>new Set),n=z.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[z.useCallback(r=>{let{type:o,event:i}=r;t.forEach(a=>{var s;return(s=a[o])==null?void 0:s.call(a,i)})},[t]),n]}const fl={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},hl={onDragStart(t){let{active:n}=t;return"Picked up draggable item "+n.id+"."},onDragOver(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was moved over droppable area "+e.id+".":"Draggable item "+n.id+" is no longer over a droppable area."},onDragEnd(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was dropped over droppable area "+e.id:"Draggable item "+n.id+" was dropped."},onDragCancel(t){let{active:n}=t;return"Dragging was cancelled. Draggable item "+n.id+" was dropped."}};function pl(t){let{announcements:n=hl,container:e,hiddenTextDescribedById:r,screenReaderInstructions:o=fl}=t;const{announce:i,announcement:a}=cl(),s=De("DndLiveRegion"),[l,d]=z.useState(!1);if(z.useEffect(()=>{d(!0)},[]),dl(z.useMemo(()=>({onDragStart(m){let{active:b}=m;i(n.onDragStart({active:b}))},onDragMove(m){let{active:b,over:u}=m;n.onDragMove&&i(n.onDragMove({active:b,over:u}))},onDragOver(m){let{active:b,over:u}=m;i(n.onDragOver({active:b,over:u}))},onDragEnd(m){let{active:b,over:u}=m;i(n.onDragEnd({active:b,over:u}))},onDragCancel(m){let{active:b,over:u}=m;i(n.onDragCancel({active:b,over:u}))}}),[i,n])),!l)return null;const h=Tt.createElement(Tt.Fragment,null,Tt.createElement(al,{id:r,value:o.draggable}),Tt.createElement(ll,{id:s,announcement:a}));return e?ke.createPortal(h,e):h}var Ct;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ct||(Ct={}));function Xe(){}function ti(t,n){return z.useMemo(()=>({sensor:t,options:n??{}}),[t,n])}function ml(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return z.useMemo(()=>[...n].filter(r=>r!=null),[...n])}const Pt=Object.freeze({x:0,y:0});function gl(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function bl(t,n){let{data:{value:e}}=t,{data:{value:r}}=n;return e-r}function yl(t,n){let{data:{value:e}}=t,{data:{value:r}}=n;return r-e}function vl(t,n){if(!t||t.length===0)return null;const[e]=t;return e[n]}function ei(t,n,e){return n===void 0&&(n=t.left),e===void 0&&(e=t.top),{x:n+t.width*.5,y:e+t.height*.5}}const wl=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:r}=t;const o=ei(n,n.left,n.top),i=[];for(const a of r){const{id:s}=a,l=e.get(s);if(l){const d=gl(ei(l),o);i.push({id:s,data:{droppableContainer:a,value:d}})}}return i.sort(bl)};function xl(t,n){const e=Math.max(n.top,t.top),r=Math.max(n.left,t.left),o=Math.min(n.left+n.width,t.left+t.width),i=Math.min(n.top+n.height,t.top+t.height),a=o-r,s=i-e;if(r<o&&e<i){const l=n.width*n.height,d=t.width*t.height,h=a*s,m=h/(l+d-h);return Number(m.toFixed(4))}return 0}const _l=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:r}=t;const o=[];for(const i of r){const{id:a}=i,s=e.get(a);if(s){const l=xl(s,n);l>0&&o.push({id:a,data:{droppableContainer:i,value:l}})}}return o.sort(yl)};function kl(t,n,e){return{...t,scaleX:n&&e?n.width/e.width:1,scaleY:n&&e?n.height/e.height:1}}function mo(t,n){return t&&n?{x:t.left-n.left,y:t.top-n.top}:Pt}function Cl(t){return function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.reduce((a,s)=>({...a,top:a.top+t*s.y,bottom:a.bottom+t*s.y,left:a.left+t*s.x,right:a.right+t*s.x}),{...e})}}const El=Cl(1);function Sl(t){if(t.startsWith("matrix3d(")){const n=t.slice(9,-1).split(/, /);return{x:+n[12],y:+n[13],scaleX:+n[0],scaleY:+n[5]}}else if(t.startsWith("matrix(")){const n=t.slice(7,-1).split(/, /);return{x:+n[4],y:+n[5],scaleX:+n[0],scaleY:+n[3]}}return null}function Rl(t,n,e){const r=Sl(n);if(!r)return t;const{scaleX:o,scaleY:i,x:a,y:s}=r,l=t.left-a-(1-o)*parseFloat(e),d=t.top-s-(1-i)*parseFloat(e.slice(e.indexOf(" ")+1)),h=o?t.width/o:t.width,m=i?t.height/i:t.height;return{width:h,height:m,top:d,right:l+h,bottom:d+m,left:l}}const Al={ignoreTransform:!1};function be(t,n){n===void 0&&(n=Al);let e=t.getBoundingClientRect();if(n.ignoreTransform){const{transform:d,transformOrigin:h}=Dt(t).getComputedStyle(t);d&&(e=Rl(e,d,h))}const{top:r,left:o,width:i,height:a,bottom:s,right:l}=e;return{top:r,left:o,width:i,height:a,bottom:s,right:l}}function ni(t){return be(t,{ignoreTransform:!0})}function Nl(t){const n=t.innerWidth,e=t.innerHeight;return{top:0,left:0,right:n,bottom:e,width:n,height:e}}function Il(t,n){return n===void 0&&(n=Dt(t).getComputedStyle(t)),n.position==="fixed"}function Tl(t,n){n===void 0&&(n=Dt(t).getComputedStyle(t));const e=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=n[o];return typeof i=="string"?e.test(i):!1})}function cr(t,n){const e=[];function r(o){if(n!=null&&e.length>=n||!o)return e;if(sr(o)&&o.scrollingElement!=null&&!e.includes(o.scrollingElement))return e.push(o.scrollingElement),e;if(!Ie(o)||fo(o)||e.includes(o))return e;const i=Dt(t).getComputedStyle(o);return o!==t&&Tl(o,i)&&e.push(o),Il(o,i)?e:r(o.parentNode)}return t?r(t):e}function go(t){const[n]=cr(t,1);return n??null}function Bn(t){return!Je||!t?null:me(t)?t:or(t)?sr(t)||t===ge(t).scrollingElement?window:Ie(t)?t:null:null}function bo(t){return me(t)?t.scrollX:t.scrollLeft}function yo(t){return me(t)?t.scrollY:t.scrollTop}function Vn(t){return{x:bo(t),y:yo(t)}}var At;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(At||(At={}));function vo(t){return!Je||!t?!1:t===document.scrollingElement}function wo(t){const n={x:0,y:0},e=vo(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-e.width,y:t.scrollHeight-e.height},o=t.scrollTop<=n.y,i=t.scrollLeft<=n.x,a=t.scrollTop>=r.y,s=t.scrollLeft>=r.x;return{isTop:o,isLeft:i,isBottom:a,isRight:s,maxScroll:r,minScroll:n}}const Dl={x:.2,y:.2};function zl(t,n,e,r,o){let{top:i,left:a,right:s,bottom:l}=e;r===void 0&&(r=10),o===void 0&&(o=Dl);const{isTop:d,isBottom:h,isLeft:m,isRight:b}=wo(t),u={x:0,y:0},y={x:0,y:0},f={height:n.height*o.y,width:n.width*o.x};return!d&&i<=n.top+f.height?(u.y=At.Backward,y.y=r*Math.abs((n.top+f.height-i)/f.height)):!h&&l>=n.bottom-f.height&&(u.y=At.Forward,y.y=r*Math.abs((n.bottom-f.height-l)/f.height)),!b&&s>=n.right-f.width?(u.x=At.Forward,y.x=r*Math.abs((n.right-f.width-s)/f.width)):!m&&a<=n.left+f.width&&(u.x=At.Backward,y.x=r*Math.abs((n.left+f.width-a)/f.width)),{direction:u,speed:y}}function jl(t){if(t===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:n,left:e,right:r,bottom:o}=t.getBoundingClientRect();return{top:n,left:e,right:r,bottom:o,width:t.clientWidth,height:t.clientHeight}}function xo(t){return t.reduce((n,e)=>ue(n,Vn(e)),Pt)}function Ll(t){return t.reduce((n,e)=>n+bo(e),0)}function Bl(t){return t.reduce((n,e)=>n+yo(e),0)}function Ml(t,n){if(n===void 0&&(n=be),!t)return;const{top:e,left:r,bottom:o,right:i}=n(t);go(t)&&(o<=0||i<=0||e>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const Pl=[["x",["left","right"],Ll],["y",["top","bottom"],Bl]];class dr{constructor(n,e){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=cr(e),o=xo(r);this.rect={...n},this.width=n.width,this.height=n.height;for(const[i,a,s]of Pl)for(const l of a)Object.defineProperty(this,l,{get:()=>{const d=s(r),h=o[i]-d;return this.rect[l]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ce{constructor(n){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...e)})},this.target=n}add(n,e,r){var o;(o=this.target)==null||o.addEventListener(n,e,r),this.listeners.push([n,e,r])}}function Ol(t){const{EventTarget:n}=Dt(t);return t instanceof n?t:ge(t)}function Mn(t,n){const e=Math.abs(t.x),r=Math.abs(t.y);return typeof n=="number"?Math.sqrt(e**2+r**2)>n:"x"in n&&"y"in n?e>n.x&&r>n.y:"x"in n?e>n.x:"y"in n?r>n.y:!1}var Mt;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Mt||(Mt={}));function ri(t){t.preventDefault()}function Fl(t){t.stopPropagation()}var mt;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(mt||(mt={}));const _o={start:[mt.Space,mt.Enter],cancel:[mt.Esc],end:[mt.Space,mt.Enter,mt.Tab]},Ul=(t,n)=>{let{currentCoordinates:e}=n;switch(t.code){case mt.Right:return{...e,x:e.x+25};case mt.Left:return{...e,x:e.x-25};case mt.Down:return{...e,y:e.y+25};case mt.Up:return{...e,y:e.y-25}}};class ko{constructor(n){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=n;const{event:{target:e}}=n;this.props=n,this.listeners=new Ce(ge(e)),this.windowListeners=new Ce(Dt(e)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Mt.Resize,this.handleCancel),this.windowListeners.add(Mt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Mt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:n,onStart:e}=this.props,r=n.node.current;r&&Ml(r),e(Pt)}handleKeyDown(n){if(lr(n)){const{active:e,context:r,options:o}=this.props,{keyboardCodes:i=_o,coordinateGetter:a=Ul,scrollBehavior:s="smooth"}=o,{code:l}=n;if(i.end.includes(l)){this.handleEnd(n);return}if(i.cancel.includes(l)){this.handleCancel(n);return}const{collisionRect:d}=r.current,h=d?{x:d.left,y:d.top}:Pt;this.referenceCoordinates||(this.referenceCoordinates=h);const m=a(n,{active:e,context:r.current,currentCoordinates:h});if(m){const b=$e(m,h),u={x:0,y:0},{scrollableAncestors:y}=r.current;for(const f of y){const v=n.code,{isTop:g,isRight:x,isLeft:k,isBottom:w,maxScroll:R,minScroll:T}=wo(f),_=jl(f),E={x:Math.min(v===mt.Right?_.right-_.width/2:_.right,Math.max(v===mt.Right?_.left:_.left+_.width/2,m.x)),y:Math.min(v===mt.Down?_.bottom-_.height/2:_.bottom,Math.max(v===mt.Down?_.top:_.top+_.height/2,m.y))},S=v===mt.Right&&!x||v===mt.Left&&!k,L=v===mt.Down&&!w||v===mt.Up&&!g;if(S&&E.x!==m.x){const U=f.scrollLeft+b.x,A=v===mt.Right&&U<=R.x||v===mt.Left&&U>=T.x;if(A&&!b.y){f.scrollTo({left:U,behavior:s});return}A?u.x=f.scrollLeft-U:u.x=v===mt.Right?f.scrollLeft-R.x:f.scrollLeft-T.x,u.x&&f.scrollBy({left:-u.x,behavior:s});break}else if(L&&E.y!==m.y){const U=f.scrollTop+b.y,A=v===mt.Down&&U<=R.y||v===mt.Up&&U>=T.y;if(A&&!b.x){f.scrollTo({top:U,behavior:s});return}A?u.y=f.scrollTop-U:u.y=v===mt.Down?f.scrollTop-R.y:f.scrollTop-T.y,u.y&&f.scrollBy({top:-u.y,behavior:s});break}}this.handleMove(n,ue($e(m,this.referenceCoordinates),u))}}}handleMove(n,e){const{onMove:r}=this.props;n.preventDefault(),r(e)}handleEnd(n){const{onEnd:e}=this.props;n.preventDefault(),this.detach(),e()}handleCancel(n){const{onCancel:e}=this.props;n.preventDefault(),this.detach(),e()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ko.activators=[{eventName:"onKeyDown",handler:(t,n,e)=>{let{keyboardCodes:r=_o,onActivation:o}=n,{active:i}=e;const{code:a}=t.nativeEvent;if(r.start.includes(a)){const s=i.activatorNode.current;return s&&t.target!==s?!1:(t.preventDefault(),o?.({event:t.nativeEvent}),!0)}return!1}}];function ii(t){return!!(t&&"distance"in t)}function oi(t){return!!(t&&"delay"in t)}class ur{constructor(n,e,r){var o;r===void 0&&(r=Ol(n.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=n,this.events=e;const{event:i}=n,{target:a}=i;this.props=n,this.events=e,this.document=ge(a),this.documentListeners=new Ce(this.document),this.listeners=new Ce(r),this.windowListeners=new Ce(Dt(a)),this.initialCoordinates=(o=Yn(i))!=null?o:Pt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:n,props:{options:{activationConstraint:e,bypassActivationConstraint:r}}}=this;if(this.listeners.add(n.move.name,this.handleMove,{passive:!1}),this.listeners.add(n.end.name,this.handleEnd),n.cancel&&this.listeners.add(n.cancel.name,this.handleCancel),this.windowListeners.add(Mt.Resize,this.handleCancel),this.windowListeners.add(Mt.DragStart,ri),this.windowListeners.add(Mt.VisibilityChange,this.handleCancel),this.windowListeners.add(Mt.ContextMenu,ri),this.documentListeners.add(Mt.Keydown,this.handleKeydown),e){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(oi(e)){this.timeoutId=setTimeout(this.handleStart,e.delay),this.handlePending(e);return}if(ii(e)){this.handlePending(e);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(n,e){const{active:r,onPending:o}=this.props;o(r,n,this.initialCoordinates,e)}handleStart(){const{initialCoordinates:n}=this,{onStart:e}=this.props;n&&(this.activated=!0,this.documentListeners.add(Mt.Click,Fl,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Mt.SelectionChange,this.removeTextSelection),e(n))}handleMove(n){var e;const{activated:r,initialCoordinates:o,props:i}=this,{onMove:a,options:{activationConstraint:s}}=i;if(!o)return;const l=(e=Yn(n))!=null?e:Pt,d=$e(o,l);if(!r&&s){if(ii(s)){if(s.tolerance!=null&&Mn(d,s.tolerance))return this.handleCancel();if(Mn(d,s.distance))return this.handleStart()}if(oi(s)&&Mn(d,s.tolerance))return this.handleCancel();this.handlePending(s,d);return}n.cancelable&&n.preventDefault(),a(l)}handleEnd(){const{onAbort:n,onEnd:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleCancel(){const{onAbort:n,onCancel:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleKeydown(n){n.code===mt.Esc&&this.handleCancel()}removeTextSelection(){var n;(n=this.document.getSelection())==null||n.removeAllRanges()}}const Wl={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class fr extends ur{constructor(n){const{event:e}=n,r=ge(e.target);super(n,Wl,r)}}fr.activators=[{eventName:"onPointerDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;return!e.isPrimary||e.button!==0?!1:(r?.({event:e}),!0)}}];const ql={move:{name:"mousemove"},end:{name:"mouseup"}};var Hn;(function(t){t[t.RightClick=2]="RightClick"})(Hn||(Hn={}));class Gl extends ur{constructor(n){super(n,ql,ge(n.event.target))}}Gl.activators=[{eventName:"onMouseDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;return e.button===Hn.RightClick?!1:(r?.({event:e}),!0)}}];const Pn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Co extends ur{constructor(n){super(n,Pn)}static setup(){return window.addEventListener(Pn.move.name,n,{capture:!1,passive:!1}),function(){window.removeEventListener(Pn.move.name,n)};function n(){}}}Co.activators=[{eventName:"onTouchStart",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;const{touches:o}=e;return o.length>1?!1:(r?.({event:e}),!0)}}];var Ee;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Ee||(Ee={}));var Ke;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ke||(Ke={}));function Yl(t){let{acceleration:n,activator:e=Ee.Pointer,canScroll:r,draggingRect:o,enabled:i,interval:a=5,order:s=Ke.TreeOrder,pointerCoordinates:l,scrollableAncestors:d,scrollableAncestorRects:h,delta:m,threshold:b}=t;const u=Hl({delta:m,disabled:!i}),[y,f]=nl(),v=z.useRef({x:0,y:0}),g=z.useRef({x:0,y:0}),x=z.useMemo(()=>{switch(e){case Ee.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Ee.DraggableRect:return o}},[e,o,l]),k=z.useRef(null),w=z.useCallback(()=>{const T=k.current;if(!T)return;const _=v.current.x*g.current.x,E=v.current.y*g.current.y;T.scrollBy(_,E)},[]),R=z.useMemo(()=>s===Ke.TreeOrder?[...d].reverse():d,[s,d]);z.useEffect(()=>{if(!i||!d.length||!x){f();return}for(const T of R){if(r?.(T)===!1)continue;const _=d.indexOf(T),E=h[_];if(!E)continue;const{direction:S,speed:L}=zl(T,E,x,n,b);for(const U of["x","y"])u[U][S[U]]||(L[U]=0,S[U]=0);if(L.x>0||L.y>0){f(),k.current=T,y(w,a),v.current=L,g.current=S;return}}v.current={x:0,y:0},g.current={x:0,y:0},f()},[n,w,r,f,i,a,JSON.stringify(x),JSON.stringify(u),y,d,R,h,JSON.stringify(b)])}const Vl={x:{[At.Backward]:!1,[At.Forward]:!1},y:{[At.Backward]:!1,[At.Forward]:!1}};function Hl(t){let{delta:n,disabled:e}=t;const r=Gn(n);return Te(o=>{if(e||!r||!o)return Vl;const i={x:Math.sign(n.x-r.x),y:Math.sign(n.y-r.y)};return{x:{[At.Backward]:o.x[At.Backward]||i.x===-1,[At.Forward]:o.x[At.Forward]||i.x===1},y:{[At.Backward]:o.y[At.Backward]||i.y===-1,[At.Forward]:o.y[At.Forward]||i.y===1}}},[e,n,r])}function Zl(t,n){const e=n!=null?t.get(n):void 0,r=e?e.node.current:null;return Te(o=>{var i;return n==null?null:(i=r??o)!=null?i:null},[r,n])}function $l(t,n){return z.useMemo(()=>t.reduce((e,r)=>{const{sensor:o}=r,i=o.activators.map(a=>({eventName:a.eventName,handler:n(a.handler,r)}));return[...e,...i]},[]),[t,n])}var Ne;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Ne||(Ne={}));var Zn;(function(t){t.Optimized="optimized"})(Zn||(Zn={}));const si=new Map;function Xl(t,n){let{dragging:e,dependencies:r,config:o}=n;const[i,a]=z.useState(null),{frequency:s,measure:l,strategy:d}=o,h=z.useRef(t),m=v(),b=Re(m),u=z.useCallback(function(g){g===void 0&&(g=[]),!b.current&&a(x=>x===null?g:x.concat(g.filter(k=>!x.includes(k))))},[b]),y=z.useRef(null),f=Te(g=>{if(m&&!e)return si;if(!g||g===si||h.current!==t||i!=null){const x=new Map;for(let k of t){if(!k)continue;if(i&&i.length>0&&!i.includes(k.id)&&k.rect.current){x.set(k.id,k.rect.current);continue}const w=k.node.current,R=w?new dr(l(w),w):null;k.rect.current=R,R&&x.set(k.id,R)}return x}return g},[t,i,e,m,l]);return z.useEffect(()=>{h.current=t},[t]),z.useEffect(()=>{m||u()},[e,m]),z.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),z.useEffect(()=>{m||typeof s!="number"||y.current!==null||(y.current=setTimeout(()=>{u(),y.current=null},s))},[s,m,u,...r]),{droppableRects:f,measureDroppableContainers:u,measuringScheduled:i!=null};function v(){switch(d){case Ne.Always:return!1;case Ne.BeforeDragging:return e;default:return!e}}}function Eo(t,n){return Te(e=>t?e||(typeof n=="function"?n(t):t):null,[n,t])}function Kl(t,n){return Eo(t,n)}function Ql(t){let{callback:n,disabled:e}=t;const r=ar(n),o=z.useMemo(()=>{if(e||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,e]);return z.useEffect(()=>()=>o?.disconnect(),[o]),o}function tn(t){let{callback:n,disabled:e}=t;const r=ar(n),o=z.useMemo(()=>{if(e||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[e]);return z.useEffect(()=>()=>o?.disconnect(),[o]),o}function Jl(t){return new dr(be(t),t)}function ai(t,n,e){n===void 0&&(n=Jl);const[r,o]=z.useState(null);function i(){o(l=>{if(!t)return null;if(t.isConnected===!1){var d;return(d=l??e)!=null?d:null}const h=n(t);return JSON.stringify(l)===JSON.stringify(h)?l:h})}const a=Ql({callback(l){if(t)for(const d of l){const{type:h,target:m}=d;if(h==="childList"&&m instanceof HTMLElement&&m.contains(t)){i();break}}}}),s=tn({callback:i});return qt(()=>{i(),t?(s?.observe(t),a?.observe(document.body,{childList:!0,subtree:!0})):(s?.disconnect(),a?.disconnect())},[t]),r}function tc(t){const n=Eo(t);return mo(t,n)}const li=[];function ec(t){const n=z.useRef(t),e=Te(r=>t?r&&r!==li&&t&&n.current&&t.parentNode===n.current.parentNode?r:cr(t):li,[t]);return z.useEffect(()=>{n.current=t},[t]),e}function nc(t){const[n,e]=z.useState(null),r=z.useRef(t),o=z.useCallback(i=>{const a=Bn(i.target);a&&e(s=>s?(s.set(a,Vn(a)),new Map(s)):null)},[]);return z.useEffect(()=>{const i=r.current;if(t!==i){a(i);const s=t.map(l=>{const d=Bn(l);return d?(d.addEventListener("scroll",o,{passive:!0}),[d,Vn(d)]):null}).filter(l=>l!=null);e(s.length?new Map(s):null),r.current=t}return()=>{a(t),a(i)};function a(s){s.forEach(l=>{const d=Bn(l);d?.removeEventListener("scroll",o)})}},[o,t]),z.useMemo(()=>t.length?n?Array.from(n.values()).reduce((i,a)=>ue(i,a),Pt):xo(t):Pt,[t,n])}function ci(t,n){n===void 0&&(n=[]);const e=z.useRef(null);return z.useEffect(()=>{e.current=null},n),z.useEffect(()=>{const r=t!==Pt;r&&!e.current&&(e.current=t),!r&&e.current&&(e.current=null)},[t]),e.current?$e(t,e.current):Pt}function rc(t){z.useEffect(()=>{if(!Je)return;const n=t.map(e=>{let{sensor:r}=e;return r.setup==null?void 0:r.setup()});return()=>{for(const e of n)e?.()}},t.map(n=>{let{sensor:e}=n;return e}))}function ic(t,n){return z.useMemo(()=>t.reduce((e,r)=>{let{eventName:o,handler:i}=r;return e[o]=a=>{i(a,n)},e},{}),[t,n])}function So(t){return z.useMemo(()=>t?Nl(t):null,[t])}const di=[];function oc(t,n){n===void 0&&(n=be);const[e]=t,r=So(e?Dt(e):null),[o,i]=z.useState(di);function a(){i(()=>t.length?t.map(l=>vo(l)?r:new dr(n(l),l)):di)}const s=tn({callback:a});return qt(()=>{s?.disconnect(),a(),t.forEach(l=>s?.observe(l))},[t]),o}function sc(t){if(!t)return null;if(t.children.length>1)return t;const n=t.children[0];return Ie(n)?n:t}function ac(t){let{measure:n}=t;const[e,r]=z.useState(null),o=z.useCallback(d=>{for(const{target:h}of d)if(Ie(h)){r(m=>{const b=n(h);return m?{...m,width:b.width,height:b.height}:b});break}},[n]),i=tn({callback:o}),a=z.useCallback(d=>{const h=sc(d);i?.disconnect(),h&&i?.observe(h),r(h?n(h):null)},[n,i]),[s,l]=Ze(a);return z.useMemo(()=>({nodeRef:s,rect:e,setRef:l}),[e,s,l])}const lc=[{sensor:fr,options:{}},{sensor:ko,options:{}}],cc={current:{}},Ve={draggable:{measure:ni},droppable:{measure:ni,strategy:Ne.WhileDragging,frequency:Zn.Optimized},dragOverlay:{measure:be}};class Se extends Map{get(n){var e;return n!=null&&(e=super.get(n))!=null?e:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(n=>{let{disabled:e}=n;return!e})}getNodeFor(n){var e,r;return(e=(r=this.get(n))==null?void 0:r.node.current)!=null?e:void 0}}const dc={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Se,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Xe},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ve,measureDroppableContainers:Xe,windowRect:null,measuringScheduled:!1},uc={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Xe,draggableNodes:new Map,over:null,measureDroppableContainers:Xe},en=z.createContext(uc),Ro=z.createContext(dc);function fc(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Se}}}function hc(t,n){switch(n.type){case Ct.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:n.initialCoordinates,active:n.active}};case Ct.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:n.coordinates.x-t.draggable.initialCoordinates.x,y:n.coordinates.y-t.draggable.initialCoordinates.y}}};case Ct.DragEnd:case Ct.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ct.RegisterDroppable:{const{element:e}=n,{id:r}=e,o=new Se(t.droppable.containers);return o.set(r,e),{...t,droppable:{...t.droppable,containers:o}}}case Ct.SetDroppableDisabled:{const{id:e,key:r,disabled:o}=n,i=t.droppable.containers.get(e);if(!i||r!==i.key)return t;const a=new Se(t.droppable.containers);return a.set(e,{...i,disabled:o}),{...t,droppable:{...t.droppable,containers:a}}}case Ct.UnregisterDroppable:{const{id:e,key:r}=n,o=t.droppable.containers.get(e);if(!o||r!==o.key)return t;const i=new Se(t.droppable.containers);return i.delete(e),{...t,droppable:{...t.droppable,containers:i}}}default:return t}}function pc(t){let{disabled:n}=t;const{active:e,activatorEvent:r,draggableNodes:o}=z.useContext(en),i=Gn(r),a=Gn(e?.id);return z.useEffect(()=>{if(!n&&!r&&i&&a!=null){if(!lr(i)||document.activeElement===i.target)return;const s=o.get(a);if(!s)return;const{activatorNode:l,node:d}=s;if(!l.current&&!d.current)return;requestAnimationFrame(()=>{for(const h of[l.current,d.current]){if(!h)continue;const m=ol(h);if(m){m.focus();break}}})}},[r,n,o,a,i]),null}function mc(t,n){let{transform:e,...r}=n;return t!=null&&t.length?t.reduce((o,i)=>i({transform:o,...r}),e):e}function gc(t){return z.useMemo(()=>({draggable:{...Ve.draggable,...t?.draggable},droppable:{...Ve.droppable,...t?.droppable},dragOverlay:{...Ve.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function bc(t){let{activeNode:n,measure:e,initialRect:r,config:o=!0}=t;const i=z.useRef(!1),{x:a,y:s}=typeof o=="boolean"?{x:o,y:o}:o;qt(()=>{if(!a&&!s||!n){i.current=!1;return}if(i.current||!r)return;const d=n?.node.current;if(!d||d.isConnected===!1)return;const h=e(d),m=mo(h,r);if(a||(m.x=0),s||(m.y=0),i.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const b=go(d);b&&b.scrollBy({top:m.y,left:m.x})}},[n,a,s,r,e])}const Ao=z.createContext({...Pt,scaleX:1,scaleY:1});var te;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(te||(te={}));const yc=z.memo(function(n){var e,r,o,i;let{id:a,accessibility:s,autoScroll:l=!0,children:d,sensors:h=lc,collisionDetection:m=_l,measuring:b,modifiers:u,...y}=n;const f=z.useReducer(hc,void 0,fc),[v,g]=f,[x,k]=ul(),[w,R]=z.useState(te.Uninitialized),T=w===te.Initialized,{draggable:{active:_,nodes:E,translate:S},droppable:{containers:L}}=v,U=_!=null?E.get(_):null,A=z.useRef({initial:null,translated:null}),C=z.useMemo(()=>{var wt;return _!=null?{id:_,data:(wt=U?.data)!=null?wt:cc,rect:A}:null},[_,U]),c=z.useRef(null),[F,Z]=z.useState(null),[q,Y]=z.useState(null),P=Re(y,Object.values(y)),tt=De("DndDescribedBy",a),M=z.useMemo(()=>L.getEnabled(),[L]),B=gc(b),{droppableRects:J,measureDroppableContainers:$,measuringScheduled:X}=Xl(M,{dragging:T,dependencies:[S.x,S.y],config:B.droppable}),dt=Zl(E,_),lt=z.useMemo(()=>q?Yn(q):null,[q]),it=Le(),at=Kl(dt,B.draggable.measure);bc({activeNode:_!=null?E.get(_):null,config:it.layoutShiftCompensation,initialRect:at,measure:B.draggable.measure});const ot=ai(dt,B.draggable.measure,at),pt=ai(dt?dt.parentElement:null),gt=z.useRef({activatorEvent:null,active:null,activeNode:dt,collisionRect:null,collisions:null,droppableRects:J,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Et=L.getNodeFor((e=gt.current.over)==null?void 0:e.id),p=ac({measure:B.dragOverlay.measure}),G=(r=p.nodeRef.current)!=null?r:dt,W=T?(o=p.rect)!=null?o:ot:null,D=!!(p.nodeRef.current&&p.rect),N=tc(D?null:ot),j=So(G?Dt(G):null),V=ec(T?Et??dt:null),H=oc(V),O=mc(u,{transform:{x:S.x-N.x,y:S.y-N.y,scaleX:1,scaleY:1},activatorEvent:q,active:C,activeNodeRect:ot,containerNodeRect:pt,draggingNodeRect:W,over:gt.current.over,overlayNodeRect:p.rect,scrollableAncestors:V,scrollableAncestorRects:H,windowRect:j}),K=lt?ue(lt,S):null,et=nc(V),Q=ci(et),st=ci(et,[ot]),ht=ue(O,Q),ct=W?El(W,O):null,St=C&&ct?m({active:C,collisionRect:ct,droppableRects:J,droppableContainers:M,pointerCoordinates:K}):null,Ht=vl(St,"id"),[_t,Zt]=z.useState(null),yt=D?O:ue(O,st),oe=kl(yt,(i=_t?.rect)!=null?i:null,ot),ee=z.useRef(null),Lt=z.useCallback((wt,Rt)=>{let{sensor:zt,options:$t}=Rt;if(c.current==null)return;const Bt=E.get(c.current);if(!Bt)return;const jt=wt.nativeEvent,Ot=new zt({active:c.current,activeNode:Bt,event:jt,options:$t,context:gt,onAbort(Nt){if(!E.get(Nt))return;const{onDragAbort:Ft}=P.current,Gt={id:Nt};Ft?.(Gt),x({type:"onDragAbort",event:Gt})},onPending(Nt,Xt,Ft,Gt){if(!E.get(Nt))return;const{onDragPending:ve}=P.current,Kt={id:Nt,constraint:Xt,initialCoordinates:Ft,offset:Gt};ve?.(Kt),x({type:"onDragPending",event:Kt})},onStart(Nt){const Xt=c.current;if(Xt==null)return;const Ft=E.get(Xt);if(!Ft)return;const{onDragStart:Gt}=P.current,ye={activatorEvent:jt,active:{id:Xt,data:Ft.data,rect:A}};ke.unstable_batchedUpdates(()=>{Gt?.(ye),R(te.Initializing),g({type:Ct.DragStart,initialCoordinates:Nt,active:Xt}),x({type:"onDragStart",event:ye}),Z(ee.current),Y(jt)})},onMove(Nt){g({type:Ct.DragMove,coordinates:Nt})},onEnd:se(Ct.DragEnd),onCancel:se(Ct.DragCancel)});ee.current=Ot;function se(Nt){return async function(){const{active:Ft,collisions:Gt,over:ye,scrollAdjustedTranslate:ve}=gt.current;let Kt=null;if(Ft&&ve){const{cancelDrop:we}=P.current;Kt={activatorEvent:jt,active:Ft,collisions:Gt,delta:ve,over:ye},Nt===Ct.DragEnd&&typeof we=="function"&&await Promise.resolve(we(Kt))&&(Nt=Ct.DragCancel)}c.current=null,ke.unstable_batchedUpdates(()=>{g({type:Nt}),R(te.Uninitialized),Zt(null),Z(null),Y(null),ee.current=null;const we=Nt===Ct.DragEnd?"onDragEnd":"onDragCancel";if(Kt){const on=P.current[we];on?.(Kt),x({type:we,event:Kt})}})}}},[E]),ze=z.useCallback((wt,Rt)=>(zt,$t)=>{const Bt=zt.nativeEvent,jt=E.get($t);if(c.current!==null||!jt||Bt.dndKit||Bt.defaultPrevented)return;const Ot={active:jt};wt(zt,Rt.options,Ot)===!0&&(Bt.dndKit={capturedBy:Rt.sensor},c.current=$t,Lt(zt,Rt))},[E,Lt]),je=$l(h,ze);rc(h),qt(()=>{ot&&w===te.Initializing&&R(te.Initialized)},[ot,w]),z.useEffect(()=>{const{onDragMove:wt}=P.current,{active:Rt,activatorEvent:zt,collisions:$t,over:Bt}=gt.current;if(!Rt||!zt)return;const jt={active:Rt,activatorEvent:zt,collisions:$t,delta:{x:ht.x,y:ht.y},over:Bt};ke.unstable_batchedUpdates(()=>{wt?.(jt),x({type:"onDragMove",event:jt})})},[ht.x,ht.y]),z.useEffect(()=>{const{active:wt,activatorEvent:Rt,collisions:zt,droppableContainers:$t,scrollAdjustedTranslate:Bt}=gt.current;if(!wt||c.current==null||!Rt||!Bt)return;const{onDragOver:jt}=P.current,Ot=$t.get(Ht),se=Ot&&Ot.rect.current?{id:Ot.id,rect:Ot.rect.current,data:Ot.data,disabled:Ot.disabled}:null,Nt={active:wt,activatorEvent:Rt,collisions:zt,delta:{x:Bt.x,y:Bt.y},over:se};ke.unstable_batchedUpdates(()=>{Zt(se),jt?.(Nt),x({type:"onDragOver",event:Nt})})},[Ht]),qt(()=>{gt.current={activatorEvent:q,active:C,activeNode:dt,collisionRect:ct,collisions:St,droppableRects:J,draggableNodes:E,draggingNode:G,draggingNodeRect:W,droppableContainers:L,over:_t,scrollableAncestors:V,scrollAdjustedTranslate:ht},A.current={initial:W,translated:ct}},[C,dt,St,ct,E,G,W,J,L,_t,V,ht]),Yl({...it,delta:S,draggingRect:ct,pointerCoordinates:K,scrollableAncestors:V,scrollableAncestorRects:H});const nn=z.useMemo(()=>({active:C,activeNode:dt,activeNodeRect:ot,activatorEvent:q,collisions:St,containerNodeRect:pt,dragOverlay:p,draggableNodes:E,droppableContainers:L,droppableRects:J,over:_t,measureDroppableContainers:$,scrollableAncestors:V,scrollableAncestorRects:H,measuringConfiguration:B,measuringScheduled:X,windowRect:j}),[C,dt,ot,q,St,pt,p,E,L,J,_t,$,V,H,B,X,j]),rn=z.useMemo(()=>({activatorEvent:q,activators:je,active:C,activeNodeRect:ot,ariaDescribedById:{draggable:tt},dispatch:g,draggableNodes:E,over:_t,measureDroppableContainers:$}),[q,je,C,ot,g,tt,E,_t,$]);return Tt.createElement(po.Provider,{value:k},Tt.createElement(en.Provider,{value:rn},Tt.createElement(Ro.Provider,{value:nn},Tt.createElement(Ao.Provider,{value:oe},d)),Tt.createElement(pc,{disabled:s?.restoreFocus===!1})),Tt.createElement(pl,{...s,hiddenTextDescribedById:tt}));function Le(){const wt=F?.autoScrollEnabled===!1,Rt=typeof l=="object"?l.enabled===!1:l===!1,zt=T&&!wt&&!Rt;return typeof l=="object"?{...l,enabled:zt}:{enabled:zt}}}),vc=z.createContext(null),ui="button",wc="Draggable";function xc(t){let{id:n,data:e,disabled:r=!1,attributes:o}=t;const i=De(wc),{activators:a,activatorEvent:s,active:l,activeNodeRect:d,ariaDescribedById:h,draggableNodes:m,over:b}=z.useContext(en),{role:u=ui,roleDescription:y="draggable",tabIndex:f=0}=o??{},v=l?.id===n,g=z.useContext(v?Ao:vc),[x,k]=Ze(),[w,R]=Ze(),T=ic(a,n),_=Re(e);qt(()=>(m.set(n,{id:n,key:i,node:x,activatorNode:w,data:_}),()=>{const S=m.get(n);S&&S.key===i&&m.delete(n)}),[m,n]);const E=z.useMemo(()=>({role:u,tabIndex:f,"aria-disabled":r,"aria-pressed":v&&u===ui?!0:void 0,"aria-roledescription":y,"aria-describedby":h.draggable}),[r,u,f,v,y,h.draggable]);return{active:l,activatorEvent:s,activeNodeRect:d,attributes:E,isDragging:v,listeners:r?void 0:T,node:x,over:b,setNodeRef:k,setActivatorNodeRef:R,transform:g}}function _c(){return z.useContext(Ro)}const kc="Droppable",Cc={timeout:25};function Ec(t){let{data:n,disabled:e=!1,id:r,resizeObserverConfig:o}=t;const i=De(kc),{active:a,dispatch:s,over:l,measureDroppableContainers:d}=z.useContext(en),h=z.useRef({disabled:e}),m=z.useRef(!1),b=z.useRef(null),u=z.useRef(null),{disabled:y,updateMeasurementsFor:f,timeout:v}={...Cc,...o},g=Re(f??r),x=z.useCallback(()=>{if(!m.current){m.current=!0;return}u.current!=null&&clearTimeout(u.current),u.current=setTimeout(()=>{d(Array.isArray(g.current)?g.current:[g.current]),u.current=null},v)},[v]),k=tn({callback:x,disabled:y||!a}),w=z.useCallback((E,S)=>{k&&(S&&(k.unobserve(S),m.current=!1),E&&k.observe(E))},[k]),[R,T]=Ze(w),_=Re(n);return z.useEffect(()=>{!k||!R.current||(k.disconnect(),m.current=!1,k.observe(R.current))},[R,k]),z.useEffect(()=>(s({type:Ct.RegisterDroppable,element:{id:r,key:i,disabled:e,node:R,rect:b,data:_}}),()=>s({type:Ct.UnregisterDroppable,key:i,id:r})),[r]),z.useEffect(()=>{e!==h.current.disabled&&(s({type:Ct.SetDroppableDisabled,id:r,key:i,disabled:e}),h.current.disabled=e)},[r,i,e,s]),{active:a,rect:b,isOver:l?.id===r,node:R,over:l,setNodeRef:T}}function hr(t,n,e){const r=t.slice();return r.splice(e<0?r.length+e:e,0,r.splice(n,1)[0]),r}function Sc(t,n){return t.reduce((e,r,o)=>{const i=n.get(r);return i&&(e[o]=i),e},Array(t.length))}function qe(t){return t!==null&&t>=0}function Rc(t,n){if(t===n)return!0;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function Ac(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const pr=t=>{let{rects:n,activeIndex:e,overIndex:r,index:o}=t;const i=hr(n,r,e),a=n[o],s=i[o];return!s||!a?null:{x:s.left-a.left,y:s.top-a.top,scaleX:s.width/a.width,scaleY:s.height/a.height}},No="Sortable",Io=Tt.createContext({activeIndex:-1,containerId:No,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:pr,disabled:{draggable:!1,droppable:!1}});function Nc(t){let{children:n,id:e,items:r,strategy:o=pr,disabled:i=!1}=t;const{active:a,dragOverlay:s,droppableRects:l,over:d,measureDroppableContainers:h}=_c(),m=De(No,e),b=s.rect!==null,u=z.useMemo(()=>r.map(T=>typeof T=="object"&&"id"in T?T.id:T),[r]),y=a!=null,f=a?u.indexOf(a.id):-1,v=d?u.indexOf(d.id):-1,g=z.useRef(u),x=!Rc(u,g.current),k=v!==-1&&f===-1||x,w=Ac(i);qt(()=>{x&&y&&h(u)},[x,u,y,h]),z.useEffect(()=>{g.current=u},[u]);const R=z.useMemo(()=>({activeIndex:f,containerId:m,disabled:w,disableTransforms:k,items:u,overIndex:v,useDragOverlay:b,sortedRects:Sc(u,l),strategy:o}),[f,m,w.draggable,w.droppable,k,u,v,l,b,o]);return Tt.createElement(Io.Provider,{value:R},n)}const Ic=t=>{let{id:n,items:e,activeIndex:r,overIndex:o}=t;return hr(e,r,o).indexOf(n)},Tc=t=>{let{containerId:n,isSorting:e,wasDragging:r,index:o,items:i,newIndex:a,previousItems:s,previousContainerId:l,transition:d}=t;return!d||!r||s!==i&&o===a?!1:e?!0:a!==o&&n===l},Dc={duration:200,easing:"ease"},To="transform",zc=Ae.Transition.toString({property:To,duration:0,easing:"linear"}),jc={roleDescription:"sortable"};function Lc(t){let{disabled:n,index:e,node:r,rect:o}=t;const[i,a]=z.useState(null),s=z.useRef(e);return qt(()=>{if(!n&&e!==s.current&&r.current){const l=o.current;if(l){const d=be(r.current,{ignoreTransform:!0}),h={x:l.left-d.left,y:l.top-d.top,scaleX:l.width/d.width,scaleY:l.height/d.height};(h.x||h.y)&&a(h)}}e!==s.current&&(s.current=e)},[n,e,r,o]),z.useEffect(()=>{i&&a(null)},[i]),i}function Bc(t){let{animateLayoutChanges:n=Tc,attributes:e,disabled:r,data:o,getNewIndex:i=Ic,id:a,strategy:s,resizeObserverConfig:l,transition:d=Dc}=t;const{items:h,containerId:m,activeIndex:b,disabled:u,disableTransforms:y,sortedRects:f,overIndex:v,useDragOverlay:g,strategy:x}=z.useContext(Io),k=Mc(r,u),w=h.indexOf(a),R=z.useMemo(()=>({sortable:{containerId:m,index:w,items:h},...o}),[m,o,w,h]),T=z.useMemo(()=>h.slice(h.indexOf(a)),[h,a]),{rect:_,node:E,isOver:S,setNodeRef:L}=Ec({id:a,data:R,disabled:k.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...l}}),{active:U,activatorEvent:A,activeNodeRect:C,attributes:c,setNodeRef:F,listeners:Z,isDragging:q,over:Y,setActivatorNodeRef:P,transform:tt}=xc({id:a,data:R,attributes:{...jc,...e},disabled:k.draggable}),M=el(L,F),B=!!U,J=B&&!y&&qe(b)&&qe(v),$=!g&&q,X=$&&J?tt:null,lt=J?X??(s??x)({rects:f,activeNodeRect:C,activeIndex:b,overIndex:v,index:w}):null,it=qe(b)&&qe(v)?i({id:a,items:h,activeIndex:b,overIndex:v}):w,at=U?.id,ot=z.useRef({activeId:at,items:h,newIndex:it,containerId:m}),pt=h!==ot.current.items,gt=n({active:U,containerId:m,isDragging:q,isSorting:B,id:a,index:w,items:h,newIndex:ot.current.newIndex,previousItems:ot.current.items,previousContainerId:ot.current.containerId,transition:d,wasDragging:ot.current.activeId!=null}),Et=Lc({disabled:!gt,index:w,node:E,rect:_});return z.useEffect(()=>{B&&ot.current.newIndex!==it&&(ot.current.newIndex=it),m!==ot.current.containerId&&(ot.current.containerId=m),h!==ot.current.items&&(ot.current.items=h)},[B,it,m,h]),z.useEffect(()=>{if(at===ot.current.activeId)return;if(at!=null&&ot.current.activeId==null){ot.current.activeId=at;return}const G=setTimeout(()=>{ot.current.activeId=at},50);return()=>clearTimeout(G)},[at]),{active:U,activeIndex:b,attributes:c,data:R,rect:_,index:w,newIndex:it,items:h,isOver:S,isSorting:B,isDragging:q,listeners:Z,node:E,overIndex:v,over:Y,setNodeRef:M,setActivatorNodeRef:P,setDroppableNodeRef:L,setDraggableNodeRef:F,transform:Et??lt,transition:p()};function p(){if(Et||pt&&ot.current.newIndex===w)return zc;if(!($&&!lr(A)||!d)&&(B||gt))return Ae.Transition.toString({...d,property:To})}}function Mc(t,n){var e,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(e=t?.draggable)!=null?e:n.draggable,droppable:(r=t?.droppable)!=null?r:n.droppable}}mt.Down,mt.Right,mt.Up,mt.Left;function Pc({id:t,children:n}){const{attributes:e,listeners:r,setNodeRef:o,transform:i,transition:a,isDragging:s,isSorting:l}=Bc({id:t}),d={transform:Ae.Translate.toString(i),transition:a,position:"relative",zIndex:s?9999:l?2:1,cursor:s?"grabbing":"grab",touchAction:"none"};return I.jsx("div",{ref:o,style:d,...e,...r,children:n})}async function Oc(t,n={}){const e=n.format??"png",r=Math.max(.5,Math.min(.95,n.quality??.8)),o=new Qn,i=o.folder("images");if(!i)throw new Error("ZIP: cannot create images/");for(let a=0;a<t.length;a++){const s=await uo(t[a].id,It),l=e==="jpeg"?await Uc(s,r):s,d=e==="jpeg"?"jpg":"png",h=`card-${String(a+1).padStart(3,"0")}.${d}`;i.file(h,Fc(l)),n.onProgress?.({done:a+1,total:t.length})}return o.generateAsync({type:"blob",compression:"DEFLATE"})}function Fc(t){const n=t.indexOf(","),e=t.slice(n+1),r=atob(e),o=new Uint8Array(r.length);for(let i=0;i<r.length;i++)o[i]=r.charCodeAt(i);return o}async function Uc(t,n){const e=await Wc(t),r=document.createElement("canvas");r.width=Math.max(1,e.naturalWidth||e.width||1),r.height=Math.max(1,e.naturalHeight||e.height||1);const o=r.getContext("2d");if(!o)throw new Error("Canvas2D unavailable");return o.drawImage(e,0,0),r.toDataURL("image/jpeg",n)}function Wc(t){return new Promise((n,e)=>{const r=new Image;r.onload=()=>n(r),r.onerror=e,r.src=t})}function fi(t){const n=t/1e3;return n<60?`${n.toFixed(1)}s`:`${Math.floor(n/60)}m ${(n%60).toFixed(0)}s`}class qc extends fr{static activators=[{eventName:"onPointerDown",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}class Gc extends Co{static activators=[{eventName:"onTouchStart",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}function Yc(){const t=ft(w=>w.photos),n=ft(w=>w.reorderPhotos),[e,r]=z.useState(!1),[o,i]=z.useState(null),a=z.useRef(!1),[s,l]=z.useState("jpeg"),[d,h]=z.useState(Gs*100),m=o?.pct??0,b=z.useMemo(()=>{if(!o)return"";const w=o.etaMs??0;return`Rendering ${o.done}/${o.total} • ${m}% • elapsed ${fi(o.elapsedMs)}${o.done<o.total?` • ETA ${fi(w)}`:""}`},[o,m]);z.useEffect(()=>{o&&o.done>=o.total&&i(null)},[o]);const u=z.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{r(!0),i({done:0,total:t.length,elapsedMs:0,pct:0});const w=performance.now(),R=await Oc(t,{format:s,quality:s==="jpeg"?d/100:void 0,onProgress:({done:E,total:S})=>{const L=performance.now()-w,U=Math.round(E/S*100);i({done:E,total:S,elapsedMs:L,pct:U})}}),T=URL.createObjectURL(R),_=document.createElement("a");_.href=T,_.download="story-squares-images.zip",document.body.appendChild(_),_.click(),_.remove(),URL.revokeObjectURL(T)}finally{r(!1),a.current=!1}}},[t,s,d]),y=z.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{r(!0);const{exportCardsToPdf:w}=await ns(async()=>{const{exportCardsToPdf:S}=await import("./pdf-VQF4wXTx.js");return{exportCardsToPdf:S}},__vite__mapDeps([0,1,2,3])),R=await w(t,{format:s,quality:s==="jpeg"?d/100:void 0,onProgress:S=>i(S)}),T=new Blob([R],{type:"application/pdf"}),_=URL.createObjectURL(T),E=document.createElement("a");E.href=_,E.download="story-squares.pdf",document.body.appendChild(E),E.click(),E.remove(),URL.revokeObjectURL(_)}finally{r(!1),a.current=!1}}},[t,s,d]),f=z.useCallback(async()=>{r(!0);try{const w=await Sa({imageFormat:s,quality:s==="jpeg"?d/100:void 0,onProgress:({done:_,total:E})=>i({done:_,total:E,elapsedMs:0,pct:Math.round(_/E*100)})}),R=URL.createObjectURL(w),T=document.createElement("a");T.href=R,T.download="story-squares.zip",document.body.appendChild(T),T.click(),T.remove(),URL.revokeObjectURL(R)}finally{r(!1)}},[s,d]),v=Tt.useRef(null),g=z.useCallback(async w=>{try{const{warnings:R}=await Ji(w);R.length&&alert(`Import finished with warnings:
`+R.join(`
`))}catch(R){alert("Import failed: "+(R?.message||String(R)))}},[]),x=ml(ti(qc,{activationConstraint:{distance:6}}),ti(Gc,{activationConstraint:{delay:120,tolerance:6}})),k=t.map(w=>w.id);return I.jsxs("section",{className:"space-y-3",children:[I.jsx(yc,{sensors:x,collisionDetection:wl,onDragEnd:({active:w,over:R})=>{if(!R||w.id===R.id)return;const T=k.indexOf(String(w.id)),_=k.indexOf(String(R.id));if(T===-1||_===-1)return;const E=hr(k,T,_);n(E)},children:I.jsx(Nc,{items:k,strategy:pr,children:I.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:t.map(w=>I.jsx(Pc,{id:w.id,children:I.jsx(tl,{photo:w})},w.id))})})}),t.length>0&&I.jsxs(to,{className:"p-4",children:[I.jsx("div",{className:"mb-3 text-sm font-medium",children:"Export the collection to..."}),o&&I.jsxs(I.Fragment,{children:[I.jsx(eo,{value:m,className:"mb-1 h-2"}),I.jsx("div",{className:"mb-3 text-xs opacity-70",children:b})]}),I.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("span",{className:"opacity-70",children:"Format"}),I.jsxs(no,{value:s,onValueChange:w=>l(w),children:[I.jsx(Jn,{className:"w-28 h-8",children:I.jsx(ro,{placeholder:"Format"})}),I.jsxs(tr,{children:[I.jsx(de,{value:"jpeg",children:"JPEG (small)"}),I.jsx(de,{value:"png",children:"PNG (lossless)"})]})]})]}),s==="jpeg"&&I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("span",{className:"opacity-70",children:"Quality"}),I.jsx("input",{type:"range",min:50,max:95,step:5,value:d,onChange:w=>h(Number(w.target.value))}),I.jsxs("span",{className:"tabular-nums",children:[d,"%"]})]}),I.jsx("div",{className:"grow"}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx(xt,{type:"button",size:"sm",onClick:f,disabled:!t.length||e,children:"Save collection (.zip)"}),I.jsx("input",{ref:v,type:"file",accept:".zip,application/zip",className:"hidden",onChange:w=>{const R=w.currentTarget.files?.[0];R&&g(R),w.currentTarget.value=""}}),I.jsx(xt,{type:"button",size:"sm",onClick:u,disabled:!t.length||e,children:"Export images (.zip)"}),I.jsx(xt,{type:"button",size:"sm",onClick:y,disabled:!t.length||e,children:e?"Exporting…":"Export PDF"})]})]})]})]})}function Vc(){return rs(),I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"sticky top-0 z-10 w-full py-3 text-center text-3xl font-bold bg-background border-b border-gray-300",children:"Story Squares v1.1"}),I.jsxs("main",{className:"mx-auto max-w-screen-md px-4 space-y-5",children:[I.jsx(Ta,{}),I.jsx(Yc,{})]})]})}gi.createRoot(document.getElementById("root")).render(I.jsx(Tt.StrictMode,{children:I.jsx(Vc,{})}));export{It as C,Gs as P,uo as e};
