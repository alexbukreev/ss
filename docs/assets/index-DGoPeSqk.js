const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-DA6H-Wju.js","assets/pdf-lib-F-JeKLTy.js","assets/vendor-react-CbJ0mb0J.js","assets/vendor-ui-CE-nAiqY.js"])))=>i.map(i=>d[i]);
import{r as x,j as o,k as At,R as Ft,C as _e,m as Ut,n as Bt,X as $t,S as Ot,L as Dt,T as _t,p as Gt,q as Vt}from"./vendor-react-CbJ0mb0J.js";import{S as Ht,R as Ge,I as Wt,T as Ve,a as Xt,b as He,c as We,P as qt,C as Xe,V as Yt,L as qe,d as Ye,e as Qt,f as Zt,g as Qe,h as Jt,i as Kt,O as Ze,j as er,k as Je,l as tr,m as Ke,D as et,n as rr,o as tt,p as rt,q as sr,r as or,s as nr,t as ar}from"./vendor-ui-CE-nAiqY.js";import"./pdf-lib-F-JeKLTy.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();function ue(e){const s=document.documentElement,t=window.matchMedia("(prefers-color-scheme: dark)").matches,r=e==="dark"||e==="system"&&t;s.classList.toggle("dark",r)}function ir(){x.useEffect(()=>{const e=localStorage.getItem("theme")??"system";ue(e);const s=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>{const n=localStorage.getItem("theme")??"system";n==="system"&&ue(n)};s.addEventListener("change",t);const r=n=>{if(n.key==="theme"){const a=n.newValue??"system";ue(a)}};return window.addEventListener("storage",r),()=>{s.removeEventListener("change",t),window.removeEventListener("storage",r)}},[])}function st(e){var s,t,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(s=0;s<n;s++)e[s]&&(t=st(e[s]))&&(r&&(r+=" "),r+=t)}else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function ot(){for(var e,s,t=0,r="",n=arguments.length;t<n;t++)(e=arguments[t])&&(s=st(e))&&(r&&(r+=" "),r+=s);return r}const Ee=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Ie=ot,nt=(e,s)=>t=>{var r;if(s?.variants==null)return Ie(e,t?.class,t?.className);const{variants:n,defaultVariants:a}=s,l=Object.keys(n).map(d=>{const p=t?.[d],f=a?.[d];if(p===null)return null;const g=Ee(p)||Ee(f);return n[d][g]}),i=t&&Object.entries(t).reduce((d,p)=>{let[f,g]=p;return g===void 0||(d[f]=g),d},{}),c=s==null||(r=s.compoundVariants)===null||r===void 0?void 0:r.reduce((d,p)=>{let{class:f,className:g,...v}=p;return Object.entries(v).every(m=>{let[k,R]=m;return Array.isArray(R)?R.includes({...a,...i}[k]):{...a,...i}[k]===R})?[...d,f,g]:d},[]);return Ie(e,l,c,t?.class,t?.className)},ke="-",lr=e=>{const s=dr(e),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:l=>{const i=l.split(ke);return i[0]===""&&i.length!==1&&i.shift(),at(i,s)||cr(l)},getConflictingClassGroupIds:(l,i)=>{const c=t[l]||[];return i&&r[l]?[...c,...r[l]]:c}}},at=(e,s)=>{if(e.length===0)return s.classGroupId;const t=e[0],r=s.nextPart.get(t),n=r?at(e.slice(1),r):void 0;if(n)return n;if(s.validators.length===0)return;const a=e.join(ke);return s.validators.find(({validator:l})=>l(a))?.classGroupId},Te=/^\[(.+)\]$/,cr=e=>{if(Te.test(e)){const s=Te.exec(e)[1],t=s?.substring(0,s.indexOf(":"));if(t)return"arbitrary.."+t}},dr=e=>{const{theme:s,classGroups:t}=e,r={nextPart:new Map,validators:[]};for(const n in t)xe(t[n],r,n,s);return r},xe=(e,s,t,r)=>{e.forEach(n=>{if(typeof n=="string"){const a=n===""?s:Ae(s,n);a.classGroupId=t;return}if(typeof n=="function"){if(mr(n)){xe(n(r),s,t,r);return}s.validators.push({validator:n,classGroupId:t});return}Object.entries(n).forEach(([a,l])=>{xe(l,Ae(s,a),t,r)})})},Ae=(e,s)=>{let t=e;return s.split(ke).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},mr=e=>e.isThemeGetter,ur=e=>{if(e<1)return{get:()=>{},set:()=>{}};let s=0,t=new Map,r=new Map;const n=(a,l)=>{t.set(a,l),s++,s>e&&(s=0,r=t,t=new Map)};return{get(a){let l=t.get(a);if(l!==void 0)return l;if((l=r.get(a))!==void 0)return n(a,l),l},set(a,l){t.has(a)?t.set(a,l):n(a,l)}}},be="!",ye=":",fr=ye.length,pr=e=>{const{prefix:s,experimentalParseClassName:t}=e;let r=n=>{const a=[];let l=0,i=0,c=0,d;for(let m=0;m<n.length;m++){let k=n[m];if(l===0&&i===0){if(k===ye){a.push(n.slice(c,m)),c=m+fr;continue}if(k==="/"){d=m;continue}}k==="["?l++:k==="]"?l--:k==="("?i++:k===")"&&i--}const p=a.length===0?n:n.substring(c),f=gr(p),g=f!==p,v=d&&d>c?d-c:void 0;return{modifiers:a,hasImportantModifier:g,baseClassName:f,maybePostfixModifierPosition:v}};if(s){const n=s+ye,a=r;r=l=>l.startsWith(n)?a(l.substring(n.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:l,maybePostfixModifierPosition:void 0}}if(t){const n=r;r=a=>t({className:a,parseClassName:n})}return r},gr=e=>e.endsWith(be)?e.substring(0,e.length-1):e.startsWith(be)?e.substring(1):e,hr=e=>{const s=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const n=[];let a=[];return r.forEach(l=>{l[0]==="["||s[l]?(n.push(...a.sort(),l),a=[]):a.push(l)}),n.push(...a.sort()),n}},xr=e=>({cache:ur(e.cacheSize),parseClassName:pr(e),sortModifiers:hr(e),...lr(e)}),br=/\s+/,yr=(e,s)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:n,sortModifiers:a}=s,l=[],i=e.trim().split(br);let c="";for(let d=i.length-1;d>=0;d-=1){const p=i[d],{isExternal:f,modifiers:g,hasImportantModifier:v,baseClassName:m,maybePostfixModifierPosition:k}=t(p);if(f){c=p+(c.length>0?" "+c:c);continue}let R=!!k,S=r(R?m.substring(0,k):m);if(!S){if(!R){c=p+(c.length>0?" "+c:c);continue}if(S=r(m),!S){c=p+(c.length>0?" "+c:c);continue}R=!1}const j=a(g).join(":"),P=v?j+be:j,z=P+S;if(l.includes(z))continue;l.push(z);const T=n(S,R);for(let I=0;I<T.length;++I){const M=T[I];l.push(P+M)}c=p+(c.length>0?" "+c:c)}return c};function wr(){let e=0,s,t,r="";for(;e<arguments.length;)(s=arguments[e++])&&(t=it(s))&&(r&&(r+=" "),r+=t);return r}const it=e=>{if(typeof e=="string")return e;let s,t="";for(let r=0;r<e.length;r++)e[r]&&(s=it(e[r]))&&(t&&(t+=" "),t+=s);return t};function vr(e,...s){let t,r,n,a=l;function l(c){const d=s.reduce((p,f)=>f(p),e());return t=xr(d),r=t.cache.get,n=t.cache.set,a=i,i(c)}function i(c){const d=r(c);if(d)return d;const p=yr(c,t);return n(c,p),p}return function(){return a(wr.apply(null,arguments))}}const A=e=>{const s=t=>t[e]||[];return s.isThemeGetter=!0,s},lt=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,ct=/^\((?:(\w[\w-]*):)?(.+)\)$/i,kr=/^\d+\/\d+$/,jr=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Nr=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Rr=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Cr=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Sr=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Z=e=>kr.test(e),C=e=>!!e&&!Number.isNaN(Number(e)),q=e=>!!e&&Number.isInteger(Number(e)),fe=e=>e.endsWith("%")&&C(e.slice(0,-1)),X=e=>jr.test(e),Pr=()=>!0,zr=e=>Nr.test(e)&&!Rr.test(e),dt=()=>!1,Mr=e=>Cr.test(e),Lr=e=>Sr.test(e),Er=e=>!y(e)&&!w(e),Ir=e=>K(e,ft,dt),y=e=>lt.test(e),Y=e=>K(e,pt,zr),pe=e=>K(e,Br,C),Fe=e=>K(e,mt,dt),Tr=e=>K(e,ut,Lr),ae=e=>K(e,gt,Mr),w=e=>ct.test(e),te=e=>ee(e,pt),Ar=e=>ee(e,$r),Ue=e=>ee(e,mt),Fr=e=>ee(e,ft),Ur=e=>ee(e,ut),ie=e=>ee(e,gt,!0),K=(e,s,t)=>{const r=lt.exec(e);return r?r[1]?s(r[1]):t(r[2]):!1},ee=(e,s,t=!1)=>{const r=ct.exec(e);return r?r[1]?s(r[1]):t:!1},mt=e=>e==="position"||e==="percentage",ut=e=>e==="image"||e==="url",ft=e=>e==="length"||e==="size"||e==="bg-size",pt=e=>e==="length",Br=e=>e==="number",$r=e=>e==="family-name",gt=e=>e==="shadow",Or=()=>{const e=A("color"),s=A("font"),t=A("text"),r=A("font-weight"),n=A("tracking"),a=A("leading"),l=A("breakpoint"),i=A("container"),c=A("spacing"),d=A("radius"),p=A("shadow"),f=A("inset-shadow"),g=A("text-shadow"),v=A("drop-shadow"),m=A("blur"),k=A("perspective"),R=A("aspect"),S=A("ease"),j=A("animate"),P=()=>["auto","avoid","all","avoid-page","page","left","right","column"],z=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],T=()=>[...z(),w,y],I=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto","contain","none"],h=()=>[w,y,c],u=()=>[Z,"full","auto",...h()],b=()=>[q,"none","subgrid",w,y],O=()=>["auto",{span:["full",q,w,y]},q,w,y],U=()=>[q,"auto",w,y],V=()=>["auto","min","max","fr",w,y],Q=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],H=()=>["start","end","center","stretch","center-safe","end-safe"],_=()=>["auto",...h()],W=()=>[Z,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...h()],N=()=>[e,w,y],Se=()=>[...z(),Ue,Fe,{position:[w,y]}],Pe=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ze=()=>["auto","cover","contain",Fr,Ir,{size:[w,y]}],de=()=>[fe,te,Y],B=()=>["","none","full",d,w,y],D=()=>["",C,te,Y],re=()=>["solid","dashed","dotted","double"],Me=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],F=()=>[C,fe,Ue,Fe],Le=()=>["","none",m,w,y],se=()=>["none",C,w,y],oe=()=>["none",C,w,y],me=()=>[C,w,y],ne=()=>[Z,"full",...h()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[X],breakpoint:[X],color:[Pr],container:[X],"drop-shadow":[X],ease:["in","out","in-out"],font:[Er],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[X],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[X],shadow:[X],spacing:["px",C],text:[X],"text-shadow":[X],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Z,y,w,R]}],container:["container"],columns:[{columns:[C,y,w,i]}],"break-after":[{"break-after":P()}],"break-before":[{"break-before":P()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:T()}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:u()}],"inset-x":[{"inset-x":u()}],"inset-y":[{"inset-y":u()}],start:[{start:u()}],end:[{end:u()}],top:[{top:u()}],right:[{right:u()}],bottom:[{bottom:u()}],left:[{left:u()}],visibility:["visible","invisible","collapse"],z:[{z:[q,"auto",w,y]}],basis:[{basis:[Z,"full","auto",i,...h()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[C,Z,"auto","initial","none",y]}],grow:[{grow:["",C,w,y]}],shrink:[{shrink:["",C,w,y]}],order:[{order:[q,"first","last","none",w,y]}],"grid-cols":[{"grid-cols":b()}],"col-start-end":[{col:O()}],"col-start":[{"col-start":U()}],"col-end":[{"col-end":U()}],"grid-rows":[{"grid-rows":b()}],"row-start-end":[{row:O()}],"row-start":[{"row-start":U()}],"row-end":[{"row-end":U()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":V()}],"auto-rows":[{"auto-rows":V()}],gap:[{gap:h()}],"gap-x":[{"gap-x":h()}],"gap-y":[{"gap-y":h()}],"justify-content":[{justify:[...Q(),"normal"]}],"justify-items":[{"justify-items":[...H(),"normal"]}],"justify-self":[{"justify-self":["auto",...H()]}],"align-content":[{content:["normal",...Q()]}],"align-items":[{items:[...H(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...H(),{baseline:["","last"]}]}],"place-content":[{"place-content":Q()}],"place-items":[{"place-items":[...H(),"baseline"]}],"place-self":[{"place-self":["auto",...H()]}],p:[{p:h()}],px:[{px:h()}],py:[{py:h()}],ps:[{ps:h()}],pe:[{pe:h()}],pt:[{pt:h()}],pr:[{pr:h()}],pb:[{pb:h()}],pl:[{pl:h()}],m:[{m:_()}],mx:[{mx:_()}],my:[{my:_()}],ms:[{ms:_()}],me:[{me:_()}],mt:[{mt:_()}],mr:[{mr:_()}],mb:[{mb:_()}],ml:[{ml:_()}],"space-x":[{"space-x":h()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":h()}],"space-y-reverse":["space-y-reverse"],size:[{size:W()}],w:[{w:[i,"screen",...W()]}],"min-w":[{"min-w":[i,"screen","none",...W()]}],"max-w":[{"max-w":[i,"screen","none","prose",{screen:[l]},...W()]}],h:[{h:["screen","lh",...W()]}],"min-h":[{"min-h":["screen","lh","none",...W()]}],"max-h":[{"max-h":["screen","lh",...W()]}],"font-size":[{text:["base",t,te,Y]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,w,pe]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",fe,y]}],"font-family":[{font:[Ar,y,s]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,w,y]}],"line-clamp":[{"line-clamp":[C,"none",w,pe]}],leading:[{leading:[a,...h()]}],"list-image":[{"list-image":["none",w,y]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",w,y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:N()}],"text-color":[{text:N()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...re(),"wavy"]}],"text-decoration-thickness":[{decoration:[C,"from-font","auto",w,Y]}],"text-decoration-color":[{decoration:N()}],"underline-offset":[{"underline-offset":[C,"auto",w,y]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:h()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",w,y]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",w,y]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Se()}],"bg-repeat":[{bg:Pe()}],"bg-size":[{bg:ze()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},q,w,y],radial:["",w,y],conic:[q,w,y]},Ur,Tr]}],"bg-color":[{bg:N()}],"gradient-from-pos":[{from:de()}],"gradient-via-pos":[{via:de()}],"gradient-to-pos":[{to:de()}],"gradient-from":[{from:N()}],"gradient-via":[{via:N()}],"gradient-to":[{to:N()}],rounded:[{rounded:B()}],"rounded-s":[{"rounded-s":B()}],"rounded-e":[{"rounded-e":B()}],"rounded-t":[{"rounded-t":B()}],"rounded-r":[{"rounded-r":B()}],"rounded-b":[{"rounded-b":B()}],"rounded-l":[{"rounded-l":B()}],"rounded-ss":[{"rounded-ss":B()}],"rounded-se":[{"rounded-se":B()}],"rounded-ee":[{"rounded-ee":B()}],"rounded-es":[{"rounded-es":B()}],"rounded-tl":[{"rounded-tl":B()}],"rounded-tr":[{"rounded-tr":B()}],"rounded-br":[{"rounded-br":B()}],"rounded-bl":[{"rounded-bl":B()}],"border-w":[{border:D()}],"border-w-x":[{"border-x":D()}],"border-w-y":[{"border-y":D()}],"border-w-s":[{"border-s":D()}],"border-w-e":[{"border-e":D()}],"border-w-t":[{"border-t":D()}],"border-w-r":[{"border-r":D()}],"border-w-b":[{"border-b":D()}],"border-w-l":[{"border-l":D()}],"divide-x":[{"divide-x":D()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":D()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...re(),"hidden","none"]}],"divide-style":[{divide:[...re(),"hidden","none"]}],"border-color":[{border:N()}],"border-color-x":[{"border-x":N()}],"border-color-y":[{"border-y":N()}],"border-color-s":[{"border-s":N()}],"border-color-e":[{"border-e":N()}],"border-color-t":[{"border-t":N()}],"border-color-r":[{"border-r":N()}],"border-color-b":[{"border-b":N()}],"border-color-l":[{"border-l":N()}],"divide-color":[{divide:N()}],"outline-style":[{outline:[...re(),"none","hidden"]}],"outline-offset":[{"outline-offset":[C,w,y]}],"outline-w":[{outline:["",C,te,Y]}],"outline-color":[{outline:N()}],shadow:[{shadow:["","none",p,ie,ae]}],"shadow-color":[{shadow:N()}],"inset-shadow":[{"inset-shadow":["none",f,ie,ae]}],"inset-shadow-color":[{"inset-shadow":N()}],"ring-w":[{ring:D()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:N()}],"ring-offset-w":[{"ring-offset":[C,Y]}],"ring-offset-color":[{"ring-offset":N()}],"inset-ring-w":[{"inset-ring":D()}],"inset-ring-color":[{"inset-ring":N()}],"text-shadow":[{"text-shadow":["none",g,ie,ae]}],"text-shadow-color":[{"text-shadow":N()}],opacity:[{opacity:[C,w,y]}],"mix-blend":[{"mix-blend":[...Me(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Me()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[C]}],"mask-image-linear-from-pos":[{"mask-linear-from":F()}],"mask-image-linear-to-pos":[{"mask-linear-to":F()}],"mask-image-linear-from-color":[{"mask-linear-from":N()}],"mask-image-linear-to-color":[{"mask-linear-to":N()}],"mask-image-t-from-pos":[{"mask-t-from":F()}],"mask-image-t-to-pos":[{"mask-t-to":F()}],"mask-image-t-from-color":[{"mask-t-from":N()}],"mask-image-t-to-color":[{"mask-t-to":N()}],"mask-image-r-from-pos":[{"mask-r-from":F()}],"mask-image-r-to-pos":[{"mask-r-to":F()}],"mask-image-r-from-color":[{"mask-r-from":N()}],"mask-image-r-to-color":[{"mask-r-to":N()}],"mask-image-b-from-pos":[{"mask-b-from":F()}],"mask-image-b-to-pos":[{"mask-b-to":F()}],"mask-image-b-from-color":[{"mask-b-from":N()}],"mask-image-b-to-color":[{"mask-b-to":N()}],"mask-image-l-from-pos":[{"mask-l-from":F()}],"mask-image-l-to-pos":[{"mask-l-to":F()}],"mask-image-l-from-color":[{"mask-l-from":N()}],"mask-image-l-to-color":[{"mask-l-to":N()}],"mask-image-x-from-pos":[{"mask-x-from":F()}],"mask-image-x-to-pos":[{"mask-x-to":F()}],"mask-image-x-from-color":[{"mask-x-from":N()}],"mask-image-x-to-color":[{"mask-x-to":N()}],"mask-image-y-from-pos":[{"mask-y-from":F()}],"mask-image-y-to-pos":[{"mask-y-to":F()}],"mask-image-y-from-color":[{"mask-y-from":N()}],"mask-image-y-to-color":[{"mask-y-to":N()}],"mask-image-radial":[{"mask-radial":[w,y]}],"mask-image-radial-from-pos":[{"mask-radial-from":F()}],"mask-image-radial-to-pos":[{"mask-radial-to":F()}],"mask-image-radial-from-color":[{"mask-radial-from":N()}],"mask-image-radial-to-color":[{"mask-radial-to":N()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":z()}],"mask-image-conic-pos":[{"mask-conic":[C]}],"mask-image-conic-from-pos":[{"mask-conic-from":F()}],"mask-image-conic-to-pos":[{"mask-conic-to":F()}],"mask-image-conic-from-color":[{"mask-conic-from":N()}],"mask-image-conic-to-color":[{"mask-conic-to":N()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Se()}],"mask-repeat":[{mask:Pe()}],"mask-size":[{mask:ze()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",w,y]}],filter:[{filter:["","none",w,y]}],blur:[{blur:Le()}],brightness:[{brightness:[C,w,y]}],contrast:[{contrast:[C,w,y]}],"drop-shadow":[{"drop-shadow":["","none",v,ie,ae]}],"drop-shadow-color":[{"drop-shadow":N()}],grayscale:[{grayscale:["",C,w,y]}],"hue-rotate":[{"hue-rotate":[C,w,y]}],invert:[{invert:["",C,w,y]}],saturate:[{saturate:[C,w,y]}],sepia:[{sepia:["",C,w,y]}],"backdrop-filter":[{"backdrop-filter":["","none",w,y]}],"backdrop-blur":[{"backdrop-blur":Le()}],"backdrop-brightness":[{"backdrop-brightness":[C,w,y]}],"backdrop-contrast":[{"backdrop-contrast":[C,w,y]}],"backdrop-grayscale":[{"backdrop-grayscale":["",C,w,y]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[C,w,y]}],"backdrop-invert":[{"backdrop-invert":["",C,w,y]}],"backdrop-opacity":[{"backdrop-opacity":[C,w,y]}],"backdrop-saturate":[{"backdrop-saturate":[C,w,y]}],"backdrop-sepia":[{"backdrop-sepia":["",C,w,y]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":h()}],"border-spacing-x":[{"border-spacing-x":h()}],"border-spacing-y":[{"border-spacing-y":h()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",w,y]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[C,"initial",w,y]}],ease:[{ease:["linear","initial",S,w,y]}],delay:[{delay:[C,w,y]}],animate:[{animate:["none",j,w,y]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[k,w,y]}],"perspective-origin":[{"perspective-origin":T()}],rotate:[{rotate:se()}],"rotate-x":[{"rotate-x":se()}],"rotate-y":[{"rotate-y":se()}],"rotate-z":[{"rotate-z":se()}],scale:[{scale:oe()}],"scale-x":[{"scale-x":oe()}],"scale-y":[{"scale-y":oe()}],"scale-z":[{"scale-z":oe()}],"scale-3d":["scale-3d"],skew:[{skew:me()}],"skew-x":[{"skew-x":me()}],"skew-y":[{"skew-y":me()}],transform:[{transform:[w,y,"","none","gpu","cpu"]}],"transform-origin":[{origin:T()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ne()}],"translate-x":[{"translate-x":ne()}],"translate-y":[{"translate-y":ne()}],"translate-z":[{"translate-z":ne()}],"translate-none":["translate-none"],accent:[{accent:N()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:N()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",w,y]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":h()}],"scroll-mx":[{"scroll-mx":h()}],"scroll-my":[{"scroll-my":h()}],"scroll-ms":[{"scroll-ms":h()}],"scroll-me":[{"scroll-me":h()}],"scroll-mt":[{"scroll-mt":h()}],"scroll-mr":[{"scroll-mr":h()}],"scroll-mb":[{"scroll-mb":h()}],"scroll-ml":[{"scroll-ml":h()}],"scroll-p":[{"scroll-p":h()}],"scroll-px":[{"scroll-px":h()}],"scroll-py":[{"scroll-py":h()}],"scroll-ps":[{"scroll-ps":h()}],"scroll-pe":[{"scroll-pe":h()}],"scroll-pt":[{"scroll-pt":h()}],"scroll-pr":[{"scroll-pr":h()}],"scroll-pb":[{"scroll-pb":h()}],"scroll-pl":[{"scroll-pl":h()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",w,y]}],fill:[{fill:["none",...N()]}],"stroke-w":[{stroke:[C,te,Y,pe]}],stroke:[{stroke:["none",...N()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Dr=vr(Or);function L(...e){return Dr(ot(e))}const _r=nt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),$=x.forwardRef(({className:e,variant:s,size:t,asChild:r=!1,...n},a)=>{const l=r?Ht:"button";return o.jsx(l,{className:L(_r({variant:s,size:t,className:e})),ref:a,...n})});$.displayName="Button";const Gr=/^(image\/(jpeg|png|webp|gif|avif|bmp|tiff))$/i;function Vr(e){return Gr.test(e.type)}function Hr(e,s=36){const t=[];for(const r of e)if(Vr(r)){if(t.length>=s)break;t.push({id:crypto.randomUUID(),url:URL.createObjectURL(r),name:r.name,size:r.size,type:r.type})}return t}function Be(e){for(const s of e)try{URL.revokeObjectURL(s.url)}catch{}}const Wr=16,G=2050,we=1024,Xr=.8,qr="contain",Yr="left",Qr="top",ht=[{id:"georgia",label:"Georgia",family:"Georgia, serif"},{id:"system-ui",label:"System UI",family:"system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif"},{id:"times",label:"Times",family:'"Times New Roman", Times, serif'},{id:"garamond",label:"Garamond",family:"Garamond, serif"}],J={scale:1,tx:0,ty:0},ge=(e,s,t)=>Math.max(s,Math.min(t,e));function Zr(e){return new Promise((s,t)=>{const r=new Image;r.onload=()=>s({w:r.naturalWidth,h:r.naturalHeight}),r.onerror=t,r.src=e})}function Jr(e,s,t,r,n,a){const l=t/e,i=t/s,c=Math.min(l,i),d=e*c,p=s*c,f=0,g=0,v=(f-(t-d)/2)/t*100,m=(g-(t-p)/2)/t*100;return{tx:Math.max(-100,Math.min(100,v)),ty:Math.max(-100,Math.min(100,m))}}const E=At((e,s)=>({photos:[],max:Wr,transforms:{},layersByPhoto:{},setTransform:(t,r)=>e(n=>{const a=n.transforms[t]??J,l={scale:ge(r.scale??a.scale,.5,4),tx:ge(r.tx??a.tx,-100,100),ty:ge(r.ty??a.ty,-100,100)};return{transforms:{...n.transforms,[t]:l}}}),resetTransform:t=>e(r=>{const{[t]:n,...a}=r.transforms;return{transforms:a}}),add:t=>{if(!t?.length)return;const{photos:r,max:n}=s(),a=Math.max(0,n-r.length);if(!a)return;const l=t.slice(0,a);e({photos:[...r,...l]});for(const i of l)(async()=>{try{const{w:c,h:d}=await Zr(i.url),{tx:p,ty:f}=Jr(c,d,G,qr,Yr,Qr);s().setTransform(i.id,{tx:p,ty:f})}catch{}})()},clear:()=>{const t=s().photos;t.length&&Be(t),e({photos:[],transforms:{},layersByPhoto:{}})},remove:t=>e(r=>{const n=r.photos.findIndex(c=>c.id===t);if(n===-1)return null;Be([r.photos[n]]);const{[t]:a,...l}=r.transforms,i={...r.layersByPhoto};return delete i[t],{photos:r.photos.filter(c=>c.id!==t),transforms:l,layersByPhoto:i}}),addTextLayer:(t,r={})=>{const n=crypto.randomUUID();return e(a=>{const l=a.layersByPhoto[t]??[],i=l.length?Math.max(...l.map(p=>p.z))+1:1,c={...r};delete c.id,delete c.type,delete c.z;const d={id:n,type:"text",x:40,y:G-140,rotation:0,scaleX:1,scaleY:1,visible:!0,z:i,text:"New text",fontFamily:"system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif",fontSize:36,fontStyle:"",fill:"#111",align:"left",verticalAlign:"top",padding:0,lineHeight:1.25,letterSpacing:0,...c};return{layersByPhoto:{...a.layersByPhoto,[t]:[...l,d]}}}),n},updateLayer:(t,r,n)=>e(a=>{const l=a.layersByPhoto[t]??[],i=l.findIndex(g=>g.id===r);if(i===-1)return null;const c=l[i],d={...n};delete d.id,delete d.type;const p={...c,...d},f=[...l];return f[i]=p,{layersByPhoto:{...a.layersByPhoto,[t]:f}}}),removeLayer:(t,r)=>e(n=>{const a=n.layersByPhoto[t]??[],l=a.filter(i=>i.id!==r);return l===a?null:{layersByPhoto:{...n.layersByPhoto,[t]:l}}}),bringToFront:(t,r)=>e(n=>{const a=n.layersByPhoto[t]??[];if(!a.length)return null;const l=Math.max(...a.map(c=>c.z)),i=a.map(c=>c.id===r?{...c,z:l+1}:c);return{layersByPhoto:{...n.layersByPhoto,[t]:i}}}),sendToBack:(t,r)=>e(n=>{const a=n.layersByPhoto[t]??[];if(!a.length)return null;const l=Math.min(...a.map(c=>c.z)),i=a.map(c=>c.id===r?{...c,z:l-1}:c);return{layersByPhoto:{...n.layersByPhoto,[t]:i}}}),setLayersOrder:(t,r)=>e(n=>{const a=n.layersByPhoto[t]??[];if(!a.length)return null;const l=new Map(a.map(d=>[d.id,d])),i=[];let c=1;for(const d of r){const p=l.get(d);p&&i.push({...p,z:c++})}for(const d of a)r.includes(d.id)||i.push({...d,z:c++});return{layersByPhoto:{...n.layersByPhoto,[t]:i}}})}));function Kr(e){const s=e.replace(/^\uFEFF/,"").replace(/\r\n?/g,`
`).split(`
`).filter(Boolean);if(!s.length)return{rows:[],hasRelative:!1};const t=s[0].toLowerCase(),r=t.includes(";")&&!t.includes(",")?";":",",n=[],a=new RegExp(`\\s*(?:"([^"]*)"|([^${r}\\n]*))\\s*(?:${r}|$)`,"g");for(const i of s){const c=[];a.lastIndex=0;let d,p=0;for(;(d=a.exec(i))&&p++<1e3;){const v=(d[1]??d[2]??"").trim();if(c.push(v),d.index+d[0].length>=i.length)break}if(!c.length)continue;const f=(c[0]??"").trim();if(!f)continue;const g=(c[1]??"").trim()||void 0;n.push({url:f,caption:g})}n.length&&n[0].url.trim().toLowerCase()==="url"&&n.shift();const l=n.some(i=>es(i.url));return{rows:n,hasRelative:l}}function xt(e){return/^https?:\/\//i.test(e)}function bt(e){return/^data:/i.test(e)}function es(e){return!(xt(e)||bt(e)||/^blob:/.test(e))}function ts(){const e=x.useRef(null),s=Ft.useRef(null),t=E(f=>f.photos),r=E(f=>f.max),n=E(f=>f.add),a=E(f=>f.clear),l=Math.max(0,r-t.length),i=x.useCallback(f=>{if(!f?.length)return;const g=Array.from(f).slice(0,l),v=Hr(g,l);n(v)},[n,l]),c=x.useCallback(f=>{i(f.target.files),f.target.value=""},[i]);async function d(f){const g=f.target.files?.[0];if(!g)return;const v=await g.text();f.target.value="";const{rows:m,hasRelative:k}=Kr(v);if(m.length){if(k){alert("В этом CSV есть относительные пути. В текущей сборке локальная папка не поддерживается. Пожалуйста, используйте полные URL (http/https) или добавьте изображения кнопкой “Choose images”.");return}await p(m)}}async function p(f,g){const v=E.getState().add,m=[];let k=0,R=0;for(const S of f)try{let j=null,P="image";if(xt(S.url)){const I=await fetch(S.url,{mode:"cors"});if(!I.ok)throw new Error(`HTTP ${I.status}`);j=await I.blob(),P=S.url.split("/").pop()||P}else if(bt(S.url))j=await(await fetch(S.url)).blob(),P="data.png";else throw new Error("Relative paths are disabled in this build");const z=URL.createObjectURL(j),T=crypto.randomUUID();m.push({id:T,url:z,name:P}),k++}catch(j){console.warn("CSV import skip:",S.url,j),R++}v(m),R&&alert(`CSV import: added ${k}, skipped ${R}`)}return o.jsx("section",{className:"mt-4 space-y-4",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"text-sm opacity-80",children:["Cards: ",o.jsx("b",{children:t.length})," / ",r]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{ref:e,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:c}),o.jsx("input",{ref:s,type:"file",accept:".csv,text/csv",className:"hidden",onChange:d}),o.jsx("button",{onClick:()=>s.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Import CSV"}),o.jsx("button",{onClick:()=>e.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Choose images"}),o.jsx($,{variant:"destructive",onClick:a,disabled:!t.length,children:"Clear"})]})]})})}const rs="modulepreload",ss=function(e){return"/ss/"+e},$e={},os=function(s,t,r){let n=Promise.resolve();if(t&&t.length>0){let c=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),i=l?.nonce||l?.getAttribute("nonce");n=c(t.map(d=>{if(d=ss(d),d in $e)return;$e[d]=!0;const p=d.endsWith(".css"),f=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${f}`))return;const g=document.createElement("link");if(g.rel=p?"stylesheet":rs,p||(g.as="script"),g.crossOrigin="",g.href=d,i&&g.setAttribute("nonce",i),document.head.appendChild(g),p)return new Promise((v,m)=>{g.addEventListener("load",v),g.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(l){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=l,window.dispatchEvent(i),!i.defaultPrevented)throw l}return n.then(l=>{for(const i of l||[])i.status==="rejected"&&a(i.reason);return s().catch(a)})},yt=x.forwardRef(({className:e,...s},t)=>o.jsx("div",{ref:t,className:L("rounded-xl border bg-card text-card-foreground shadow",e),...s}));yt.displayName="Card";const ns=x.forwardRef(({className:e,...s},t)=>o.jsx("div",{ref:t,className:L("flex flex-col space-y-1.5 p-6",e),...s}));ns.displayName="CardHeader";const as=x.forwardRef(({className:e,...s},t)=>o.jsx("div",{ref:t,className:L("font-semibold leading-none tracking-tight",e),...s}));as.displayName="CardTitle";const is=x.forwardRef(({className:e,...s},t)=>o.jsx("div",{ref:t,className:L("text-sm text-muted-foreground",e),...s}));is.displayName="CardDescription";const ls=x.forwardRef(({className:e,...s},t)=>o.jsx("div",{ref:t,className:L("p-6 pt-0",e),...s}));ls.displayName="CardContent";const cs=x.forwardRef(({className:e,...s},t)=>o.jsx("div",{ref:t,className:L("flex items-center p-6 pt-0",e),...s}));cs.displayName="CardFooter";const wt=x.forwardRef(({className:e,value:s,...t},r)=>o.jsx(Ge,{ref:r,className:L("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...t,children:o.jsx(Wt,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));wt.displayName=Ge.displayName;const ds=Jt,ms=Kt,vt=x.forwardRef(({className:e,children:s,...t},r)=>o.jsxs(Ve,{ref:r,className:L("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...t,children:[s,o.jsx(Xt,{asChild:!0,children:o.jsx(_e,{className:"h-4 w-4 opacity-50"})})]}));vt.displayName=Ve.displayName;const kt=x.forwardRef(({className:e,...s},t)=>o.jsx(He,{ref:t,className:L("flex cursor-default items-center justify-center py-1",e),...s,children:o.jsx(Ut,{className:"h-4 w-4"})}));kt.displayName=He.displayName;const jt=x.forwardRef(({className:e,...s},t)=>o.jsx(We,{ref:t,className:L("flex cursor-default items-center justify-center py-1",e),...s,children:o.jsx(_e,{className:"h-4 w-4"})}));jt.displayName=We.displayName;const Nt=x.forwardRef(({className:e,children:s,position:t="popper",...r},n)=>o.jsx(qt,{children:o.jsxs(Xe,{ref:n,className:L("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...r,children:[o.jsx(kt,{}),o.jsx(Yt,{className:L("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),o.jsx(jt,{})]})}));Nt.displayName=Xe.displayName;const us=x.forwardRef(({className:e,...s},t)=>o.jsx(qe,{ref:t,className:L("px-2 py-1.5 text-sm font-semibold",e),...s}));us.displayName=qe.displayName;const ve=x.forwardRef(({className:e,children:s,...t},r)=>o.jsxs(Ye,{ref:r,className:L("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[o.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(Qt,{children:o.jsx(Bt,{className:"h-4 w-4"})})}),o.jsx(Zt,{children:s})]}));ve.displayName=Ye.displayName;const fs=x.forwardRef(({className:e,...s},t)=>o.jsx(Qe,{ref:t,className:L("-mx-1 my-1 h-px bg-muted",e),...s}));fs.displayName=Qe.displayName;function Rt(e,s,t){if(!s?.length)return;const r=t/G,n=[...s].sort((a,l)=>a.z-l.z);for(const a of n)a.visible!==!1&&a.type==="text"&&gs(e,a,r)}function ps(e,s,t,r=0){const n=[];if(!s)return n;const a=s.replace(/\r\n?/g,`
`).split(`
`),l=i=>e.measureText(i).width+Math.max(0,i.length-1)*r;for(const i of a){if(!t||t<=0){n.push(i);continue}const c=i.split(/\s+/);let d="";for(const p of c){const f=d?d+" "+p:p;if(l(f)<=t)d=f;else if(d&&n.push(d),l(p)>t){let g="";for(const v of p){const m=g+v;l(m)<=t?g=m:(g&&n.push(g),g=v)}d=g}else d=p}n.push(d)}return n}function gs(e,s,t){e.save(),e.translate(s.x*t,s.y*t),s.rotation&&e.rotate(s.rotation*Math.PI/180);const r=s.fontFamily||"system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif",n=Math.max(1,s.fontSize||16)*t,a=s.fontStyle||"",l=[];a.includes("italic")&&l.push("italic"),a.includes("bold")&&l.push("bold"),l.push(`${n}px`,r),e.font=l.join(" "),e.fontKerning="none",e.fillStyle=s.fill||"#111",e.textBaseline="top",e.textAlign="left";const i=Math.max(0,s.padding??0)*t,c=(s.width??0)>0?Math.max(0,s.width*t-i*2):void 0,d=s.align||"left",p=n*(s.lineHeight??1.25),f=(s.letterSpacing??0)*t,g=ps(e,s.text??"",c,f);let v=i;for(const m of g){let k=0;for(let j=0;j<m.length;j++){const P=m[j];k+=e.measureText(P).width,j<m.length-1&&(k+=f)}let R=i;c!==void 0&&(d==="center"?R=i+(c-k)/2:d==="right"&&(R=i+(c-k)));let S=R;for(let j=0;j<m.length;j++){const P=m[j];e.fillText(P,S,v),S+=e.measureText(P).width,j<m.length-1&&(S+=f)}v+=p}e.restore()}const Oe=new Set,he=new Map;function Ct(e){const s=ht.find(n=>n.family===e);if(!s||Oe.has(s.family))return Promise.resolve();const t=he.get(s.family);if(t)return t;const r=(async()=>{if(s.src?.length&&await Promise.all(s.src.map(async n=>{const a=new window.FontFace(s.family.split(",")[0].replace(/(^"|"$)/g,""),`url(${n.url})`,{style:n.style??"normal",weight:n.weight??"400",display:"swap"});await a.load(),document.fonts.add(a)})),document.fonts?.ready)try{await document.fonts.ready}catch{}Oe.add(s.family),he.delete(s.family)})();return he.set(s.family,r),r}function St(e){if(!e?.length)return Promise.resolve();const s=[];for(const t of e)t.type==="text"&&t.fontFamily&&s.push(Ct(t.fontFamily));return Promise.all(s).then(()=>{})}async function Pt(){const e=document;if(e?.fonts?.ready&&typeof e.fonts.ready.then=="function")try{await e.fonts.ready}catch{}}async function zt(e){return new Promise((s,t)=>{const r=new Image;r.onload=()=>s(r),r.onerror=n=>t(n),r.src=e})}function hs(e,s="card"){return(e.replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||s).slice(0,100)}function xs(e,s){const t=document.createElement("a"),r=URL.createObjectURL(e);t.href=r,t.download=s,document.body.appendChild(t),t.click(),t.remove(),URL.revokeObjectURL(r)}async function bs(e,s,t={}){const r=t.size??we,n=t.baseSize??G,a=await Lt(e,s,{size:n,bg:t.bg,captionBg:t.captionBg,textColor:t.textColor,transform:t.transform,layers:t.layers});try{const l=await zt(a),i=document.createElement("canvas");i.width=r,i.height=r;const c=i.getContext("2d");if(!c)throw new Error("No 2D context");c.imageSmoothingQuality="high",c.drawImage(l,0,0,r,r);const d=await new Promise((p,f)=>i.toBlob(g=>g?p(g):f(new Error("toBlob failed")),"image/png"));return URL.createObjectURL(d)}finally{URL.revokeObjectURL(a)}}async function Mt(e,s,t={}){const r=t.size??G,n=t.bg??"transparent",a=t.transform??J;await St(t.layers),await Pt();const l=document.createElement("canvas");l.width=r,l.height=r;const i=l.getContext("2d");if(!i)throw new Error("No 2D context");n!=="transparent"&&(i.fillStyle=n,i.fillRect(0,0,r,r));const c=await zt(e.url),d=r/c.width,p=r/c.height,g=Math.min(d,p)*a.scale,v=Math.round(c.width*g),m=Math.round(c.height*g),k=Math.round((r-v)/2+a.tx/100*r),R=Math.round((r-m)/2+a.ty/100*r);i.imageSmoothingQuality="high",i.drawImage(c,k,R,v,m),Rt(i,t.layers,r);const S=await new Promise((j,P)=>l.toBlob(z=>z?j(z):P(new Error("toBlob failed")),"image/png"));xs(S,`${hs(e.name||"card")}.png`)}async function Lt(e,s,t={}){const r=t.size??G,n=t.bg??"transparent",a=t.transform??J;await St(t.layers),await Pt();const l=document.createElement("canvas");l.width=r,l.height=r;const i=l.getContext("2d");if(!i)throw new Error("No 2D context");n!=="transparent"&&(i.fillStyle=n,i.fillRect(0,0,r,r));const c=await async function(P){return new Promise((z,T)=>{const I=new Image;I.onload=()=>z(I),I.onerror=M=>T(M),I.src=P})}(e.url),d=r/c.width,p=r/c.height,g=Math.min(d,p)*a.scale,v=Math.round(c.width*g),m=Math.round(c.height*g),k=Math.round((r-v)/2+a.tx/100*r),R=Math.round((r-m)/2+a.ty/100*r);i.imageSmoothingQuality="high",i.drawImage(c,k,R,v,m),Rt(i,t.layers,r);const S=await new Promise((j,P)=>l.toBlob(z=>z?j(z):P(new Error("toBlob failed")),"image/png"));return URL.createObjectURL(S)}const Et=rr,ys=er,It=x.forwardRef(({className:e,...s},t)=>o.jsx(Ze,{ref:t,className:L("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));It.displayName=Ze.displayName;const je=x.forwardRef(({className:e,children:s,...t},r)=>o.jsxs(ys,{children:[o.jsx(It,{}),o.jsxs(Je,{ref:r,className:L("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[s,o.jsxs(tr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[o.jsx($t,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));je.displayName=Je.displayName;const Ne=({className:e,...s})=>o.jsx("div",{className:L("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});Ne.displayName="DialogHeader";const Re=({className:e,...s})=>o.jsx("div",{className:L("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});Re.displayName="DialogFooter";const Ce=x.forwardRef(({className:e,...s},t)=>o.jsx(Ke,{ref:t,className:L("text-lg font-semibold leading-none tracking-tight",e),...s}));Ce.displayName=Ke.displayName;const Tt=x.forwardRef(({className:e,...s},t)=>o.jsx(et,{ref:t,className:L("text-sm text-muted-foreground",e),...s}));Tt.displayName=et.displayName;const ws=nt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),le=x.forwardRef(({className:e,...s},t)=>o.jsx(tt,{ref:t,className:L(ws(),e),...s}));le.displayName=tt.displayName;const ce=x.forwardRef(({className:e,...s},t)=>o.jsxs(rt,{ref:t,className:L("relative flex w-full touch-none select-none items-center",e),...s,children:[o.jsx(sr,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:o.jsx(or,{className:"absolute h-full bg-primary"})}),o.jsx(nr,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));ce.displayName=rt.displayName;const vs=[],ks=x.forwardRef(function({photoId:s,size:t,selectedId:r,onSelect:n},a){const i=x.useRef(null);x.useImperativeHandle(a,()=>({toDataURL:v=>{const m=i.current;if(!m)return null;const k=v&&v>0?v/t:1;return m.toDataURL({pixelRatio:k,mimeType:"image/png"})}}));const c=E(v=>v.layersByPhoto[s]??vs,Object.is),d=E(v=>v.updateLayer),p=x.useRef(null),f=x.useRef(null);x.useEffect(()=>{const v=p.current,m=f.current;v&&m&&r&&(v.nodes([m]),v.getLayer()?.batchDraw())},[r]);const g=t/G;return o.jsx(Ot,{ref:i,width:t,height:t,pixelRatio:1,listening:!0,style:{width:"100%",height:"100%"},onMouseDown:v=>{v.target===v.target.getStage()&&n(null)},onTouchStart:v=>{v.target===v.target.getStage()&&n(null)},children:o.jsxs(Dt,{children:[c.slice().sort((v,m)=>v.z-m.z).map(v=>{if(v.type!=="text")return null;const m=v,R=r===m.id?f:void 0,S=m.x*g,j=m.y*g,P=(m.fontSize??16)*g,z=m.width?m.width*g:void 0,T=(m.padding??0)*g,I=(m.letterSpacing??0)*g;return o.jsx(_t,{ref:R,draggable:!0,x:S,y:j,text:m.text,fontFamily:m.fontFamily||"Georgia, serif",fontSize:P,fontStyle:m.fontStyle,fill:m.fill,width:z,align:m.align,lineHeight:m.lineHeight??1.25,padding:T,letterSpacing:I,rotation:m.rotation,scaleX:1,scaleY:1,visible:m.visible,perfectDrawEnabled:!1,onTransform:M=>{const h=M.target,u=typeof h.scaleX=="function"?h.scaleX():1,b=typeof h.width=="function"?h.width():void 0;b!==void 0&&u&&u!==1&&(h.width(Math.max(4,Math.round(b*u))),typeof h.scaleX=="function"&&h.scaleX(1),typeof h.scaleY=="function"&&h.scaleY(1),h.getLayer()?.batchDraw())},onMouseDown:()=>n(m.id),onTap:()=>n(m.id),onDragEnd:M=>{d(s,m.id,{x:M.target.x()/g,y:M.target.y()/g})},onTransformEnd:M=>{const h=M.target,u=typeof h.scaleX=="function"?h.scaleX():1,b=typeof h.width=="function"?h.width():void 0,O={x:h.x()/g,y:h.y()/g,rotation:h.rotation(),scaleX:1,scaleY:1,width:b!==void 0?Math.max(4,Math.round(b*u/g)):void 0};typeof h.scaleX=="function"&&h.scaleX(1),typeof h.scaleY=="function"&&h.scaleY(1),d(s,m.id,O)}},m.id)}),r&&o.jsx(Gt,{ref:p,rotateEnabled:!0,enabledAnchors:["middle-left","middle-right","top-center","bottom-center","top-left","top-right","bottom-left","bottom-right"],borderStroke:"#fff",anchorStroke:"#fff",anchorFill:"#111",anchorSize:7,keepRatio:!1,centeredScaling:!1,boundBoxFunc:(v,m)=>{const R=Math.max(6,m.width),S=Math.max(6,m.height);return{...m,width:R,height:S}}})]})})}),js=[];function Ns({open:e,onOpenChange:s,photo:t,canvasRef:r}){const n=E(u=>u.addTextLayer),a=E(u=>u.transforms[t.id]??J),l=E(u=>u.setTransform),[i,c]=x.useState(a),[d,p]=x.useState(null),f=E(u=>u.updateLayer),g=E(u=>u.removeLayer),v=E(u=>u.bringToFront),m=E(u=>u.sendToBack),k=E(u=>u.layersByPhoto[t.id]??js,Object.is),R=x.useRef(null),S=r??R;x.useEffect(()=>{e&&c(a)},[e,a]);const[j,P]=x.useState(null);x.useEffect(()=>{if(!e)return;let u=!1;const b=new Image;return b.onload=()=>{u||P({w:b.naturalWidth,h:b.naturalHeight})},b.src=t.url,()=>{u=!0}},[e,t.url]);const z=x.useRef(null),[T,I]=x.useState(0),M=x.useCallback(()=>{const u=z.current;if(!u)return;const b=Math.round(u.clientWidth);b&&I(b)},[]);x.useEffect(()=>{const u=z.current;if(!u)return;const b=new ResizeObserver(()=>M());return b.observe(u),M(),()=>b.disconnect()},[M]),x.useEffect(()=>{e&&(requestAnimationFrame(M),setTimeout(M,50))},[e,M]);const h=x.useMemo(()=>{if(!j||!T)return null;const u=T,b=u/j.w,O=u/j.h,V=Math.min(b,O)*i.scale,Q=Math.round(j.w*V),H=Math.round(j.h*V),_=Math.round((u-Q)/2+i.tx/100*u),W=Math.round((u-H)/2+i.ty/100*u);return{dw:Q,dh:H,dx:_,dy:W}},[j,T,i.scale,i.tx,i.ty]);return o.jsx(Et,{open:e,onOpenChange:s,children:o.jsxs(je,{"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden flex flex-col",onOpenAutoFocus:()=>{requestAnimationFrame(()=>{setTimeout(M,50)})},children:[o.jsxs(Ne,{className:"shrink-0",children:[o.jsx(Ce,{children:"Edit card"}),o.jsx(Tt,{className:"sr-only",children:"Adjust zoom/position and edit text layers."})]}),o.jsx("div",{className:"flex-1 overflow-auto",children:o.jsxs("div",{className:"grid gap-4",children:[o.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:o.jsxs("div",{className:"relative aspect-square overflow-hidden rounded-xl",ref:z,children:[h?o.jsx("img",{src:t.url,alt:t.name,className:"absolute top-0 left-0 select-none pointer-events-none",style:{width:`${h.dw}px`,height:`${h.dh}px`,maxWidth:"none",transform:`translate3d(${h.dx}px, ${h.dy}px, 0)`},draggable:!1}):o.jsx("img",{src:t.url,alt:t.name,className:"h-full w-full object-contain will-change-transform select-none",style:{transform:`translate(${i.tx}%, ${i.ty}%) scale(${i.scale})`,transformOrigin:"center"},draggable:!1}),T>0&&o.jsx("div",{className:"absolute inset-0 pointer-events-auto z-20",children:o.jsx(ks,{ref:S,photoId:t.id,size:T,selectedId:d,onSelect:p})})]})}),d&&(()=>{const u=k.find(b=>b.id===d&&b.type==="text");return u?o.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[o.jsx("label",{className:"text-xs opacity-70",children:"Text"}),o.jsx("textarea",{value:u.text,onChange:b=>f(t.id,u.id,{text:b.target.value}),rows:3,className:"resize-y w-full rounded border px-2 py-1 text-sm bg-background"}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("label",{className:"text-xs opacity-70",children:"Size"}),o.jsx("input",{type:"number",min:8,max:240,step:1,value:u.fontSize??36,onChange:b=>f(t.id,u.id,{fontSize:Number(b.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),o.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${u.fontStyle?.includes("bold")?"bg-foreground/10":""}`,onClick:()=>{const b=u.fontStyle?.includes("bold"),U=`${u.fontStyle?.includes("italic")?"italic":""} ${b?"":"bold"}`.trim();f(t.id,u.id,{fontStyle:U})},children:"Bold"}),o.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${u.fontStyle?.includes("italic")?"bg-foreground/10":""}`,onClick:()=>{const b=u.fontStyle?.includes("bold"),U=`${u.fontStyle?.includes("italic")?"":"italic"} ${b?"bold":""}`.trim();f(t.id,u.id,{fontStyle:U})},children:"Italic"}),o.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Color"}),o.jsx("input",{type:"color",value:u.fill??"#111111",onChange:b=>f(t.id,u.id,{fill:b.target.value}),className:"h-8 w-10 cursor-pointer"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("label",{className:"text-xs opacity-70",children:"Font"}),o.jsx("select",{value:u.fontFamily??"Georgia, serif",onChange:async b=>{const O=b.target.value;await Ct(O),f(t.id,u.id,{fontFamily:O})},className:"rounded border px-2 py-1 text-sm",children:ht.map(b=>o.jsx("option",{value:b.family,children:b.label},b.id))})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("label",{className:"text-xs opacity-70",children:"Align"}),["left","center","right"].map(b=>o.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${u.align===b?"bg-foreground/10":""}`,onClick:()=>f(t.id,u.id,{align:b}),children:b},b)),o.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Wrap width"}),o.jsx("input",{type:"number",min:0,max:G,step:10,value:u.width??0,onChange:b=>f(t.id,u.id,{width:Number(b.target.value)||void 0}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0 disables wrapping"}),o.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Padding"}),o.jsx("input",{type:"number",min:0,max:200,step:1,value:u.padding??0,onChange:b=>f(t.id,u.id,{padding:Number(b.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),o.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Line height"}),o.jsx("input",{type:"number",min:.8,max:2,step:.05,value:u.lineHeight??1.25,onChange:b=>f(t.id,u.id,{lineHeight:Number(b.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),o.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Tracking"}),o.jsx("input",{type:"number",min:-5,max:20,step:.5,value:u.letterSpacing??0,onChange:b=>f(t.id,u.id,{letterSpacing:Number(b.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Additional spacing between glyphs (px, card space)"})]})]}):null})(),o.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:o.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[o.jsx($,{variant:"secondary",disabled:!d,onClick:()=>{if(!d)return;const b=(E.getState().layersByPhoto[t.id]??[]).find(V=>V.id===d);if(!b)return;const U=((b.rotation??0)-90)%360;f(t.id,d,{rotation:U<0?U+360:U})},children:"Rotate −90°"}),o.jsx($,{variant:"secondary",disabled:!d,onClick:()=>{if(!d)return;const b=(E.getState().layersByPhoto[t.id]??[]).find(V=>V.id===d);if(!b)return;const U=((b.rotation??0)+90)%360;f(t.id,d,{rotation:U})},children:"Rotate +90°"}),o.jsx($,{variant:"secondary",disabled:!d,onClick:()=>d&&v(t.id,d),children:"Bring to front"}),o.jsx($,{variant:"secondary",disabled:!d,onClick:()=>d&&m(t.id,d),children:"Send to back"}),o.jsx($,{variant:"destructive",disabled:!d,onClick:()=>{d&&(g(t.id,d),p(null))},children:"Delete layer"})]})}),o.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:o.jsxs("div",{className:"grid gap-3",children:[o.jsxs("div",{className:"grid gap-1.5",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx(le,{children:"Zoom"}),o.jsxs("span",{className:"tabular-nums opacity-70",children:[i.scale.toFixed(2),"×"]})]}),o.jsx(ce,{value:[i.scale],min:1,max:3,step:.01,onValueChange:([u])=>c(b=>({...b,scale:u}))})]}),o.jsxs("div",{className:"grid gap-1.5",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx(le,{children:"Horizontal"}),o.jsxs("span",{className:"tabular-nums opacity-70",children:[i.tx.toFixed(0),"%"]})]}),o.jsx(ce,{value:[i.tx],min:-100,max:100,step:.1,onValueChange:([u])=>c(b=>({...b,tx:u}))})]}),o.jsxs("div",{className:"grid gap-1.5",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx(le,{children:"Vertical"}),o.jsxs("span",{className:"tabular-nums opacity-70",children:[i.ty.toFixed(0),"%"]})]}),o.jsx(ce,{value:[i.ty],min:-100,max:100,step:.1,onValueChange:([u])=>c(b=>({...b,ty:u}))})]})]})})]})}),o.jsxs(Re,{className:"shrink-0 space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx($,{variant:"ghost",onClick:()=>c(J),children:"Reset image"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx($,{variant:"secondary",onClick:()=>s(!1),children:"Cancel"}),o.jsx($,{onClick:()=>{l(t.id,i),s(!1)},children:"Save"})]})]}),o.jsx("div",{children:o.jsx($,{variant:"secondary",onClick:()=>{const u=n(t.id,{text:"New text",fontSize:48,fontFamily:"Georgia, serif",fill:"#fff",x:40,y:40,align:"left"});p(u)},children:"Add text layer"})})]})]})})}function Rs({open:e,onOpenChange:s,photo:t,transform:r,layers:n,snapshot:a,onEdit:l}){const[i,c]=x.useState(null),[d,p]=x.useState(!1),f=x.useRef(null),[g,v]=x.useState(0);return x.useEffect(()=>{const m=f.current;if(!m)return;const k=()=>v(Math.round(m.clientWidth));k();const R=new ResizeObserver(k);return R.observe(m),()=>R.disconnect()},[]),x.useEffect(()=>{let m=null,k=!1;if(!e){m&&URL.revokeObjectURL(m),c(null);return}return(async()=>{p(!0);const R=Math.max(we,g||we);if(a){const j=a(R);if(k)return;if(j){c(j),p(!1);return}}const S=await Lt(t,"",{size:R,transform:r,layers:n});if(k){URL.revokeObjectURL(S);return}m&&URL.revokeObjectURL(m),m=S,c(S),p(!1)})(),()=>{k=!0,m&&URL.revokeObjectURL(m)}},[e,g,t.id,t.url,r.scale,r.tx,r.ty,n,a]),o.jsx(Et,{open:e,onOpenChange:s,children:o.jsxs(je,{"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden",children:[o.jsx(Ne,{children:o.jsx(ar,{asChild:!0,children:o.jsx(Ce,{children:"Preview"})})}),o.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:o.jsxs("div",{ref:f,className:"relative aspect-square overflow-hidden rounded-xl",children:[i?o.jsx("img",{src:i,alt:t.name,className:"absolute inset-0 w-full h-full object-contain"}):o.jsx("div",{className:"h-24"}),o.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${d?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!d,children:o.jsx("div",{className:"h-7 w-7 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]})}),o.jsxs(Re,{className:"mt-2 gap-2",children:[o.jsx($,{variant:"secondary",onClick:()=>{s(!1),l?.()},children:"Edit"}),o.jsx($,{variant:"secondary",onClick:()=>s(!1),children:"Close"}),o.jsx($,{onClick:()=>Mt(t,"",{size:G,transform:r,layers:n}),children:"Save PNG"})]})]})})}function Cs({photo:e}){const s=E(j=>j.remove),t=E(j=>j.transforms[e.id]??J),r=E(j=>j.layersByPhoto),[n,a]=x.useState(!1),[l,i]=x.useState(!1),c=x.useRef(null),d=x.useRef(null),[p,f]=x.useState(0);x.useEffect(()=>{const j=d.current;if(!j)return;const P=()=>f(j.clientWidth);P();const z=new ResizeObserver(P);return z.observe(j),()=>z.disconnect()},[]);const[g,v]=x.useState(null),[m,k]=x.useState(!0),R=x.useRef(0);x.useEffect(()=>{let j=!1,P=null;const z=++R.current;return(async()=>{if(!p)return;k(!0);const I=window.devicePixelRatio||1,M=Math.max(384,Math.min(1024,Math.round(p*I))),h=await bs(e,"",{size:M,transform:t,layers:r[e.id]});if(j||R.current!==z){URL.revokeObjectURL(h);return}P&&URL.revokeObjectURL(P),v(h),P=h,k(!1)})(),()=>{j=!0,P&&URL.revokeObjectURL(P)}},[p,e.url,t.scale,t.tx,t.ty,r[e.id]]);const S=x.useCallback(async()=>{await Mt(e,"",{size:G,transform:t,layers:r[e.id]})},[e,t,r]);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"overflow-hidden rounded-xl border border-foreground/15 bg-foreground/[0.02]",children:[o.jsxs("div",{ref:d,onClick:()=>i(!0),className:"relative aspect-square w-full overflow-hidden cursor-zoom-in",children:[o.jsx("button",{"aria-label":"Remove image",title:"Remove",onClick:j=>{j.stopPropagation(),s(e.id)},className:"absolute right-1 top-1 z-10 rounded-md bg-background/80 px-1.5 py-0.5 text-[11px] shadow hover:bg-background",children:"×"}),g?o.jsx("img",{src:g,alt:e.name,className:"h-full w-full object-cover"}):o.jsx("div",{className:"h-full w-full bg-foreground/[0.06]"}),o.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${m?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!m,children:o.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]}),o.jsxs("div",{className:"flex items-center justify-between gap-2 border-t bg-background/70 px-2 py-1.5 supports-[backdrop-filter]:bg-background/60",children:[o.jsx("button",{"aria-label":"Edit card",title:"Edit",onClick:j=>{j.stopPropagation(),a(!0)},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Edit"}),o.jsx("button",{"aria-label":"Save PNG",title:"Save PNG",onClick:j=>{j.stopPropagation(),S()},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Save PNG"})]})]}),o.jsx(Rs,{open:l,onOpenChange:i,photo:e,transform:t,layers:r[e.id],snapshot:j=>c.current?.toDataURL(j)??null,onEdit:()=>a(!0)}),o.jsx(Ns,{open:n,onOpenChange:a,photo:e,canvasRef:c})]})}function De(e){const s=e/1e3;return s<60?`${s.toFixed(1)}s`:`${Math.floor(s/60)}m ${(s%60).toFixed(0)}s`}function Ss(){const e=E(k=>k.photos),s=E(k=>k.transforms),t=E(k=>k.layersByPhoto),[r,n]=x.useState(!1),[a,l]=x.useState(null),i=x.useRef(!1),[c,d]=x.useState("jpeg"),[p,f]=x.useState(Xr*100),g=a?.pct??0,v=x.useMemo(()=>{if(!a)return"";const k=a.etaMs??0;return`Rendering ${a.done}/${a.total} • ${g}% • elapsed ${De(a.elapsedMs)}${a.done<a.total?` • ETA ${De(k)}`:""}`},[a,g]);x.useEffect(()=>{a&&a.done>=a.total&&l(null)},[a]);const m=x.useCallback(async()=>{if(!(!e.length||i.current)){i.current=!0;try{n(!0),l({done:0,total:e.length,elapsedMs:0,pct:0});const{exportCardsToPdf:k}=await os(async()=>{const{exportCardsToPdf:R}=await import("./pdf-DA6H-Wju.js");return{exportCardsToPdf:R}},__vite__mapDeps([0,1,2,3]));await k(e,void 0,s,{size:G,format:c,quality:Math.min(.95,Math.max(.5,p/100)),onProgress:R=>l(R)},t)}finally{n(!1),i.current=!1}}},[e,s,c,p,t]);return o.jsxs("section",{className:"space-y-3",children:[o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:e.map(k=>o.jsx(Cs,{photo:k},k.id))}),e.length>0&&o.jsxs(yt,{className:"p-4",children:[o.jsx("div",{className:"mb-3 text-sm font-medium",children:"Export the collection to PDF"}),a&&o.jsxs(o.Fragment,{children:[o.jsx(wt,{value:g,className:"mb-1 h-2"}),o.jsx("div",{className:"mb-3 text-xs opacity-70",children:v})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"opacity-70",children:"Format"}),o.jsxs(ds,{value:c,onValueChange:k=>d(k),children:[o.jsx(vt,{className:"w-28 h-8",children:o.jsx(ms,{placeholder:"Format"})}),o.jsxs(Nt,{children:[o.jsx(ve,{value:"jpeg",children:"JPEG (small)"}),o.jsx(ve,{value:"png",children:"PNG (lossless)"})]})]})]}),c==="jpeg"&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"opacity-70",children:"Quality"}),o.jsx("input",{type:"range",min:50,max:95,step:5,value:p,onChange:k=>f(Number(k.target.value))}),o.jsxs("span",{className:"tabular-nums",children:[p,"%"]})]}),o.jsx("div",{className:"grow"}),o.jsx($,{type:"button",size:"sm",onClick:m,disabled:!e.length||r,children:r?"Exporting…":"Export PDF"})]})]})]})}function Ps(){return ir(),o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"sticky top-0 z-10 w-full py-3 text-center text-3xl font-bold bg-background border-b border-gray-300",children:"Story Squares v1.0"}),o.jsxs("main",{className:"mx-auto max-w-screen-md px-4 space-y-5",children:[o.jsx(ts,{}),o.jsx(Ss,{})]})]})}Vt.createRoot(document.getElementById("root")).render(o.jsx(x.StrictMode,{children:o.jsx(Ps,{})}));export{G as C,J as D,Xr as P,Rt as d,St as e};
