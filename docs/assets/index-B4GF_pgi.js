const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-7PivIdT5.js","assets/jspdf-Bb3MAaWf.js","assets/vendor-react-Cx2gpj_n.js","assets/vendor-ui-Bnhpo9lR.js"])))=>i.map(i=>d[i]);
import{r as L,j as C,k as Co,m as Eo,n as qe,C as So,p as qi,q as Yi,S as $i,L as Gi,t as Cr,I as Ro,T as Vi,v as Hi,X as Zi,w as Ao,x as No,R as Tt,a as Re,y as Xi,N as Zn,z as Ki,A as mn,B as Qi}from"./vendor-react-Cx2gpj_n.js";import{S as Ji,R as Io,I as ts,T as To,a as es,b as Do,c as zo,P as ns,C as jo,V as rs,L as Lo,d as Mo,e as os,f as is,g as Bo,h as ss,i as as,O as Po,j as ls,k as Oo,l as cs,m as Fo,D as Uo,n as ds,o as us,p as Wo,q as qo,r as fs,s as hs,t as ms}from"./vendor-ui-Bnhpo9lR.js";import{_ as ps}from"./jspdf-Bb3MAaWf.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}})();if(typeof window<"u"){const t=n=>{const e=n?.reason&&(n.reason.message||String(n.reason))||"Unknown async error";console.error("Unhandled promise rejection:",n?.reason),setTimeout(()=>alert(`Error: ${e}`),0)};window.addEventListener("unhandledrejection",t)}function pn(t){const n=document.documentElement,e=window.matchMedia("(prefers-color-scheme: dark)").matches,r=t==="dark"||t==="system"&&e;n.classList.toggle("dark",r)}function gs(){L.useEffect(()=>{const t=localStorage.getItem("theme")??"system";pn(t);const n=window.matchMedia("(prefers-color-scheme: dark)"),e=()=>{const o=localStorage.getItem("theme")??"system";o==="system"&&pn(o)};n.addEventListener("change",e);const r=o=>{if(o.key==="theme"){const i=o.newValue??"system";pn(i)}};return window.addEventListener("storage",r),()=>{n.removeEventListener("change",e),window.removeEventListener("storage",r)}},[])}function Yo(t){var n,e,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(n=0;n<o;n++)t[n]&&(e=Yo(t[n]))&&(r&&(r+=" "),r+=e)}else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function $o(){for(var t,n,e=0,r="",o=arguments.length;e<o;e++)(t=arguments[e])&&(n=Yo(t))&&(r&&(r+=" "),r+=n);return r}const Er=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Sr=$o,Go=(t,n)=>e=>{var r;if(n?.variants==null)return Sr(t,e?.class,e?.className);const{variants:o,defaultVariants:i}=n,a=Object.keys(o).map(f=>{const c=e?.[f],g=i?.[f];if(c===null)return null;const p=Er(c)||Er(g);return o[f][p]}),s=e&&Object.entries(e).reduce((f,c)=>{let[g,p]=c;return p===void 0||(f[g]=p),f},{}),l=n==null||(r=n.compoundVariants)===null||r===void 0?void 0:r.reduce((f,c)=>{let{class:g,className:p,...d}=c;return Object.entries(d).every(b=>{let[u,v]=b;return Array.isArray(v)?v.includes({...i,...s}[u]):{...i,...s}[u]===v})?[...f,g,p]:f},[]);return Sr(t,a,l,e?.class,e?.className)},or="-",bs=t=>{const n=vs(t),{conflictingClassGroups:e,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const s=a.split(or);return s[0]===""&&s.length!==1&&s.shift(),Vo(s,n)||ys(a)},getConflictingClassGroupIds:(a,s)=>{const l=e[a]||[];return s&&r[a]?[...l,...r[a]]:l}}},Vo=(t,n)=>{if(t.length===0)return n.classGroupId;const e=t[0],r=n.nextPart.get(e),o=r?Vo(t.slice(1),r):void 0;if(o)return o;if(n.validators.length===0)return;const i=t.join(or);return n.validators.find(({validator:a})=>a(i))?.classGroupId},Rr=/^\[(.+)\]$/,ys=t=>{if(Rr.test(t)){const n=Rr.exec(t)[1],e=n?.substring(0,n.indexOf(":"));if(e)return"arbitrary.."+e}},vs=t=>{const{theme:n,classGroups:e}=t,r={nextPart:new Map,validators:[]};for(const o in e)Xn(e[o],r,o,n);return r},Xn=(t,n,e,r)=>{t.forEach(o=>{if(typeof o=="string"){const i=o===""?n:Ar(n,o);i.classGroupId=e;return}if(typeof o=="function"){if(ws(o)){Xn(o(r),n,e,r);return}n.validators.push({validator:o,classGroupId:e});return}Object.entries(o).forEach(([i,a])=>{Xn(a,Ar(n,i),e,r)})})},Ar=(t,n)=>{let e=t;return n.split(or).forEach(r=>{e.nextPart.has(r)||e.nextPart.set(r,{nextPart:new Map,validators:[]}),e=e.nextPart.get(r)}),e},ws=t=>t.isThemeGetter,xs=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,e=new Map,r=new Map;const o=(i,a)=>{e.set(i,a),n++,n>t&&(n=0,r=e,e=new Map)};return{get(i){let a=e.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return o(i,a),a},set(i,a){e.has(i)?e.set(i,a):o(i,a)}}},Kn="!",Qn=":",_s=Qn.length,ks=t=>{const{prefix:n,experimentalParseClassName:e}=t;let r=o=>{const i=[];let a=0,s=0,l=0,f;for(let b=0;b<o.length;b++){let u=o[b];if(a===0&&s===0){if(u===Qn){i.push(o.slice(l,b)),l=b+_s;continue}if(u==="/"){f=b;continue}}u==="["?a++:u==="]"?a--:u==="("?s++:u===")"&&s--}const c=i.length===0?o:o.substring(l),g=Cs(c),p=g!==c,d=f&&f>l?f-l:void 0;return{modifiers:i,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:d}};if(n){const o=n+Qn,i=r;r=a=>a.startsWith(o)?i(a.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(e){const o=r;r=i=>e({className:i,parseClassName:o})}return r},Cs=t=>t.endsWith(Kn)?t.substring(0,t.length-1):t.startsWith(Kn)?t.substring(1):t,Es=t=>{const n=Object.fromEntries(t.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const o=[];let i=[];return r.forEach(a=>{a[0]==="["||n[a]?(o.push(...i.sort(),a),i=[]):i.push(a)}),o.push(...i.sort()),o}},Ss=t=>({cache:xs(t.cacheSize),parseClassName:ks(t),sortModifiers:Es(t),...bs(t)}),Rs=/\s+/,As=(t,n)=>{const{parseClassName:e,getClassGroupId:r,getConflictingClassGroupIds:o,sortModifiers:i}=n,a=[],s=t.trim().split(Rs);let l="";for(let f=s.length-1;f>=0;f-=1){const c=s[f],{isExternal:g,modifiers:p,hasImportantModifier:d,baseClassName:b,maybePostfixModifierPosition:u}=e(c);if(g){l=c+(l.length>0?" "+l:l);continue}let v=!!u,y=r(v?b.substring(0,u):b);if(!y){if(!v){l=c+(l.length>0?" "+l:l);continue}if(y=r(b),!y){l=c+(l.length>0?" "+l:l);continue}v=!1}const w=i(p).join(":"),x=d?w+Kn:w,_=x+y;if(a.includes(_))continue;a.push(_);const R=o(y,v);for(let N=0;N<R.length;++N){const I=R[N];a.push(x+I)}l=c+(l.length>0?" "+l:l)}return l};function Ns(){let t=0,n,e,r="";for(;t<arguments.length;)(n=arguments[t++])&&(e=Ho(n))&&(r&&(r+=" "),r+=e);return r}const Ho=t=>{if(typeof t=="string")return t;let n,e="";for(let r=0;r<t.length;r++)t[r]&&(n=Ho(t[r]))&&(e&&(e+=" "),e+=n);return e};function Is(t,...n){let e,r,o,i=a;function a(l){const f=n.reduce((c,g)=>g(c),t());return e=Ss(f),r=e.cache.get,o=e.cache.set,i=s,s(l)}function s(l){const f=r(l);if(f)return f;const c=As(l,e);return o(l,c),c}return function(){return i(Ns.apply(null,arguments))}}const Ct=t=>{const n=e=>e[t]||[];return n.isThemeGetter=!0,n},Zo=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Xo=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Ts=/^\d+\/\d+$/,Ds=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,zs=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,js=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Ls=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Ms=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,fe=t=>Ts.test(t),ft=t=>!!t&&!Number.isNaN(Number(t)),te=t=>!!t&&Number.isInteger(Number(t)),gn=t=>t.endsWith("%")&&ft(t.slice(0,-1)),Gt=t=>Ds.test(t),Bs=()=>!0,Ps=t=>zs.test(t)&&!js.test(t),Ko=()=>!1,Os=t=>Ls.test(t),Fs=t=>Ms.test(t),Us=t=>!st(t)&&!at(t),Ws=t=>be(t,ti,Ko),st=t=>Zo.test(t),se=t=>be(t,ei,Ps),bn=t=>be(t,Vs,ft),Nr=t=>be(t,Qo,Ko),qs=t=>be(t,Jo,Fs),Ye=t=>be(t,ni,Os),at=t=>Xo.test(t),Ee=t=>ye(t,ei),Ys=t=>ye(t,Hs),Ir=t=>ye(t,Qo),$s=t=>ye(t,ti),Gs=t=>ye(t,Jo),$e=t=>ye(t,ni,!0),be=(t,n,e)=>{const r=Zo.exec(t);return r?r[1]?n(r[1]):e(r[2]):!1},ye=(t,n,e=!1)=>{const r=Xo.exec(t);return r?r[1]?n(r[1]):e:!1},Qo=t=>t==="position"||t==="percentage",Jo=t=>t==="image"||t==="url",ti=t=>t==="length"||t==="size"||t==="bg-size",ei=t=>t==="length",Vs=t=>t==="number",Hs=t=>t==="family-name",ni=t=>t==="shadow",Zs=()=>{const t=Ct("color"),n=Ct("font"),e=Ct("text"),r=Ct("font-weight"),o=Ct("tracking"),i=Ct("leading"),a=Ct("breakpoint"),s=Ct("container"),l=Ct("spacing"),f=Ct("radius"),c=Ct("shadow"),g=Ct("inset-shadow"),p=Ct("text-shadow"),d=Ct("drop-shadow"),b=Ct("blur"),u=Ct("perspective"),v=Ct("aspect"),y=Ct("ease"),w=Ct("animate"),x=()=>["auto","avoid","all","avoid-page","page","left","right","column"],_=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],R=()=>[..._(),at,st],N=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto","contain","none"],z=()=>[at,st,l],T=()=>[fe,"full","auto",...z()],O=()=>[te,"none","subgrid",at,st],q=()=>["auto",{span:["full",te,at,st]},te,at,st],S=()=>[te,"auto",at,st],k=()=>["auto","min","max","fr",at,st],m=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],W=()=>["start","end","center","stretch","center-safe","end-safe"],nt=()=>["auto",...z()],G=()=>[fe,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...z()],F=()=>[t,at,st],B=()=>[..._(),Ir,Nr,{position:[at,st]}],j=()=>["no-repeat",{repeat:["","x","y","space","round"]}],E=()=>["auto","cover","contain",$s,Ws,{size:[at,st]}],M=()=>[gn,Ee,se],Z=()=>["","none","full",f,at,st],V=()=>["",ft,Ee,se],$=()=>["solid","dashed","dotted","double"],lt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ot=()=>[ft,gn,Ir,Nr],tt=()=>["","none",b,at,st],K=()=>["none",ft,at,st],rt=()=>["none",ft,at,st],dt=()=>[ft,at,st],pt=()=>[fe,"full",...z()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Gt],breakpoint:[Gt],color:[Bs],container:[Gt],"drop-shadow":[Gt],ease:["in","out","in-out"],font:[Us],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Gt],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Gt],shadow:[Gt],spacing:["px",ft],text:[Gt],"text-shadow":[Gt],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",fe,st,at,v]}],container:["container"],columns:[{columns:[ft,st,at,s]}],"break-after":[{"break-after":x()}],"break-before":[{"break-before":x()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:R()}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:T()}],"inset-x":[{"inset-x":T()}],"inset-y":[{"inset-y":T()}],start:[{start:T()}],end:[{end:T()}],top:[{top:T()}],right:[{right:T()}],bottom:[{bottom:T()}],left:[{left:T()}],visibility:["visible","invisible","collapse"],z:[{z:[te,"auto",at,st]}],basis:[{basis:[fe,"full","auto",s,...z()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ft,fe,"auto","initial","none",st]}],grow:[{grow:["",ft,at,st]}],shrink:[{shrink:["",ft,at,st]}],order:[{order:[te,"first","last","none",at,st]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:q()}],"col-start":[{"col-start":S()}],"col-end":[{"col-end":S()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:q()}],"row-start":[{"row-start":S()}],"row-end":[{"row-end":S()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":k()}],"auto-rows":[{"auto-rows":k()}],gap:[{gap:z()}],"gap-x":[{"gap-x":z()}],"gap-y":[{"gap-y":z()}],"justify-content":[{justify:[...m(),"normal"]}],"justify-items":[{"justify-items":[...W(),"normal"]}],"justify-self":[{"justify-self":["auto",...W()]}],"align-content":[{content:["normal",...m()]}],"align-items":[{items:[...W(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...W(),{baseline:["","last"]}]}],"place-content":[{"place-content":m()}],"place-items":[{"place-items":[...W(),"baseline"]}],"place-self":[{"place-self":["auto",...W()]}],p:[{p:z()}],px:[{px:z()}],py:[{py:z()}],ps:[{ps:z()}],pe:[{pe:z()}],pt:[{pt:z()}],pr:[{pr:z()}],pb:[{pb:z()}],pl:[{pl:z()}],m:[{m:nt()}],mx:[{mx:nt()}],my:[{my:nt()}],ms:[{ms:nt()}],me:[{me:nt()}],mt:[{mt:nt()}],mr:[{mr:nt()}],mb:[{mb:nt()}],ml:[{ml:nt()}],"space-x":[{"space-x":z()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":z()}],"space-y-reverse":["space-y-reverse"],size:[{size:G()}],w:[{w:[s,"screen",...G()]}],"min-w":[{"min-w":[s,"screen","none",...G()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[a]},...G()]}],h:[{h:["screen","lh",...G()]}],"min-h":[{"min-h":["screen","lh","none",...G()]}],"max-h":[{"max-h":["screen","lh",...G()]}],"font-size":[{text:["base",e,Ee,se]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,at,bn]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",gn,st]}],"font-family":[{font:[Ys,st,n]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,at,st]}],"line-clamp":[{"line-clamp":[ft,"none",at,bn]}],leading:[{leading:[i,...z()]}],"list-image":[{"list-image":["none",at,st]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",at,st]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:F()}],"text-color":[{text:F()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...$(),"wavy"]}],"text-decoration-thickness":[{decoration:[ft,"from-font","auto",at,se]}],"text-decoration-color":[{decoration:F()}],"underline-offset":[{"underline-offset":[ft,"auto",at,st]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",at,st]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",at,st]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:B()}],"bg-repeat":[{bg:j()}],"bg-size":[{bg:E()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},te,at,st],radial:["",at,st],conic:[te,at,st]},Gs,qs]}],"bg-color":[{bg:F()}],"gradient-from-pos":[{from:M()}],"gradient-via-pos":[{via:M()}],"gradient-to-pos":[{to:M()}],"gradient-from":[{from:F()}],"gradient-via":[{via:F()}],"gradient-to":[{to:F()}],rounded:[{rounded:Z()}],"rounded-s":[{"rounded-s":Z()}],"rounded-e":[{"rounded-e":Z()}],"rounded-t":[{"rounded-t":Z()}],"rounded-r":[{"rounded-r":Z()}],"rounded-b":[{"rounded-b":Z()}],"rounded-l":[{"rounded-l":Z()}],"rounded-ss":[{"rounded-ss":Z()}],"rounded-se":[{"rounded-se":Z()}],"rounded-ee":[{"rounded-ee":Z()}],"rounded-es":[{"rounded-es":Z()}],"rounded-tl":[{"rounded-tl":Z()}],"rounded-tr":[{"rounded-tr":Z()}],"rounded-br":[{"rounded-br":Z()}],"rounded-bl":[{"rounded-bl":Z()}],"border-w":[{border:V()}],"border-w-x":[{"border-x":V()}],"border-w-y":[{"border-y":V()}],"border-w-s":[{"border-s":V()}],"border-w-e":[{"border-e":V()}],"border-w-t":[{"border-t":V()}],"border-w-r":[{"border-r":V()}],"border-w-b":[{"border-b":V()}],"border-w-l":[{"border-l":V()}],"divide-x":[{"divide-x":V()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":V()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...$(),"hidden","none"]}],"divide-style":[{divide:[...$(),"hidden","none"]}],"border-color":[{border:F()}],"border-color-x":[{"border-x":F()}],"border-color-y":[{"border-y":F()}],"border-color-s":[{"border-s":F()}],"border-color-e":[{"border-e":F()}],"border-color-t":[{"border-t":F()}],"border-color-r":[{"border-r":F()}],"border-color-b":[{"border-b":F()}],"border-color-l":[{"border-l":F()}],"divide-color":[{divide:F()}],"outline-style":[{outline:[...$(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ft,at,st]}],"outline-w":[{outline:["",ft,Ee,se]}],"outline-color":[{outline:F()}],shadow:[{shadow:["","none",c,$e,Ye]}],"shadow-color":[{shadow:F()}],"inset-shadow":[{"inset-shadow":["none",g,$e,Ye]}],"inset-shadow-color":[{"inset-shadow":F()}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:F()}],"ring-offset-w":[{"ring-offset":[ft,se]}],"ring-offset-color":[{"ring-offset":F()}],"inset-ring-w":[{"inset-ring":V()}],"inset-ring-color":[{"inset-ring":F()}],"text-shadow":[{"text-shadow":["none",p,$e,Ye]}],"text-shadow-color":[{"text-shadow":F()}],opacity:[{opacity:[ft,at,st]}],"mix-blend":[{"mix-blend":[...lt(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":lt()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ft]}],"mask-image-linear-from-pos":[{"mask-linear-from":ot()}],"mask-image-linear-to-pos":[{"mask-linear-to":ot()}],"mask-image-linear-from-color":[{"mask-linear-from":F()}],"mask-image-linear-to-color":[{"mask-linear-to":F()}],"mask-image-t-from-pos":[{"mask-t-from":ot()}],"mask-image-t-to-pos":[{"mask-t-to":ot()}],"mask-image-t-from-color":[{"mask-t-from":F()}],"mask-image-t-to-color":[{"mask-t-to":F()}],"mask-image-r-from-pos":[{"mask-r-from":ot()}],"mask-image-r-to-pos":[{"mask-r-to":ot()}],"mask-image-r-from-color":[{"mask-r-from":F()}],"mask-image-r-to-color":[{"mask-r-to":F()}],"mask-image-b-from-pos":[{"mask-b-from":ot()}],"mask-image-b-to-pos":[{"mask-b-to":ot()}],"mask-image-b-from-color":[{"mask-b-from":F()}],"mask-image-b-to-color":[{"mask-b-to":F()}],"mask-image-l-from-pos":[{"mask-l-from":ot()}],"mask-image-l-to-pos":[{"mask-l-to":ot()}],"mask-image-l-from-color":[{"mask-l-from":F()}],"mask-image-l-to-color":[{"mask-l-to":F()}],"mask-image-x-from-pos":[{"mask-x-from":ot()}],"mask-image-x-to-pos":[{"mask-x-to":ot()}],"mask-image-x-from-color":[{"mask-x-from":F()}],"mask-image-x-to-color":[{"mask-x-to":F()}],"mask-image-y-from-pos":[{"mask-y-from":ot()}],"mask-image-y-to-pos":[{"mask-y-to":ot()}],"mask-image-y-from-color":[{"mask-y-from":F()}],"mask-image-y-to-color":[{"mask-y-to":F()}],"mask-image-radial":[{"mask-radial":[at,st]}],"mask-image-radial-from-pos":[{"mask-radial-from":ot()}],"mask-image-radial-to-pos":[{"mask-radial-to":ot()}],"mask-image-radial-from-color":[{"mask-radial-from":F()}],"mask-image-radial-to-color":[{"mask-radial-to":F()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":_()}],"mask-image-conic-pos":[{"mask-conic":[ft]}],"mask-image-conic-from-pos":[{"mask-conic-from":ot()}],"mask-image-conic-to-pos":[{"mask-conic-to":ot()}],"mask-image-conic-from-color":[{"mask-conic-from":F()}],"mask-image-conic-to-color":[{"mask-conic-to":F()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:B()}],"mask-repeat":[{mask:j()}],"mask-size":[{mask:E()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",at,st]}],filter:[{filter:["","none",at,st]}],blur:[{blur:tt()}],brightness:[{brightness:[ft,at,st]}],contrast:[{contrast:[ft,at,st]}],"drop-shadow":[{"drop-shadow":["","none",d,$e,Ye]}],"drop-shadow-color":[{"drop-shadow":F()}],grayscale:[{grayscale:["",ft,at,st]}],"hue-rotate":[{"hue-rotate":[ft,at,st]}],invert:[{invert:["",ft,at,st]}],saturate:[{saturate:[ft,at,st]}],sepia:[{sepia:["",ft,at,st]}],"backdrop-filter":[{"backdrop-filter":["","none",at,st]}],"backdrop-blur":[{"backdrop-blur":tt()}],"backdrop-brightness":[{"backdrop-brightness":[ft,at,st]}],"backdrop-contrast":[{"backdrop-contrast":[ft,at,st]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ft,at,st]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ft,at,st]}],"backdrop-invert":[{"backdrop-invert":["",ft,at,st]}],"backdrop-opacity":[{"backdrop-opacity":[ft,at,st]}],"backdrop-saturate":[{"backdrop-saturate":[ft,at,st]}],"backdrop-sepia":[{"backdrop-sepia":["",ft,at,st]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":z()}],"border-spacing-x":[{"border-spacing-x":z()}],"border-spacing-y":[{"border-spacing-y":z()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",at,st]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ft,"initial",at,st]}],ease:[{ease:["linear","initial",y,at,st]}],delay:[{delay:[ft,at,st]}],animate:[{animate:["none",w,at,st]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[u,at,st]}],"perspective-origin":[{"perspective-origin":R()}],rotate:[{rotate:K()}],"rotate-x":[{"rotate-x":K()}],"rotate-y":[{"rotate-y":K()}],"rotate-z":[{"rotate-z":K()}],scale:[{scale:rt()}],"scale-x":[{"scale-x":rt()}],"scale-y":[{"scale-y":rt()}],"scale-z":[{"scale-z":rt()}],"scale-3d":["scale-3d"],skew:[{skew:dt()}],"skew-x":[{"skew-x":dt()}],"skew-y":[{"skew-y":dt()}],transform:[{transform:[at,st,"","none","gpu","cpu"]}],"transform-origin":[{origin:R()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:pt()}],"translate-x":[{"translate-x":pt()}],"translate-y":[{"translate-y":pt()}],"translate-z":[{"translate-z":pt()}],"translate-none":["translate-none"],accent:[{accent:F()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:F()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",at,st]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":z()}],"scroll-mx":[{"scroll-mx":z()}],"scroll-my":[{"scroll-my":z()}],"scroll-ms":[{"scroll-ms":z()}],"scroll-me":[{"scroll-me":z()}],"scroll-mt":[{"scroll-mt":z()}],"scroll-mr":[{"scroll-mr":z()}],"scroll-mb":[{"scroll-mb":z()}],"scroll-ml":[{"scroll-ml":z()}],"scroll-p":[{"scroll-p":z()}],"scroll-px":[{"scroll-px":z()}],"scroll-py":[{"scroll-py":z()}],"scroll-ps":[{"scroll-ps":z()}],"scroll-pe":[{"scroll-pe":z()}],"scroll-pt":[{"scroll-pt":z()}],"scroll-pr":[{"scroll-pr":z()}],"scroll-pb":[{"scroll-pb":z()}],"scroll-pl":[{"scroll-pl":z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",at,st]}],fill:[{fill:["none",...F()]}],"stroke-w":[{stroke:[ft,Ee,se,bn]}],stroke:[{stroke:["none",...F()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Xs=Is(Zs);function vt(...t){return Xs($o(t))}const Ks=Go("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),gt=L.forwardRef(({className:t,variant:n,size:e,asChild:r=!1,...o},i)=>{const a=r?Ji:"button";return C.jsx(a,{className:vt(Ks({variant:n,size:e,className:t})),ref:i,...o})});gt.displayName="Button";const Qs=/^(image\/(jpeg|png|webp|gif|avif|bmp|tiff))$/i;function Js(t){return Qs.test(t.type)}function ta(t,n=36){const e=[];for(const r of t)if(Js(r)){if(e.length>=n)break;e.push({id:crypto.randomUUID(),url:URL.createObjectURL(r),name:r.name,size:r.size,type:r.type})}return e}function Tr(t){for(const n of t)try{URL.revokeObjectURL(n.url)}catch{}}let qt=null;function Ge(){if(!qt)throw new Error("ConfigController: not initialized. Call Config.init().")}function Dr(t){if(t.MAX_CARDS!=null&&(!Number.isInteger(t.MAX_CARDS)||t.MAX_CARDS<=0))throw new Error("MAX_CARDS must be a positive integer.");if(t.CARD_EXPORT_SIZE!=null&&(!Number.isInteger(t.CARD_EXPORT_SIZE)||t.CARD_EXPORT_SIZE<=0))throw new Error("CARD_EXPORT_SIZE must be a positive integer.");if(t.PREVIEW_EXACT_SIZE!=null&&(!Number.isInteger(t.PREVIEW_EXACT_SIZE)||t.PREVIEW_EXACT_SIZE<=0))throw new Error("PREVIEW_EXACT_SIZE must be a positive integer.");if(t.PREVIEW_FAST_SIZE!=null&&(!Number.isInteger(t.PREVIEW_FAST_SIZE)||t.PREVIEW_FAST_SIZE<=0))throw new Error("PREVIEW_FAST_SIZE must be a positive integer.");if(t.PDF_JPEG_QUALITY!=null&&(t.PDF_JPEG_QUALITY<0||t.PDF_JPEG_QUALITY>1))throw new Error("PDF_JPEG_QUALITY must be within [0..1].");if(t.IMAGE_FIT_MODE!=null&&t.IMAGE_FIT_MODE!=="cover"&&t.IMAGE_FIT_MODE!=="contain")throw new Error("IMAGE_FIT_MODE must be 'cover' or 'contain'.");if(t.INITIAL_ALIGN_X!=null&&!["center","left","right"].includes(t.INITIAL_ALIGN_X))throw new Error("INITIAL_ALIGN_X must be 'center' | 'left' | 'right'.");if(t.INITIAL_ALIGN_Y!=null&&!["center","top","bottom"].includes(t.INITIAL_ALIGN_Y))throw new Error("INITIAL_ALIGN_Y must be 'center' | 'top' | 'bottom'.");if(t.FONT_CATALOG!=null&&!Array.isArray(t.FONT_CATALOG))throw new Error("FONT_CATALOG must be an array.");if(t.DEFAULT_CARD_LAYERS!=null&&!Array.isArray(t.DEFAULT_CARD_LAYERS))throw new Error("DEFAULT_CARD_LAYERS must be an array.");if(t.DEFAULTS!=null&&(typeof t.DEFAULTS!="object"||Array.isArray(t.DEFAULTS)))throw new Error("DEFAULTS must be an object.");if(t.NEAR_SQUARE_TOLERANCE!=null&&(t.NEAR_SQUARE_TOLERANCE<0||t.NEAR_SQUARE_TOLERANCE>.5))throw new Error("NEAR_SQUARE_TOLERANCE must be within [0..0.5].");if(t.NEAR_SQUARE_SCALE!=null&&(t.NEAR_SQUARE_SCALE<=0||t.NEAR_SQUARE_SCALE>1))throw new Error("NEAR_SQUARE_SCALE must be within (0..1].");if(t.LAYER_PROFILES!=null){if(typeof t.LAYER_PROFILES!="object"||Array.isArray(t.LAYER_PROFILES))throw new Error("LAYER_PROFILES must be an object.");for(const[n,e]of Object.entries(t.LAYER_PROFILES)){if(e==null||typeof e!="object"||Array.isArray(e))throw new Error(`LAYER_PROFILES['${n}'] must be an object.`);if(e.on!=null&&typeof e.on!="boolean")throw new Error(`LAYER_PROFILES['${n}'].on must be boolean if provided.`);if(e.landscape!=null&&!Array.isArray(e.landscape))throw new Error(`LAYER_PROFILES['${n}'].landscape must be an array if provided.`);if(e.portrait!=null&&!Array.isArray(e.portrait))throw new Error(`LAYER_PROFILES['${n}'].portrait must be an array if provided.`);if(e.square!=null&&!Array.isArray(e.square))throw new Error(`LAYER_PROFILES['${n}'].square must be an array if provided.`)}}}const yt={init(t){qt=Object.freeze({...t})},get(){return Ge(),qt},update(t){return Ge(),Dr(t),qt=Object.freeze({...qt,...t}),qt},loadFromJson(t){Ge();const n=t;return Dr(n),qt=Object.freeze({...qt,...n}),qt},toJson(){return Ge(),{...qt}},async loadFromUrl(t){const n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error(`Config.loadFromUrl failed: ${n.status}`);const e=await n.json(),{schemaVersion:r,...o}=e??{};return this.loadFromJson(o)}};yt.init({});const ea="/ss/configs/default.json";await yt.loadFromUrl(ea);const ri=yt.get().MAX_CARDS,It=yt.get().CARD_EXPORT_SIZE,Ke=yt.get().PREVIEW_EXACT_SIZE,na=yt.get().PREVIEW_FAST_SIZE,ra=yt.get().PDF_JPEG_QUALITY,zr=yt.get().IMAGE_FIT_MODE,oa=yt.get().INITIAL_ALIGN_X,ia=yt.get().INITIAL_ALIGN_Y,oi=yt.get().FONT_CATALOG;yt.get().NEAR_SQUARE_TOLERANCE;yt.get().NEAR_SQUARE_SCALE;yt.get().DEFAULTS;yt.get().DEFAULT_CARD_LAYERS;var he={},yn,jr;function sa(){return jr||(jr=1,yn=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),yn}var vn={},ee={},Lr;function le(){if(Lr)return ee;Lr=1;let t;const n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return ee.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17},ee.getSymbolTotalCodewords=function(r){return n[r]},ee.getBCHDigit=function(e){let r=0;for(;e!==0;)r++,e>>>=1;return r},ee.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');t=r},ee.isKanjiModeEnabled=function(){return typeof t<"u"},ee.toSJIS=function(r){return t(r)},ee}var wn={},Mr;function ir(){return Mr||(Mr=1,function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function n(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}t.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},t.from=function(r,o){if(t.isValid(r))return r;try{return n(r)}catch{return o}}}(wn)),wn}var xn,Br;function aa(){if(Br)return xn;Br=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(n){const e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let r=0;r<e;r++)this.putBit((n>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}},xn=t,xn}var _n,Pr;function la(){if(Pr)return _n;Pr=1;function t(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}return t.prototype.set=function(n,e,r,o){const i=n*this.size+e;this.data[i]=r,o&&(this.reservedBit[i]=!0)},t.prototype.get=function(n,e){return this.data[n*this.size+e]},t.prototype.xor=function(n,e,r){this.data[n*this.size+e]^=r},t.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]},_n=t,_n}var kn={},Or;function ca(){return Or||(Or=1,function(t){const n=le().getSymbolSize;t.getRowColCoords=function(r){if(r===1)return[];const o=Math.floor(r/7)+2,i=n(r),a=i===145?26:Math.ceil((i-13)/(2*o-2))*2,s=[i-7];for(let l=1;l<o-1;l++)s[l]=s[l-1]-a;return s.push(6),s.reverse()},t.getPositions=function(r){const o=[],i=t.getRowColCoords(r),a=i.length;for(let s=0;s<a;s++)for(let l=0;l<a;l++)s===0&&l===0||s===0&&l===a-1||s===a-1&&l===0||o.push([i[s],i[l]]);return o}}(kn)),kn}var Cn={},Fr;function da(){if(Fr)return Cn;Fr=1;const t=le().getSymbolSize,n=7;return Cn.getPositions=function(r){const o=t(r);return[[0,0],[o-n,0],[0,o-n]]},Cn}var En={},Ur;function ua(){return Ur||(Ur=1,function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n={N1:3,N2:3,N3:40,N4:10};t.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},t.from=function(o){return t.isValid(o)?parseInt(o,10):void 0},t.getPenaltyN1=function(o){const i=o.size;let a=0,s=0,l=0,f=null,c=null;for(let g=0;g<i;g++){s=l=0,f=c=null;for(let p=0;p<i;p++){let d=o.get(g,p);d===f?s++:(s>=5&&(a+=n.N1+(s-5)),f=d,s=1),d=o.get(p,g),d===c?l++:(l>=5&&(a+=n.N1+(l-5)),c=d,l=1)}s>=5&&(a+=n.N1+(s-5)),l>=5&&(a+=n.N1+(l-5))}return a},t.getPenaltyN2=function(o){const i=o.size;let a=0;for(let s=0;s<i-1;s++)for(let l=0;l<i-1;l++){const f=o.get(s,l)+o.get(s,l+1)+o.get(s+1,l)+o.get(s+1,l+1);(f===4||f===0)&&a++}return a*n.N2},t.getPenaltyN3=function(o){const i=o.size;let a=0,s=0,l=0;for(let f=0;f<i;f++){s=l=0;for(let c=0;c<i;c++)s=s<<1&2047|o.get(f,c),c>=10&&(s===1488||s===93)&&a++,l=l<<1&2047|o.get(c,f),c>=10&&(l===1488||l===93)&&a++}return a*n.N3},t.getPenaltyN4=function(o){let i=0;const a=o.data.length;for(let l=0;l<a;l++)i+=o.data[l];return Math.abs(Math.ceil(i*100/a/5)-10)*n.N4};function e(r,o,i){switch(r){case t.Patterns.PATTERN000:return(o+i)%2===0;case t.Patterns.PATTERN001:return o%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(o+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return o*i%2+o*i%3===0;case t.Patterns.PATTERN110:return(o*i%2+o*i%3)%2===0;case t.Patterns.PATTERN111:return(o*i%3+(o+i)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}t.applyMask=function(o,i){const a=i.size;for(let s=0;s<a;s++)for(let l=0;l<a;l++)i.isReserved(l,s)||i.xor(l,s,e(o,l,s))},t.getBestMask=function(o,i){const a=Object.keys(t.Patterns).length;let s=0,l=1/0;for(let f=0;f<a;f++){i(f),t.applyMask(f,o);const c=t.getPenaltyN1(o)+t.getPenaltyN2(o)+t.getPenaltyN3(o)+t.getPenaltyN4(o);t.applyMask(f,o),c<l&&(l=c,s=f)}return s}}(En)),En}var Ve={},Wr;function ii(){if(Wr)return Ve;Wr=1;const t=ir(),n=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],e=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Ve.getBlocksCount=function(o,i){switch(i){case t.L:return n[(o-1)*4+0];case t.M:return n[(o-1)*4+1];case t.Q:return n[(o-1)*4+2];case t.H:return n[(o-1)*4+3];default:return}},Ve.getTotalCodewordsCount=function(o,i){switch(i){case t.L:return e[(o-1)*4+0];case t.M:return e[(o-1)*4+1];case t.Q:return e[(o-1)*4+2];case t.H:return e[(o-1)*4+3];default:return}},Ve}var Sn={},Se={},qr;function fa(){if(qr)return Se;qr=1;const t=new Uint8Array(512),n=new Uint8Array(256);return function(){let r=1;for(let o=0;o<255;o++)t[o]=r,n[r]=o,r<<=1,r&256&&(r^=285);for(let o=255;o<512;o++)t[o]=t[o-255]}(),Se.log=function(r){if(r<1)throw new Error("log("+r+")");return n[r]},Se.exp=function(r){return t[r]},Se.mul=function(r,o){return r===0||o===0?0:t[n[r]+n[o]]},Se}var Yr;function ha(){return Yr||(Yr=1,function(t){const n=fa();t.mul=function(r,o){const i=new Uint8Array(r.length+o.length-1);for(let a=0;a<r.length;a++)for(let s=0;s<o.length;s++)i[a+s]^=n.mul(r[a],o[s]);return i},t.mod=function(r,o){let i=new Uint8Array(r);for(;i.length-o.length>=0;){const a=i[0];for(let l=0;l<o.length;l++)i[l]^=n.mul(o[l],a);let s=0;for(;s<i.length&&i[s]===0;)s++;i=i.slice(s)}return i},t.generateECPolynomial=function(r){let o=new Uint8Array([1]);for(let i=0;i<r;i++)o=t.mul(o,new Uint8Array([1,n.exp(i)]));return o}}(Sn)),Sn}var Rn,$r;function ma(){if($r)return Rn;$r=1;const t=ha();function n(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}return n.prototype.initialize=function(r){this.degree=r,this.genPoly=t.generateECPolynomial(this.degree)},n.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(r.length+this.degree);o.set(r);const i=t.mod(o,this.genPoly),a=this.degree-i.length;if(a>0){const s=new Uint8Array(this.degree);return s.set(i,a),s}return i},Rn=n,Rn}var An={},Nn={},In={},Gr;function si(){return Gr||(Gr=1,In.isValid=function(n){return!isNaN(n)&&n>=1&&n<=40}),In}var Wt={},Vr;function ai(){if(Vr)return Wt;Vr=1;const t="[0-9]+",n="[A-Z $%*+\\-./:]+";let e="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";e=e.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+e+`)(?:.|[\r
]))+`;Wt.KANJI=new RegExp(e,"g"),Wt.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Wt.BYTE=new RegExp(r,"g"),Wt.NUMERIC=new RegExp(t,"g"),Wt.ALPHANUMERIC=new RegExp(n,"g");const o=new RegExp("^"+e+"$"),i=new RegExp("^"+t+"$"),a=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Wt.testKanji=function(l){return o.test(l)},Wt.testNumeric=function(l){return i.test(l)},Wt.testAlphanumeric=function(l){return a.test(l)},Wt}var Hr;function ce(){return Hr||(Hr=1,function(t){const n=si(),e=ai();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,a){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!n.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?i.ccBits[0]:a<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return e.testNumeric(i)?t.NUMERIC:e.testAlphanumeric(i)?t.ALPHANUMERIC:e.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function r(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+o)}}t.from=function(i,a){if(t.isValid(i))return i;try{return r(i)}catch{return a}}}(Nn)),Nn}var Zr;function pa(){return Zr||(Zr=1,function(t){const n=le(),e=ii(),r=ir(),o=ce(),i=si(),a=7973,s=n.getBCHDigit(a);function l(p,d,b){for(let u=1;u<=40;u++)if(d<=t.getCapacity(u,b,p))return u}function f(p,d){return o.getCharCountIndicator(p,d)+4}function c(p,d){let b=0;return p.forEach(function(u){const v=f(u.mode,d);b+=v+u.getBitsLength()}),b}function g(p,d){for(let b=1;b<=40;b++)if(c(p,b)<=t.getCapacity(b,d,o.MIXED))return b}t.from=function(d,b){return i.isValid(d)?parseInt(d,10):b},t.getCapacity=function(d,b,u){if(!i.isValid(d))throw new Error("Invalid QR Code version");typeof u>"u"&&(u=o.BYTE);const v=n.getSymbolTotalCodewords(d),y=e.getTotalCodewordsCount(d,b),w=(v-y)*8;if(u===o.MIXED)return w;const x=w-f(u,d);switch(u){case o.NUMERIC:return Math.floor(x/10*3);case o.ALPHANUMERIC:return Math.floor(x/11*2);case o.KANJI:return Math.floor(x/13);case o.BYTE:default:return Math.floor(x/8)}},t.getBestVersionForData=function(d,b){let u;const v=r.from(b,r.M);if(Array.isArray(d)){if(d.length>1)return g(d,v);if(d.length===0)return 1;u=d[0]}else u=d;return l(u.mode,u.getLength(),v)},t.getEncodedBits=function(d){if(!i.isValid(d)||d<7)throw new Error("Invalid QR Code version");let b=d<<12;for(;n.getBCHDigit(b)-s>=0;)b^=a<<n.getBCHDigit(b)-s;return d<<12|b}}(An)),An}var Tn={},Xr;function ga(){if(Xr)return Tn;Xr=1;const t=le(),n=1335,e=21522,r=t.getBCHDigit(n);return Tn.getEncodedBits=function(i,a){const s=i.bit<<3|a;let l=s<<10;for(;t.getBCHDigit(l)-r>=0;)l^=n<<t.getBCHDigit(l)-r;return(s<<10|l)^e},Tn}var Dn={},zn,Kr;function ba(){if(Kr)return zn;Kr=1;const t=ce();function n(e){this.mode=t.NUMERIC,this.data=e.toString()}return n.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let o,i,a;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),a=parseInt(i,10),r.put(a,10);const s=this.data.length-o;s>0&&(i=this.data.substr(o),a=parseInt(i,10),r.put(a,s*3+1))},zn=n,zn}var jn,Qr;function ya(){if(Qr)return jn;Qr=1;const t=ce(),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function e(r){this.mode=t.ALPHANUMERIC,this.data=r}return e.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(o){let i;for(i=0;i+2<=this.data.length;i+=2){let a=n.indexOf(this.data[i])*45;a+=n.indexOf(this.data[i+1]),o.put(a,11)}this.data.length%2&&o.put(n.indexOf(this.data[i]),6)},jn=e,jn}var Ln,Jr;function va(){if(Jr)return Ln;Jr=1;const t=ce();function n(e){this.mode=t.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}return n.getBitsLength=function(r){return r*8},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(e){for(let r=0,o=this.data.length;r<o;r++)e.put(this.data[r],8)},Ln=n,Ln}var Mn,to;function wa(){if(to)return Mn;to=1;const t=ce(),n=le();function e(r){this.mode=t.KANJI,this.data=r}return e.getBitsLength=function(o){return o*13},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(r){let o;for(o=0;o<this.data.length;o++){let i=n.toSJIS(this.data[o]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),r.put(i,13)}},Mn=e,Mn}var Bn={exports:{}},eo;function xa(){return eo||(eo=1,function(t){var n={single_source_shortest_paths:function(e,r,o){var i={},a={};a[r]=0;var s=n.PriorityQueue.make();s.push(r,0);for(var l,f,c,g,p,d,b,u,v;!s.empty();){l=s.pop(),f=l.value,g=l.cost,p=e[f]||{};for(c in p)p.hasOwnProperty(c)&&(d=p[c],b=g+d,u=a[c],v=typeof a[c]>"u",(v||u>b)&&(a[c]=b,s.push(c,b),i[c]=f))}if(typeof o<"u"&&typeof a[o]>"u"){var y=["Could not find a path from ",r," to ",o,"."].join("");throw new Error(y)}return i},extract_shortest_path_from_predecessor_list:function(e,r){for(var o=[],i=r;i;)o.push(i),e[i],i=e[i];return o.reverse(),o},find_path:function(e,r,o){var i=n.single_source_shortest_paths(e,r,o);return n.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(e){var r=n.PriorityQueue,o={},i;e=e||{};for(i in r)r.hasOwnProperty(i)&&(o[i]=r[i]);return o.queue=[],o.sorter=e.sorter||r.default_sorter,o},default_sorter:function(e,r){return e.cost-r.cost},push:function(e,r){var o={value:e,cost:r};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=n}(Bn)),Bn.exports}var no;function _a(){return no||(no=1,function(t){const n=ce(),e=ba(),r=ya(),o=va(),i=wa(),a=ai(),s=le(),l=xa();function f(y){return unescape(encodeURIComponent(y)).length}function c(y,w,x){const _=[];let R;for(;(R=y.exec(x))!==null;)_.push({data:R[0],index:R.index,mode:w,length:R[0].length});return _}function g(y){const w=c(a.NUMERIC,n.NUMERIC,y),x=c(a.ALPHANUMERIC,n.ALPHANUMERIC,y);let _,R;return s.isKanjiModeEnabled()?(_=c(a.BYTE,n.BYTE,y),R=c(a.KANJI,n.KANJI,y)):(_=c(a.BYTE_KANJI,n.BYTE,y),R=[]),w.concat(x,_,R).sort(function(I,z){return I.index-z.index}).map(function(I){return{data:I.data,mode:I.mode,length:I.length}})}function p(y,w){switch(w){case n.NUMERIC:return e.getBitsLength(y);case n.ALPHANUMERIC:return r.getBitsLength(y);case n.KANJI:return i.getBitsLength(y);case n.BYTE:return o.getBitsLength(y)}}function d(y){return y.reduce(function(w,x){const _=w.length-1>=0?w[w.length-1]:null;return _&&_.mode===x.mode?(w[w.length-1].data+=x.data,w):(w.push(x),w)},[])}function b(y){const w=[];for(let x=0;x<y.length;x++){const _=y[x];switch(_.mode){case n.NUMERIC:w.push([_,{data:_.data,mode:n.ALPHANUMERIC,length:_.length},{data:_.data,mode:n.BYTE,length:_.length}]);break;case n.ALPHANUMERIC:w.push([_,{data:_.data,mode:n.BYTE,length:_.length}]);break;case n.KANJI:w.push([_,{data:_.data,mode:n.BYTE,length:f(_.data)}]);break;case n.BYTE:w.push([{data:_.data,mode:n.BYTE,length:f(_.data)}])}}return w}function u(y,w){const x={},_={start:{}};let R=["start"];for(let N=0;N<y.length;N++){const I=y[N],z=[];for(let T=0;T<I.length;T++){const O=I[T],q=""+N+T;z.push(q),x[q]={node:O,lastCount:0},_[q]={};for(let S=0;S<R.length;S++){const k=R[S];x[k]&&x[k].node.mode===O.mode?(_[k][q]=p(x[k].lastCount+O.length,O.mode)-p(x[k].lastCount,O.mode),x[k].lastCount+=O.length):(x[k]&&(x[k].lastCount=O.length),_[k][q]=p(O.length,O.mode)+4+n.getCharCountIndicator(O.mode,w))}}R=z}for(let N=0;N<R.length;N++)_[R[N]].end=0;return{map:_,table:x}}function v(y,w){let x;const _=n.getBestModeForData(y);if(x=n.from(w,_),x!==n.BYTE&&x.bit<_.bit)throw new Error('"'+y+'" cannot be encoded with mode '+n.toString(x)+`.
 Suggested mode is: `+n.toString(_));switch(x===n.KANJI&&!s.isKanjiModeEnabled()&&(x=n.BYTE),x){case n.NUMERIC:return new e(y);case n.ALPHANUMERIC:return new r(y);case n.KANJI:return new i(y);case n.BYTE:return new o(y)}}t.fromArray=function(w){return w.reduce(function(x,_){return typeof _=="string"?x.push(v(_,null)):_.data&&x.push(v(_.data,_.mode)),x},[])},t.fromString=function(w,x){const _=g(w,s.isKanjiModeEnabled()),R=b(_),N=u(R,x),I=l.find_path(N.map,"start","end"),z=[];for(let T=1;T<I.length-1;T++)z.push(N.table[I[T]].node);return t.fromArray(d(z))},t.rawSplit=function(w){return t.fromArray(g(w,s.isKanjiModeEnabled()))}}(Dn)),Dn}var ro;function ka(){if(ro)return vn;ro=1;const t=le(),n=ir(),e=aa(),r=la(),o=ca(),i=da(),a=ua(),s=ii(),l=ma(),f=pa(),c=ga(),g=ce(),p=_a();function d(N,I){const z=N.size,T=i.getPositions(I);for(let O=0;O<T.length;O++){const q=T[O][0],S=T[O][1];for(let k=-1;k<=7;k++)if(!(q+k<=-1||z<=q+k))for(let m=-1;m<=7;m++)S+m<=-1||z<=S+m||(k>=0&&k<=6&&(m===0||m===6)||m>=0&&m<=6&&(k===0||k===6)||k>=2&&k<=4&&m>=2&&m<=4?N.set(q+k,S+m,!0,!0):N.set(q+k,S+m,!1,!0))}}function b(N){const I=N.size;for(let z=8;z<I-8;z++){const T=z%2===0;N.set(z,6,T,!0),N.set(6,z,T,!0)}}function u(N,I){const z=o.getPositions(I);for(let T=0;T<z.length;T++){const O=z[T][0],q=z[T][1];for(let S=-2;S<=2;S++)for(let k=-2;k<=2;k++)S===-2||S===2||k===-2||k===2||S===0&&k===0?N.set(O+S,q+k,!0,!0):N.set(O+S,q+k,!1,!0)}}function v(N,I){const z=N.size,T=f.getEncodedBits(I);let O,q,S;for(let k=0;k<18;k++)O=Math.floor(k/3),q=k%3+z-8-3,S=(T>>k&1)===1,N.set(O,q,S,!0),N.set(q,O,S,!0)}function y(N,I,z){const T=N.size,O=c.getEncodedBits(I,z);let q,S;for(q=0;q<15;q++)S=(O>>q&1)===1,q<6?N.set(q,8,S,!0):q<8?N.set(q+1,8,S,!0):N.set(T-15+q,8,S,!0),q<8?N.set(8,T-q-1,S,!0):q<9?N.set(8,15-q-1+1,S,!0):N.set(8,15-q-1,S,!0);N.set(T-8,8,1,!0)}function w(N,I){const z=N.size;let T=-1,O=z-1,q=7,S=0;for(let k=z-1;k>0;k-=2)for(k===6&&k--;;){for(let m=0;m<2;m++)if(!N.isReserved(O,k-m)){let W=!1;S<I.length&&(W=(I[S]>>>q&1)===1),N.set(O,k-m,W),q--,q===-1&&(S++,q=7)}if(O+=T,O<0||z<=O){O-=T,T=-T;break}}}function x(N,I,z){const T=new e;z.forEach(function(m){T.put(m.mode.bit,4),T.put(m.getLength(),g.getCharCountIndicator(m.mode,N)),m.write(T)});const O=t.getSymbolTotalCodewords(N),q=s.getTotalCodewordsCount(N,I),S=(O-q)*8;for(T.getLengthInBits()+4<=S&&T.put(0,4);T.getLengthInBits()%8!==0;)T.putBit(0);const k=(S-T.getLengthInBits())/8;for(let m=0;m<k;m++)T.put(m%2?17:236,8);return _(T,N,I)}function _(N,I,z){const T=t.getSymbolTotalCodewords(I),O=s.getTotalCodewordsCount(I,z),q=T-O,S=s.getBlocksCount(I,z),k=T%S,m=S-k,W=Math.floor(T/S),nt=Math.floor(q/S),G=nt+1,F=W-nt,B=new l(F);let j=0;const E=new Array(S),M=new Array(S);let Z=0;const V=new Uint8Array(N.buffer);for(let K=0;K<S;K++){const rt=K<m?nt:G;E[K]=V.slice(j,j+rt),M[K]=B.encode(E[K]),j+=rt,Z=Math.max(Z,rt)}const $=new Uint8Array(T);let lt=0,ot,tt;for(ot=0;ot<Z;ot++)for(tt=0;tt<S;tt++)ot<E[tt].length&&($[lt++]=E[tt][ot]);for(ot=0;ot<F;ot++)for(tt=0;tt<S;tt++)$[lt++]=M[tt][ot];return $}function R(N,I,z,T){let O;if(Array.isArray(N))O=p.fromArray(N);else if(typeof N=="string"){let W=I;if(!W){const nt=p.rawSplit(N);W=f.getBestVersionForData(nt,z)}O=p.fromString(N,W||40)}else throw new Error("Invalid data");const q=f.getBestVersionForData(O,z);if(!q)throw new Error("The amount of data is too big to be stored in a QR Code");if(!I)I=q;else if(I<q)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+q+`.
`);const S=x(I,z,O),k=t.getSymbolSize(I),m=new r(k);return d(m,I),b(m),u(m,I),y(m,z,0),I>=7&&v(m,I),w(m,S),isNaN(T)&&(T=a.getBestMask(m,y.bind(null,m,z))),a.applyMask(T,m),y(m,z,T),{modules:m,version:I,errorCorrectionLevel:z,maskPattern:T,segments:O}}return vn.create=function(I,z){if(typeof I>"u"||I==="")throw new Error("No input text");let T=n.M,O,q;return typeof z<"u"&&(T=n.from(z.errorCorrectionLevel,n.M),O=f.from(z.version),q=a.from(z.maskPattern),z.toSJISFunc&&t.setToSJISFunction(z.toSJISFunc)),R(I,O,T,q)},vn}var Pn={},On={},oo;function li(){return oo||(oo=1,function(t){function n(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let r=e.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+e);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(i){return[i,i]}))),r.length===6&&r.push("F","F");const o=parseInt(r.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+r.slice(0,6).join("")}}t.getOptions=function(r){r||(r={}),r.color||(r.color={});const o=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,i=r.width&&r.width>=21?r.width:void 0,a=r.scale||4;return{width:i,scale:i?4:a,margin:o,color:{dark:n(r.color.dark||"#000000ff"),light:n(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},t.getScale=function(r,o){return o.width&&o.width>=r+o.margin*2?o.width/(r+o.margin*2):o.scale},t.getImageWidth=function(r,o){const i=t.getScale(r,o);return Math.floor((r+o.margin*2)*i)},t.qrToImageData=function(r,o,i){const a=o.modules.size,s=o.modules.data,l=t.getScale(a,i),f=Math.floor((a+i.margin*2)*l),c=i.margin*l,g=[i.color.light,i.color.dark];for(let p=0;p<f;p++)for(let d=0;d<f;d++){let b=(p*f+d)*4,u=i.color.light;if(p>=c&&d>=c&&p<f-c&&d<f-c){const v=Math.floor((p-c)/l),y=Math.floor((d-c)/l);u=g[s[v*a+y]?1:0]}r[b++]=u.r,r[b++]=u.g,r[b++]=u.b,r[b]=u.a}}}(On)),On}var io;function Ca(){return io||(io=1,function(t){const n=li();function e(o,i,a){o.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=a,i.width=a,i.style.height=a+"px",i.style.width=a+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,a,s){let l=s,f=a;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),a||(f=r()),l=n.getOptions(l);const c=n.getImageWidth(i.modules.size,l),g=f.getContext("2d"),p=g.createImageData(c,c);return n.qrToImageData(p.data,i,l),e(g,f,c),g.putImageData(p,0,0),f},t.renderToDataURL=function(i,a,s){let l=s;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),l||(l={});const f=t.render(i,a,l),c=l.type||"image/png",g=l.rendererOpts||{};return f.toDataURL(c,g.quality)}}(Pn)),Pn}var Fn={},so;function Ea(){if(so)return Fn;so=1;const t=li();function n(o,i){const a=o.a/255,s=i+'="'+o.hex+'"';return a<1?s+" "+i+'-opacity="'+a.toFixed(2).slice(1)+'"':s}function e(o,i,a){let s=o+i;return typeof a<"u"&&(s+=" "+a),s}function r(o,i,a){let s="",l=0,f=!1,c=0;for(let g=0;g<o.length;g++){const p=Math.floor(g%i),d=Math.floor(g/i);!p&&!f&&(f=!0),o[g]?(c++,g>0&&p>0&&o[g-1]||(s+=f?e("M",p+a,.5+d+a):e("m",l,0),l=0,f=!1),p+1<i&&o[g+1]||(s+=e("h",c),c=0)):l++}return s}return Fn.render=function(i,a,s){const l=t.getOptions(a),f=i.modules.size,c=i.modules.data,g=f+l.margin*2,p=l.color.light.a?"<path "+n(l.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",d="<path "+n(l.color.dark,"stroke")+' d="'+r(c,f,l.margin)+'"/>',b='viewBox="0 0 '+g+" "+g+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+b+' shape-rendering="crispEdges">'+p+d+`</svg>
`;return typeof s=="function"&&s(null,v),v},Fn}var ao;function Sa(){if(ao)return he;ao=1;const t=sa(),n=ka(),e=Ca(),r=Ea();function o(i,a,s,l,f){const c=[].slice.call(arguments,1),g=c.length,p=typeof c[g-1]=="function";if(!p&&!t())throw new Error("Callback required as last argument");if(p){if(g<2)throw new Error("Too few arguments provided");g===2?(f=s,s=a,a=l=void 0):g===3&&(a.getContext&&typeof f>"u"?(f=l,l=void 0):(f=l,l=s,s=a,a=void 0))}else{if(g<1)throw new Error("Too few arguments provided");return g===1?(s=a,a=l=void 0):g===2&&!a.getContext&&(l=s,s=a,a=void 0),new Promise(function(d,b){try{const u=n.create(s,l);d(i(u,a,l))}catch(u){b(u)}})}try{const d=n.create(s,l);f(null,i(d,a,l))}catch(d){f(d)}}return he.create=n.create,he.toCanvas=o.bind(null,e.render),he.toDataURL=o.bind(null,e.renderToDataURL),he.toString=o.bind(null,function(i,a,s){return r.render(i,s)}),he}var Ra=Sa();const Aa=Co(Ra);async function De(t,n=512,e=1){const r={errorCorrectionLevel:"M",type:"image/png",margin:e,width:n,color:{dark:"#000000",light:"#ffffff"}};return Aa.toDataURL(t,r)}const tn=(()=>{const t=yt.get().DEFAULTS?.BACKGROUND;return{color:typeof t?.color=="string"?t.color:"#ffffff",alpha:Math.max(0,Math.min(1,typeof t?.alpha=="number"?t.alpha:1))}})(),ae={scale:1,tx:0,ty:0},Un=(t,n,e)=>Math.max(n,Math.min(e,t)),Vt=(t,n)=>typeof t=="number"?t:n;function Na(t){return new Promise((n,e)=>{const r=new Image;r.onload=()=>n({w:r.naturalWidth,h:r.naturalHeight}),r.onerror=e,r.src=t})}function Ia(t,n,e,r,o,i,a=1){const s=e/t,l=e/n,f=Math.min(s,l)*a,c=t*f,g=n*f,p=o==="left"?0:o==="right"?e-c:(e-c)/2,d=i==="top"?0:i==="bottom"?e-g:(e-g)/2,b=(p-(e-c)/2)/e*100,u=(d-(e-g)/2)/e*100;return{tx:Math.max(-100,Math.min(100,b)),ty:Math.max(-100,Math.min(100,u))}}const bt=Eo((t,n)=>({photos:[],max:ri,fitModeByPhoto:{},setFitMode:(e,r)=>t(o=>({fitModeByPhoto:{...o.fitModeByPhoto,[e]:r}})),transforms:{},layersByPhoto:{},cardBackground:{},setCardBackground:(e,r)=>t(o=>{const i=o.cardBackground[e]??tn,a={color:r.color??i.color,alpha:Math.max(0,Math.min(1,r.alpha??i.alpha))};return{cardBackground:{...o.cardBackground,[e]:a}}}),setTransform:(e,r)=>t(o=>{const i=o.transforms[e]??ae,a={scale:Un(r.scale??i.scale,.5,4),...r.scaleAbs!=null?{scaleAbs:Math.max(1e-4,r.scaleAbs)}:i.scaleAbs!=null?{scaleAbs:i.scaleAbs}:{},tx:Un(r.tx??i.tx,-100,100),ty:Un(r.ty??i.ty,-100,100)};return{transforms:{...o.transforms,[e]:a}}}),resetTransform:e=>t(r=>{const{[e]:o,...i}=r.transforms;return{transforms:i}}),add:(e,r)=>{if(!e?.length)return;const{photos:o,max:i}=n(),a=Math.max(0,i-o.length);if(a<=0){alert(`Достигнут лимит коллекции: ${i} карточек.`);return}let s=e;if(e.length>a&&(alert(`Можно добавить только ${a} из ${e.length} — лимит коллекции ${i}.`),s=e.slice(0,a)),t({photos:[...o,...s]}),r?.skipInit)return;r?.skipInit||t(f=>{const c={...f.fitModeByPhoto};for(const g of s)c[g.id]==null&&(c[g.id]=zr);return{fitModeByPhoto:c}});const l=yt.get().DEFAULT_CARD_LAYERS??[];if(l.length){for(const f of s)for(const c of l)if(c?.type==="text"){const g=Vt(c.y,It-140);n().addTextLayer(f.id,{x:typeof c.x=="number"?c.x:40,y:g,text:typeof c.text=="string"?c.text:void 0,fontFamily:typeof c.fontFamily=="string"?c.fontFamily:void 0,fontSize:typeof c.fontSize=="number"?c.fontSize:void 0,fontStyle:typeof c.fontStyle=="string"?c.fontStyle:void 0,fill:typeof c.fill=="string"?c.fill:void 0,align:["left","center","right"].includes(c.align)?c.align:void 0,lineHeight:typeof c.lineHeight=="number"?c.lineHeight:void 0,letterSpacing:typeof c.letterSpacing=="number"?c.letterSpacing:void 0,width:typeof c.width=="number"?c.width:void 0,rotation:typeof c.rotation=="number"?c.rotation:void 0,name:typeof c.name=="string"?c.name:void 0})}else if(c?.type==="rect"){const g=Vt(c.y,40);n().addRectLayer(f.id,{x:typeof c.x=="number"?c.x:40,y:g,width:typeof c.width=="number"?c.width:void 0,height:typeof c.height=="number"?c.height:void 0,fill:typeof c.fill=="string"?c.fill:void 0,stroke:typeof c.stroke=="string"?c.stroke:void 0,strokeWidth:typeof c.strokeWidth=="number"?c.strokeWidth:void 0,cornerRadius:typeof c.cornerRadius=="number"?c.cornerRadius:void 0,opacity:typeof c.opacity=="number"?c.opacity:void 0,rotation:typeof c.rotation=="number"?c.rotation:void 0,name:typeof c.name=="string"?c.name:void 0})}else if(c?.type==="qr"){const g=Vt(c.y,40),p=Math.max(1,Math.round(typeof c.size=="number"?c.size:512));(async()=>{const d=await n().addQrLayer(f.id,typeof c.text=="string"?c.text:"",p);n().updateLayer(f.id,d,{x:typeof c.x=="number"?c.x:40,y:g,name:typeof c.name=="string"?c.name:void 0})})()}}for(const f of s)(async()=>{try{const{w:c,h:g}=await Na(f.url),p=yt.get(),d=Math.max(0,Number(p.NEAR_SQUARE_TOLERANCE??0)),b=Number(p.NEAR_SQUARE_SCALE??1),u=It,v=u/c,y=u/g,w=Math.min(v,y),x=Math.max(v,y),_=zr==="contain",R=c/g,N=Math.abs(R-1)<=d;let I=1;_?I=N?b:1:I=x/w;const{tx:z,ty:T}=Ia(c,g,u,"contain",oa,ia,I);n().setTransform(f.id,{tx:z,ty:T,scale:Math.max(.5,Math.min(4,ae.scale*I))});const O=yt.get().LAYER_PROFILES?.orientation;if(O&&O.on!==!1){let q;R>1+d?q="landscape":R<1-d?q="portrait":q="square";const S=q==="landscape"?O.landscape??[]:q==="portrait"?O.portrait??[]:O.square??[];for(const k of S)if(!(!k||typeof k!="object")){if(k.type==="text"){const m=Vt(k.y,It-140);n().addTextLayer(f.id,{x:typeof k.x=="number"?k.x:40,y:m,text:typeof k.text=="string"?k.text:void 0,fontFamily:typeof k.fontFamily=="string"?k.fontFamily:void 0,fontSize:typeof k.fontSize=="number"?k.fontSize:void 0,fontStyle:typeof k.fontStyle=="string"?k.fontStyle:void 0,fill:typeof k.fill=="string"?k.fill:void 0,align:["left","center","right"].includes(k.align)?k.align:void 0,lineHeight:typeof k.lineHeight=="number"?k.lineHeight:void 0,letterSpacing:typeof k.letterSpacing=="number"?k.letterSpacing:void 0,width:typeof k.width=="number"?k.width:void 0,rotation:typeof k.rotation=="number"?k.rotation:void 0,name:typeof k.name=="string"?k.name:void 0})}else if(k.type==="rect"){const m=Vt(k.y,40);n().addRectLayer(f.id,{x:typeof k.x=="number"?k.x:40,y:m,width:typeof k.width=="number"?k.width:void 0,height:typeof k.height=="number"?k.height:void 0,fill:typeof k.fill=="string"?k.fill:void 0,stroke:typeof k.stroke=="string"?k.stroke:void 0,strokeWidth:typeof k.strokeWidth=="number"?k.strokeWidth:void 0,cornerRadius:typeof k.cornerRadius=="number"?k.cornerRadius:void 0,opacity:typeof k.opacity=="number"?k.opacity:void 0,rotation:typeof k.rotation=="number"?k.rotation:void 0,name:typeof k.name=="string"?k.name:void 0})}else if(k.type==="qr"){const m=Vt(k.y,40),W=Math.max(1,Math.round(typeof k.size=="number"?k.size:512)),nt=await n().addQrLayer(f.id,typeof k.text=="string"?k.text:"",W);n().updateLayer(f.id,nt,{x:typeof k.x=="number"?k.x:40,y:m,rotation:typeof k.rotation=="number"?k.rotation:void 0,name:typeof k.name=="string"?k.name:void 0})}}}}catch{}})()},clear:()=>{const e=n().photos;e.length&&Tr(e),t({photos:[],transforms:{},layersByPhoto:{},cardBackground:{},fitModeByPhoto:{}})},remove:e=>t(r=>{const o=r.photos.findIndex(f=>f.id===e);if(o===-1)return null;Tr([r.photos[o]]);const{[e]:i,...a}=r.transforms,s={...r.layersByPhoto};delete s[e];const l={...r.fitModeByPhoto};return delete l[e],{photos:r.photos.filter(f=>f.id!==e),transforms:a,layersByPhoto:s,fitModeByPhoto:l}}),addTextLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(b=>b.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const f=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=yt.get().DEFAULTS?.TEXT??{},g=Vt(c.y,It-140),p=f??g,d={id:o,type:"text",x:typeof c.x=="number"?c.x:40,y:p,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,text:typeof c.text=="string"?c.text:"New text",fontFamily:typeof c.fontFamily=="string"?c.fontFamily:"Georgia, serif",fontSize:typeof c.fontSize=="number"?c.fontSize:36,fontStyle:typeof c.fontStyle=="string"?c.fontStyle:"",fill:typeof c.fill=="string"?c.fill:"#111",align:["left","center","right"].includes(c.align)?c.align:"left",verticalAlign:["top","middle","bottom"].includes(c.verticalAlign)?c.verticalAlign:"top",padding:typeof c.padding=="number"?c.padding:0,lineHeight:typeof c.lineHeight=="number"?c.lineHeight:1.25,letterSpacing:typeof c.letterSpacing=="number"?c.letterSpacing:0,width:typeof c.width=="number"?c.width:void 0,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,d]}}}),o},addRectLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(b=>b.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const f=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=yt.get().DEFAULTS?.RECT??{},g=Vt(c.y,40),p=f??g,d={id:o,type:"rect",x:typeof c.x=="number"?c.x:40,y:p,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,width:typeof c.width=="number"?c.width:600,height:typeof c.height=="number"?c.height:300,fill:typeof c.fill=="string"?c.fill:"#ffffff",stroke:typeof c.stroke=="string"?c.stroke:void 0,strokeWidth:typeof c.strokeWidth=="number"?c.strokeWidth:0,cornerRadius:typeof c.cornerRadius=="number"?c.cornerRadius:0,opacity:typeof c.opacity=="number"?c.opacity:1,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,d]}}}),o},addImageLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(b=>b.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const f=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=yt.get().DEFAULTS?.IMAGE??{},g=Vt(c.y,40),p=f??g,d={id:o,type:"image",x:typeof c.x=="number"?c.x:40,y:p,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,src:"",w:typeof c.w=="number"?c.w:void 0,h:typeof c.h=="number"?c.h:void 0,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,d]}}}),o},addQrLayer:async(e,r,o=512)=>{const i=yt.get().DEFAULTS?.QR??{},a=Math.max(1,Math.round(typeof o=="number"?o:i.size??512)),s=await De(r,a,1);return n().addImageLayer(e,{src:s,x:typeof i.x=="number"?i.x:40,y:typeof i.y=="number"?i.y:40,w:a,h:a,qrText:r})},updateQrLayer:async(e,r,o)=>{const a=n().layersByPhoto[e]??[],s=a.findIndex(p=>p.id===r&&p.type==="image");if(s===-1)return;const l=a[s];if(!l.qrText&&!o.text)return;const f=o.text??l.qrText??"",c=Math.max(1,Math.round(o.size??l.w??l.h??512)),g=await De(f,c,1);n().updateLayer(e,r,{src:g,w:c,h:c,...f?{qrText:f}:{}})},updateLayer:(e,r,o)=>t(i=>{const a=i.layersByPhoto[e]??[],s=a.findIndex(p=>p.id===r);if(s===-1)return null;const l=a[s],f={...o};delete f.id,delete f.type;const c={...l,...f},g=[...a];return g[s]=c,{layersByPhoto:{...i.layersByPhoto,[e]:g}}}),removeLayer:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[],a=i.filter(s=>s.id!==r);return a===i?null:{layersByPhoto:{...o.layersByPhoto,[e]:a}}}),bringToFront:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=Math.max(...i.map(l=>l.z)),s=i.map(l=>l.id===r?{...l,z:a+1}:l);return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),sendToBack:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=Math.min(...i.map(l=>l.z)),s=i.map(l=>l.id===r?{...l,z:a-1}:l);return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),setLayersOrder:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=new Map(i.map(f=>[f.id,f])),s=[];let l=1;for(const f of r){const c=a.get(f);c&&s.push({...c,z:l++})}for(const f of i)r.includes(f.id)||s.push({...f,z:l++});return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),reorderPhotos:e=>t(r=>{if(!Array.isArray(e)||!e.length)return null;const o=new Map(r.photos.map(a=>[a.id,a])),i=e.map(a=>o.get(a)).filter(Boolean);for(const a of r.photos)e.includes(a.id)||i.push(a);return{photos:i}})}));function Ta(t){const n=t.replace(/^\uFEFF/,"").replace(/\r\n?/g,`
`).split(`
`).filter(Boolean);if(!n.length)return{rows:[],hasRelative:!1};const e=n[0].toLowerCase(),r=e.includes(";")&&!e.includes(",")?";":",",o=new RegExp(`\\s*(?:"([^"]*)"|([^${r}\\n]*))\\s*(?:${r}|$)`,"g");function i(f){const c=f.toLowerCase();switch(c){case"fontsize":return"fontSize";case"fontstyle":return"fontStyle";case"lineheight":return"lineHeight";case"letterspacing":return"letterSpacing";default:return c}}let a=null;{const f=n[0].toLowerCase();if(/\burl\b/.test(f)){o.lastIndex=0;const c=[];let g;for(;g=o.exec(n[0]);){const p=g[1]??g[2]??"",d=(g[1]?p.replace(/""/g,'"'):p).trim();if(d&&c.push(d),g.index+g[0].length>=n[0].length)break}c.map(p=>p.toLowerCase()).includes("url")&&(a=c)}}const s=[];for(let f=0;f<n.length;f++){const c=n[f];if(!c.trim()||f===0&&a)continue;const g=[];o.lastIndex=0;let p,d=0;for(;(p=o.exec(c))&&d++<1e3;){const w=p[1]??p[2]??"",x=(p[1]?w.replace(/""/g,'"'):w).trim();if(g.push(x),p.index+p[0].length>=c.length)break}if(!g.length)continue;if(!a){const w=(g[0]??"").trim();if(!w)continue;const x=(g[1]??"").trim()||void 0;s.push({url:w,caption:x});continue}const b={};a.forEach((w,x)=>b[w.trim().toLowerCase()]=g[x]??"");const u=(b.url??"").trim();if(!u)continue;const v=(b.caption??"").trim()||void 0,y={};for(const[w,x]of Object.entries(b)){const _=x?.trim(),R=/^layer_([^_]+)_(.+)$/i.exec(w.trim());if(R&&_){const N=`layer_${R[1]}`.toLowerCase(),I=i(R[2]);y[N]||(y[N]={}),y[N][I]=_}}s.push({url:u,caption:v,layers:Object.keys(y).length?y:void 0})}const l=s.some(f=>Da(f.url));return{rows:s,hasRelative:l}}function ci(t){return/^https?:\/\//i.test(t)}function di(t){return/^data:/i.test(t)}function Da(t){return!(ci(t)||di(t)||/^blob:/.test(t))}function He(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wn={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var lo;function za(){return lo||(lo=1,function(t,n){(function(e){t.exports=e()})(function(){return function e(r,o,i){function a(f,c){if(!o[f]){if(!r[f]){var g=typeof He=="function"&&He;if(!c&&g)return g(f,!0);if(s)return s(f,!0);var p=new Error("Cannot find module '"+f+"'");throw p.code="MODULE_NOT_FOUND",p}var d=o[f]={exports:{}};r[f][0].call(d.exports,function(b){var u=r[f][1][b];return a(u||b)},d,d.exports,e,r,o,i)}return o[f].exports}for(var s=typeof He=="function"&&He,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(e,r,o){var i=e("./utils"),a=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(l){for(var f,c,g,p,d,b,u,v=[],y=0,w=l.length,x=w,_=i.getTypeOf(l)!=="string";y<l.length;)x=w-y,g=_?(f=l[y++],c=y<w?l[y++]:0,y<w?l[y++]:0):(f=l.charCodeAt(y++),c=y<w?l.charCodeAt(y++):0,y<w?l.charCodeAt(y++):0),p=f>>2,d=(3&f)<<4|c>>4,b=1<x?(15&c)<<2|g>>6:64,u=2<x?63&g:64,v.push(s.charAt(p)+s.charAt(d)+s.charAt(b)+s.charAt(u));return v.join("")},o.decode=function(l){var f,c,g,p,d,b,u=0,v=0,y="data:";if(l.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var w,x=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&x--,l.charAt(l.length-2)===s.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=a.uint8array?new Uint8Array(0|x):new Array(0|x);u<l.length;)f=s.indexOf(l.charAt(u++))<<2|(p=s.indexOf(l.charAt(u++)))>>4,c=(15&p)<<4|(d=s.indexOf(l.charAt(u++)))>>2,g=(3&d)<<6|(b=s.indexOf(l.charAt(u++))),w[v++]=f,d!==64&&(w[v++]=c),b!==64&&(w[v++]=g);return w}},{"./support":30,"./utils":32}],2:[function(e,r,o){var i=e("./external"),a=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function f(c,g,p,d,b){this.compressedSize=c,this.uncompressedSize=g,this.crc32=p,this.compression=d,this.compressedContent=b}f.prototype={getContentWorker:function(){var c=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),g=this;return c.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(c,g,p){return c.pipe(new s).pipe(new l("uncompressedSize")).pipe(g.compressWorker(p)).pipe(new l("compressedSize")).withStreamInfo("compression",g)},r.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,o){var i=e("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},o.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,o){var i=e("./utils"),a=function(){for(var s,l=[],f=0;f<256;f++){s=f;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;l[f]=s}return l}();r.exports=function(s,l){return s!==void 0&&s.length?i.getTypeOf(s)!=="string"?function(f,c,g,p){var d=a,b=p+g;f^=-1;for(var u=p;u<b;u++)f=f>>>8^d[255&(f^c[u])];return-1^f}(0|l,s,s.length,0):function(f,c,g,p){var d=a,b=p+g;f^=-1;for(var u=p;u<b;u++)f=f>>>8^d[255&(f^c.charCodeAt(u))];return-1^f}(0|l,s,s.length,0):0}},{"./utils":32}],5:[function(e,r,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(e,r,o){var i=null;i=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:i}},{lie:37}],7:[function(e,r,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=e("pako"),s=e("./utils"),l=e("./stream/GenericWorker"),f=i?"uint8array":"array";function c(g,p){l.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=p,this.meta={}}o.magic="\b\0",s.inherits(c,l),c.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(f,g.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(p){g.push({data:p,meta:g.meta})}},o.compressWorker=function(g){return new c("Deflate",g)},o.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,o){function i(d,b){var u,v="";for(u=0;u<b;u++)v+=String.fromCharCode(255&d),d>>>=8;return v}function a(d,b,u,v,y,w){var x,_,R=d.file,N=d.compression,I=w!==f.utf8encode,z=s.transformTo("string",w(R.name)),T=s.transformTo("string",f.utf8encode(R.name)),O=R.comment,q=s.transformTo("string",w(O)),S=s.transformTo("string",f.utf8encode(O)),k=T.length!==R.name.length,m=S.length!==O.length,W="",nt="",G="",F=R.dir,B=R.date,j={crc32:0,compressedSize:0,uncompressedSize:0};b&&!u||(j.crc32=d.crc32,j.compressedSize=d.compressedSize,j.uncompressedSize=d.uncompressedSize);var E=0;b&&(E|=8),I||!k&&!m||(E|=2048);var M=0,Z=0;F&&(M|=16),y==="UNIX"?(Z=798,M|=function($,lt){var ot=$;return $||(ot=lt?16893:33204),(65535&ot)<<16}(R.unixPermissions,F)):(Z=20,M|=function($){return 63&($||0)}(R.dosPermissions)),x=B.getUTCHours(),x<<=6,x|=B.getUTCMinutes(),x<<=5,x|=B.getUTCSeconds()/2,_=B.getUTCFullYear()-1980,_<<=4,_|=B.getUTCMonth()+1,_<<=5,_|=B.getUTCDate(),k&&(nt=i(1,1)+i(c(z),4)+T,W+="up"+i(nt.length,2)+nt),m&&(G=i(1,1)+i(c(q),4)+S,W+="uc"+i(G.length,2)+G);var V="";return V+=`
\0`,V+=i(E,2),V+=N.magic,V+=i(x,2),V+=i(_,2),V+=i(j.crc32,4),V+=i(j.compressedSize,4),V+=i(j.uncompressedSize,4),V+=i(z.length,2),V+=i(W.length,2),{fileRecord:g.LOCAL_FILE_HEADER+V+z+W,dirRecord:g.CENTRAL_FILE_HEADER+i(Z,2)+V+i(q.length,2)+"\0\0\0\0"+i(M,4)+i(v,4)+z+W+q}}var s=e("../utils"),l=e("../stream/GenericWorker"),f=e("../utf8"),c=e("../crc32"),g=e("../signature");function p(d,b,u,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=u,this.encodeFileName=v,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(p,l),p.prototype.push=function(d){var b=d.meta.percent||0,u=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,l.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:u?(b+100*(u-v-1))/u:100}}))},p.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var b=this.streamFiles&&!d.file.dir;if(b){var u=a(d,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:u.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(d){this.accumulate=!1;var b=this.streamFiles&&!d.file.dir,u=a(d,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(u.dirRecord),b)this.push({data:function(v){return g.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:u.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var d=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var u=this.bytesWritten-d,v=function(y,w,x,_,R){var N=s.transformTo("string",R(_));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(y,2)+i(y,2)+i(w,4)+i(x,4)+i(N.length,2)+N}(this.dirRecords.length,u,d,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(d){this._sources.push(d);var b=this;return d.on("data",function(u){b.processChunk(u)}),d.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),d.on("error",function(u){b.error(u)}),this},p.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(d){var b=this._sources;if(!l.prototype.error.call(this,d))return!1;for(var u=0;u<b.length;u++)try{b[u].error(d)}catch{}return!0},p.prototype.lock=function(){l.prototype.lock.call(this);for(var d=this._sources,b=0;b<d.length;b++)d[b].lock()},r.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,o){var i=e("../compressions"),a=e("./ZipFileWorker");o.generateWorker=function(s,l,f){var c=new a(l.streamFiles,f,l.platform,l.encodeFileName),g=0;try{s.forEach(function(p,d){g++;var b=function(w,x){var _=w||x,R=i[_];if(!R)throw new Error(_+" is not a valid compression method !");return R}(d.options.compression,l.compression),u=d.options.compressionOptions||l.compressionOptions||{},v=d.dir,y=d.date;d._compressWorker(b,u).withStreamInfo("file",{name:p,dir:v,date:y,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(c)}),c.entriesCount=g}catch(p){c.error(p)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,o){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var s in this)typeof this[s]!="function"&&(a[s]=this[s]);return a}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(a,s){return new i().loadAsync(a,s)},i.external=e("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,o){var i=e("./utils"),a=e("./external"),s=e("./utf8"),l=e("./zipEntries"),f=e("./stream/Crc32Probe"),c=e("./nodejsUtils");function g(p){return new a.Promise(function(d,b){var u=p.decompressed.getContentWorker().pipe(new f);u.on("error",function(v){b(v)}).on("end",function(){u.streamInfo.crc32!==p.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}r.exports=function(p,d){var b=this;return d=i.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),c.isNode&&c.isStream(p)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",p,!0,d.optimizedBinaryString,d.base64).then(function(u){var v=new l(d);return v.load(u),v}).then(function(u){var v=[a.Promise.resolve(u)],y=u.files;if(d.checkCRC32)for(var w=0;w<y.length;w++)v.push(g(y[w]));return a.Promise.all(v)}).then(function(u){for(var v=u.shift(),y=v.files,w=0;w<y.length;w++){var x=y[w],_=x.fileNameStr,R=i.resolve(x.fileNameStr);b.file(R,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:d.createFolders}),x.dir||(b.file(R).unsafeOriginalName=_)}return v.zipComment.length&&(b.comment=v.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,o){var i=e("../utils"),a=e("../stream/GenericWorker");function s(l,f){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(f)}i.inherits(s,a),s.prototype._bindStream=function(l){var f=this;(this._stream=l).pause(),l.on("data",function(c){f.push({data:c,meta:{percent:0}})}).on("error",function(c){f.isPaused?this.generatedError=c:f.error(c)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,o){var i=e("readable-stream").Readable;function a(s,l,f){i.call(this,l),this._helper=s;var c=this;s.on("data",function(g,p){c.push(g)||c._helper.pause(),f&&f(p)}).on("error",function(g){c.emit("error",g)}).on("end",function(){c.push(null)})}e("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,r,o){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,a)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var a=new Buffer(i);return a.fill(0),a},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(e,r,o){function i(R,N,I){var z,T=s.getTypeOf(N),O=s.extend(I||{},c);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(R=y(R)),O.createFolders&&(z=v(R))&&w.call(this,z,!0);var q=T==="string"&&O.binary===!1&&O.base64===!1;I&&I.binary!==void 0||(O.binary=!q),(N instanceof g&&N.uncompressedSize===0||O.dir||!N||N.length===0)&&(O.base64=!1,O.binary=!0,N="",O.compression="STORE",T="string");var S=null;S=N instanceof g||N instanceof l?N:b.isNode&&b.isStream(N)?new u(R,N):s.prepareContent(R,N,O.binary,O.optimizedBinaryString,O.base64);var k=new p(R,S,O);this.files[R]=k}var a=e("./utf8"),s=e("./utils"),l=e("./stream/GenericWorker"),f=e("./stream/StreamHelper"),c=e("./defaults"),g=e("./compressedObject"),p=e("./zipObject"),d=e("./generate"),b=e("./nodejsUtils"),u=e("./nodejs/NodejsStreamInputAdapter"),v=function(R){R.slice(-1)==="/"&&(R=R.substring(0,R.length-1));var N=R.lastIndexOf("/");return 0<N?R.substring(0,N):""},y=function(R){return R.slice(-1)!=="/"&&(R+="/"),R},w=function(R,N){return N=N!==void 0?N:c.createFolders,R=y(R),this.files[R]||i.call(this,R,null,{dir:!0,createFolders:N}),this.files[R]};function x(R){return Object.prototype.toString.call(R)==="[object RegExp]"}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(R){var N,I,z;for(N in this.files)z=this.files[N],(I=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&R(I,z)},filter:function(R){var N=[];return this.forEach(function(I,z){R(I,z)&&N.push(z)}),N},file:function(R,N,I){if(arguments.length!==1)return R=this.root+R,i.call(this,R,N,I),this;if(x(R)){var z=R;return this.filter(function(O,q){return!q.dir&&z.test(O)})}var T=this.files[this.root+R];return T&&!T.dir?T:null},folder:function(R){if(!R)return this;if(x(R))return this.filter(function(T,O){return O.dir&&R.test(T)});var N=this.root+R,I=w.call(this,N),z=this.clone();return z.root=I.name,z},remove:function(R){R=this.root+R;var N=this.files[R];if(N||(R.slice(-1)!=="/"&&(R+="/"),N=this.files[R]),N&&!N.dir)delete this.files[R];else for(var I=this.filter(function(T,O){return O.name.slice(0,R.length)===R}),z=0;z<I.length;z++)delete this.files[I[z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(R){var N,I={};try{if((I=s.extend(R||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");s.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var z=I.comment||this.comment||"";N=d.generateWorker(this,I,z)}catch(T){(N=new l("error")).error(T)}return new f(N,I.type||"string",I.mimeType)},generateAsync:function(R,N){return this.generateInternalStream(R).accumulate(N)},generateNodeStream:function(R,N){return(R=R||{}).type||(R.type="nodebuffer"),this.generateInternalStream(R).toNodejsStream(N)}};r.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,o){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,o){var i=e("./DataReader");function a(s){i.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}e("../utils").inherits(a,i),a.prototype.byteAt=function(s){return this.data[this.zero+s]},a.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),f=s.charCodeAt(1),c=s.charCodeAt(2),g=s.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===l&&this.data[p+1]===f&&this.data[p+2]===c&&this.data[p+3]===g)return p-this.zero;return-1},a.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),f=s.charCodeAt(1),c=s.charCodeAt(2),g=s.charCodeAt(3),p=this.readData(4);return l===p[0]&&f===p[1]&&c===p[2]&&g===p[3]},a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,r,o){var i=e("../utils");function a(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var l,f=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)f=(f<<8)+this.byteAt(l);return this.index+=s,f},readString:function(s){return i.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},r.exports=a},{"../utils":32}],19:[function(e,r,o){var i=e("./Uint8ArrayReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,o){var i=e("./DataReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},a.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},a.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,r,o){var i=e("./ArrayReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,o){var i=e("../utils"),a=e("../support"),s=e("./ArrayReader"),l=e("./StringReader"),f=e("./NodeBufferReader"),c=e("./Uint8ArrayReader");r.exports=function(g){var p=i.getTypeOf(g);return i.checkSupport(p),p!=="string"||a.uint8array?p==="nodebuffer"?new f(g):a.uint8array?new c(i.transformTo("uint8array",g)):new s(i.transformTo("array",g)):new l(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,o){var i=e("./GenericWorker"),a=e("../utils");function s(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(s,i),s.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,o){var i=e("./GenericWorker"),a=e("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,i),s.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,o){var i=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(s,a),s.prototype.processChunk=function(l){if(l){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,o){var i=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){f.dataIsReady=!0,f.data=c,f.max=c&&c.length||0,f.type=i.getTypeOf(c),f.isPaused||f._tickAndRepeat()},function(c){f.error(c)})}i.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,f);break;case"uint8array":l=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":l=this.data.slice(this.index,f)}return this.index=f,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,o){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,s){return this._listeners[a].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,s){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,s)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var s=this;return a.on("data",function(l){s.processChunk(l)}),a.on("end",function(){s.end()}),a.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,s){return this.extraStreamInfo[a]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(e,r,o){var i=e("../utils"),a=e("./ConvertWorker"),s=e("./GenericWorker"),l=e("../base64"),f=e("../support"),c=e("../external"),g=null;if(f.nodestream)try{g=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(b,u){return new c.Promise(function(v,y){var w=[],x=b._internalType,_=b._outputType,R=b._mimeType;b.on("data",function(N,I){w.push(N),u&&u(I)}).on("error",function(N){w=[],y(N)}).on("end",function(){try{var N=function(I,z,T){switch(I){case"blob":return i.newBlob(i.transformTo("arraybuffer",z),T);case"base64":return l.encode(z);default:return i.transformTo(I,z)}}(_,function(I,z){var T,O=0,q=null,S=0;for(T=0;T<z.length;T++)S+=z[T].length;switch(I){case"string":return z.join("");case"array":return Array.prototype.concat.apply([],z);case"uint8array":for(q=new Uint8Array(S),T=0;T<z.length;T++)q.set(z[T],O),O+=z[T].length;return q;case"nodebuffer":return Buffer.concat(z);default:throw new Error("concat : unsupported type '"+I+"'")}}(x,w),R);v(N)}catch(I){y(I)}w=[]}).resume()})}function d(b,u,v){var y=u;switch(u){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=u,this._mimeType=v,i.checkSupport(y),this._worker=b.pipe(new a(y)),b.lock()}catch(w){this._worker=new s("error"),this._worker.error(w)}}d.prototype={accumulate:function(b){return p(this,b)},on:function(b,u){var v=this;return b==="data"?this._worker.on(b,function(y){u.call(v,y.data,y.meta)}):this._worker.on(b,function(){i.delay(u,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},b)}},r.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var i=new ArrayBuffer(0);try{o.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),o.blob=a.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!e("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,o){for(var i=e("./utils"),a=e("./support"),s=e("./nodejsUtils"),l=e("./stream/GenericWorker"),f=new Array(256),c=0;c<256;c++)f[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;f[254]=f[254]=1;function g(){l.call(this,"utf-8 decode"),this.leftOver=null}function p(){l.call(this,"utf-8 encode")}o.utf8encode=function(d){return a.nodebuffer?s.newBufferFrom(d,"utf-8"):function(b){var u,v,y,w,x,_=b.length,R=0;for(w=0;w<_;w++)(64512&(v=b.charCodeAt(w)))==55296&&w+1<_&&(64512&(y=b.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(y-56320),w++),R+=v<128?1:v<2048?2:v<65536?3:4;for(u=a.uint8array?new Uint8Array(R):new Array(R),w=x=0;x<R;w++)(64512&(v=b.charCodeAt(w)))==55296&&w+1<_&&(64512&(y=b.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(y-56320),w++),v<128?u[x++]=v:(v<2048?u[x++]=192|v>>>6:(v<65536?u[x++]=224|v>>>12:(u[x++]=240|v>>>18,u[x++]=128|v>>>12&63),u[x++]=128|v>>>6&63),u[x++]=128|63&v);return u}(d)},o.utf8decode=function(d){return a.nodebuffer?i.transformTo("nodebuffer",d).toString("utf-8"):function(b){var u,v,y,w,x=b.length,_=new Array(2*x);for(u=v=0;u<x;)if((y=b[u++])<128)_[v++]=y;else if(4<(w=f[y]))_[v++]=65533,u+=w-1;else{for(y&=w===2?31:w===3?15:7;1<w&&u<x;)y=y<<6|63&b[u++],w--;1<w?_[v++]=65533:y<65536?_[v++]=y:(y-=65536,_[v++]=55296|y>>10&1023,_[v++]=56320|1023&y)}return _.length!==v&&(_.subarray?_=_.subarray(0,v):_.length=v),i.applyFromCharCode(_)}(d=i.transformTo(a.uint8array?"uint8array":"array",d))},i.inherits(g,l),g.prototype.processChunk=function(d){var b=i.transformTo(a.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var u=b;(b=new Uint8Array(u.length+this.leftOver.length)).set(this.leftOver,0),b.set(u,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var v=function(w,x){var _;for((x=x||w.length)>w.length&&(x=w.length),_=x-1;0<=_&&(192&w[_])==128;)_--;return _<0||_===0?x:_+f[w[_]]>x?_:x}(b),y=b;v!==b.length&&(a.uint8array?(y=b.subarray(0,v),this.leftOver=b.subarray(v,b.length)):(y=b.slice(0,v),this.leftOver=b.slice(v,b.length))),this.push({data:o.utf8decode(y),meta:d.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=g,i.inherits(p,l),p.prototype.processChunk=function(d){this.push({data:o.utf8encode(d.data),meta:d.meta})},o.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,o){var i=e("./support"),a=e("./base64"),s=e("./nodejsUtils"),l=e("./external");function f(u){return u}function c(u,v){for(var y=0;y<u.length;++y)v[y]=255&u.charCodeAt(y);return v}e("setimmediate"),o.newBlob=function(u,v){o.checkSupport("blob");try{return new Blob([u],{type:v})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(u),y.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(u,v,y){var w=[],x=0,_=u.length;if(_<=y)return String.fromCharCode.apply(null,u);for(;x<_;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,u.slice(x,Math.min(x+y,_)))):w.push(String.fromCharCode.apply(null,u.subarray(x,Math.min(x+y,_)))),x+=y;return w.join("")},stringifyByChar:function(u){for(var v="",y=0;y<u.length;y++)v+=String.fromCharCode(u[y]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function p(u){var v=65536,y=o.getTypeOf(u),w=!0;if(y==="uint8array"?w=g.applyCanBeUsed.uint8array:y==="nodebuffer"&&(w=g.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return g.stringifyByChunk(u,y,v)}catch{v=Math.floor(v/2)}return g.stringifyByChar(u)}function d(u,v){for(var y=0;y<u.length;y++)v[y]=u[y];return v}o.applyFromCharCode=p;var b={};b.string={string:f,array:function(u){return c(u,new Array(u.length))},arraybuffer:function(u){return b.string.uint8array(u).buffer},uint8array:function(u){return c(u,new Uint8Array(u.length))},nodebuffer:function(u){return c(u,s.allocBuffer(u.length))}},b.array={string:p,array:f,arraybuffer:function(u){return new Uint8Array(u).buffer},uint8array:function(u){return new Uint8Array(u)},nodebuffer:function(u){return s.newBufferFrom(u)}},b.arraybuffer={string:function(u){return p(new Uint8Array(u))},array:function(u){return d(new Uint8Array(u),new Array(u.byteLength))},arraybuffer:f,uint8array:function(u){return new Uint8Array(u)},nodebuffer:function(u){return s.newBufferFrom(new Uint8Array(u))}},b.uint8array={string:p,array:function(u){return d(u,new Array(u.length))},arraybuffer:function(u){return u.buffer},uint8array:f,nodebuffer:function(u){return s.newBufferFrom(u)}},b.nodebuffer={string:p,array:function(u){return d(u,new Array(u.length))},arraybuffer:function(u){return b.nodebuffer.uint8array(u).buffer},uint8array:function(u){return d(u,new Uint8Array(u.length))},nodebuffer:f},o.transformTo=function(u,v){if(v=v||"",!u)return v;o.checkSupport(u);var y=o.getTypeOf(v);return b[y][u](v)},o.resolve=function(u){for(var v=u.split("/"),y=[],w=0;w<v.length;w++){var x=v[w];x==="."||x===""&&w!==0&&w!==v.length-1||(x===".."?y.pop():y.push(x))}return y.join("/")},o.getTypeOf=function(u){return typeof u=="string"?"string":Object.prototype.toString.call(u)==="[object Array]"?"array":i.nodebuffer&&s.isBuffer(u)?"nodebuffer":i.uint8array&&u instanceof Uint8Array?"uint8array":i.arraybuffer&&u instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(u){if(!i[u.toLowerCase()])throw new Error(u+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(u){var v,y,w="";for(y=0;y<(u||"").length;y++)w+="\\x"+((v=u.charCodeAt(y))<16?"0":"")+v.toString(16).toUpperCase();return w},o.delay=function(u,v,y){setImmediate(function(){u.apply(y||null,v||[])})},o.inherits=function(u,v){function y(){}y.prototype=v.prototype,u.prototype=new y},o.extend=function(){var u,v,y={};for(u=0;u<arguments.length;u++)for(v in arguments[u])Object.prototype.hasOwnProperty.call(arguments[u],v)&&y[v]===void 0&&(y[v]=arguments[u][v]);return y},o.prepareContent=function(u,v,y,w,x){return l.Promise.resolve(v).then(function(_){return i.blob&&(_ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(_))!==-1)&&typeof FileReader<"u"?new l.Promise(function(R,N){var I=new FileReader;I.onload=function(z){R(z.target.result)},I.onerror=function(z){N(z.target.error)},I.readAsArrayBuffer(_)}):_}).then(function(_){var R=o.getTypeOf(_);return R?(R==="arraybuffer"?_=o.transformTo("uint8array",_):R==="string"&&(x?_=a.decode(_):y&&w!==!0&&(_=function(N){return c(N,i.uint8array?new Uint8Array(N.length):new Array(N.length))}(_))),_):l.Promise.reject(new Error("Can't read the data of '"+u+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,o){var i=e("./reader/readerFor"),a=e("./utils"),s=e("./signature"),l=e("./zipEntry"),f=e("./support");function c(g){this.files=[],this.loadOptions=g}c.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(p)+", expected "+a.pretty(g)+")")}},isSignature:function(g,p){var d=this.reader.index;this.reader.setIndex(g);var b=this.reader.readString(4)===p;return this.reader.setIndex(d),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),p=f.uint8array?"uint8array":"array",d=a.transformTo(p,g);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,p,d,b=this.zip64EndOfCentralSize-44;0<b;)g=this.reader.readInt(2),p=this.reader.readInt(4),d=this.reader.readData(p),this.zip64ExtensibleData[g]={id:g,length:p,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,p;for(g=0;g<this.files.length;g++)p=this.files[g],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(g=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var p=g;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var b=p-d;if(0<b)this.isSignature(p,s.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(g){this.reader=i(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,o){var i=e("./reader/readerFor"),a=e("./utils"),s=e("./compressedObject"),l=e("./crc32"),f=e("./utf8"),c=e("./compressions"),g=e("./support");function p(d,b){this.options=d,this.loadOptions=b}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var b,u;if(d.skip(22),this.fileNameLength=d.readInt(2),u=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(u),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=function(v){for(var y in c)if(Object.prototype.hasOwnProperty.call(c,y)&&c[y].magic===v)return c[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,b,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var b=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(b),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var b,u,v,y=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<y;)b=d.readInt(2),u=d.readInt(2),v=d.readData(u),this.extraFields[b]={id:b,length:u,value:v};d.setIndex(y)},handleUTF8:function(){var d=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var u=a.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(u)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var y=a.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var b=i(d.value);return b.readInt(1)!==1||l(this.fileName)!==b.readInt(4)?null:f.utf8decode(b.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var b=i(d.value);return b.readInt(1)!==1||l(this.fileComment)!==b.readInt(4)?null:f.utf8decode(b.readData(d.length-5))}return null}},r.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,o){function i(b,u,v){this.name=b,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=u,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),l=e("./utf8"),f=e("./compressedObject"),c=e("./stream/GenericWorker");i.prototype={internalStream:function(b){var u=null,v="string";try{if(!b)throw new Error("No output type specified.");var y=(v=b.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),u=this._decompressWorker();var w=!this._dataBinary;w&&!y&&(u=u.pipe(new l.Utf8EncodeWorker)),!w&&y&&(u=u.pipe(new l.Utf8DecodeWorker))}catch(x){(u=new c("error")).error(x)}return new a(u,v,"")},async:function(b,u){return this.internalStream(b).accumulate(u)},nodeStream:function(b,u){return this.internalStream(b||"nodebuffer").toNodejsStream(u)},_compressWorker:function(b,u){if(this._data instanceof f&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),f.createWorkerFrom(v,b,u)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof c?this._data:new s(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<g.length;d++)i.prototype[g[d]]=p;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,o){(function(i){var a,s,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var f=0,c=new l(b),g=i.document.createTextNode("");c.observe(g,{characterData:!0}),a=function(){g.data=f=++f%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var u=i.document.createElement("script");u.onreadystatechange=function(){b(),u.onreadystatechange=null,u.parentNode.removeChild(u),u=null},i.document.documentElement.appendChild(u)}:function(){setTimeout(b,0)};else{var p=new i.MessageChannel;p.port1.onmessage=b,a=function(){p.port2.postMessage(0)}}var d=[];function b(){var u,v;s=!0;for(var y=d.length;y;){for(v=d,d=[],u=-1;++u<y;)v[u]();y=d.length}s=!1}r.exports=function(u){d.push(u)!==1||s||a()}}).call(this,typeof qe<"u"?qe:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,o){var i=e("immediate");function a(){}var s={},l=["REJECTED"],f=["FULFILLED"],c=["PENDING"];function g(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,y!==a&&u(this,y)}function p(y,w,x){this.promise=y,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function d(y,w,x){i(function(){var _;try{_=w(x)}catch(R){return s.reject(y,R)}_===y?s.reject(y,new TypeError("Cannot resolve promise with itself")):s.resolve(y,_)})}function b(y){var w=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof w=="function")return function(){w.apply(y,arguments)}}function u(y,w){var x=!1;function _(I){x||(x=!0,s.reject(y,I))}function R(I){x||(x=!0,s.resolve(y,I))}var N=v(function(){w(R,_)});N.status==="error"&&_(N.value)}function v(y,w){var x={};try{x.value=y(w),x.status="success"}catch(_){x.status="error",x.value=_}return x}(r.exports=g).prototype.finally=function(y){if(typeof y!="function")return this;var w=this.constructor;return this.then(function(x){return w.resolve(y()).then(function(){return x})},function(x){return w.resolve(y()).then(function(){throw x})})},g.prototype.catch=function(y){return this.then(null,y)},g.prototype.then=function(y,w){if(typeof y!="function"&&this.state===f||typeof w!="function"&&this.state===l)return this;var x=new this.constructor(a);return this.state!==c?d(x,this.state===f?y:w,this.outcome):this.queue.push(new p(x,y,w)),x},p.prototype.callFulfilled=function(y){s.resolve(this.promise,y)},p.prototype.otherCallFulfilled=function(y){d(this.promise,this.onFulfilled,y)},p.prototype.callRejected=function(y){s.reject(this.promise,y)},p.prototype.otherCallRejected=function(y){d(this.promise,this.onRejected,y)},s.resolve=function(y,w){var x=v(b,w);if(x.status==="error")return s.reject(y,x.value);var _=x.value;if(_)u(y,_);else{y.state=f,y.outcome=w;for(var R=-1,N=y.queue.length;++R<N;)y.queue[R].callFulfilled(w)}return y},s.reject=function(y,w){y.state=l,y.outcome=w;for(var x=-1,_=y.queue.length;++x<_;)y.queue[x].callRejected(w);return y},g.resolve=function(y){return y instanceof this?y:s.resolve(new this(a),y)},g.reject=function(y){var w=new this(a);return s.reject(w,y)},g.all=function(y){var w=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=y.length,_=!1;if(!x)return this.resolve([]);for(var R=new Array(x),N=0,I=-1,z=new this(a);++I<x;)T(y[I],I);return z;function T(O,q){w.resolve(O).then(function(S){R[q]=S,++N!==x||_||(_=!0,s.resolve(z,R))},function(S){_||(_=!0,s.reject(z,S))})}},g.race=function(y){var w=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=y.length,_=!1;if(!x)return this.resolve([]);for(var R=-1,N=new this(a);++R<x;)I=y[R],w.resolve(I).then(function(z){_||(_=!0,s.resolve(N,z))},function(z){_||(_=!0,s.reject(N,z))});var I;return N}},{immediate:36}],38:[function(e,r,o){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,o){var i=e("./zlib/deflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/messages"),f=e("./zlib/zstream"),c=Object.prototype.toString,g=0,p=-1,d=0,b=8;function u(y){if(!(this instanceof u))return new u(y);this.options=a.assign({level:p,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},y||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var x=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(x!==g)throw new Error(l[x]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var _;if(_=typeof w.dictionary=="string"?s.string2buf(w.dictionary):c.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(x=i.deflateSetDictionary(this.strm,_))!==g)throw new Error(l[x]);this._dict_set=!0}}function v(y,w){var x=new u(w);if(x.push(y,!0),x.err)throw x.msg||l[x.err];return x.result}u.prototype.push=function(y,w){var x,_,R=this.strm,N=this.options.chunkSize;if(this.ended)return!1;_=w===~~w?w:w===!0?4:0,typeof y=="string"?R.input=s.string2buf(y):c.call(y)==="[object ArrayBuffer]"?R.input=new Uint8Array(y):R.input=y,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new a.Buf8(N),R.next_out=0,R.avail_out=N),(x=i.deflate(R,_))!==1&&x!==g)return this.onEnd(x),!(this.ended=!0);R.avail_out!==0&&(R.avail_in!==0||_!==4&&_!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(a.shrinkBuf(R.output,R.next_out))):this.onData(a.shrinkBuf(R.output,R.next_out)))}while((0<R.avail_in||R.avail_out===0)&&x!==1);return _===4?(x=i.deflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===g):_!==2||(this.onEnd(g),!(R.avail_out=0))},u.prototype.onData=function(y){this.chunks.push(y)},u.prototype.onEnd=function(y){y===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},o.Deflate=u,o.deflate=v,o.deflateRaw=function(y,w){return(w=w||{}).raw=!0,v(y,w)},o.gzip=function(y,w){return(w=w||{}).gzip=!0,v(y,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,o){var i=e("./zlib/inflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/constants"),f=e("./zlib/messages"),c=e("./zlib/zstream"),g=e("./zlib/gzheader"),p=Object.prototype.toString;function d(u){if(!(this instanceof d))return new d(u);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},u||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||u&&u.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var y=i.inflateInit2(this.strm,v.windowBits);if(y!==l.Z_OK)throw new Error(f[y]);this.header=new g,i.inflateGetHeader(this.strm,this.header)}function b(u,v){var y=new d(v);if(y.push(u,!0),y.err)throw y.msg||f[y.err];return y.result}d.prototype.push=function(u,v){var y,w,x,_,R,N,I=this.strm,z=this.options.chunkSize,T=this.options.dictionary,O=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof u=="string"?I.input=s.binstring2buf(u):p.call(u)==="[object ArrayBuffer]"?I.input=new Uint8Array(u):I.input=u,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new a.Buf8(z),I.next_out=0,I.avail_out=z),(y=i.inflate(I,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&T&&(N=typeof T=="string"?s.string2buf(T):p.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,y=i.inflateSetDictionary(this.strm,N)),y===l.Z_BUF_ERROR&&O===!0&&(y=l.Z_OK,O=!1),y!==l.Z_STREAM_END&&y!==l.Z_OK)return this.onEnd(y),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&y!==l.Z_STREAM_END&&(I.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=s.utf8border(I.output,I.next_out),_=I.next_out-x,R=s.buf2string(I.output,x),I.next_out=_,I.avail_out=z-_,_&&a.arraySet(I.output,I.output,x,_,0),this.onData(R)):this.onData(a.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(O=!0)}while((0<I.avail_in||I.avail_out===0)&&y!==l.Z_STREAM_END);return y===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(y=i.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(I.avail_out=0))},d.prototype.onData=function(u){this.chunks.push(u)},d.prototype.onEnd=function(u){u===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg},o.Inflate=d,o.inflate=b,o.inflateRaw=function(u,v){return(v=v||{}).raw=!0,b(u,v)},o.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(l){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var c=f.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var g in c)c.hasOwnProperty(g)&&(l[g]=c[g])}}return l},o.shrinkBuf=function(l,f){return l.length===f?l:l.subarray?l.subarray(0,f):(l.length=f,l)};var a={arraySet:function(l,f,c,g,p){if(f.subarray&&l.subarray)l.set(f.subarray(c,c+g),p);else for(var d=0;d<g;d++)l[p+d]=f[c+d]},flattenChunks:function(l){var f,c,g,p,d,b;for(f=g=0,c=l.length;f<c;f++)g+=l[f].length;for(b=new Uint8Array(g),f=p=0,c=l.length;f<c;f++)d=l[f],b.set(d,p),p+=d.length;return b}},s={arraySet:function(l,f,c,g,p){for(var d=0;d<g;d++)l[p+d]=f[c+d]},flattenChunks:function(l){return[].concat.apply([],l)}};o.setTyped=function(l){l?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,a)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,s))},o.setTyped(i)},{}],42:[function(e,r,o){var i=e("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new i.Buf8(256),f=0;f<256;f++)l[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function c(g,p){if(p<65537&&(g.subarray&&s||!g.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(g,p));for(var d="",b=0;b<p;b++)d+=String.fromCharCode(g[b]);return d}l[254]=l[254]=1,o.string2buf=function(g){var p,d,b,u,v,y=g.length,w=0;for(u=0;u<y;u++)(64512&(d=g.charCodeAt(u)))==55296&&u+1<y&&(64512&(b=g.charCodeAt(u+1)))==56320&&(d=65536+(d-55296<<10)+(b-56320),u++),w+=d<128?1:d<2048?2:d<65536?3:4;for(p=new i.Buf8(w),u=v=0;v<w;u++)(64512&(d=g.charCodeAt(u)))==55296&&u+1<y&&(64512&(b=g.charCodeAt(u+1)))==56320&&(d=65536+(d-55296<<10)+(b-56320),u++),d<128?p[v++]=d:(d<2048?p[v++]=192|d>>>6:(d<65536?p[v++]=224|d>>>12:(p[v++]=240|d>>>18,p[v++]=128|d>>>12&63),p[v++]=128|d>>>6&63),p[v++]=128|63&d);return p},o.buf2binstring=function(g){return c(g,g.length)},o.binstring2buf=function(g){for(var p=new i.Buf8(g.length),d=0,b=p.length;d<b;d++)p[d]=g.charCodeAt(d);return p},o.buf2string=function(g,p){var d,b,u,v,y=p||g.length,w=new Array(2*y);for(d=b=0;d<y;)if((u=g[d++])<128)w[b++]=u;else if(4<(v=l[u]))w[b++]=65533,d+=v-1;else{for(u&=v===2?31:v===3?15:7;1<v&&d<y;)u=u<<6|63&g[d++],v--;1<v?w[b++]=65533:u<65536?w[b++]=u:(u-=65536,w[b++]=55296|u>>10&1023,w[b++]=56320|1023&u)}return c(w,b)},o.utf8border=function(g,p){var d;for((p=p||g.length)>g.length&&(p=g.length),d=p-1;0<=d&&(192&g[d])==128;)d--;return d<0||d===0?p:d+l[g[d]]>p?d:p}},{"./common":41}],43:[function(e,r,o){r.exports=function(i,a,s,l){for(var f=65535&i|0,c=i>>>16&65535|0,g=0;s!==0;){for(s-=g=2e3<s?2e3:s;c=c+(f=f+a[l++]|0)|0,--g;);f%=65521,c%=65521}return f|c<<16|0}},{}],44:[function(e,r,o){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,o){var i=function(){for(var a,s=[],l=0;l<256;l++){a=l;for(var f=0;f<8;f++)a=1&a?3988292384^a>>>1:a>>>1;s[l]=a}return s}();r.exports=function(a,s,l,f){var c=i,g=f+l;a^=-1;for(var p=f;p<g;p++)a=a>>>8^c[255&(a^s[p])];return-1^a}},{}],46:[function(e,r,o){var i,a=e("../utils/common"),s=e("./trees"),l=e("./adler32"),f=e("./crc32"),c=e("./messages"),g=0,p=4,d=0,b=-2,u=-1,v=4,y=2,w=8,x=9,_=286,R=30,N=19,I=2*_+1,z=15,T=3,O=258,q=O+T+1,S=42,k=113,m=1,W=2,nt=3,G=4;function F(h,H){return h.msg=c[H],H}function B(h){return(h<<1)-(4<h?9:0)}function j(h){for(var H=h.length;0<=--H;)h[H]=0}function E(h){var H=h.state,Y=H.pending;Y>h.avail_out&&(Y=h.avail_out),Y!==0&&(a.arraySet(h.output,H.pending_buf,H.pending_out,Y,h.next_out),h.next_out+=Y,H.pending_out+=Y,h.total_out+=Y,h.avail_out-=Y,H.pending-=Y,H.pending===0&&(H.pending_out=0))}function M(h,H){s._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,H),h.block_start=h.strstart,E(h.strm)}function Z(h,H){h.pending_buf[h.pending++]=H}function V(h,H){h.pending_buf[h.pending++]=H>>>8&255,h.pending_buf[h.pending++]=255&H}function $(h,H){var Y,D,A=h.max_chain_length,P=h.strstart,X=h.prev_length,Q=h.nice_match,U=h.strstart>h.w_size-q?h.strstart-(h.w_size-q):0,J=h.window,it=h.w_mask,et=h.prev,ct=h.strstart+O,ht=J[P+X-1],ut=J[P+X];h.prev_length>=h.good_match&&(A>>=2),Q>h.lookahead&&(Q=h.lookahead);do if(J[(Y=H)+X]===ut&&J[Y+X-1]===ht&&J[Y]===J[P]&&J[++Y]===J[P+1]){P+=2,Y++;do;while(J[++P]===J[++Y]&&J[++P]===J[++Y]&&J[++P]===J[++Y]&&J[++P]===J[++Y]&&J[++P]===J[++Y]&&J[++P]===J[++Y]&&J[++P]===J[++Y]&&J[++P]===J[++Y]&&P<ct);if(D=O-(ct-P),P=ct-O,X<D){if(h.match_start=H,Q<=(X=D))break;ht=J[P+X-1],ut=J[P+X]}}while((H=et[H&it])>U&&--A!=0);return X<=h.lookahead?X:h.lookahead}function lt(h){var H,Y,D,A,P,X,Q,U,J,it,et=h.w_size;do{if(A=h.window_size-h.lookahead-h.strstart,h.strstart>=et+(et-q)){for(a.arraySet(h.window,h.window,et,et,0),h.match_start-=et,h.strstart-=et,h.block_start-=et,H=Y=h.hash_size;D=h.head[--H],h.head[H]=et<=D?D-et:0,--Y;);for(H=Y=et;D=h.prev[--H],h.prev[H]=et<=D?D-et:0,--Y;);A+=et}if(h.strm.avail_in===0)break;if(X=h.strm,Q=h.window,U=h.strstart+h.lookahead,J=A,it=void 0,it=X.avail_in,J<it&&(it=J),Y=it===0?0:(X.avail_in-=it,a.arraySet(Q,X.input,X.next_in,it,U),X.state.wrap===1?X.adler=l(X.adler,Q,it,U):X.state.wrap===2&&(X.adler=f(X.adler,Q,it,U)),X.next_in+=it,X.total_in+=it,it),h.lookahead+=Y,h.lookahead+h.insert>=T)for(P=h.strstart-h.insert,h.ins_h=h.window[P],h.ins_h=(h.ins_h<<h.hash_shift^h.window[P+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[P+T-1])&h.hash_mask,h.prev[P&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=P,P++,h.insert--,!(h.lookahead+h.insert<T)););}while(h.lookahead<q&&h.strm.avail_in!==0)}function ot(h,H){for(var Y,D;;){if(h.lookahead<q){if(lt(h),h.lookahead<q&&H===g)return m;if(h.lookahead===0)break}if(Y=0,h.lookahead>=T&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+T-1])&h.hash_mask,Y=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),Y!==0&&h.strstart-Y<=h.w_size-q&&(h.match_length=$(h,Y)),h.match_length>=T)if(D=s._tr_tally(h,h.strstart-h.match_start,h.match_length-T),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=T){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+T-1])&h.hash_mask,Y=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else D=s._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(D&&(M(h,!1),h.strm.avail_out===0))return m}return h.insert=h.strstart<T-1?h.strstart:T-1,H===p?(M(h,!0),h.strm.avail_out===0?nt:G):h.last_lit&&(M(h,!1),h.strm.avail_out===0)?m:W}function tt(h,H){for(var Y,D,A;;){if(h.lookahead<q){if(lt(h),h.lookahead<q&&H===g)return m;if(h.lookahead===0)break}if(Y=0,h.lookahead>=T&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+T-1])&h.hash_mask,Y=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=T-1,Y!==0&&h.prev_length<h.max_lazy_match&&h.strstart-Y<=h.w_size-q&&(h.match_length=$(h,Y),h.match_length<=5&&(h.strategy===1||h.match_length===T&&4096<h.strstart-h.match_start)&&(h.match_length=T-1)),h.prev_length>=T&&h.match_length<=h.prev_length){for(A=h.strstart+h.lookahead-T,D=s._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-T),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=A&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+T-1])&h.hash_mask,Y=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=T-1,h.strstart++,D&&(M(h,!1),h.strm.avail_out===0))return m}else if(h.match_available){if((D=s._tr_tally(h,0,h.window[h.strstart-1]))&&M(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return m}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(D=s._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<T-1?h.strstart:T-1,H===p?(M(h,!0),h.strm.avail_out===0?nt:G):h.last_lit&&(M(h,!1),h.strm.avail_out===0)?m:W}function K(h,H,Y,D,A){this.good_length=h,this.max_lazy=H,this.nice_length=Y,this.max_chain=D,this.func=A}function rt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*I),this.dyn_dtree=new a.Buf16(2*(2*R+1)),this.bl_tree=new a.Buf16(2*(2*N+1)),j(this.dyn_ltree),j(this.dyn_dtree),j(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(z+1),this.heap=new a.Buf16(2*_+1),j(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*_+1),j(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function dt(h){var H;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=y,(H=h.state).pending=0,H.pending_out=0,H.wrap<0&&(H.wrap=-H.wrap),H.status=H.wrap?S:k,h.adler=H.wrap===2?0:1,H.last_flush=g,s._tr_init(H),d):F(h,b)}function pt(h){var H=dt(h);return H===d&&function(Y){Y.window_size=2*Y.w_size,j(Y.head),Y.max_lazy_match=i[Y.level].max_lazy,Y.good_match=i[Y.level].good_length,Y.nice_match=i[Y.level].nice_length,Y.max_chain_length=i[Y.level].max_chain,Y.strstart=0,Y.block_start=0,Y.lookahead=0,Y.insert=0,Y.match_length=Y.prev_length=T-1,Y.match_available=0,Y.ins_h=0}(h.state),H}function _t(h,H,Y,D,A,P){if(!h)return b;var X=1;if(H===u&&(H=6),D<0?(X=0,D=-D):15<D&&(X=2,D-=16),A<1||x<A||Y!==w||D<8||15<D||H<0||9<H||P<0||v<P)return F(h,b);D===8&&(D=9);var Q=new rt;return(h.state=Q).strm=h,Q.wrap=X,Q.gzhead=null,Q.w_bits=D,Q.w_size=1<<Q.w_bits,Q.w_mask=Q.w_size-1,Q.hash_bits=A+7,Q.hash_size=1<<Q.hash_bits,Q.hash_mask=Q.hash_size-1,Q.hash_shift=~~((Q.hash_bits+T-1)/T),Q.window=new a.Buf8(2*Q.w_size),Q.head=new a.Buf16(Q.hash_size),Q.prev=new a.Buf16(Q.w_size),Q.lit_bufsize=1<<A+6,Q.pending_buf_size=4*Q.lit_bufsize,Q.pending_buf=new a.Buf8(Q.pending_buf_size),Q.d_buf=1*Q.lit_bufsize,Q.l_buf=3*Q.lit_bufsize,Q.level=H,Q.strategy=P,Q.method=Y,pt(h)}i=[new K(0,0,0,0,function(h,H){var Y=65535;for(Y>h.pending_buf_size-5&&(Y=h.pending_buf_size-5);;){if(h.lookahead<=1){if(lt(h),h.lookahead===0&&H===g)return m;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var D=h.block_start+Y;if((h.strstart===0||h.strstart>=D)&&(h.lookahead=h.strstart-D,h.strstart=D,M(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-q&&(M(h,!1),h.strm.avail_out===0))return m}return h.insert=0,H===p?(M(h,!0),h.strm.avail_out===0?nt:G):(h.strstart>h.block_start&&(M(h,!1),h.strm.avail_out),m)}),new K(4,4,8,4,ot),new K(4,5,16,8,ot),new K(4,6,32,32,ot),new K(4,4,16,16,tt),new K(8,16,32,32,tt),new K(8,16,128,128,tt),new K(8,32,128,256,tt),new K(32,128,258,1024,tt),new K(32,258,258,4096,tt)],o.deflateInit=function(h,H){return _t(h,H,w,15,8,0)},o.deflateInit2=_t,o.deflateReset=pt,o.deflateResetKeep=dt,o.deflateSetHeader=function(h,H){return h&&h.state?h.state.wrap!==2?b:(h.state.gzhead=H,d):b},o.deflate=function(h,H){var Y,D,A,P;if(!h||!h.state||5<H||H<0)return h?F(h,b):b;if(D=h.state,!h.output||!h.input&&h.avail_in!==0||D.status===666&&H!==p)return F(h,h.avail_out===0?-5:b);if(D.strm=h,Y=D.last_flush,D.last_flush=H,D.status===S)if(D.wrap===2)h.adler=0,Z(D,31),Z(D,139),Z(D,8),D.gzhead?(Z(D,(D.gzhead.text?1:0)+(D.gzhead.hcrc?2:0)+(D.gzhead.extra?4:0)+(D.gzhead.name?8:0)+(D.gzhead.comment?16:0)),Z(D,255&D.gzhead.time),Z(D,D.gzhead.time>>8&255),Z(D,D.gzhead.time>>16&255),Z(D,D.gzhead.time>>24&255),Z(D,D.level===9?2:2<=D.strategy||D.level<2?4:0),Z(D,255&D.gzhead.os),D.gzhead.extra&&D.gzhead.extra.length&&(Z(D,255&D.gzhead.extra.length),Z(D,D.gzhead.extra.length>>8&255)),D.gzhead.hcrc&&(h.adler=f(h.adler,D.pending_buf,D.pending,0)),D.gzindex=0,D.status=69):(Z(D,0),Z(D,0),Z(D,0),Z(D,0),Z(D,0),Z(D,D.level===9?2:2<=D.strategy||D.level<2?4:0),Z(D,3),D.status=k);else{var X=w+(D.w_bits-8<<4)<<8;X|=(2<=D.strategy||D.level<2?0:D.level<6?1:D.level===6?2:3)<<6,D.strstart!==0&&(X|=32),X+=31-X%31,D.status=k,V(D,X),D.strstart!==0&&(V(D,h.adler>>>16),V(D,65535&h.adler)),h.adler=1}if(D.status===69)if(D.gzhead.extra){for(A=D.pending;D.gzindex<(65535&D.gzhead.extra.length)&&(D.pending!==D.pending_buf_size||(D.gzhead.hcrc&&D.pending>A&&(h.adler=f(h.adler,D.pending_buf,D.pending-A,A)),E(h),A=D.pending,D.pending!==D.pending_buf_size));)Z(D,255&D.gzhead.extra[D.gzindex]),D.gzindex++;D.gzhead.hcrc&&D.pending>A&&(h.adler=f(h.adler,D.pending_buf,D.pending-A,A)),D.gzindex===D.gzhead.extra.length&&(D.gzindex=0,D.status=73)}else D.status=73;if(D.status===73)if(D.gzhead.name){A=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>A&&(h.adler=f(h.adler,D.pending_buf,D.pending-A,A)),E(h),A=D.pending,D.pending===D.pending_buf_size)){P=1;break}P=D.gzindex<D.gzhead.name.length?255&D.gzhead.name.charCodeAt(D.gzindex++):0,Z(D,P)}while(P!==0);D.gzhead.hcrc&&D.pending>A&&(h.adler=f(h.adler,D.pending_buf,D.pending-A,A)),P===0&&(D.gzindex=0,D.status=91)}else D.status=91;if(D.status===91)if(D.gzhead.comment){A=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>A&&(h.adler=f(h.adler,D.pending_buf,D.pending-A,A)),E(h),A=D.pending,D.pending===D.pending_buf_size)){P=1;break}P=D.gzindex<D.gzhead.comment.length?255&D.gzhead.comment.charCodeAt(D.gzindex++):0,Z(D,P)}while(P!==0);D.gzhead.hcrc&&D.pending>A&&(h.adler=f(h.adler,D.pending_buf,D.pending-A,A)),P===0&&(D.status=103)}else D.status=103;if(D.status===103&&(D.gzhead.hcrc?(D.pending+2>D.pending_buf_size&&E(h),D.pending+2<=D.pending_buf_size&&(Z(D,255&h.adler),Z(D,h.adler>>8&255),h.adler=0,D.status=k)):D.status=k),D.pending!==0){if(E(h),h.avail_out===0)return D.last_flush=-1,d}else if(h.avail_in===0&&B(H)<=B(Y)&&H!==p)return F(h,-5);if(D.status===666&&h.avail_in!==0)return F(h,-5);if(h.avail_in!==0||D.lookahead!==0||H!==g&&D.status!==666){var Q=D.strategy===2?function(U,J){for(var it;;){if(U.lookahead===0&&(lt(U),U.lookahead===0)){if(J===g)return m;break}if(U.match_length=0,it=s._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++,it&&(M(U,!1),U.strm.avail_out===0))return m}return U.insert=0,J===p?(M(U,!0),U.strm.avail_out===0?nt:G):U.last_lit&&(M(U,!1),U.strm.avail_out===0)?m:W}(D,H):D.strategy===3?function(U,J){for(var it,et,ct,ht,ut=U.window;;){if(U.lookahead<=O){if(lt(U),U.lookahead<=O&&J===g)return m;if(U.lookahead===0)break}if(U.match_length=0,U.lookahead>=T&&0<U.strstart&&(et=ut[ct=U.strstart-1])===ut[++ct]&&et===ut[++ct]&&et===ut[++ct]){ht=U.strstart+O;do;while(et===ut[++ct]&&et===ut[++ct]&&et===ut[++ct]&&et===ut[++ct]&&et===ut[++ct]&&et===ut[++ct]&&et===ut[++ct]&&et===ut[++ct]&&ct<ht);U.match_length=O-(ht-ct),U.match_length>U.lookahead&&(U.match_length=U.lookahead)}if(U.match_length>=T?(it=s._tr_tally(U,1,U.match_length-T),U.lookahead-=U.match_length,U.strstart+=U.match_length,U.match_length=0):(it=s._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++),it&&(M(U,!1),U.strm.avail_out===0))return m}return U.insert=0,J===p?(M(U,!0),U.strm.avail_out===0?nt:G):U.last_lit&&(M(U,!1),U.strm.avail_out===0)?m:W}(D,H):i[D.level].func(D,H);if(Q!==nt&&Q!==G||(D.status=666),Q===m||Q===nt)return h.avail_out===0&&(D.last_flush=-1),d;if(Q===W&&(H===1?s._tr_align(D):H!==5&&(s._tr_stored_block(D,0,0,!1),H===3&&(j(D.head),D.lookahead===0&&(D.strstart=0,D.block_start=0,D.insert=0))),E(h),h.avail_out===0))return D.last_flush=-1,d}return H!==p?d:D.wrap<=0?1:(D.wrap===2?(Z(D,255&h.adler),Z(D,h.adler>>8&255),Z(D,h.adler>>16&255),Z(D,h.adler>>24&255),Z(D,255&h.total_in),Z(D,h.total_in>>8&255),Z(D,h.total_in>>16&255),Z(D,h.total_in>>24&255)):(V(D,h.adler>>>16),V(D,65535&h.adler)),E(h),0<D.wrap&&(D.wrap=-D.wrap),D.pending!==0?d:1)},o.deflateEnd=function(h){var H;return h&&h.state?(H=h.state.status)!==S&&H!==69&&H!==73&&H!==91&&H!==103&&H!==k&&H!==666?F(h,b):(h.state=null,H===k?F(h,-3):d):b},o.deflateSetDictionary=function(h,H){var Y,D,A,P,X,Q,U,J,it=H.length;if(!h||!h.state||(P=(Y=h.state).wrap)===2||P===1&&Y.status!==S||Y.lookahead)return b;for(P===1&&(h.adler=l(h.adler,H,it,0)),Y.wrap=0,it>=Y.w_size&&(P===0&&(j(Y.head),Y.strstart=0,Y.block_start=0,Y.insert=0),J=new a.Buf8(Y.w_size),a.arraySet(J,H,it-Y.w_size,Y.w_size,0),H=J,it=Y.w_size),X=h.avail_in,Q=h.next_in,U=h.input,h.avail_in=it,h.next_in=0,h.input=H,lt(Y);Y.lookahead>=T;){for(D=Y.strstart,A=Y.lookahead-(T-1);Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[D+T-1])&Y.hash_mask,Y.prev[D&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=D,D++,--A;);Y.strstart=D,Y.lookahead=T-1,lt(Y)}return Y.strstart+=Y.lookahead,Y.block_start=Y.strstart,Y.insert=Y.lookahead,Y.lookahead=0,Y.match_length=Y.prev_length=T-1,Y.match_available=0,h.next_in=Q,h.input=U,h.avail_in=X,Y.wrap=P,d},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,o){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,o){r.exports=function(i,a){var s,l,f,c,g,p,d,b,u,v,y,w,x,_,R,N,I,z,T,O,q,S,k,m,W;s=i.state,l=i.next_in,m=i.input,f=l+(i.avail_in-5),c=i.next_out,W=i.output,g=c-(a-i.avail_out),p=c+(i.avail_out-257),d=s.dmax,b=s.wsize,u=s.whave,v=s.wnext,y=s.window,w=s.hold,x=s.bits,_=s.lencode,R=s.distcode,N=(1<<s.lenbits)-1,I=(1<<s.distbits)-1;t:do{x<15&&(w+=m[l++]<<x,x+=8,w+=m[l++]<<x,x+=8),z=_[w&N];e:for(;;){if(w>>>=T=z>>>24,x-=T,(T=z>>>16&255)===0)W[c++]=65535&z;else{if(!(16&T)){if((64&T)==0){z=_[(65535&z)+(w&(1<<T)-1)];continue e}if(32&T){s.mode=12;break t}i.msg="invalid literal/length code",s.mode=30;break t}O=65535&z,(T&=15)&&(x<T&&(w+=m[l++]<<x,x+=8),O+=w&(1<<T)-1,w>>>=T,x-=T),x<15&&(w+=m[l++]<<x,x+=8,w+=m[l++]<<x,x+=8),z=R[w&I];n:for(;;){if(w>>>=T=z>>>24,x-=T,!(16&(T=z>>>16&255))){if((64&T)==0){z=R[(65535&z)+(w&(1<<T)-1)];continue n}i.msg="invalid distance code",s.mode=30;break t}if(q=65535&z,x<(T&=15)&&(w+=m[l++]<<x,(x+=8)<T&&(w+=m[l++]<<x,x+=8)),d<(q+=w&(1<<T)-1)){i.msg="invalid distance too far back",s.mode=30;break t}if(w>>>=T,x-=T,(T=c-g)<q){if(u<(T=q-T)&&s.sane){i.msg="invalid distance too far back",s.mode=30;break t}if(k=y,(S=0)===v){if(S+=b-T,T<O){for(O-=T;W[c++]=y[S++],--T;);S=c-q,k=W}}else if(v<T){if(S+=b+v-T,(T-=v)<O){for(O-=T;W[c++]=y[S++],--T;);if(S=0,v<O){for(O-=T=v;W[c++]=y[S++],--T;);S=c-q,k=W}}}else if(S+=v-T,T<O){for(O-=T;W[c++]=y[S++],--T;);S=c-q,k=W}for(;2<O;)W[c++]=k[S++],W[c++]=k[S++],W[c++]=k[S++],O-=3;O&&(W[c++]=k[S++],1<O&&(W[c++]=k[S++]))}else{for(S=c-q;W[c++]=W[S++],W[c++]=W[S++],W[c++]=W[S++],2<(O-=3););O&&(W[c++]=W[S++],1<O&&(W[c++]=W[S++]))}break}}break}}while(l<f&&c<p);l-=O=x>>3,w&=(1<<(x-=O<<3))-1,i.next_in=l,i.next_out=c,i.avail_in=l<f?f-l+5:5-(l-f),i.avail_out=c<p?p-c+257:257-(c-p),s.hold=w,s.bits=x}},{}],49:[function(e,r,o){var i=e("../utils/common"),a=e("./adler32"),s=e("./crc32"),l=e("./inffast"),f=e("./inftrees"),c=1,g=2,p=0,d=-2,b=1,u=852,v=592;function y(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(S){var k;return S&&S.state?(k=S.state,S.total_in=S.total_out=k.total=0,S.msg="",k.wrap&&(S.adler=1&k.wrap),k.mode=b,k.last=0,k.havedict=0,k.dmax=32768,k.head=null,k.hold=0,k.bits=0,k.lencode=k.lendyn=new i.Buf32(u),k.distcode=k.distdyn=new i.Buf32(v),k.sane=1,k.back=-1,p):d}function _(S){var k;return S&&S.state?((k=S.state).wsize=0,k.whave=0,k.wnext=0,x(S)):d}function R(S,k){var m,W;return S&&S.state?(W=S.state,k<0?(m=0,k=-k):(m=1+(k>>4),k<48&&(k&=15)),k&&(k<8||15<k)?d:(W.window!==null&&W.wbits!==k&&(W.window=null),W.wrap=m,W.wbits=k,_(S))):d}function N(S,k){var m,W;return S?(W=new w,(S.state=W).window=null,(m=R(S,k))!==p&&(S.state=null),m):d}var I,z,T=!0;function O(S){if(T){var k;for(I=new i.Buf32(512),z=new i.Buf32(32),k=0;k<144;)S.lens[k++]=8;for(;k<256;)S.lens[k++]=9;for(;k<280;)S.lens[k++]=7;for(;k<288;)S.lens[k++]=8;for(f(c,S.lens,0,288,I,0,S.work,{bits:9}),k=0;k<32;)S.lens[k++]=5;f(g,S.lens,0,32,z,0,S.work,{bits:5}),T=!1}S.lencode=I,S.lenbits=9,S.distcode=z,S.distbits=5}function q(S,k,m,W){var nt,G=S.state;return G.window===null&&(G.wsize=1<<G.wbits,G.wnext=0,G.whave=0,G.window=new i.Buf8(G.wsize)),W>=G.wsize?(i.arraySet(G.window,k,m-G.wsize,G.wsize,0),G.wnext=0,G.whave=G.wsize):(W<(nt=G.wsize-G.wnext)&&(nt=W),i.arraySet(G.window,k,m-W,nt,G.wnext),(W-=nt)?(i.arraySet(G.window,k,m-W,W,0),G.wnext=W,G.whave=G.wsize):(G.wnext+=nt,G.wnext===G.wsize&&(G.wnext=0),G.whave<G.wsize&&(G.whave+=nt))),0}o.inflateReset=_,o.inflateReset2=R,o.inflateResetKeep=x,o.inflateInit=function(S){return N(S,15)},o.inflateInit2=N,o.inflate=function(S,k){var m,W,nt,G,F,B,j,E,M,Z,V,$,lt,ot,tt,K,rt,dt,pt,_t,h,H,Y,D,A=0,P=new i.Buf8(4),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return d;(m=S.state).mode===12&&(m.mode=13),F=S.next_out,nt=S.output,j=S.avail_out,G=S.next_in,W=S.input,B=S.avail_in,E=m.hold,M=m.bits,Z=B,V=j,H=p;t:for(;;)switch(m.mode){case b:if(m.wrap===0){m.mode=13;break}for(;M<16;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}if(2&m.wrap&&E===35615){P[m.check=0]=255&E,P[1]=E>>>8&255,m.check=s(m.check,P,2,0),M=E=0,m.mode=2;break}if(m.flags=0,m.head&&(m.head.done=!1),!(1&m.wrap)||(((255&E)<<8)+(E>>8))%31){S.msg="incorrect header check",m.mode=30;break}if((15&E)!=8){S.msg="unknown compression method",m.mode=30;break}if(M-=4,h=8+(15&(E>>>=4)),m.wbits===0)m.wbits=h;else if(h>m.wbits){S.msg="invalid window size",m.mode=30;break}m.dmax=1<<h,S.adler=m.check=1,m.mode=512&E?10:12,M=E=0;break;case 2:for(;M<16;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}if(m.flags=E,(255&m.flags)!=8){S.msg="unknown compression method",m.mode=30;break}if(57344&m.flags){S.msg="unknown header flags set",m.mode=30;break}m.head&&(m.head.text=E>>8&1),512&m.flags&&(P[0]=255&E,P[1]=E>>>8&255,m.check=s(m.check,P,2,0)),M=E=0,m.mode=3;case 3:for(;M<32;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}m.head&&(m.head.time=E),512&m.flags&&(P[0]=255&E,P[1]=E>>>8&255,P[2]=E>>>16&255,P[3]=E>>>24&255,m.check=s(m.check,P,4,0)),M=E=0,m.mode=4;case 4:for(;M<16;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}m.head&&(m.head.xflags=255&E,m.head.os=E>>8),512&m.flags&&(P[0]=255&E,P[1]=E>>>8&255,m.check=s(m.check,P,2,0)),M=E=0,m.mode=5;case 5:if(1024&m.flags){for(;M<16;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}m.length=E,m.head&&(m.head.extra_len=E),512&m.flags&&(P[0]=255&E,P[1]=E>>>8&255,m.check=s(m.check,P,2,0)),M=E=0}else m.head&&(m.head.extra=null);m.mode=6;case 6:if(1024&m.flags&&(B<($=m.length)&&($=B),$&&(m.head&&(h=m.head.extra_len-m.length,m.head.extra||(m.head.extra=new Array(m.head.extra_len)),i.arraySet(m.head.extra,W,G,$,h)),512&m.flags&&(m.check=s(m.check,W,$,G)),B-=$,G+=$,m.length-=$),m.length))break t;m.length=0,m.mode=7;case 7:if(2048&m.flags){if(B===0)break t;for($=0;h=W[G+$++],m.head&&h&&m.length<65536&&(m.head.name+=String.fromCharCode(h)),h&&$<B;);if(512&m.flags&&(m.check=s(m.check,W,$,G)),B-=$,G+=$,h)break t}else m.head&&(m.head.name=null);m.length=0,m.mode=8;case 8:if(4096&m.flags){if(B===0)break t;for($=0;h=W[G+$++],m.head&&h&&m.length<65536&&(m.head.comment+=String.fromCharCode(h)),h&&$<B;);if(512&m.flags&&(m.check=s(m.check,W,$,G)),B-=$,G+=$,h)break t}else m.head&&(m.head.comment=null);m.mode=9;case 9:if(512&m.flags){for(;M<16;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}if(E!==(65535&m.check)){S.msg="header crc mismatch",m.mode=30;break}M=E=0}m.head&&(m.head.hcrc=m.flags>>9&1,m.head.done=!0),S.adler=m.check=0,m.mode=12;break;case 10:for(;M<32;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}S.adler=m.check=y(E),M=E=0,m.mode=11;case 11:if(m.havedict===0)return S.next_out=F,S.avail_out=j,S.next_in=G,S.avail_in=B,m.hold=E,m.bits=M,2;S.adler=m.check=1,m.mode=12;case 12:if(k===5||k===6)break t;case 13:if(m.last){E>>>=7&M,M-=7&M,m.mode=27;break}for(;M<3;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}switch(m.last=1&E,M-=1,3&(E>>>=1)){case 0:m.mode=14;break;case 1:if(O(m),m.mode=20,k!==6)break;E>>>=2,M-=2;break t;case 2:m.mode=17;break;case 3:S.msg="invalid block type",m.mode=30}E>>>=2,M-=2;break;case 14:for(E>>>=7&M,M-=7&M;M<32;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}if((65535&E)!=(E>>>16^65535)){S.msg="invalid stored block lengths",m.mode=30;break}if(m.length=65535&E,M=E=0,m.mode=15,k===6)break t;case 15:m.mode=16;case 16:if($=m.length){if(B<$&&($=B),j<$&&($=j),$===0)break t;i.arraySet(nt,W,G,$,F),B-=$,G+=$,j-=$,F+=$,m.length-=$;break}m.mode=12;break;case 17:for(;M<14;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}if(m.nlen=257+(31&E),E>>>=5,M-=5,m.ndist=1+(31&E),E>>>=5,M-=5,m.ncode=4+(15&E),E>>>=4,M-=4,286<m.nlen||30<m.ndist){S.msg="too many length or distance symbols",m.mode=30;break}m.have=0,m.mode=18;case 18:for(;m.have<m.ncode;){for(;M<3;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}m.lens[X[m.have++]]=7&E,E>>>=3,M-=3}for(;m.have<19;)m.lens[X[m.have++]]=0;if(m.lencode=m.lendyn,m.lenbits=7,Y={bits:m.lenbits},H=f(0,m.lens,0,19,m.lencode,0,m.work,Y),m.lenbits=Y.bits,H){S.msg="invalid code lengths set",m.mode=30;break}m.have=0,m.mode=19;case 19:for(;m.have<m.nlen+m.ndist;){for(;K=(A=m.lencode[E&(1<<m.lenbits)-1])>>>16&255,rt=65535&A,!((tt=A>>>24)<=M);){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}if(rt<16)E>>>=tt,M-=tt,m.lens[m.have++]=rt;else{if(rt===16){for(D=tt+2;M<D;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}if(E>>>=tt,M-=tt,m.have===0){S.msg="invalid bit length repeat",m.mode=30;break}h=m.lens[m.have-1],$=3+(3&E),E>>>=2,M-=2}else if(rt===17){for(D=tt+3;M<D;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}M-=tt,h=0,$=3+(7&(E>>>=tt)),E>>>=3,M-=3}else{for(D=tt+7;M<D;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}M-=tt,h=0,$=11+(127&(E>>>=tt)),E>>>=7,M-=7}if(m.have+$>m.nlen+m.ndist){S.msg="invalid bit length repeat",m.mode=30;break}for(;$--;)m.lens[m.have++]=h}}if(m.mode===30)break;if(m.lens[256]===0){S.msg="invalid code -- missing end-of-block",m.mode=30;break}if(m.lenbits=9,Y={bits:m.lenbits},H=f(c,m.lens,0,m.nlen,m.lencode,0,m.work,Y),m.lenbits=Y.bits,H){S.msg="invalid literal/lengths set",m.mode=30;break}if(m.distbits=6,m.distcode=m.distdyn,Y={bits:m.distbits},H=f(g,m.lens,m.nlen,m.ndist,m.distcode,0,m.work,Y),m.distbits=Y.bits,H){S.msg="invalid distances set",m.mode=30;break}if(m.mode=20,k===6)break t;case 20:m.mode=21;case 21:if(6<=B&&258<=j){S.next_out=F,S.avail_out=j,S.next_in=G,S.avail_in=B,m.hold=E,m.bits=M,l(S,V),F=S.next_out,nt=S.output,j=S.avail_out,G=S.next_in,W=S.input,B=S.avail_in,E=m.hold,M=m.bits,m.mode===12&&(m.back=-1);break}for(m.back=0;K=(A=m.lencode[E&(1<<m.lenbits)-1])>>>16&255,rt=65535&A,!((tt=A>>>24)<=M);){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}if(K&&(240&K)==0){for(dt=tt,pt=K,_t=rt;K=(A=m.lencode[_t+((E&(1<<dt+pt)-1)>>dt)])>>>16&255,rt=65535&A,!(dt+(tt=A>>>24)<=M);){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}E>>>=dt,M-=dt,m.back+=dt}if(E>>>=tt,M-=tt,m.back+=tt,m.length=rt,K===0){m.mode=26;break}if(32&K){m.back=-1,m.mode=12;break}if(64&K){S.msg="invalid literal/length code",m.mode=30;break}m.extra=15&K,m.mode=22;case 22:if(m.extra){for(D=m.extra;M<D;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}m.length+=E&(1<<m.extra)-1,E>>>=m.extra,M-=m.extra,m.back+=m.extra}m.was=m.length,m.mode=23;case 23:for(;K=(A=m.distcode[E&(1<<m.distbits)-1])>>>16&255,rt=65535&A,!((tt=A>>>24)<=M);){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}if((240&K)==0){for(dt=tt,pt=K,_t=rt;K=(A=m.distcode[_t+((E&(1<<dt+pt)-1)>>dt)])>>>16&255,rt=65535&A,!(dt+(tt=A>>>24)<=M);){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}E>>>=dt,M-=dt,m.back+=dt}if(E>>>=tt,M-=tt,m.back+=tt,64&K){S.msg="invalid distance code",m.mode=30;break}m.offset=rt,m.extra=15&K,m.mode=24;case 24:if(m.extra){for(D=m.extra;M<D;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}m.offset+=E&(1<<m.extra)-1,E>>>=m.extra,M-=m.extra,m.back+=m.extra}if(m.offset>m.dmax){S.msg="invalid distance too far back",m.mode=30;break}m.mode=25;case 25:if(j===0)break t;if($=V-j,m.offset>$){if(($=m.offset-$)>m.whave&&m.sane){S.msg="invalid distance too far back",m.mode=30;break}lt=$>m.wnext?($-=m.wnext,m.wsize-$):m.wnext-$,$>m.length&&($=m.length),ot=m.window}else ot=nt,lt=F-m.offset,$=m.length;for(j<$&&($=j),j-=$,m.length-=$;nt[F++]=ot[lt++],--$;);m.length===0&&(m.mode=21);break;case 26:if(j===0)break t;nt[F++]=m.length,j--,m.mode=21;break;case 27:if(m.wrap){for(;M<32;){if(B===0)break t;B--,E|=W[G++]<<M,M+=8}if(V-=j,S.total_out+=V,m.total+=V,V&&(S.adler=m.check=m.flags?s(m.check,nt,V,F-V):a(m.check,nt,V,F-V)),V=j,(m.flags?E:y(E))!==m.check){S.msg="incorrect data check",m.mode=30;break}M=E=0}m.mode=28;case 28:if(m.wrap&&m.flags){for(;M<32;){if(B===0)break t;B--,E+=W[G++]<<M,M+=8}if(E!==(4294967295&m.total)){S.msg="incorrect length check",m.mode=30;break}M=E=0}m.mode=29;case 29:H=1;break t;case 30:H=-3;break t;case 31:return-4;case 32:default:return d}return S.next_out=F,S.avail_out=j,S.next_in=G,S.avail_in=B,m.hold=E,m.bits=M,(m.wsize||V!==S.avail_out&&m.mode<30&&(m.mode<27||k!==4))&&q(S,S.output,S.next_out,V-S.avail_out)?(m.mode=31,-4):(Z-=S.avail_in,V-=S.avail_out,S.total_in+=Z,S.total_out+=V,m.total+=V,m.wrap&&V&&(S.adler=m.check=m.flags?s(m.check,nt,V,S.next_out-V):a(m.check,nt,V,S.next_out-V)),S.data_type=m.bits+(m.last?64:0)+(m.mode===12?128:0)+(m.mode===20||m.mode===15?256:0),(Z==0&&V===0||k===4)&&H===p&&(H=-5),H)},o.inflateEnd=function(S){if(!S||!S.state)return d;var k=S.state;return k.window&&(k.window=null),S.state=null,p},o.inflateGetHeader=function(S,k){var m;return S&&S.state?(2&(m=S.state).wrap)==0?d:((m.head=k).done=!1,p):d},o.inflateSetDictionary=function(S,k){var m,W=k.length;return S&&S.state?(m=S.state).wrap!==0&&m.mode!==11?d:m.mode===11&&a(1,k,W,0)!==m.check?-3:q(S,k,W,W)?(m.mode=31,-4):(m.havedict=1,p):d},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,o){var i=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(c,g,p,d,b,u,v,y){var w,x,_,R,N,I,z,T,O,q=y.bits,S=0,k=0,m=0,W=0,nt=0,G=0,F=0,B=0,j=0,E=0,M=null,Z=0,V=new i.Buf16(16),$=new i.Buf16(16),lt=null,ot=0;for(S=0;S<=15;S++)V[S]=0;for(k=0;k<d;k++)V[g[p+k]]++;for(nt=q,W=15;1<=W&&V[W]===0;W--);if(W<nt&&(nt=W),W===0)return b[u++]=20971520,b[u++]=20971520,y.bits=1,0;for(m=1;m<W&&V[m]===0;m++);for(nt<m&&(nt=m),S=B=1;S<=15;S++)if(B<<=1,(B-=V[S])<0)return-1;if(0<B&&(c===0||W!==1))return-1;for($[1]=0,S=1;S<15;S++)$[S+1]=$[S]+V[S];for(k=0;k<d;k++)g[p+k]!==0&&(v[$[g[p+k]]++]=k);if(I=c===0?(M=lt=v,19):c===1?(M=a,Z-=257,lt=s,ot-=257,256):(M=l,lt=f,-1),S=m,N=u,F=k=E=0,_=-1,R=(j=1<<(G=nt))-1,c===1&&852<j||c===2&&592<j)return 1;for(;;){for(z=S-F,O=v[k]<I?(T=0,v[k]):v[k]>I?(T=lt[ot+v[k]],M[Z+v[k]]):(T=96,0),w=1<<S-F,m=x=1<<G;b[N+(E>>F)+(x-=w)]=z<<24|T<<16|O|0,x!==0;);for(w=1<<S-1;E&w;)w>>=1;if(w!==0?(E&=w-1,E+=w):E=0,k++,--V[S]==0){if(S===W)break;S=g[p+v[k]]}if(nt<S&&(E&R)!==_){for(F===0&&(F=nt),N+=m,B=1<<(G=S-F);G+F<W&&!((B-=V[G+F])<=0);)G++,B<<=1;if(j+=1<<G,c===1&&852<j||c===2&&592<j)return 1;b[_=E&R]=nt<<24|G<<16|N-u|0}}return E!==0&&(b[N+E]=S-F<<24|64<<16|0),y.bits=nt,0}},{"../utils/common":41}],51:[function(e,r,o){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,o){var i=e("../utils/common"),a=0,s=1;function l(A){for(var P=A.length;0<=--P;)A[P]=0}var f=0,c=29,g=256,p=g+1+c,d=30,b=19,u=2*p+1,v=15,y=16,w=7,x=256,_=16,R=17,N=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=new Array(2*(p+2));l(q);var S=new Array(2*d);l(S);var k=new Array(512);l(k);var m=new Array(256);l(m);var W=new Array(c);l(W);var nt,G,F,B=new Array(d);function j(A,P,X,Q,U){this.static_tree=A,this.extra_bits=P,this.extra_base=X,this.elems=Q,this.max_length=U,this.has_stree=A&&A.length}function E(A,P){this.dyn_tree=A,this.max_code=0,this.stat_desc=P}function M(A){return A<256?k[A]:k[256+(A>>>7)]}function Z(A,P){A.pending_buf[A.pending++]=255&P,A.pending_buf[A.pending++]=P>>>8&255}function V(A,P,X){A.bi_valid>y-X?(A.bi_buf|=P<<A.bi_valid&65535,Z(A,A.bi_buf),A.bi_buf=P>>y-A.bi_valid,A.bi_valid+=X-y):(A.bi_buf|=P<<A.bi_valid&65535,A.bi_valid+=X)}function $(A,P,X){V(A,X[2*P],X[2*P+1])}function lt(A,P){for(var X=0;X|=1&A,A>>>=1,X<<=1,0<--P;);return X>>>1}function ot(A,P,X){var Q,U,J=new Array(v+1),it=0;for(Q=1;Q<=v;Q++)J[Q]=it=it+X[Q-1]<<1;for(U=0;U<=P;U++){var et=A[2*U+1];et!==0&&(A[2*U]=lt(J[et]++,et))}}function tt(A){var P;for(P=0;P<p;P++)A.dyn_ltree[2*P]=0;for(P=0;P<d;P++)A.dyn_dtree[2*P]=0;for(P=0;P<b;P++)A.bl_tree[2*P]=0;A.dyn_ltree[2*x]=1,A.opt_len=A.static_len=0,A.last_lit=A.matches=0}function K(A){8<A.bi_valid?Z(A,A.bi_buf):0<A.bi_valid&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0}function rt(A,P,X,Q){var U=2*P,J=2*X;return A[U]<A[J]||A[U]===A[J]&&Q[P]<=Q[X]}function dt(A,P,X){for(var Q=A.heap[X],U=X<<1;U<=A.heap_len&&(U<A.heap_len&&rt(P,A.heap[U+1],A.heap[U],A.depth)&&U++,!rt(P,Q,A.heap[U],A.depth));)A.heap[X]=A.heap[U],X=U,U<<=1;A.heap[X]=Q}function pt(A,P,X){var Q,U,J,it,et=0;if(A.last_lit!==0)for(;Q=A.pending_buf[A.d_buf+2*et]<<8|A.pending_buf[A.d_buf+2*et+1],U=A.pending_buf[A.l_buf+et],et++,Q===0?$(A,U,P):($(A,(J=m[U])+g+1,P),(it=I[J])!==0&&V(A,U-=W[J],it),$(A,J=M(--Q),X),(it=z[J])!==0&&V(A,Q-=B[J],it)),et<A.last_lit;);$(A,x,P)}function _t(A,P){var X,Q,U,J=P.dyn_tree,it=P.stat_desc.static_tree,et=P.stat_desc.has_stree,ct=P.stat_desc.elems,ht=-1;for(A.heap_len=0,A.heap_max=u,X=0;X<ct;X++)J[2*X]!==0?(A.heap[++A.heap_len]=ht=X,A.depth[X]=0):J[2*X+1]=0;for(;A.heap_len<2;)J[2*(U=A.heap[++A.heap_len]=ht<2?++ht:0)]=1,A.depth[U]=0,A.opt_len--,et&&(A.static_len-=it[2*U+1]);for(P.max_code=ht,X=A.heap_len>>1;1<=X;X--)dt(A,J,X);for(U=ct;X=A.heap[1],A.heap[1]=A.heap[A.heap_len--],dt(A,J,1),Q=A.heap[1],A.heap[--A.heap_max]=X,A.heap[--A.heap_max]=Q,J[2*U]=J[2*X]+J[2*Q],A.depth[U]=(A.depth[X]>=A.depth[Q]?A.depth[X]:A.depth[Q])+1,J[2*X+1]=J[2*Q+1]=U,A.heap[1]=U++,dt(A,J,1),2<=A.heap_len;);A.heap[--A.heap_max]=A.heap[1],function(ut,St){var Zt,kt,Xt,wt,de,ie,Lt=St.dyn_tree,Fe=St.max_code,Ue=St.stat_desc.static_tree,un=St.stat_desc.has_stree,fn=St.stat_desc.extra_bits,We=St.stat_desc.extra_base,xt=St.stat_desc.max_length,Rt=0;for(wt=0;wt<=v;wt++)ut.bl_count[wt]=0;for(Lt[2*ut.heap[ut.heap_max]+1]=0,Zt=ut.heap_max+1;Zt<u;Zt++)xt<(wt=Lt[2*Lt[2*(kt=ut.heap[Zt])+1]+1]+1)&&(wt=xt,Rt++),Lt[2*kt+1]=wt,Fe<kt||(ut.bl_count[wt]++,de=0,We<=kt&&(de=fn[kt-We]),ie=Lt[2*kt],ut.opt_len+=ie*(wt+de),un&&(ut.static_len+=ie*(Ue[2*kt+1]+de)));if(Rt!==0){do{for(wt=xt-1;ut.bl_count[wt]===0;)wt--;ut.bl_count[wt]--,ut.bl_count[wt+1]+=2,ut.bl_count[xt]--,Rt-=2}while(0<Rt);for(wt=xt;wt!==0;wt--)for(kt=ut.bl_count[wt];kt!==0;)Fe<(Xt=ut.heap[--Zt])||(Lt[2*Xt+1]!==wt&&(ut.opt_len+=(wt-Lt[2*Xt+1])*Lt[2*Xt],Lt[2*Xt+1]=wt),kt--)}}(A,P),ot(J,ht,A.bl_count)}function h(A,P,X){var Q,U,J=-1,it=P[1],et=0,ct=7,ht=4;for(it===0&&(ct=138,ht=3),P[2*(X+1)+1]=65535,Q=0;Q<=X;Q++)U=it,it=P[2*(Q+1)+1],++et<ct&&U===it||(et<ht?A.bl_tree[2*U]+=et:U!==0?(U!==J&&A.bl_tree[2*U]++,A.bl_tree[2*_]++):et<=10?A.bl_tree[2*R]++:A.bl_tree[2*N]++,J=U,ht=(et=0)===it?(ct=138,3):U===it?(ct=6,3):(ct=7,4))}function H(A,P,X){var Q,U,J=-1,it=P[1],et=0,ct=7,ht=4;for(it===0&&(ct=138,ht=3),Q=0;Q<=X;Q++)if(U=it,it=P[2*(Q+1)+1],!(++et<ct&&U===it)){if(et<ht)for(;$(A,U,A.bl_tree),--et!=0;);else U!==0?(U!==J&&($(A,U,A.bl_tree),et--),$(A,_,A.bl_tree),V(A,et-3,2)):et<=10?($(A,R,A.bl_tree),V(A,et-3,3)):($(A,N,A.bl_tree),V(A,et-11,7));J=U,ht=(et=0)===it?(ct=138,3):U===it?(ct=6,3):(ct=7,4)}}l(B);var Y=!1;function D(A,P,X,Q){V(A,(f<<1)+(Q?1:0),3),function(U,J,it,et){K(U),Z(U,it),Z(U,~it),i.arraySet(U.pending_buf,U.window,J,it,U.pending),U.pending+=it}(A,P,X)}o._tr_init=function(A){Y||(function(){var P,X,Q,U,J,it=new Array(v+1);for(U=Q=0;U<c-1;U++)for(W[U]=Q,P=0;P<1<<I[U];P++)m[Q++]=U;for(m[Q-1]=U,U=J=0;U<16;U++)for(B[U]=J,P=0;P<1<<z[U];P++)k[J++]=U;for(J>>=7;U<d;U++)for(B[U]=J<<7,P=0;P<1<<z[U]-7;P++)k[256+J++]=U;for(X=0;X<=v;X++)it[X]=0;for(P=0;P<=143;)q[2*P+1]=8,P++,it[8]++;for(;P<=255;)q[2*P+1]=9,P++,it[9]++;for(;P<=279;)q[2*P+1]=7,P++,it[7]++;for(;P<=287;)q[2*P+1]=8,P++,it[8]++;for(ot(q,p+1,it),P=0;P<d;P++)S[2*P+1]=5,S[2*P]=lt(P,5);nt=new j(q,I,g+1,p,v),G=new j(S,z,0,d,v),F=new j(new Array(0),T,0,b,w)}(),Y=!0),A.l_desc=new E(A.dyn_ltree,nt),A.d_desc=new E(A.dyn_dtree,G),A.bl_desc=new E(A.bl_tree,F),A.bi_buf=0,A.bi_valid=0,tt(A)},o._tr_stored_block=D,o._tr_flush_block=function(A,P,X,Q){var U,J,it=0;0<A.level?(A.strm.data_type===2&&(A.strm.data_type=function(et){var ct,ht=4093624447;for(ct=0;ct<=31;ct++,ht>>>=1)if(1&ht&&et.dyn_ltree[2*ct]!==0)return a;if(et.dyn_ltree[18]!==0||et.dyn_ltree[20]!==0||et.dyn_ltree[26]!==0)return s;for(ct=32;ct<g;ct++)if(et.dyn_ltree[2*ct]!==0)return s;return a}(A)),_t(A,A.l_desc),_t(A,A.d_desc),it=function(et){var ct;for(h(et,et.dyn_ltree,et.l_desc.max_code),h(et,et.dyn_dtree,et.d_desc.max_code),_t(et,et.bl_desc),ct=b-1;3<=ct&&et.bl_tree[2*O[ct]+1]===0;ct--);return et.opt_len+=3*(ct+1)+5+5+4,ct}(A),U=A.opt_len+3+7>>>3,(J=A.static_len+3+7>>>3)<=U&&(U=J)):U=J=X+5,X+4<=U&&P!==-1?D(A,P,X,Q):A.strategy===4||J===U?(V(A,2+(Q?1:0),3),pt(A,q,S)):(V(A,4+(Q?1:0),3),function(et,ct,ht,ut){var St;for(V(et,ct-257,5),V(et,ht-1,5),V(et,ut-4,4),St=0;St<ut;St++)V(et,et.bl_tree[2*O[St]+1],3);H(et,et.dyn_ltree,ct-1),H(et,et.dyn_dtree,ht-1)}(A,A.l_desc.max_code+1,A.d_desc.max_code+1,it+1),pt(A,A.dyn_ltree,A.dyn_dtree)),tt(A),Q&&K(A)},o._tr_tally=function(A,P,X){return A.pending_buf[A.d_buf+2*A.last_lit]=P>>>8&255,A.pending_buf[A.d_buf+2*A.last_lit+1]=255&P,A.pending_buf[A.l_buf+A.last_lit]=255&X,A.last_lit++,P===0?A.dyn_ltree[2*X]++:(A.matches++,P--,A.dyn_ltree[2*(m[X]+g+1)]++,A.dyn_dtree[2*M(P)]++),A.last_lit===A.lit_bufsize-1},o._tr_align=function(A){V(A,2,3),$(A,x,q),function(P){P.bi_valid===16?(Z(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):8<=P.bi_valid&&(P.pending_buf[P.pending++]=255&P.bi_buf,P.bi_buf>>=8,P.bi_valid-=8)}(A)}},{"../utils/common":41}],53:[function(e,r,o){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,o){(function(i){(function(a,s){if(!a.setImmediate){var l,f,c,g,p=1,d={},b=!1,u=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(_){process.nextTick(function(){w(_)})}:function(){if(a.postMessage&&!a.importScripts){var _=!0,R=a.onmessage;return a.onmessage=function(){_=!1},a.postMessage("","*"),a.onmessage=R,_}}()?(g="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",x,!1):a.attachEvent("onmessage",x),function(_){a.postMessage(g+_,"*")}):a.MessageChannel?((c=new MessageChannel).port1.onmessage=function(_){w(_.data)},function(_){c.port2.postMessage(_)}):u&&"onreadystatechange"in u.createElement("script")?(f=u.documentElement,function(_){var R=u.createElement("script");R.onreadystatechange=function(){w(_),R.onreadystatechange=null,f.removeChild(R),R=null},f.appendChild(R)}):function(_){setTimeout(w,0,_)},v.setImmediate=function(_){typeof _!="function"&&(_=new Function(""+_));for(var R=new Array(arguments.length-1),N=0;N<R.length;N++)R[N]=arguments[N+1];var I={callback:_,args:R};return d[p]=I,l(p),p++},v.clearImmediate=y}function y(_){delete d[_]}function w(_){if(b)setTimeout(w,0,_);else{var R=d[_];if(R){b=!0;try{(function(N){var I=N.callback,z=N.args;switch(z.length){case 0:I();break;case 1:I(z[0]);break;case 2:I(z[0],z[1]);break;case 3:I(z[0],z[1],z[2]);break;default:I.apply(s,z)}})(R)}finally{y(_),b=!1}}}}function x(_){_.source===a&&typeof _.data=="string"&&_.data.indexOf(g)===0&&w(+_.data.slice(g.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof qe<"u"?qe:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(Wn)),Wn.exports}var ja=za();const sr=Co(ja);function La(t){const n=t?.toLowerCase()||"";return n.includes("jpeg")?"jpeg":n.includes("png")?"png":n.includes("webp")?"webp":n.includes("gif")?"gif":n.includes("bmp")?"bmp":n.includes("avif")?"avif":"jpg"}async function Ma(t){try{const n=await fetch(t,{cache:"no-store"});if(n.ok){const e=await n.blob();return{blob:e,mime:e.type||"image/jpeg"}}}catch{}try{const n=await Ba(t),{blob:e,mime:r}=await Pa(n);return{blob:e,mime:r}}catch{throw new Error("Unable to read image bytes (fetch/canvas failed).")}}function Ba(t){return new Promise((n,e)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>n(r),r.onerror=e,r.src=t})}function Pa(t){return new Promise((n,e)=>{const r=Math.max(1,t.naturalWidth||t.width||1),o=Math.max(1,t.naturalHeight||t.height||1),i=document.createElement("canvas");i.width=r,i.height=o;const a=i.getContext("2d");if(!a)return e(new Error("Canvas2D unavailable"));a.drawImage(t,0,0,r,o),i.toBlob(s=>{if(!s)return e(new Error("Canvas toBlob failed (tainted?)"));n({blob:s,mime:s.type||"image/png"})},"image/png",.92)})}async function Oa(t){const n=t?.imageFormat??"jpeg",e=Math.max(.5,Math.min(.95,t?.quality??.8)),r=bt.getState(),o=r.photos,i=o.length;let a=0;const s=new sr,l=s.folder("images");if(!l)throw new Error("ZIP: cannot create images/");const f={schemaVersion:1,createdAt:new Date().toISOString(),appConfigSnapshot:{MAX_CARDS:ri,CARD_EXPORT_SIZE:It,PREVIEW_EXACT_SIZE:Ke,PREVIEW_FAST_SIZE:na},images:[],cards:[]};for(let g=0;g<o.length;g++){const p=o[g];let d=null,b="image/jpeg";try{const _=await Ma(p.url);d=_.blob,b=_.mime||b}catch{d=null}if(d){const _=(d.type||"").toLowerCase();if(n==="jpeg"){if(!/jpe?g/.test(_)||e!==.8)try{d=await Ua(d,e),b="image/jpeg"}catch{}}else if(n==="png"&&!/png/.test(_))try{d=await Wa(d),b="image/png"}catch{}}const u=La(b),v=`images/${p.id}.${u}`;d?(l.file(`${p.id}.${u}`,d),f.images.push({id:p.id,path:v,mime:b,size:d.size,source:{type:"embedded"}})):f.images.push({id:p.id,path:v,mime:b,source:{type:"url"}});const y=r.transforms[p.id]??{scale:1,tx:0,ty:0},w=r.cardBackground?.[p.id],x=(r.layersByPhoto[p.id]??[]).map(Fa);f.cards.push({photoId:p.id,order:g,transform:y,background:w,layers:x}),a++,t?.onProgress?.({done:a,total:i})}return s.file("manifest.json",JSON.stringify(f,null,2)),await s.generateAsync({type:"blob",compression:"DEFLATE"})}function Fa(t){if(!t)return t;if(t.type==="image"&&t.qrText){const{src:n,...e}=t;return e}if(t.type==="image"&&typeof t.src=="string"&&t.src.startsWith("data:")){const{src:n,...e}=t;return e}return{...t}}async function ui(t){const n=URL.createObjectURL(t);try{return await new Promise((e,r)=>{const o=new Image;o.onload=()=>e(o),o.onerror=r,o.src=n})}finally{URL.revokeObjectURL(n)}}async function Ua(t,n){const e=await ui(t),r=document.createElement("canvas");r.width=Math.max(1,e.naturalWidth||e.width||1),r.height=Math.max(1,e.naturalHeight||e.height||1);const o=r.getContext("2d");if(!o)throw new Error("Canvas2D unavailable");o.drawImage(e,0,0);const i=r.toDataURL("image/jpeg",n);return await(await fetch(i)).blob()}async function Wa(t){const n=await ui(t),e=document.createElement("canvas");e.width=Math.max(1,n.naturalWidth||n.width||1),e.height=Math.max(1,n.naturalHeight||n.height||1);const r=e.getContext("2d");if(!r)throw new Error("Canvas2D unavailable");r.drawImage(n,0,0);const o=e.toDataURL("image/png");return await(await fetch(o)).blob()}async function fi(t){const n=[],e=await sr.loadAsync(t),r=e.file("manifest.json");if(!r)throw new Error("manifest.json not found in zip");const o=await r.async("string");let i;try{i=JSON.parse(o)}catch{throw new Error("manifest.json is not valid JSON")}if(i.schemaVersion!==1)throw new Error(`Unsupported schemaVersion: ${i.schemaVersion}`);const a=new Map;for(const p of i.images){const d=e.file(p.path);if(!d){n.push(`Image file missing in zip: ${p.path}`);continue}try{const b=await d.async("blob"),u=URL.createObjectURL(b);a.set(p.id,u)}catch{n.push(`Failed to read image: ${p.path}`)}}const s=[],l={},f={},c={},g=[...i.cards].sort((p,d)=>p.order-d.order);for(const p of g){const d=a.get(p.photoId);d?s.push({id:p.photoId,url:d}):(n.push(`Missing image for card photoId=${p.photoId}. Card will appear without photo.`),s.push({id:p.photoId,url:qa})),l[p.photoId]={...p.transform},p.background&&(c[p.photoId]={...p.background});const b=Array.isArray(p.layers)?p.layers.slice():[];for(const u of b)if(u&&u.type==="image"&&u.qrText&&!u.src){const v=Math.max(1,Math.round(u.w??u.h??512));u.src=await De(u.qrText,v,1),u.w==null&&(u.w=v),u.h==null&&(u.h=v)}f[p.photoId]=b}return bt.setState({photos:s,transforms:l,layersByPhoto:f,cardBackground:c}),{warnings:n}}const qa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=",Ae=Eo(t=>({busy:!1,busyText:void 0,progress:void 0,setBusy:(n,e,r)=>t({busy:n,busyText:n?e:void 0,progress:n?r:void 0}),start:n=>t({busy:!0,busyText:n??"Loading...",progress:0}),setProgress:(n,e)=>t(r=>({progress:Math.max(0,Math.min(100,n)),busyText:e??r.busyText})),stop:()=>t({busy:!1,busyText:void 0,progress:void 0})}));function Ya(){const t=L.useRef(null),n=L.useRef(null),e=L.useRef(null),r=bt(p=>p.photos),o=bt(p=>p.add),i=bt(p=>p.clear),a=L.useCallback(p=>{if(!p?.length)return;const d=Array.from(p),b=ta(d);o(b)},[o]),s=L.useCallback(p=>{a(p.target.files),p.target.value=""},[a]);async function l(p){const d=p.target.files?.[0];if(!d)return;const b=await d.text();p.target.value="";const{rows:u,hasRelative:v}=Ta(b);if(!u.length)return;if(v){alert("В этом CSV есть относительные пути. В текущей сборке локальная папка не поддерживается. Пожалуйста, используйте полные URL (http/https) или добавьте изображения кнопкой “Choose images”.");return}const y=Ae.getState();y.start("Importing CSV…");try{await g(u,null)}finally{y.stop()}}function f(p){return new Promise(d=>setTimeout(d,p))}async function c(p,d,b=4e3,u=50){const v=Date.now()+b,y=d.map(w=>w.toLowerCase());for(;Date.now()<v;){const x=bt.getState().layersByPhoto[p]??[],_=new Set(x.map(N=>typeof N?.name=="string"?N.name.toLowerCase():"").filter(Boolean));if(y.filter(N=>!_.has(N)).length===0)return[];await f(u)}return d}async function g(p,d){const b=Ae.getState(),u=bt.getState(),v=u.photos.length,y=u.max,w=Math.max(0,y-v);if(w<=0){alert(`Достигнут лимит коллекции: ${y} карточек.`);return}const x=Math.min(w,p.length);x<p.length&&alert(`Будут импортированы только ${x} из ${p.length} — лимит коллекции ${y}.`);const _=p.slice(0,x),R=[];let N=0,I=0;for(let k=0;k<_.length;k++){const m=_[k];try{let W=null,nt="image";if(ci(m.url)){const B=await fetch(m.url,{mode:"cors"});if(!B.ok)throw new Error(`HTTP ${B.status}`);W=await B.blob(),nt=m.url.split("/").pop()||nt}else if(di(m.url))W=await(await fetch(m.url)).blob(),nt="data.png";else throw new Error("Relative paths are disabled in this build");const G=URL.createObjectURL(W),F=crypto.randomUUID();R.push({id:F,url:G,name:nt}),N++}catch(W){console.warn("CSV import skip:",m.url,W),I++}b.setProgress(Math.round((k+1)/_.length*100),`Importing CSV… (${k+1}/${_.length})`)}const z=bt.getState().add;z(R);const q=bt.getState().photos.slice(v).map(k=>k.id),S=_.slice(0,q.length);for(let k=0;k<S.length;k++){const m=S[k],W=q[k];if(!m.layers)continue;const nt=Object.keys(m.layers).map(E=>E.toLowerCase());(await c(W,nt,4e3,50)).length;const F=bt.getState(),B=F.layersByPhoto[W]??[],j=E=>["x","y","w","h","width","height","fontSize","rotation","letterSpacing","lineHeight","padding","opacity","strokeWidth"].includes(E);for(const[E,M]of Object.entries(m.layers)){const Z=String(E).toLowerCase(),V=B.filter($=>typeof $?.name=="string"&&$.name.toLowerCase()===Z);if(V.length)for(const $ of V)for(const[lt,ot]of Object.entries(M)){const tt=lt;if($.type==="image"&&$.qrText!==void 0){if(tt==="text"){await F.updateQrLayer(W,$.id,{text:ot});continue}if(tt==="size"){const rt=parseInt(ot,10);Number.isNaN(rt)||await F.updateQrLayer(W,$.id,{size:rt});continue}}const K={};if(tt==="text"?K.text=ot:tt==="fill"?K.fill=ot:tt==="align"?K.align=ot:tt==="vertical_align"||tt==="verticalalign"?K.verticalAlign=ot:tt==="fontfamily"||tt==="font_family"?K.fontFamily=ot:(tt==="fontstyle"||tt==="font_style")&&(K.fontStyle=ot),j(tt)){const rt=parseFloat(ot);Number.isNaN(rt)||(K[tt]=rt)}Object.keys(K).length&&F.updateLayer(W,$.id,K)}}b.setProgress(Math.round((k+1)/S.length*100),`Applying CSV overrides… (${k+1}/${S.length})`)}I&&alert(`CSV import: добавлено ${N}, пропущено ${I}`)}return C.jsx("section",{className:"mt-4 space-y-4",children:C.jsxs("div",{className:"flex items-center justify-between gap-2",children:[C.jsxs("div",{className:"text-sm opacity-80",children:["Cards: ",C.jsx("b",{children:r.length})]}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx("input",{ref:t,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:s}),C.jsx("input",{ref:n,type:"file",accept:".csv,text/csv",className:"hidden",onChange:l}),C.jsx("input",{ref:e,type:"file",accept:".zip,application/zip",className:"hidden",onChange:async p=>{const d=p.currentTarget,b=d.files?.[0];if(d.value="",!!b)try{const{warnings:u}=await fi(b);u.length&&alert(`Import finished with warnings:
`+u.join(`
`))}catch(u){setTimeout(()=>{alert(`Cannot open .zip: ${u?.message??String(u)}`)},0)}}}),C.jsx(gt,{variant:"secondary",onClick:()=>e.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Open collection (.zip)"}),C.jsx("button",{onClick:()=>n.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Import CSV"}),C.jsx("button",{onClick:()=>t.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Choose images"}),C.jsx(gt,{variant:"destructive",onClick:i,disabled:!r.length,children:"Clear"})]})]})})}const hi=L.forwardRef(({className:t,...n},e)=>C.jsx("div",{ref:e,className:vt("rounded-xl border bg-card text-card-foreground shadow",t),...n}));hi.displayName="Card";const $a=L.forwardRef(({className:t,...n},e)=>C.jsx("div",{ref:e,className:vt("flex flex-col space-y-1.5 p-6",t),...n}));$a.displayName="CardHeader";const Ga=L.forwardRef(({className:t,...n},e)=>C.jsx("div",{ref:e,className:vt("font-semibold leading-none tracking-tight",t),...n}));Ga.displayName="CardTitle";const Va=L.forwardRef(({className:t,...n},e)=>C.jsx("div",{ref:e,className:vt("text-sm text-muted-foreground",t),...n}));Va.displayName="CardDescription";const Ha=L.forwardRef(({className:t,...n},e)=>C.jsx("div",{ref:e,className:vt("p-6 pt-0",t),...n}));Ha.displayName="CardContent";const Za=L.forwardRef(({className:t,...n},e)=>C.jsx("div",{ref:e,className:vt("flex items-center p-6 pt-0",t),...n}));Za.displayName="CardFooter";const ar=L.forwardRef(({className:t,value:n,...e},r)=>C.jsx(Io,{ref:r,className:vt("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...e,children:C.jsx(ts,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));ar.displayName=Io.displayName;const mi=ss,pi=as,lr=L.forwardRef(({className:t,children:n,...e},r)=>C.jsxs(To,{ref:r,className:vt("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...e,children:[n,C.jsx(es,{asChild:!0,children:C.jsx(So,{className:"h-4 w-4 opacity-50"})})]}));lr.displayName=To.displayName;const gi=L.forwardRef(({className:t,...n},e)=>C.jsx(Do,{ref:e,className:vt("flex cursor-default items-center justify-center py-1",t),...n,children:C.jsx(qi,{className:"h-4 w-4"})}));gi.displayName=Do.displayName;const bi=L.forwardRef(({className:t,...n},e)=>C.jsx(zo,{ref:e,className:vt("flex cursor-default items-center justify-center py-1",t),...n,children:C.jsx(So,{className:"h-4 w-4"})}));bi.displayName=zo.displayName;const cr=L.forwardRef(({className:t,children:n,position:e="popper",...r},o)=>C.jsx(ns,{children:C.jsxs(jo,{ref:o,className:vt("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:e,...r,children:[C.jsx(gi,{}),C.jsx(rs,{className:vt("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),C.jsx(bi,{})]})}));cr.displayName=jo.displayName;const Xa=L.forwardRef(({className:t,...n},e)=>C.jsx(Lo,{ref:e,className:vt("px-2 py-1.5 text-sm font-semibold",t),...n}));Xa.displayName=Lo.displayName;const pe=L.forwardRef(({className:t,children:n,...e},r)=>C.jsxs(Mo,{ref:r,className:vt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e,children:[C.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:C.jsx(os,{children:C.jsx(Yi,{className:"h-4 w-4"})})}),C.jsx(is,{children:n})]}));pe.displayName=Mo.displayName;const Ka=L.forwardRef(({className:t,...n},e)=>C.jsx(Bo,{ref:e,className:vt("-mx-1 my-1 h-px bg-muted",t),...n}));Ka.displayName=Bo.displayName;const Qa=[];function yi(t,n=""){const[e,r]=L.useState(null),[o,i]=L.useState("idle");return L.useEffect(()=>{if(!t){r(null),i("idle");return}let a=!1;const s=new Image;return n&&(s.crossOrigin=n),i("loading"),s.onload=()=>{a||(r(s),i("loaded"))},s.onerror=()=>{a||(r(null),i("failed"))},s.src=t,()=>{a=!0}},[t,n]),[e,o]}function Ja({layer:t,k:n,onSelect:e,updateLayer:r,selectedId:o,forwardRef:i,onReady:a}){const[s]=yi(t.src||"","anonymous"),l=o===t.id,f=L.useRef(null),c=l&&i?i:f;L.useEffect(()=>{s&&a?.()},[s]);const g=t.x*n,p=t.y*n,d=s?.naturalWidth??0,b=s?.naturalHeight??0,u=Math.max(1,t.w?t.w*n:d*n||1),v=Math.max(1,t.h?t.h*n:b*n||1);return C.jsx(Ro,{ref:c,draggable:!0,listening:!0,image:s??void 0,x:g,y:p,width:u,height:v,rotation:t.rotation,visible:t.visible,onMouseDown:()=>e(t.id),onTap:()=>e(t.id),onDragEnd:y=>{r(t.photoId,t.id,{x:y.target.x()/n,y:y.target.y()/n})},onTransformEnd:y=>{const w=y.target,x=typeof w.scaleX=="function"?w.scaleX():1,_=typeof w.scaleY=="function"?w.scaleY():1,R=typeof w.width=="function"?w.width():u,N=typeof w.height=="function"?w.height():v,I={x:w.x()/n,y:w.y()/n,rotation:w.rotation(),scaleX:1,scaleY:1,w:Math.max(1,Math.round(R*x/n)),h:Math.max(1,Math.round(N*_/n))};typeof w.scaleX=="function"&&w.scaleX(1),typeof w.scaleY=="function"&&w.scaleY(1),r(t.photoId,t.id,I)}},t.id)}const an=L.forwardRef(function({photoId:n,size:e,selectedId:r,onSelect:o,transformOverride:i,layersOverride:a,backgroundOverride:s,onLayerPatch:l,onTransformPatch:f},c){const p=L.useRef(null),d=bt(F=>F.photos.find(B=>B.id===n)?.url),b=bt(F=>F.transforms[n]??ae),u=bt(F=>F.setTransform),v=i??b,y=bt(F=>F.layersByPhoto[n]??Qa,Object.is).map(F=>({...F,photoId:n})),w=(a??y).map(F=>({...F,photoId:n})),x=s||bt(F=>F.cardBackground?.[n]??tn,Object.is),_=bt(F=>F.updateLayer),R=L.useCallback((F,B,j)=>{l?l(B,j):_(F,B,j)},[l,_]),[N,I]=yi(d??"","anonymous"),z=I==="loaded";L.useImperativeHandle(c,()=>({toDataURL:F=>{const B=p.current;if(!B)return null;const j=F&&F>0?F/e:1;return B.toDataURL({pixelRatio:j,mimeType:"image/png"})},isReady:()=>!!p.current&&z}));const T=L.useRef(null),O=L.useRef(null),[q,S]=L.useState(0),k=e/It,m=L.useMemo(()=>w.find(F=>F.id===r),[w,r]),W=!!(m?.type==="image"&&m?.qrText);L.useLayoutEffect(()=>{const F=T.current,B=O.current;F&&(r&&B?F.nodes([B]):F.nodes([]),F.getLayer()?.batchDraw())},[r,m?.id,w.length,q]);function nt(F,B,j){const E=B/F.width,M=B/F.height,V=Math.min(E,M)*(j?.scale??1),$=F.width*V,lt=F.height*V,ot=(B-$)/2+(j?.tx??0)/100*B,tt=(B-lt)/2+(j?.ty??0)/100*B;return{x:ot*k,y:tt*k,width:$*k,height:lt*k}}const G=L.useCallback(F=>{if(!(F.evt.ctrlKey||F.evt.metaKey))return;F.evt.preventDefault();const j=F.evt.deltaY||0;if(!Number.isFinite(j)||j===0)return;const E=Math.pow(1.0015,-j),M=v,Z=Math.max(.5,Math.min(4,M.scale*E));Z!==M.scale&&(f?f({scale:Z}):u(n,{scale:Z}))},[n,v,f,u]);return C.jsx($i,{ref:p,width:e,height:e,pixelRatio:1,listening:!0,style:{width:"100%",height:"100%"},onWheel:G,onMouseDown:F=>{F.target===F.target.getStage()&&o(null)},onTouchStart:F=>{F.target===F.target.getStage()&&o(null)},children:C.jsxs(Gi,{children:[C.jsx(Cr,{x:0,y:0,width:e,height:e,fill:x.color,opacity:x.alpha,listening:!1}),N?C.jsx(Ro,{image:N,...nt(N,It,v),listening:!1}):null,w.slice().sort((F,B)=>F.z-B.z).map(F=>{if(F.type==="text"){const B=F,E=r===B.id?O:void 0,M=B.x*k,Z=B.y*k,V=(B.fontSize??16)*k,$=B.width?B.width*k:void 0,lt=(B.padding??0)*k,ot=(B.letterSpacing??0)*k;return C.jsx(Vi,{ref:E,draggable:!0,x:M,y:Z,text:B.text,fontFamily:B.fontFamily||"Georgia, serif",fontSize:V,fontStyle:B.fontStyle,fill:B.fill,width:$,align:B.align,lineHeight:B.lineHeight??1.25,padding:lt,letterSpacing:ot,rotation:B.rotation,scaleX:1,scaleY:1,visible:B.visible,perfectDrawEnabled:!1,onTransform:tt=>{const K=tt.target,rt=typeof K.scaleX=="function"?K.scaleX():1,dt=typeof K.width=="function"?K.width():void 0;dt!==void 0&&rt&&rt!==1&&(K.width(Math.max(4,Math.round(dt*rt))),typeof K.scaleX=="function"&&K.scaleX(1),typeof K.scaleY=="function"&&K.scaleY(1),K.getLayer()?.batchDraw())},onMouseDown:()=>o(B.id),onTap:()=>o(B.id),onDragEnd:tt=>{R(n,B.id,{x:tt.target.x()/k,y:tt.target.y()/k})},onTransformEnd:tt=>{const K=tt.target,rt=typeof K.scaleX=="function"?K.scaleX():1,dt=typeof K.width=="function"?K.width():void 0,pt={x:K.x()/k,y:K.y()/k,rotation:K.rotation(),scaleX:1,scaleY:1,width:dt!==void 0?Math.max(4,Math.round(dt*rt/k)):void 0};typeof K.scaleX=="function"&&K.scaleX(1),typeof K.scaleY=="function"&&K.scaleY(1),R(n,B.id,pt)}},B.id)}if(F.type==="rect"){const B=F,E=r===B.id?O:void 0,M=B.x*k,Z=B.y*k,V=Math.max(1,(B.width??100)*k),$=Math.max(1,(B.height??100)*k),lt=Math.max(0,(B.strokeWidth??0)*k),ot=Math.max(0,(B.cornerRadius??0)*k);return C.jsx(Cr,{ref:E,draggable:!0,x:M,y:Z,width:V,height:$,rotation:B.rotation,fill:B.fill??"#ffffff",stroke:B.stroke,strokeWidth:lt,cornerRadius:ot,visible:B.visible,opacity:Math.max(0,Math.min(1,B.opacity??1)),onMouseDown:()=>o(B.id),onTap:()=>o(B.id),onDragEnd:tt=>{R(n,B.id,{x:tt.target.x()/k,y:tt.target.y()/k})},onTransformEnd:tt=>{const K=tt.target,rt=typeof K.scaleX=="function"?K.scaleX():1,dt=typeof K.scaleY=="function"?K.scaleY():1,pt=typeof K.width=="function"?K.width():V,_t=typeof K.height=="function"?K.height():$,h={x:K.x()/k,y:K.y()/k,rotation:K.rotation(),scaleX:1,scaleY:1,width:Math.max(1,Math.round(pt*rt/k)),height:Math.max(1,Math.round(_t*dt/k))};typeof K.scaleX=="function"&&K.scaleX(1),typeof K.scaleY=="function"&&K.scaleY(1),R(n,B.id,h)}},B.id)}if(F.type==="image"){const B=r===F.id;return C.jsx(Ja,{layer:F,k,selectedId:r,onSelect:o,updateLayer:R,forwardRef:B?O:void 0,onReady:()=>S(j=>j+1)},F.id)}return null}),r&&C.jsx(Hi,{ref:T,rotateEnabled:!0,enabledAnchors:["middle-left","middle-right","top-center","bottom-center","top-left","top-right","bottom-left","bottom-right"],borderStroke:"#fff",anchorStroke:"#fff",anchorFill:"#111",anchorSize:7,keepRatio:W,centeredScaling:!1,boundBoxFunc:(F,B)=>{const E=Math.max(6,B.width),M=Math.max(6,B.height);return{...B,width:E,height:M}}})]})})}),vi=ds,tl=ls,wi=L.forwardRef(({className:t,...n},e)=>C.jsx(Po,{ref:e,className:vt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));wi.displayName=Po.displayName;const dr=L.forwardRef(({className:t,children:n,...e},r)=>C.jsxs(tl,{children:[C.jsx(wi,{}),C.jsxs(Oo,{ref:r,className:vt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e,children:[n,C.jsxs(cs,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[C.jsx(Zi,{className:"h-4 w-4"}),C.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));dr.displayName=Oo.displayName;const ur=({className:t,...n})=>C.jsx("div",{className:vt("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});ur.displayName="DialogHeader";const fr=({className:t,...n})=>C.jsx("div",{className:vt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});fr.displayName="DialogFooter";const hr=L.forwardRef(({className:t,...n},e)=>C.jsx(Fo,{ref:e,className:vt("text-lg font-semibold leading-none tracking-tight",t),...n}));hr.displayName=Fo.displayName;const xi=L.forwardRef(({className:t,...n},e)=>C.jsx(Uo,{ref:e,className:vt("text-sm text-muted-foreground",t),...n}));xi.displayName=Uo.displayName;function el(t,n="card"){return(t.replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||n).slice(0,100)}function nl(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function rl({open:t,onOpenChange:n,photo:e,transform:r,layers:o,snapshot:i,onEdit:a}){const[s,l]=L.useState(null),[f,c]=L.useState(!1),g=L.useRef(null),[p,d]=L.useState(0);L.useEffect(()=>{const x=g.current;if(!x)return;const _=()=>d(Math.round(x.clientWidth));_();const R=new ResizeObserver(_);return R.observe(x),()=>R.disconnect()},[]);const b=L.useRef(null),[u,v]=L.useState(Ke),y=L.useMemo(()=>t?C.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:u,height:u,overflow:"hidden"},children:C.jsx(an,{ref:b,photoId:e.id,size:u,selectedId:null,onSelect:()=>{}})}):null,[t,e.id,u]);async function w(x){v(x),await new Promise(R=>setTimeout(R,0));try{const R=document;R?.fonts?.ready&&typeof R.fonts.ready.then=="function"&&await R.fonts.ready}catch{}const _=Date.now()+1e3;for(;!b.current?.isReady?.()&&!(Date.now()>_);)await new Promise(R=>setTimeout(R,30));return b.current?.toDataURL(x)??null}return L.useEffect(()=>{let x=!1;if(!t){l(null);return}return(async()=>{c(!0);const _=Math.max(Ke,p||Ke);let R=null;i&&(R=i(_)),R||(R=await w(_)),!x&&(l(R),c(!1))})(),()=>{x=!0}},[t,p,e.id,r.scale,r.tx,r.ty,o,i]),C.jsxs(vi,{"data-dnd-ignore":!0,open:t,onOpenChange:n,children:[y,C.jsxs(dr,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden",children:[C.jsx(ur,{children:C.jsx(us,{asChild:!0,children:C.jsx(hr,{children:"Preview"})})}),C.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:C.jsxs("div",{ref:g,className:"relative aspect-square overflow-hidden rounded-xl",children:[s?C.jsx("img",{src:s,alt:e.name,className:"absolute inset-0 w-full h-full object-contain"}):C.jsx("div",{className:"h-24"}),C.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${f?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!f,children:C.jsx("div",{className:"h-7 w-7 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]})}),C.jsxs(fr,{className:"mt-2 gap-2",children:[C.jsx(gt,{variant:"secondary",onClick:()=>{n(!1),a?.()},children:"Edit"}),C.jsx(gt,{variant:"secondary",onClick:()=>n(!1),children:"Close"}),C.jsx(gt,{onClick:async()=>{const x=i&&i(It)||await w(It);x&&nl(x,`${el(e.name||"card")}.png`)},children:"Save PNG"})]})]})]})}const qn=new Map;function en(t){const n=t.trim();if(n.startsWith('"')){const e=n.indexOf('"',1);return e>1?n.slice(1,e):n.replace(/["']/g,"")}return n.split(",")[0].replace(/["']/g,"").trim()}function ol(t){const n=en(t);return oi.find(e=>en(e.family).toLowerCase()===n.toLowerCase())}function il(t,n){if(document.getElementById(n))return;const e=document.createElement("link");e.id=n,e.rel="stylesheet",e.href=t;const r=document.createElement("link");r.rel="preconnect",r.href="https://fonts.googleapis.com";const o=document.createElement("link");o.rel="preconnect",o.href="https://fonts.gstatic.com",o.crossOrigin="anonymous",document.head.appendChild(r),document.head.appendChild(o),document.head.appendChild(e)}function sl(t){const n=en(t);if(qn.has(n))return qn.get(n);const e=(async()=>{const r=ol(t);r&&r.cssHref&&il(r.cssHref,`font-css-${r.id}`);try{const o=document;o?.fonts?.ready&&typeof o.fonts.ready.then=="function"&&await o.fonts.ready}catch{}try{document.fonts?.load&&await document.fonts.load(`1em ${en(t)}`)}catch{}})();return qn.set(n,e),e}async function al(t,n=It){const e=document.createElement("div");e.style.position="fixed",e.style.left="-10000px",e.style.top="-10000px",e.style.width=`${n}px`,e.style.height=`${n}px`,document.body.appendChild(e);const r=L.createRef(),o=Ao.createRoot(e);o.render(L.createElement(an,{ref:r,photoId:t,size:n,selectedId:null,onSelect:()=>{}})),await new Promise(s=>setTimeout(s,0));try{const s=document;s?.fonts?.ready&&typeof s.fonts.ready.then=="function"&&await s.fonts.ready}catch{}const i=Date.now()+1500;for(;!r.current?.isReady?.()&&!(Date.now()>i);)await new Promise(s=>setTimeout(s,25));const a=r.current?.toDataURL(n)??"";return o.unmount(),e.remove(),a}async function _i(t,n=It){return al(t,n)}function ll(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function cl({photo:t}){const n=bt(N=>N.remove),e=bt(N=>N.transforms[t.id]??ae),r=bt(N=>N.layersByPhoto),[o,i]=L.useState(!1),[a,s]=L.useState(!1),l=No(),f=L.useRef(null),[c,g]=L.useState(0);L.useEffect(()=>{const N=f.current;if(!N)return;const I=()=>g(N.clientWidth);I();const z=new ResizeObserver(I);return z.observe(N),()=>z.disconnect()},[]);const p=L.useRef(null),[d,b]=L.useState(512),u=C.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:d,height:d,overflow:"hidden"},children:C.jsx(an,{ref:p,photoId:t.id,size:d,selectedId:null,onSelect:()=>{}})}),[v,y]=L.useState(null),[w,x]=L.useState(!0),_=L.useRef(null);L.useEffect(()=>{if(o)return;const N=window.devicePixelRatio||1,I=Math.max(384,Math.min(1024,Math.round((c||300)*N)));return b(I),_.current&&window.clearTimeout(_.current),_.current=window.setTimeout(async()=>{x(!0);try{const O=document;O?.fonts?.ready&&typeof O.fonts.ready.then=="function"&&await O.fonts.ready}catch{}const z=Date.now()+800;for(;!p.current?.isReady?.()&&!(Date.now()>z);)await new Promise(O=>setTimeout(O,25));const T=p.current?.toDataURL(I)??null;y(T),x(!1)},150),()=>{_.current&&(window.clearTimeout(_.current),_.current=null)}},[c,o,t.id,e.scale,e.tx,e.ty,r[t.id]]);const R=L.useCallback(async()=>{const N=await _i(t.id,It);if(!N)return;const z=(t.name||"card").replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||"card";ll(N,`${z}.png`)},[t.id,t.name]);return C.jsxs(C.Fragment,{children:[u,C.jsxs("div",{className:"overflow-hidden rounded-xl border border-foreground/15 bg-foreground/[0.02]",children:[C.jsxs("div",{ref:f,onClick:()=>s(!0),className:"relative aspect-square w-full overflow-hidden cursor-zoom-in",children:[C.jsx("button",{"aria-label":"Remove image",title:"Remove",onClick:N=>{N.stopPropagation(),n(t.id)},className:"absolute right-1 top-1 z-10 rounded-md bg-background/80 px-1.5 py-0.5 text-[11px] shadow hover:bg-background",children:"×"}),v?C.jsx("img",{src:v,alt:t.name,className:"h-full w-full object-cover"}):C.jsx("div",{className:"h-full w-full bg-foreground/[0.06]"}),C.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${w?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!w,children:C.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]}),C.jsxs("div",{className:"flex items-center justify-between gap-2 border-t bg-background/70 px-2 py-1.5 supports-[backdrop-filter]:bg-background/60",children:[C.jsx("button",{"aria-label":"Edit card",title:"Edit",onClick:N=>{N.stopPropagation(),i(!0),l(`/edit/${t.id}`)},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Edit"}),C.jsx("button",{"aria-label":"Save PNG",title:"Save PNG",onClick:N=>{N.stopPropagation(),R()},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Save PNG"})]})]}),C.jsx(rl,{open:a,onOpenChange:s,photo:t,transform:e,layers:r[t.id],onEdit:()=>l(`/edit/${t.id}`)})]})}function dl(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return L.useMemo(()=>r=>{n.forEach(o=>o(r))},n)}const ln=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ve(t){const n=Object.prototype.toString.call(t);return n==="[object Window]"||n==="[object global]"}function mr(t){return"nodeType"in t}function Dt(t){var n,e;return t?ve(t)?t:mr(t)&&(n=(e=t.ownerDocument)==null?void 0:e.defaultView)!=null?n:window:window}function pr(t){const{Document:n}=Dt(t);return t instanceof n}function Me(t){return ve(t)?!1:t instanceof Dt(t).HTMLElement}function ki(t){return t instanceof Dt(t).SVGElement}function we(t){return t?ve(t)?t.document:mr(t)?pr(t)?t:Me(t)||ki(t)?t.ownerDocument:document:document:document}const Yt=ln?L.useLayoutEffect:L.useEffect;function gr(t){const n=L.useRef(t);return Yt(()=>{n.current=t}),L.useCallback(function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return n.current==null?void 0:n.current(...r)},[])}function ul(){const t=L.useRef(null),n=L.useCallback((r,o)=>{t.current=setInterval(r,o)},[]),e=L.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[n,e]}function ze(t,n){n===void 0&&(n=[t]);const e=L.useRef(t);return Yt(()=>{e.current!==t&&(e.current=t)},n),e}function Be(t,n){const e=L.useRef();return L.useMemo(()=>{const r=t(e.current);return e.current=r,r},[...n])}function nn(t){const n=gr(t),e=L.useRef(null),r=L.useCallback(o=>{o!==e.current&&n?.(o,e.current),e.current=o},[]);return[e,r]}function Jn(t){const n=L.useRef();return L.useEffect(()=>{n.current=t},[t]),n.current}let Yn={};function Pe(t,n){return L.useMemo(()=>{if(n)return n;const e=Yn[t]==null?0:Yn[t]+1;return Yn[t]=e,t+"-"+e},[t,n])}function Ci(t){return function(n){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return r.reduce((i,a)=>{const s=Object.entries(a);for(const[l,f]of s){const c=i[l];c!=null&&(i[l]=c+t*f)}return i},{...n})}}const ge=Ci(1),rn=Ci(-1);function fl(t){return"clientX"in t&&"clientY"in t}function br(t){if(!t)return!1;const{KeyboardEvent:n}=Dt(t.target);return n&&t instanceof n}function hl(t){if(!t)return!1;const{TouchEvent:n}=Dt(t.target);return n&&t instanceof n}function tr(t){if(hl(t)){if(t.touches&&t.touches.length){const{clientX:n,clientY:e}=t.touches[0];return{x:n,y:e}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:n,clientY:e}=t.changedTouches[0];return{x:n,y:e}}}return fl(t)?{x:t.clientX,y:t.clientY}:null}const je=Object.freeze({Translate:{toString(t){if(!t)return;const{x:n,y:e}=t;return"translate3d("+(n?Math.round(n):0)+"px, "+(e?Math.round(e):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:n,scaleY:e}=t;return"scaleX("+n+") scaleY("+e+")"}},Transform:{toString(t){if(t)return[je.Translate.toString(t),je.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:n,duration:e,easing:r}=t;return n+" "+e+"ms "+r}}}),co="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ml(t){return t.matches(co)?t:t.querySelector(co)}const pl={display:"none"};function gl(t){let{id:n,value:e}=t;return Tt.createElement("div",{id:n,style:pl},e)}function bl(t){let{id:n,announcement:e,ariaLiveType:r="assertive"}=t;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Tt.createElement("div",{id:n,style:o,role:"status","aria-live":r,"aria-atomic":!0},e)}function yl(){const[t,n]=L.useState("");return{announce:L.useCallback(r=>{r!=null&&n(r)},[]),announcement:t}}const Ei=L.createContext(null);function vl(t){const n=L.useContext(Ei);L.useEffect(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(t)},[t,n])}function wl(){const[t]=L.useState(()=>new Set),n=L.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[L.useCallback(r=>{let{type:o,event:i}=r;t.forEach(a=>{var s;return(s=a[o])==null?void 0:s.call(a,i)})},[t]),n]}const xl={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},_l={onDragStart(t){let{active:n}=t;return"Picked up draggable item "+n.id+"."},onDragOver(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was moved over droppable area "+e.id+".":"Draggable item "+n.id+" is no longer over a droppable area."},onDragEnd(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was dropped over droppable area "+e.id:"Draggable item "+n.id+" was dropped."},onDragCancel(t){let{active:n}=t;return"Dragging was cancelled. Draggable item "+n.id+" was dropped."}};function kl(t){let{announcements:n=_l,container:e,hiddenTextDescribedById:r,screenReaderInstructions:o=xl}=t;const{announce:i,announcement:a}=yl(),s=Pe("DndLiveRegion"),[l,f]=L.useState(!1);if(L.useEffect(()=>{f(!0)},[]),vl(L.useMemo(()=>({onDragStart(g){let{active:p}=g;i(n.onDragStart({active:p}))},onDragMove(g){let{active:p,over:d}=g;n.onDragMove&&i(n.onDragMove({active:p,over:d}))},onDragOver(g){let{active:p,over:d}=g;i(n.onDragOver({active:p,over:d}))},onDragEnd(g){let{active:p,over:d}=g;i(n.onDragEnd({active:p,over:d}))},onDragCancel(g){let{active:p,over:d}=g;i(n.onDragCancel({active:p,over:d}))}}),[i,n])),!l)return null;const c=Tt.createElement(Tt.Fragment,null,Tt.createElement(gl,{id:r,value:o.draggable}),Tt.createElement(bl,{id:s,announcement:a}));return e?Re.createPortal(c,e):c}var Et;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Et||(Et={}));function on(){}function uo(t,n){return L.useMemo(()=>({sensor:t,options:n??{}}),[t,n])}function Cl(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return L.useMemo(()=>[...n].filter(r=>r!=null),[...n])}const Ot=Object.freeze({x:0,y:0});function El(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function Sl(t,n){let{data:{value:e}}=t,{data:{value:r}}=n;return e-r}function Rl(t,n){let{data:{value:e}}=t,{data:{value:r}}=n;return r-e}function Al(t,n){if(!t||t.length===0)return null;const[e]=t;return e[n]}function fo(t,n,e){return n===void 0&&(n=t.left),e===void 0&&(e=t.top),{x:n+t.width*.5,y:e+t.height*.5}}const Nl=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:r}=t;const o=fo(n,n.left,n.top),i=[];for(const a of r){const{id:s}=a,l=e.get(s);if(l){const f=El(fo(l),o);i.push({id:s,data:{droppableContainer:a,value:f}})}}return i.sort(Sl)};function Il(t,n){const e=Math.max(n.top,t.top),r=Math.max(n.left,t.left),o=Math.min(n.left+n.width,t.left+t.width),i=Math.min(n.top+n.height,t.top+t.height),a=o-r,s=i-e;if(r<o&&e<i){const l=n.width*n.height,f=t.width*t.height,c=a*s,g=c/(l+f-c);return Number(g.toFixed(4))}return 0}const Tl=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:r}=t;const o=[];for(const i of r){const{id:a}=i,s=e.get(a);if(s){const l=Il(s,n);l>0&&o.push({id:a,data:{droppableContainer:i,value:l}})}}return o.sort(Rl)};function Dl(t,n,e){return{...t,scaleX:n&&e?n.width/e.width:1,scaleY:n&&e?n.height/e.height:1}}function Si(t,n){return t&&n?{x:t.left-n.left,y:t.top-n.top}:Ot}function zl(t){return function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.reduce((a,s)=>({...a,top:a.top+t*s.y,bottom:a.bottom+t*s.y,left:a.left+t*s.x,right:a.right+t*s.x}),{...e})}}const jl=zl(1);function Ll(t){if(t.startsWith("matrix3d(")){const n=t.slice(9,-1).split(/, /);return{x:+n[12],y:+n[13],scaleX:+n[0],scaleY:+n[5]}}else if(t.startsWith("matrix(")){const n=t.slice(7,-1).split(/, /);return{x:+n[4],y:+n[5],scaleX:+n[0],scaleY:+n[3]}}return null}function Ml(t,n,e){const r=Ll(n);if(!r)return t;const{scaleX:o,scaleY:i,x:a,y:s}=r,l=t.left-a-(1-o)*parseFloat(e),f=t.top-s-(1-i)*parseFloat(e.slice(e.indexOf(" ")+1)),c=o?t.width/o:t.width,g=i?t.height/i:t.height;return{width:c,height:g,top:f,right:l+c,bottom:f+g,left:l}}const Bl={ignoreTransform:!1};function xe(t,n){n===void 0&&(n=Bl);let e=t.getBoundingClientRect();if(n.ignoreTransform){const{transform:f,transformOrigin:c}=Dt(t).getComputedStyle(t);f&&(e=Ml(e,f,c))}const{top:r,left:o,width:i,height:a,bottom:s,right:l}=e;return{top:r,left:o,width:i,height:a,bottom:s,right:l}}function ho(t){return xe(t,{ignoreTransform:!0})}function Pl(t){const n=t.innerWidth,e=t.innerHeight;return{top:0,left:0,right:n,bottom:e,width:n,height:e}}function Ol(t,n){return n===void 0&&(n=Dt(t).getComputedStyle(t)),n.position==="fixed"}function Fl(t,n){n===void 0&&(n=Dt(t).getComputedStyle(t));const e=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=n[o];return typeof i=="string"?e.test(i):!1})}function yr(t,n){const e=[];function r(o){if(n!=null&&e.length>=n||!o)return e;if(pr(o)&&o.scrollingElement!=null&&!e.includes(o.scrollingElement))return e.push(o.scrollingElement),e;if(!Me(o)||ki(o)||e.includes(o))return e;const i=Dt(t).getComputedStyle(o);return o!==t&&Fl(o,i)&&e.push(o),Ol(o,i)?e:r(o.parentNode)}return t?r(t):e}function Ri(t){const[n]=yr(t,1);return n??null}function $n(t){return!ln||!t?null:ve(t)?t:mr(t)?pr(t)||t===we(t).scrollingElement?window:Me(t)?t:null:null}function Ai(t){return ve(t)?t.scrollX:t.scrollLeft}function Ni(t){return ve(t)?t.scrollY:t.scrollTop}function er(t){return{x:Ai(t),y:Ni(t)}}var At;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(At||(At={}));function Ii(t){return!ln||!t?!1:t===document.scrollingElement}function Ti(t){const n={x:0,y:0},e=Ii(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-e.width,y:t.scrollHeight-e.height},o=t.scrollTop<=n.y,i=t.scrollLeft<=n.x,a=t.scrollTop>=r.y,s=t.scrollLeft>=r.x;return{isTop:o,isLeft:i,isBottom:a,isRight:s,maxScroll:r,minScroll:n}}const Ul={x:.2,y:.2};function Wl(t,n,e,r,o){let{top:i,left:a,right:s,bottom:l}=e;r===void 0&&(r=10),o===void 0&&(o=Ul);const{isTop:f,isBottom:c,isLeft:g,isRight:p}=Ti(t),d={x:0,y:0},b={x:0,y:0},u={height:n.height*o.y,width:n.width*o.x};return!f&&i<=n.top+u.height?(d.y=At.Backward,b.y=r*Math.abs((n.top+u.height-i)/u.height)):!c&&l>=n.bottom-u.height&&(d.y=At.Forward,b.y=r*Math.abs((n.bottom-u.height-l)/u.height)),!p&&s>=n.right-u.width?(d.x=At.Forward,b.x=r*Math.abs((n.right-u.width-s)/u.width)):!g&&a<=n.left+u.width&&(d.x=At.Backward,b.x=r*Math.abs((n.left+u.width-a)/u.width)),{direction:d,speed:b}}function ql(t){if(t===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:n,left:e,right:r,bottom:o}=t.getBoundingClientRect();return{top:n,left:e,right:r,bottom:o,width:t.clientWidth,height:t.clientHeight}}function Di(t){return t.reduce((n,e)=>ge(n,er(e)),Ot)}function Yl(t){return t.reduce((n,e)=>n+Ai(e),0)}function $l(t){return t.reduce((n,e)=>n+Ni(e),0)}function Gl(t,n){if(n===void 0&&(n=xe),!t)return;const{top:e,left:r,bottom:o,right:i}=n(t);Ri(t)&&(o<=0||i<=0||e>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const Vl=[["x",["left","right"],Yl],["y",["top","bottom"],$l]];class vr{constructor(n,e){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=yr(e),o=Di(r);this.rect={...n},this.width=n.width,this.height=n.height;for(const[i,a,s]of Vl)for(const l of a)Object.defineProperty(this,l,{get:()=>{const f=s(r),c=o[i]-f;return this.rect[l]+c},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ne{constructor(n){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...e)})},this.target=n}add(n,e,r){var o;(o=this.target)==null||o.addEventListener(n,e,r),this.listeners.push([n,e,r])}}function Hl(t){const{EventTarget:n}=Dt(t);return t instanceof n?t:we(t)}function Gn(t,n){const e=Math.abs(t.x),r=Math.abs(t.y);return typeof n=="number"?Math.sqrt(e**2+r**2)>n:"x"in n&&"y"in n?e>n.x&&r>n.y:"x"in n?e>n.x:"y"in n?r>n.y:!1}var Bt;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Bt||(Bt={}));function mo(t){t.preventDefault()}function Zl(t){t.stopPropagation()}var mt;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(mt||(mt={}));const zi={start:[mt.Space,mt.Enter],cancel:[mt.Esc],end:[mt.Space,mt.Enter,mt.Tab]},Xl=(t,n)=>{let{currentCoordinates:e}=n;switch(t.code){case mt.Right:return{...e,x:e.x+25};case mt.Left:return{...e,x:e.x-25};case mt.Down:return{...e,y:e.y+25};case mt.Up:return{...e,y:e.y-25}}};class ji{constructor(n){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=n;const{event:{target:e}}=n;this.props=n,this.listeners=new Ne(we(e)),this.windowListeners=new Ne(Dt(e)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Bt.Resize,this.handleCancel),this.windowListeners.add(Bt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Bt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:n,onStart:e}=this.props,r=n.node.current;r&&Gl(r),e(Ot)}handleKeyDown(n){if(br(n)){const{active:e,context:r,options:o}=this.props,{keyboardCodes:i=zi,coordinateGetter:a=Xl,scrollBehavior:s="smooth"}=o,{code:l}=n;if(i.end.includes(l)){this.handleEnd(n);return}if(i.cancel.includes(l)){this.handleCancel(n);return}const{collisionRect:f}=r.current,c=f?{x:f.left,y:f.top}:Ot;this.referenceCoordinates||(this.referenceCoordinates=c);const g=a(n,{active:e,context:r.current,currentCoordinates:c});if(g){const p=rn(g,c),d={x:0,y:0},{scrollableAncestors:b}=r.current;for(const u of b){const v=n.code,{isTop:y,isRight:w,isLeft:x,isBottom:_,maxScroll:R,minScroll:N}=Ti(u),I=ql(u),z={x:Math.min(v===mt.Right?I.right-I.width/2:I.right,Math.max(v===mt.Right?I.left:I.left+I.width/2,g.x)),y:Math.min(v===mt.Down?I.bottom-I.height/2:I.bottom,Math.max(v===mt.Down?I.top:I.top+I.height/2,g.y))},T=v===mt.Right&&!w||v===mt.Left&&!x,O=v===mt.Down&&!_||v===mt.Up&&!y;if(T&&z.x!==g.x){const q=u.scrollLeft+p.x,S=v===mt.Right&&q<=R.x||v===mt.Left&&q>=N.x;if(S&&!p.y){u.scrollTo({left:q,behavior:s});return}S?d.x=u.scrollLeft-q:d.x=v===mt.Right?u.scrollLeft-R.x:u.scrollLeft-N.x,d.x&&u.scrollBy({left:-d.x,behavior:s});break}else if(O&&z.y!==g.y){const q=u.scrollTop+p.y,S=v===mt.Down&&q<=R.y||v===mt.Up&&q>=N.y;if(S&&!p.x){u.scrollTo({top:q,behavior:s});return}S?d.y=u.scrollTop-q:d.y=v===mt.Down?u.scrollTop-R.y:u.scrollTop-N.y,d.y&&u.scrollBy({top:-d.y,behavior:s});break}}this.handleMove(n,ge(rn(g,this.referenceCoordinates),d))}}}handleMove(n,e){const{onMove:r}=this.props;n.preventDefault(),r(e)}handleEnd(n){const{onEnd:e}=this.props;n.preventDefault(),this.detach(),e()}handleCancel(n){const{onCancel:e}=this.props;n.preventDefault(),this.detach(),e()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ji.activators=[{eventName:"onKeyDown",handler:(t,n,e)=>{let{keyboardCodes:r=zi,onActivation:o}=n,{active:i}=e;const{code:a}=t.nativeEvent;if(r.start.includes(a)){const s=i.activatorNode.current;return s&&t.target!==s?!1:(t.preventDefault(),o?.({event:t.nativeEvent}),!0)}return!1}}];function po(t){return!!(t&&"distance"in t)}function go(t){return!!(t&&"delay"in t)}class wr{constructor(n,e,r){var o;r===void 0&&(r=Hl(n.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=n,this.events=e;const{event:i}=n,{target:a}=i;this.props=n,this.events=e,this.document=we(a),this.documentListeners=new Ne(this.document),this.listeners=new Ne(r),this.windowListeners=new Ne(Dt(a)),this.initialCoordinates=(o=tr(i))!=null?o:Ot,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:n,props:{options:{activationConstraint:e,bypassActivationConstraint:r}}}=this;if(this.listeners.add(n.move.name,this.handleMove,{passive:!1}),this.listeners.add(n.end.name,this.handleEnd),n.cancel&&this.listeners.add(n.cancel.name,this.handleCancel),this.windowListeners.add(Bt.Resize,this.handleCancel),this.windowListeners.add(Bt.DragStart,mo),this.windowListeners.add(Bt.VisibilityChange,this.handleCancel),this.windowListeners.add(Bt.ContextMenu,mo),this.documentListeners.add(Bt.Keydown,this.handleKeydown),e){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(go(e)){this.timeoutId=setTimeout(this.handleStart,e.delay),this.handlePending(e);return}if(po(e)){this.handlePending(e);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(n,e){const{active:r,onPending:o}=this.props;o(r,n,this.initialCoordinates,e)}handleStart(){const{initialCoordinates:n}=this,{onStart:e}=this.props;n&&(this.activated=!0,this.documentListeners.add(Bt.Click,Zl,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Bt.SelectionChange,this.removeTextSelection),e(n))}handleMove(n){var e;const{activated:r,initialCoordinates:o,props:i}=this,{onMove:a,options:{activationConstraint:s}}=i;if(!o)return;const l=(e=tr(n))!=null?e:Ot,f=rn(o,l);if(!r&&s){if(po(s)){if(s.tolerance!=null&&Gn(f,s.tolerance))return this.handleCancel();if(Gn(f,s.distance))return this.handleStart()}if(go(s)&&Gn(f,s.tolerance))return this.handleCancel();this.handlePending(s,f);return}n.cancelable&&n.preventDefault(),a(l)}handleEnd(){const{onAbort:n,onEnd:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleCancel(){const{onAbort:n,onCancel:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleKeydown(n){n.code===mt.Esc&&this.handleCancel()}removeTextSelection(){var n;(n=this.document.getSelection())==null||n.removeAllRanges()}}const Kl={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class xr extends wr{constructor(n){const{event:e}=n,r=we(e.target);super(n,Kl,r)}}xr.activators=[{eventName:"onPointerDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;return!e.isPrimary||e.button!==0?!1:(r?.({event:e}),!0)}}];const Ql={move:{name:"mousemove"},end:{name:"mouseup"}};var nr;(function(t){t[t.RightClick=2]="RightClick"})(nr||(nr={}));class Jl extends wr{constructor(n){super(n,Ql,we(n.event.target))}}Jl.activators=[{eventName:"onMouseDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;return e.button===nr.RightClick?!1:(r?.({event:e}),!0)}}];const Vn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Li extends wr{constructor(n){super(n,Vn)}static setup(){return window.addEventListener(Vn.move.name,n,{capture:!1,passive:!1}),function(){window.removeEventListener(Vn.move.name,n)};function n(){}}}Li.activators=[{eventName:"onTouchStart",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;const{touches:o}=e;return o.length>1?!1:(r?.({event:e}),!0)}}];var Ie;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Ie||(Ie={}));var sn;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(sn||(sn={}));function tc(t){let{acceleration:n,activator:e=Ie.Pointer,canScroll:r,draggingRect:o,enabled:i,interval:a=5,order:s=sn.TreeOrder,pointerCoordinates:l,scrollableAncestors:f,scrollableAncestorRects:c,delta:g,threshold:p}=t;const d=nc({delta:g,disabled:!i}),[b,u]=ul(),v=L.useRef({x:0,y:0}),y=L.useRef({x:0,y:0}),w=L.useMemo(()=>{switch(e){case Ie.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Ie.DraggableRect:return o}},[e,o,l]),x=L.useRef(null),_=L.useCallback(()=>{const N=x.current;if(!N)return;const I=v.current.x*y.current.x,z=v.current.y*y.current.y;N.scrollBy(I,z)},[]),R=L.useMemo(()=>s===sn.TreeOrder?[...f].reverse():f,[s,f]);L.useEffect(()=>{if(!i||!f.length||!w){u();return}for(const N of R){if(r?.(N)===!1)continue;const I=f.indexOf(N),z=c[I];if(!z)continue;const{direction:T,speed:O}=Wl(N,z,w,n,p);for(const q of["x","y"])d[q][T[q]]||(O[q]=0,T[q]=0);if(O.x>0||O.y>0){u(),x.current=N,b(_,a),v.current=O,y.current=T;return}}v.current={x:0,y:0},y.current={x:0,y:0},u()},[n,_,r,u,i,a,JSON.stringify(w),JSON.stringify(d),b,f,R,c,JSON.stringify(p)])}const ec={x:{[At.Backward]:!1,[At.Forward]:!1},y:{[At.Backward]:!1,[At.Forward]:!1}};function nc(t){let{delta:n,disabled:e}=t;const r=Jn(n);return Be(o=>{if(e||!r||!o)return ec;const i={x:Math.sign(n.x-r.x),y:Math.sign(n.y-r.y)};return{x:{[At.Backward]:o.x[At.Backward]||i.x===-1,[At.Forward]:o.x[At.Forward]||i.x===1},y:{[At.Backward]:o.y[At.Backward]||i.y===-1,[At.Forward]:o.y[At.Forward]||i.y===1}}},[e,n,r])}function rc(t,n){const e=n!=null?t.get(n):void 0,r=e?e.node.current:null;return Be(o=>{var i;return n==null?null:(i=r??o)!=null?i:null},[r,n])}function oc(t,n){return L.useMemo(()=>t.reduce((e,r)=>{const{sensor:o}=r,i=o.activators.map(a=>({eventName:a.eventName,handler:n(a.handler,r)}));return[...e,...i]},[]),[t,n])}var Le;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Le||(Le={}));var rr;(function(t){t.Optimized="optimized"})(rr||(rr={}));const bo=new Map;function ic(t,n){let{dragging:e,dependencies:r,config:o}=n;const[i,a]=L.useState(null),{frequency:s,measure:l,strategy:f}=o,c=L.useRef(t),g=v(),p=ze(g),d=L.useCallback(function(y){y===void 0&&(y=[]),!p.current&&a(w=>w===null?y:w.concat(y.filter(x=>!w.includes(x))))},[p]),b=L.useRef(null),u=Be(y=>{if(g&&!e)return bo;if(!y||y===bo||c.current!==t||i!=null){const w=new Map;for(let x of t){if(!x)continue;if(i&&i.length>0&&!i.includes(x.id)&&x.rect.current){w.set(x.id,x.rect.current);continue}const _=x.node.current,R=_?new vr(l(_),_):null;x.rect.current=R,R&&w.set(x.id,R)}return w}return y},[t,i,e,g,l]);return L.useEffect(()=>{c.current=t},[t]),L.useEffect(()=>{g||d()},[e,g]),L.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),L.useEffect(()=>{g||typeof s!="number"||b.current!==null||(b.current=setTimeout(()=>{d(),b.current=null},s))},[s,g,d,...r]),{droppableRects:u,measureDroppableContainers:d,measuringScheduled:i!=null};function v(){switch(f){case Le.Always:return!1;case Le.BeforeDragging:return e;default:return!e}}}function Mi(t,n){return Be(e=>t?e||(typeof n=="function"?n(t):t):null,[n,t])}function sc(t,n){return Mi(t,n)}function ac(t){let{callback:n,disabled:e}=t;const r=gr(n),o=L.useMemo(()=>{if(e||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,e]);return L.useEffect(()=>()=>o?.disconnect(),[o]),o}function cn(t){let{callback:n,disabled:e}=t;const r=gr(n),o=L.useMemo(()=>{if(e||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[e]);return L.useEffect(()=>()=>o?.disconnect(),[o]),o}function lc(t){return new vr(xe(t),t)}function yo(t,n,e){n===void 0&&(n=lc);const[r,o]=L.useState(null);function i(){o(l=>{if(!t)return null;if(t.isConnected===!1){var f;return(f=l??e)!=null?f:null}const c=n(t);return JSON.stringify(l)===JSON.stringify(c)?l:c})}const a=ac({callback(l){if(t)for(const f of l){const{type:c,target:g}=f;if(c==="childList"&&g instanceof HTMLElement&&g.contains(t)){i();break}}}}),s=cn({callback:i});return Yt(()=>{i(),t?(s?.observe(t),a?.observe(document.body,{childList:!0,subtree:!0})):(s?.disconnect(),a?.disconnect())},[t]),r}function cc(t){const n=Mi(t);return Si(t,n)}const vo=[];function dc(t){const n=L.useRef(t),e=Be(r=>t?r&&r!==vo&&t&&n.current&&t.parentNode===n.current.parentNode?r:yr(t):vo,[t]);return L.useEffect(()=>{n.current=t},[t]),e}function uc(t){const[n,e]=L.useState(null),r=L.useRef(t),o=L.useCallback(i=>{const a=$n(i.target);a&&e(s=>s?(s.set(a,er(a)),new Map(s)):null)},[]);return L.useEffect(()=>{const i=r.current;if(t!==i){a(i);const s=t.map(l=>{const f=$n(l);return f?(f.addEventListener("scroll",o,{passive:!0}),[f,er(f)]):null}).filter(l=>l!=null);e(s.length?new Map(s):null),r.current=t}return()=>{a(t),a(i)};function a(s){s.forEach(l=>{const f=$n(l);f?.removeEventListener("scroll",o)})}},[o,t]),L.useMemo(()=>t.length?n?Array.from(n.values()).reduce((i,a)=>ge(i,a),Ot):Di(t):Ot,[t,n])}function wo(t,n){n===void 0&&(n=[]);const e=L.useRef(null);return L.useEffect(()=>{e.current=null},n),L.useEffect(()=>{const r=t!==Ot;r&&!e.current&&(e.current=t),!r&&e.current&&(e.current=null)},[t]),e.current?rn(t,e.current):Ot}function fc(t){L.useEffect(()=>{if(!ln)return;const n=t.map(e=>{let{sensor:r}=e;return r.setup==null?void 0:r.setup()});return()=>{for(const e of n)e?.()}},t.map(n=>{let{sensor:e}=n;return e}))}function hc(t,n){return L.useMemo(()=>t.reduce((e,r)=>{let{eventName:o,handler:i}=r;return e[o]=a=>{i(a,n)},e},{}),[t,n])}function Bi(t){return L.useMemo(()=>t?Pl(t):null,[t])}const xo=[];function mc(t,n){n===void 0&&(n=xe);const[e]=t,r=Bi(e?Dt(e):null),[o,i]=L.useState(xo);function a(){i(()=>t.length?t.map(l=>Ii(l)?r:new vr(n(l),l)):xo)}const s=cn({callback:a});return Yt(()=>{s?.disconnect(),a(),t.forEach(l=>s?.observe(l))},[t]),o}function pc(t){if(!t)return null;if(t.children.length>1)return t;const n=t.children[0];return Me(n)?n:t}function gc(t){let{measure:n}=t;const[e,r]=L.useState(null),o=L.useCallback(f=>{for(const{target:c}of f)if(Me(c)){r(g=>{const p=n(c);return g?{...g,width:p.width,height:p.height}:p});break}},[n]),i=cn({callback:o}),a=L.useCallback(f=>{const c=pc(f);i?.disconnect(),c&&i?.observe(c),r(c?n(c):null)},[n,i]),[s,l]=nn(a);return L.useMemo(()=>({nodeRef:s,rect:e,setRef:l}),[e,s,l])}const bc=[{sensor:xr,options:{}},{sensor:ji,options:{}}],yc={current:{}},Qe={draggable:{measure:ho},droppable:{measure:ho,strategy:Le.WhileDragging,frequency:rr.Optimized},dragOverlay:{measure:xe}};class Te extends Map{get(n){var e;return n!=null&&(e=super.get(n))!=null?e:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(n=>{let{disabled:e}=n;return!e})}getNodeFor(n){var e,r;return(e=(r=this.get(n))==null?void 0:r.node.current)!=null?e:void 0}}const vc={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Te,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:on},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Qe,measureDroppableContainers:on,windowRect:null,measuringScheduled:!1},wc={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:on,draggableNodes:new Map,over:null,measureDroppableContainers:on},dn=L.createContext(wc),Pi=L.createContext(vc);function xc(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Te}}}function _c(t,n){switch(n.type){case Et.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:n.initialCoordinates,active:n.active}};case Et.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:n.coordinates.x-t.draggable.initialCoordinates.x,y:n.coordinates.y-t.draggable.initialCoordinates.y}}};case Et.DragEnd:case Et.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Et.RegisterDroppable:{const{element:e}=n,{id:r}=e,o=new Te(t.droppable.containers);return o.set(r,e),{...t,droppable:{...t.droppable,containers:o}}}case Et.SetDroppableDisabled:{const{id:e,key:r,disabled:o}=n,i=t.droppable.containers.get(e);if(!i||r!==i.key)return t;const a=new Te(t.droppable.containers);return a.set(e,{...i,disabled:o}),{...t,droppable:{...t.droppable,containers:a}}}case Et.UnregisterDroppable:{const{id:e,key:r}=n,o=t.droppable.containers.get(e);if(!o||r!==o.key)return t;const i=new Te(t.droppable.containers);return i.delete(e),{...t,droppable:{...t.droppable,containers:i}}}default:return t}}function kc(t){let{disabled:n}=t;const{active:e,activatorEvent:r,draggableNodes:o}=L.useContext(dn),i=Jn(r),a=Jn(e?.id);return L.useEffect(()=>{if(!n&&!r&&i&&a!=null){if(!br(i)||document.activeElement===i.target)return;const s=o.get(a);if(!s)return;const{activatorNode:l,node:f}=s;if(!l.current&&!f.current)return;requestAnimationFrame(()=>{for(const c of[l.current,f.current]){if(!c)continue;const g=ml(c);if(g){g.focus();break}}})}},[r,n,o,a,i]),null}function Cc(t,n){let{transform:e,...r}=n;return t!=null&&t.length?t.reduce((o,i)=>i({transform:o,...r}),e):e}function Ec(t){return L.useMemo(()=>({draggable:{...Qe.draggable,...t?.draggable},droppable:{...Qe.droppable,...t?.droppable},dragOverlay:{...Qe.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function Sc(t){let{activeNode:n,measure:e,initialRect:r,config:o=!0}=t;const i=L.useRef(!1),{x:a,y:s}=typeof o=="boolean"?{x:o,y:o}:o;Yt(()=>{if(!a&&!s||!n){i.current=!1;return}if(i.current||!r)return;const f=n?.node.current;if(!f||f.isConnected===!1)return;const c=e(f),g=Si(c,r);if(a||(g.x=0),s||(g.y=0),i.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const p=Ri(f);p&&p.scrollBy({top:g.y,left:g.x})}},[n,a,s,r,e])}const Oi=L.createContext({...Ot,scaleX:1,scaleY:1});var oe;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(oe||(oe={}));const Rc=L.memo(function(n){var e,r,o,i;let{id:a,accessibility:s,autoScroll:l=!0,children:f,sensors:c=bc,collisionDetection:g=Tl,measuring:p,modifiers:d,...b}=n;const u=L.useReducer(_c,void 0,xc),[v,y]=u,[w,x]=wl(),[_,R]=L.useState(oe.Uninitialized),N=_===oe.Initialized,{draggable:{active:I,nodes:z,translate:T},droppable:{containers:O}}=v,q=I!=null?z.get(I):null,S=L.useRef({initial:null,translated:null}),k=L.useMemo(()=>{var xt;return I!=null?{id:I,data:(xt=q?.data)!=null?xt:yc,rect:S}:null},[I,q]),m=L.useRef(null),[W,nt]=L.useState(null),[G,F]=L.useState(null),B=ze(b,Object.values(b)),j=Pe("DndDescribedBy",a),E=L.useMemo(()=>O.getEnabled(),[O]),M=Ec(p),{droppableRects:Z,measureDroppableContainers:V,measuringScheduled:$}=ic(E,{dragging:N,dependencies:[T.x,T.y],config:M.droppable}),lt=rc(z,I),ot=L.useMemo(()=>G?tr(G):null,[G]),tt=We(),K=sc(lt,M.draggable.measure);Sc({activeNode:I!=null?z.get(I):null,config:tt.layoutShiftCompensation,initialRect:K,measure:M.draggable.measure});const rt=yo(lt,M.draggable.measure,K),dt=yo(lt?lt.parentElement:null),pt=L.useRef({activatorEvent:null,active:null,activeNode:lt,collisionRect:null,collisions:null,droppableRects:Z,draggableNodes:z,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),_t=O.getNodeFor((e=pt.current.over)==null?void 0:e.id),h=gc({measure:M.dragOverlay.measure}),H=(r=h.nodeRef.current)!=null?r:lt,Y=N?(o=h.rect)!=null?o:rt:null,D=!!(h.nodeRef.current&&h.rect),A=cc(D?null:rt),P=Bi(H?Dt(H):null),X=dc(N?_t??lt:null),Q=mc(X),U=Cc(d,{transform:{x:T.x-A.x,y:T.y-A.y,scaleX:1,scaleY:1},activatorEvent:G,active:k,activeNodeRect:rt,containerNodeRect:dt,draggingNodeRect:Y,over:pt.current.over,overlayNodeRect:h.rect,scrollableAncestors:X,scrollableAncestorRects:Q,windowRect:P}),J=ot?ge(ot,T):null,it=uc(X),et=wo(it),ct=wo(it,[rt]),ht=ge(U,et),ut=Y?jl(Y,U):null,St=k&&ut?g({active:k,collisionRect:ut,droppableRects:Z,droppableContainers:E,pointerCoordinates:J}):null,Zt=Al(St,"id"),[kt,Xt]=L.useState(null),wt=D?U:ge(U,ct),de=Dl(wt,(i=kt?.rect)!=null?i:null,rt),ie=L.useRef(null),Lt=L.useCallback((xt,Rt)=>{let{sensor:zt,options:Kt}=Rt;if(m.current==null)return;const Mt=z.get(m.current);if(!Mt)return;const jt=xt.nativeEvent,Ft=new zt({active:m.current,activeNode:Mt,event:jt,options:Kt,context:pt,onAbort(Nt){if(!z.get(Nt))return;const{onDragAbort:Ut}=B.current,$t={id:Nt};Ut?.($t),w({type:"onDragAbort",event:$t})},onPending(Nt,Qt,Ut,$t){if(!z.get(Nt))return;const{onDragPending:ke}=B.current,Jt={id:Nt,constraint:Qt,initialCoordinates:Ut,offset:$t};ke?.(Jt),w({type:"onDragPending",event:Jt})},onStart(Nt){const Qt=m.current;if(Qt==null)return;const Ut=z.get(Qt);if(!Ut)return;const{onDragStart:$t}=B.current,_e={activatorEvent:jt,active:{id:Qt,data:Ut.data,rect:S}};Re.unstable_batchedUpdates(()=>{$t?.(_e),R(oe.Initializing),y({type:Et.DragStart,initialCoordinates:Nt,active:Qt}),w({type:"onDragStart",event:_e}),nt(ie.current),F(jt)})},onMove(Nt){y({type:Et.DragMove,coordinates:Nt})},onEnd:ue(Et.DragEnd),onCancel:ue(Et.DragCancel)});ie.current=Ft;function ue(Nt){return async function(){const{active:Ut,collisions:$t,over:_e,scrollAdjustedTranslate:ke}=pt.current;let Jt=null;if(Ut&&ke){const{cancelDrop:Ce}=B.current;Jt={activatorEvent:jt,active:Ut,collisions:$t,delta:ke,over:_e},Nt===Et.DragEnd&&typeof Ce=="function"&&await Promise.resolve(Ce(Jt))&&(Nt=Et.DragCancel)}m.current=null,Re.unstable_batchedUpdates(()=>{y({type:Nt}),R(oe.Uninitialized),Xt(null),nt(null),F(null),ie.current=null;const Ce=Nt===Et.DragEnd?"onDragEnd":"onDragCancel";if(Jt){const hn=B.current[Ce];hn?.(Jt),w({type:Ce,event:Jt})}})}}},[z]),Fe=L.useCallback((xt,Rt)=>(zt,Kt)=>{const Mt=zt.nativeEvent,jt=z.get(Kt);if(m.current!==null||!jt||Mt.dndKit||Mt.defaultPrevented)return;const Ft={active:jt};xt(zt,Rt.options,Ft)===!0&&(Mt.dndKit={capturedBy:Rt.sensor},m.current=Kt,Lt(zt,Rt))},[z,Lt]),Ue=oc(c,Fe);fc(c),Yt(()=>{rt&&_===oe.Initializing&&R(oe.Initialized)},[rt,_]),L.useEffect(()=>{const{onDragMove:xt}=B.current,{active:Rt,activatorEvent:zt,collisions:Kt,over:Mt}=pt.current;if(!Rt||!zt)return;const jt={active:Rt,activatorEvent:zt,collisions:Kt,delta:{x:ht.x,y:ht.y},over:Mt};Re.unstable_batchedUpdates(()=>{xt?.(jt),w({type:"onDragMove",event:jt})})},[ht.x,ht.y]),L.useEffect(()=>{const{active:xt,activatorEvent:Rt,collisions:zt,droppableContainers:Kt,scrollAdjustedTranslate:Mt}=pt.current;if(!xt||m.current==null||!Rt||!Mt)return;const{onDragOver:jt}=B.current,Ft=Kt.get(Zt),ue=Ft&&Ft.rect.current?{id:Ft.id,rect:Ft.rect.current,data:Ft.data,disabled:Ft.disabled}:null,Nt={active:xt,activatorEvent:Rt,collisions:zt,delta:{x:Mt.x,y:Mt.y},over:ue};Re.unstable_batchedUpdates(()=>{Xt(ue),jt?.(Nt),w({type:"onDragOver",event:Nt})})},[Zt]),Yt(()=>{pt.current={activatorEvent:G,active:k,activeNode:lt,collisionRect:ut,collisions:St,droppableRects:Z,draggableNodes:z,draggingNode:H,draggingNodeRect:Y,droppableContainers:O,over:kt,scrollableAncestors:X,scrollAdjustedTranslate:ht},S.current={initial:Y,translated:ut}},[k,lt,St,ut,z,H,Y,Z,O,kt,X,ht]),tc({...tt,delta:T,draggingRect:ut,pointerCoordinates:J,scrollableAncestors:X,scrollableAncestorRects:Q});const un=L.useMemo(()=>({active:k,activeNode:lt,activeNodeRect:rt,activatorEvent:G,collisions:St,containerNodeRect:dt,dragOverlay:h,draggableNodes:z,droppableContainers:O,droppableRects:Z,over:kt,measureDroppableContainers:V,scrollableAncestors:X,scrollableAncestorRects:Q,measuringConfiguration:M,measuringScheduled:$,windowRect:P}),[k,lt,rt,G,St,dt,h,z,O,Z,kt,V,X,Q,M,$,P]),fn=L.useMemo(()=>({activatorEvent:G,activators:Ue,active:k,activeNodeRect:rt,ariaDescribedById:{draggable:j},dispatch:y,draggableNodes:z,over:kt,measureDroppableContainers:V}),[G,Ue,k,rt,y,j,z,kt,V]);return Tt.createElement(Ei.Provider,{value:x},Tt.createElement(dn.Provider,{value:fn},Tt.createElement(Pi.Provider,{value:un},Tt.createElement(Oi.Provider,{value:de},f)),Tt.createElement(kc,{disabled:s?.restoreFocus===!1})),Tt.createElement(kl,{...s,hiddenTextDescribedById:j}));function We(){const xt=W?.autoScrollEnabled===!1,Rt=typeof l=="object"?l.enabled===!1:l===!1,zt=N&&!xt&&!Rt;return typeof l=="object"?{...l,enabled:zt}:{enabled:zt}}}),Ac=L.createContext(null),_o="button",Nc="Draggable";function Ic(t){let{id:n,data:e,disabled:r=!1,attributes:o}=t;const i=Pe(Nc),{activators:a,activatorEvent:s,active:l,activeNodeRect:f,ariaDescribedById:c,draggableNodes:g,over:p}=L.useContext(dn),{role:d=_o,roleDescription:b="draggable",tabIndex:u=0}=o??{},v=l?.id===n,y=L.useContext(v?Oi:Ac),[w,x]=nn(),[_,R]=nn(),N=hc(a,n),I=ze(e);Yt(()=>(g.set(n,{id:n,key:i,node:w,activatorNode:_,data:I}),()=>{const T=g.get(n);T&&T.key===i&&g.delete(n)}),[g,n]);const z=L.useMemo(()=>({role:d,tabIndex:u,"aria-disabled":r,"aria-pressed":v&&d===_o?!0:void 0,"aria-roledescription":b,"aria-describedby":c.draggable}),[r,d,u,v,b,c.draggable]);return{active:l,activatorEvent:s,activeNodeRect:f,attributes:z,isDragging:v,listeners:r?void 0:N,node:w,over:p,setNodeRef:x,setActivatorNodeRef:R,transform:y}}function Tc(){return L.useContext(Pi)}const Dc="Droppable",zc={timeout:25};function jc(t){let{data:n,disabled:e=!1,id:r,resizeObserverConfig:o}=t;const i=Pe(Dc),{active:a,dispatch:s,over:l,measureDroppableContainers:f}=L.useContext(dn),c=L.useRef({disabled:e}),g=L.useRef(!1),p=L.useRef(null),d=L.useRef(null),{disabled:b,updateMeasurementsFor:u,timeout:v}={...zc,...o},y=ze(u??r),w=L.useCallback(()=>{if(!g.current){g.current=!0;return}d.current!=null&&clearTimeout(d.current),d.current=setTimeout(()=>{f(Array.isArray(y.current)?y.current:[y.current]),d.current=null},v)},[v]),x=cn({callback:w,disabled:b||!a}),_=L.useCallback((z,T)=>{x&&(T&&(x.unobserve(T),g.current=!1),z&&x.observe(z))},[x]),[R,N]=nn(_),I=ze(n);return L.useEffect(()=>{!x||!R.current||(x.disconnect(),g.current=!1,x.observe(R.current))},[R,x]),L.useEffect(()=>(s({type:Et.RegisterDroppable,element:{id:r,key:i,disabled:e,node:R,rect:p,data:I}}),()=>s({type:Et.UnregisterDroppable,key:i,id:r})),[r]),L.useEffect(()=>{e!==c.current.disabled&&(s({type:Et.SetDroppableDisabled,id:r,key:i,disabled:e}),c.current.disabled=e)},[r,i,e,s]),{active:a,rect:p,isOver:l?.id===r,node:R,over:l,setNodeRef:N}}function _r(t,n,e){const r=t.slice();return r.splice(e<0?r.length+e:e,0,r.splice(n,1)[0]),r}function Lc(t,n){return t.reduce((e,r,o)=>{const i=n.get(r);return i&&(e[o]=i),e},Array(t.length))}function Ze(t){return t!==null&&t>=0}function Mc(t,n){if(t===n)return!0;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function Bc(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const kr=t=>{let{rects:n,activeIndex:e,overIndex:r,index:o}=t;const i=_r(n,r,e),a=n[o],s=i[o];return!s||!a?null:{x:s.left-a.left,y:s.top-a.top,scaleX:s.width/a.width,scaleY:s.height/a.height}},Fi="Sortable",Ui=Tt.createContext({activeIndex:-1,containerId:Fi,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:kr,disabled:{draggable:!1,droppable:!1}});function Pc(t){let{children:n,id:e,items:r,strategy:o=kr,disabled:i=!1}=t;const{active:a,dragOverlay:s,droppableRects:l,over:f,measureDroppableContainers:c}=Tc(),g=Pe(Fi,e),p=s.rect!==null,d=L.useMemo(()=>r.map(N=>typeof N=="object"&&"id"in N?N.id:N),[r]),b=a!=null,u=a?d.indexOf(a.id):-1,v=f?d.indexOf(f.id):-1,y=L.useRef(d),w=!Mc(d,y.current),x=v!==-1&&u===-1||w,_=Bc(i);Yt(()=>{w&&b&&c(d)},[w,d,b,c]),L.useEffect(()=>{y.current=d},[d]);const R=L.useMemo(()=>({activeIndex:u,containerId:g,disabled:_,disableTransforms:x,items:d,overIndex:v,useDragOverlay:p,sortedRects:Lc(d,l),strategy:o}),[u,g,_.draggable,_.droppable,x,d,v,l,p,o]);return Tt.createElement(Ui.Provider,{value:R},n)}const Oc=t=>{let{id:n,items:e,activeIndex:r,overIndex:o}=t;return _r(e,r,o).indexOf(n)},Fc=t=>{let{containerId:n,isSorting:e,wasDragging:r,index:o,items:i,newIndex:a,previousItems:s,previousContainerId:l,transition:f}=t;return!f||!r||s!==i&&o===a?!1:e?!0:a!==o&&n===l},Uc={duration:200,easing:"ease"},Wi="transform",Wc=je.Transition.toString({property:Wi,duration:0,easing:"linear"}),qc={roleDescription:"sortable"};function Yc(t){let{disabled:n,index:e,node:r,rect:o}=t;const[i,a]=L.useState(null),s=L.useRef(e);return Yt(()=>{if(!n&&e!==s.current&&r.current){const l=o.current;if(l){const f=xe(r.current,{ignoreTransform:!0}),c={x:l.left-f.left,y:l.top-f.top,scaleX:l.width/f.width,scaleY:l.height/f.height};(c.x||c.y)&&a(c)}}e!==s.current&&(s.current=e)},[n,e,r,o]),L.useEffect(()=>{i&&a(null)},[i]),i}function $c(t){let{animateLayoutChanges:n=Fc,attributes:e,disabled:r,data:o,getNewIndex:i=Oc,id:a,strategy:s,resizeObserverConfig:l,transition:f=Uc}=t;const{items:c,containerId:g,activeIndex:p,disabled:d,disableTransforms:b,sortedRects:u,overIndex:v,useDragOverlay:y,strategy:w}=L.useContext(Ui),x=Gc(r,d),_=c.indexOf(a),R=L.useMemo(()=>({sortable:{containerId:g,index:_,items:c},...o}),[g,o,_,c]),N=L.useMemo(()=>c.slice(c.indexOf(a)),[c,a]),{rect:I,node:z,isOver:T,setNodeRef:O}=jc({id:a,data:R,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...l}}),{active:q,activatorEvent:S,activeNodeRect:k,attributes:m,setNodeRef:W,listeners:nt,isDragging:G,over:F,setActivatorNodeRef:B,transform:j}=Ic({id:a,data:R,attributes:{...qc,...e},disabled:x.draggable}),E=dl(O,W),M=!!q,Z=M&&!b&&Ze(p)&&Ze(v),V=!y&&G,$=V&&Z?j:null,ot=Z?$??(s??w)({rects:u,activeNodeRect:k,activeIndex:p,overIndex:v,index:_}):null,tt=Ze(p)&&Ze(v)?i({id:a,items:c,activeIndex:p,overIndex:v}):_,K=q?.id,rt=L.useRef({activeId:K,items:c,newIndex:tt,containerId:g}),dt=c!==rt.current.items,pt=n({active:q,containerId:g,isDragging:G,isSorting:M,id:a,index:_,items:c,newIndex:rt.current.newIndex,previousItems:rt.current.items,previousContainerId:rt.current.containerId,transition:f,wasDragging:rt.current.activeId!=null}),_t=Yc({disabled:!pt,index:_,node:z,rect:I});return L.useEffect(()=>{M&&rt.current.newIndex!==tt&&(rt.current.newIndex=tt),g!==rt.current.containerId&&(rt.current.containerId=g),c!==rt.current.items&&(rt.current.items=c)},[M,tt,g,c]),L.useEffect(()=>{if(K===rt.current.activeId)return;if(K!=null&&rt.current.activeId==null){rt.current.activeId=K;return}const H=setTimeout(()=>{rt.current.activeId=K},50);return()=>clearTimeout(H)},[K]),{active:q,activeIndex:p,attributes:m,data:R,rect:I,index:_,newIndex:tt,items:c,isOver:T,isSorting:M,isDragging:G,listeners:nt,node:z,overIndex:v,over:F,setNodeRef:E,setActivatorNodeRef:B,setDroppableNodeRef:O,setDraggableNodeRef:W,transform:_t??ot,transition:h()};function h(){if(_t||dt&&rt.current.newIndex===_)return Wc;if(!(V&&!br(S)||!f)&&(M||pt))return je.Transition.toString({...f,property:Wi})}}function Gc(t,n){var e,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(e=t?.draggable)!=null?e:n.draggable,droppable:(r=t?.droppable)!=null?r:n.droppable}}mt.Down,mt.Right,mt.Up,mt.Left;function Vc({id:t,children:n}){const{attributes:e,listeners:r,setNodeRef:o,transform:i,transition:a,isDragging:s,isSorting:l}=$c({id:t}),f={transform:je.Translate.toString(i),transition:a,position:"relative",zIndex:s?9999:l?2:1,cursor:s?"grabbing":"grab",touchAction:"none"};return C.jsx("div",{ref:o,style:f,...e,...r,children:n})}async function Hc(t,n={}){const e=n.format??"png",r=Math.max(.5,Math.min(.95,n.quality??.8)),o=new sr,i=o.folder("images");if(!i)throw new Error("ZIP: cannot create images/");for(let a=0;a<t.length;a++){const s=await _i(t[a].id,It),l=e==="jpeg"?await Xc(s,r):s,f=e==="jpeg"?"jpg":"png",c=`card-${String(a+1).padStart(3,"0")}.${f}`;i.file(c,Zc(l)),n.onProgress?.({done:a+1,total:t.length})}return o.generateAsync({type:"blob",compression:"DEFLATE"})}function Zc(t){const n=t.indexOf(","),e=t.slice(n+1),r=atob(e),o=new Uint8Array(r.length);for(let i=0;i<r.length;i++)o[i]=r.charCodeAt(i);return o}async function Xc(t,n){const e=await Kc(t),r=document.createElement("canvas");r.width=Math.max(1,e.naturalWidth||e.width||1),r.height=Math.max(1,e.naturalHeight||e.height||1);const o=r.getContext("2d");if(!o)throw new Error("Canvas2D unavailable");return o.drawImage(e,0,0),r.toDataURL("image/jpeg",n)}function Kc(t){return new Promise((n,e)=>{const r=new Image;r.onload=()=>n(r),r.onerror=e,r.src=t})}function ko(t){const n=t/1e3;return n<60?`${n.toFixed(1)}s`:`${Math.floor(n/60)}m ${(n%60).toFixed(0)}s`}class Qc extends xr{static activators=[{eventName:"onPointerDown",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}class Jc extends Li{static activators=[{eventName:"onTouchStart",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}function td(){const t=bt(_=>_.photos),n=bt(_=>_.reorderPhotos),[e,r]=L.useState(!1),[o,i]=L.useState(null),a=L.useRef(!1),[s,l]=L.useState("jpeg"),[f,c]=L.useState(ra*100),g=o?.pct??0,p=L.useMemo(()=>{if(!o)return"";const _=o.etaMs??0;return`Rendering ${o.done}/${o.total} • ${g}% • elapsed ${ko(o.elapsedMs)}${o.done<o.total?` • ETA ${ko(_)}`:""}`},[o,g]);L.useEffect(()=>{o&&o.done>=o.total&&i(null)},[o]);const d=L.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{r(!0),i({done:0,total:t.length,elapsedMs:0,pct:0});const _=performance.now(),R=await Hc(t,{format:s,quality:s==="jpeg"?f/100:void 0,onProgress:({done:z,total:T})=>{const O=performance.now()-_,q=Math.round(z/T*100);i({done:z,total:T,elapsedMs:O,pct:q})}}),N=URL.createObjectURL(R),I=document.createElement("a");I.href=N,I.download="story-squares-images.zip",document.body.appendChild(I),I.click(),I.remove(),URL.revokeObjectURL(N)}finally{r(!1),a.current=!1}}},[t,s,f]),b=L.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{r(!0);const{exportCardsToPdf:_}=await ps(async()=>{const{exportCardsToPdf:T}=await import("./pdf-7PivIdT5.js");return{exportCardsToPdf:T}},__vite__mapDeps([0,1,2,3])),R=await _(t,{format:s,quality:s==="jpeg"?f/100:void 0,onProgress:T=>i(T)}),N=new Blob([R],{type:"application/pdf"}),I=URL.createObjectURL(N),z=document.createElement("a");z.href=I,z.download="story-squares.pdf",document.body.appendChild(z),z.click(),z.remove(),URL.revokeObjectURL(I)}finally{r(!1),a.current=!1}}},[t,s,f]),u=L.useCallback(async()=>{r(!0);try{const _=await Oa({imageFormat:s,quality:s==="jpeg"?f/100:void 0,onProgress:({done:I,total:z})=>i({done:I,total:z,elapsedMs:0,pct:Math.round(I/z*100)})}),R=URL.createObjectURL(_),N=document.createElement("a");N.href=R,N.download="story-squares.zip",document.body.appendChild(N),N.click(),N.remove(),URL.revokeObjectURL(R)}finally{r(!1)}},[s,f]),v=Tt.useRef(null),y=L.useCallback(async _=>{try{const{warnings:R}=await fi(_);R.length&&alert(`Import finished with warnings:
`+R.join(`
`))}catch(R){alert("Import failed: "+(R?.message||String(R)))}},[]),w=Cl(uo(Qc,{activationConstraint:{distance:6}}),uo(Jc,{activationConstraint:{delay:120,tolerance:6}})),x=t.map(_=>_.id);return C.jsxs("section",{className:"space-y-3",children:[C.jsx(Rc,{sensors:w,collisionDetection:Nl,onDragEnd:({active:_,over:R})=>{if(!R||_.id===R.id)return;const N=x.indexOf(String(_.id)),I=x.indexOf(String(R.id));if(N===-1||I===-1)return;const z=_r(x,N,I);n(z)},children:C.jsx(Pc,{items:x,strategy:kr,children:C.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:t.map(_=>C.jsx(Vc,{id:_.id,children:C.jsx(cl,{photo:_})},_.id))})})}),t.length>0&&C.jsxs(hi,{className:"p-4",children:[C.jsx("div",{className:"mb-3 text-sm font-medium",children:"Export the collection to..."}),o&&C.jsxs(C.Fragment,{children:[C.jsx(ar,{value:g,className:"mb-1 h-2"}),C.jsx("div",{className:"mb-3 text-xs opacity-70",children:p})]}),C.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("span",{className:"opacity-70",children:"Format"}),C.jsxs(mi,{value:s,onValueChange:_=>l(_),children:[C.jsx(lr,{className:"w-28 h-8",children:C.jsx(pi,{placeholder:"Format"})}),C.jsxs(cr,{children:[C.jsx(pe,{value:"jpeg",children:"JPEG (small)"}),C.jsx(pe,{value:"png",children:"PNG (lossless)"})]})]})]}),s==="jpeg"&&C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("span",{className:"opacity-70",children:"Quality"}),C.jsx("input",{type:"range",min:50,max:95,step:5,value:f,onChange:_=>c(Number(_.target.value))}),C.jsxs("span",{className:"tabular-nums",children:[f,"%"]})]}),C.jsx("div",{className:"grow"}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx(gt,{type:"button",size:"sm",onClick:u,disabled:!t.length||e,children:"Save collection (.zip)"}),C.jsx("input",{ref:v,type:"file",accept:".zip,application/zip",className:"hidden",onChange:_=>{const R=_.currentTarget.files?.[0];R&&y(R),_.currentTarget.value=""}}),C.jsx(gt,{type:"button",size:"sm",onClick:d,disabled:!t.length||e,children:"Export images (.zip)"}),C.jsx(gt,{type:"button",size:"sm",onClick:b,disabled:!t.length||e,children:e?"Exporting…":"Export PDF"})]})]})]})]})}function ed(){const t=Ae(r=>r.busy),n=Ae(r=>r.busyText),e=Ae(r=>r.progress);return t?C.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/60 backdrop-blur-sm","aria-live":"polite","aria-busy":"true",role:"status",children:C.jsxs("div",{className:"flex min-w-64 flex-col items-stretch gap-3 rounded-2xl border bg-background px-4 py-3 shadow-lg",children:[C.jsxs("div",{className:"flex items-center gap-3",children:[C.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent","aria-hidden":"true"}),C.jsx("div",{className:"text-sm",children:n??"Loading..."})]}),typeof e=="number"&&C.jsx(ar,{value:e,className:"h-2"})]})}):null}const nd=Go("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),me=L.forwardRef(({className:t,...n},e)=>C.jsx(Wo,{ref:e,className:vt(nd(),t),...n}));me.displayName=Wo.displayName;const Je=L.forwardRef(({className:t,...n},e)=>C.jsxs(qo,{ref:e,className:vt("relative flex w-full touch-none select-none items-center",t),...n,children:[C.jsx(fs,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:C.jsx(hs,{className:"absolute h-full bg-primary"})}),C.jsx(ms,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Je.displayName=qo.displayName;const rd=[],Xe="__none__",Oe=yt.get().DEFAULTS,Hn=Oe.BACKGROUND,ne=Oe.TEXT,re=Oe.RECT;Oe.IMAGE;const Pt=Oe.QR;function Ht(t){return JSON.parse(JSON.stringify(t))}function od({layer:t,onPatch:n}){const[e,r]=L.useState(t.qrText??Pt.text),[o,i]=L.useState(Math.max(1,Math.round(t.w??t.h??Pt.size))),[a,s]=L.useState(!1);return L.useEffect(()=>{r(t.qrText??Pt.text),i(Math.max(1,Math.round(t.w??t.h??Pt.size)))},[t.id,t.qrText,t.w,t.h]),C.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-foreground/10",children:"QR"}),C.jsx("span",{className:"opacity-70 text-sm",children:"This layer is a QR code"})]}),C.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[C.jsx("label",{className:"text-xs opacity-70",children:"QR text / URL"}),C.jsx("input",{type:"text",value:e,onChange:l=>r(l.target.value),className:"flex-1 min-w-[16rem] rounded border px-2 py-1 text-sm",placeholder:"https://example.com"}),C.jsx("label",{className:"text-xs opacity-70",children:"Size (px)"}),C.jsx("input",{type:"number",min:1,max:It,step:1,value:o,onChange:l=>i(Math.max(1,Number(l.target.value)||1)),className:"w-28 rounded border px-2 py-1 text-sm",title:"QR side size in card pixels"}),C.jsx(gt,{variant:"secondary",disabled:a,onClick:async()=>{const l=e.trim();if(l)try{s(!0);const f=Math.max(1,o),c=await De(l,f);n({qrText:l,w:f,h:f,src:c})}finally{s(!1)}},children:a?"Updating…":"Update QR"})]})]})}function id({open:t,onOpenChange:n,photo:e,canvasRef:r,asPage:o}){const i=bt(j=>j.layersByPhoto[e.id]??rd,Object.is),a=bt(j=>j.cardBackground?.[e.id]??tn,Object.is),s=bt(j=>j.transforms[e.id]??ae),[l,f]=L.useState([]),[c,g]=L.useState(tn),[p,d]=L.useState(s);L.useEffect(()=>{!t&&!o||(f(Ht(i)),g(a??Hn),d({...s}))},[t,o,i,a,s]);const[b,u]=L.useState(null);L.useEffect(()=>{if(!b)return;(l??[]).some(E=>E.id===b)||u(null)},[l,b]);const v=L.useRef(null),y=L.useCallback(j=>{const E=j.target,M=(E?.tagName||"").toLowerCase();if(!(M==="input"||M==="textarea"||E&&E.isContentEditable===!0)){if(j.key==="ArrowUp"||j.key==="ArrowDown"||j.key==="ArrowLeft"||j.key==="ArrowRight"){if(!b)return;j.preventDefault();const V=j.altKey?1:j.shiftKey?20:5;let $=0,lt=0;j.key==="ArrowLeft"&&($=-V),j.key==="ArrowRight"&&($=V),j.key==="ArrowUp"&&(lt=-V),j.key==="ArrowDown"&&(lt=V),f(ot=>{const tt=ot.findIndex(dt=>dt.id===b);if(tt===-1)return ot;const K=ot.slice(),rt=K[tt];return K[tt]={...rt,x:(rt.x??0)+$,y:(rt.y??0)+lt},K});return}if(j.key==="Delete"||j.key==="Backspace"){if(!b)return;j.preventDefault(),f(V=>V.filter($=>$.id!==b)),u(null);return}}},[b]),w=L.useRef(null),x=r??w,_=L.useRef(null),[R,N]=L.useState(0),I=L.useCallback(()=>{const j=_.current;if(!j)return;const E=Math.round(j.clientWidth);E&&N(E)},[]);L.useEffect(()=>{const j=_.current;if(!j)return;const E=new ResizeObserver(I);return E.observe(j),I(),()=>E.disconnect()},[I]),L.useEffect(()=>{!t&&!o||(requestAnimationFrame(I),setTimeout(I,50))},[t,o,I]);const z=L.useCallback((j,E)=>{const M=j.id.slice(0,6);let Z="Layer";return j.type==="text"?Z="Text":j.type==="rect"?Z="Rect":j.type==="image"&&j.qrText?Z="QR":j.type==="image"&&(Z="Image"),`${Z} #${E+1} (${M})`},[]),T=L.useCallback((j,E)=>{f(M=>{const Z=M.findIndex($=>$.id===j);if(Z===-1)return M;const V=M.slice();return V[Z]={...V[Z],...E},V})},[]),O=L.useCallback(j=>{f(E=>{const M=E.findIndex($=>$.id===j);if(M===-1)return E;const Z=E.reduce(($,lt)=>Math.max($,lt.z??1),1),V=E.slice();return V[M]={...V[M],z:Z+1},V})},[]),q=L.useCallback(j=>{f(E=>{const M=E.findIndex($=>$.id===j);if(M===-1)return E;const Z=E.reduce(($,lt)=>Math.min($,lt.z??1),1),V=E.slice();return V[M]={...V[M],z:Z-1},V})},[]),S=L.useCallback(j=>{f(E=>E.filter(M=>M.id!==j))},[]),k=L.useCallback(()=>{const j=crypto.randomUUID();return f(E=>[...E,{id:j,type:"text",...Ht(ne),rotation:0,scaleX:1,scaleY:1,visible:!0,z:E.reduce((M,Z)=>Math.max(M,Z.z??1),1)+1}]),j},[]),m=L.useCallback(()=>{const j=crypto.randomUUID();return f(E=>[...E,{id:j,type:"rect",...Ht(re),rotation:0,scaleX:1,scaleY:1,visible:!0,z:E.reduce((M,Z)=>Math.max(M,Z.z??1),1)+1}]),j},[]),W=L.useCallback(async j=>{const E=crypto.randomUUID(),M=j&&j.trim()?j.trim():Pt.text,Z=Math.max(1,Pt.size),V=await De(M,Z);return f($=>[...$,{id:E,type:"image",qrText:M,src:V,x:Pt.x,y:Pt.y,w:Z,h:Z,rotation:0,scaleX:1,scaleY:1,visible:!0,name:Pt.name,z:$.reduce((lt,ot)=>Math.max(lt,ot.z??1),1)+1}]),E},[]);L.useEffect(()=>{!t&&!o||setTimeout(()=>v.current?.focus(),0)},[t,o,b]);const nt=(j,E,M)=>Math.max(E,Math.min(M,j)),G=o?C.jsxs("div",{className:"shrink-0",children:[C.jsx("h2",{className:"text-lg font-semibold",children:"Edit card"}),C.jsx("p",{className:"sr-only",children:"Adjust zoom/position and edit layers."})]}):C.jsxs(ur,{className:"shrink-0",children:[C.jsx(hr,{children:"Edit card"}),C.jsx(xi,{className:"sr-only",children:"Adjust zoom/position and edit layers."})]}),F=C.jsx(C.Fragment,{children:C.jsx("div",{className:"flex-1 overflow-auto",children:C.jsxs("div",{className:"grid gap-4",children:[C.jsx("div",{ref:v,tabIndex:0,onKeyDown:y,className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20 outline-none focus:outline-none",children:C.jsx("div",{className:"relative aspect-square overflow-hidden rounded-xl",ref:_,children:R>0&&C.jsx("div",{className:"absolute inset-0 pointer-events-auto z-0",children:C.jsx(an,{"data-dnd-ignore":!0,ref:x,photoId:e.id,size:R,selectedId:b,onSelect:u,transformOverride:p,layersOverride:l,backgroundOverride:c,onLayerPatch:(j,E)=>T(j,E),onTransformPatch:j=>d(E=>({...E,...j}))})})})}),C.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:C.jsxs("div",{className:"flex items-center gap-3",children:[C.jsx(me,{className:"whitespace-nowrap",children:"Layers"}),C.jsxs(mi,{value:b??Xe,onValueChange:j=>u(j===Xe?null:j),children:[C.jsx(lr,{className:"w-[18rem]",children:C.jsx(pi,{placeholder:l.length?"Select a layer…":"No layers"})}),C.jsx(cr,{children:l.length===0?C.jsx(pe,{value:Xe,disabled:!0,children:"No layers"}):C.jsxs(C.Fragment,{children:[C.jsx(pe,{value:Xe,disabled:!0,children:"Select a layer…"}),l.slice().sort((j,E)=>j.z-E.z).map((j,E)=>C.jsx(pe,{value:j.id,children:z(j,E)},j.id))]})})]}),C.jsx("div",{className:"ml-auto"})]})}),b&&(()=>{const j=l.find(E=>E.id===b&&E.type==="text");return j?C.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[C.jsx("label",{className:"text-xs opacity-70",children:"Text"}),C.jsx("textarea",{value:j.text,onChange:E=>T(j.id,{text:E.target.value}),rows:3,className:"resize-y w-full rounded border px-2 py-1 text-sm bg-background"}),C.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[C.jsx("label",{className:"text-xs opacity-70",children:"Size"}),C.jsx("input",{type:"number",min:8,max:240,step:1,value:j.fontSize??ne.fontSize,onChange:E=>T(j.id,{fontSize:Number(E.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),C.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${j.fontStyle?.includes("bold")?"bg-foreground/10":""}`,onClick:()=>{const E=j.fontStyle?.includes("bold"),Z=`${j.fontStyle?.includes("italic")?"italic":""} ${E?"":"bold"}`.trim();T(j.id,{fontStyle:Z})},children:"Bold"}),C.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${j.fontStyle?.includes("italic")?"bg-foreground/10":""}`,onClick:()=>{const E=j.fontStyle?.includes("bold"),Z=`${j.fontStyle?.includes("italic")?"":"italic"} ${E?"bold":""}`.trim();T(j.id,{fontStyle:Z})},children:"Italic"}),C.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Color"}),C.jsx("input",{type:"color",value:j.fill??ne.fill,onChange:E=>T(j.id,{fill:E.target.value}),className:"h-8 w-10 cursor-pointer"})]}),C.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[C.jsx("label",{className:"text-xs opacity-70",children:"Font"}),C.jsx("select",{value:j.fontFamily??ne.fontFamily,onChange:async E=>{const M=E.target.value;await sl(M),T(j.id,{fontFamily:M})},className:"rounded border px-2 py-1 text-sm",children:oi.map(E=>C.jsx("option",{value:E.family,children:E.label},E.id))})]}),C.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[C.jsx("label",{className:"text-xs opacity-70",children:"Align"}),["left","center","right"].map(E=>C.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${j.align===E?"bg-foreground/10":""}`,onClick:()=>T(j.id,{align:E}),children:E},E)),C.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Wrap width"}),C.jsx("input",{type:"number",min:0,max:It,step:10,value:j.width??ne.width,onChange:E=>T(j.id,{width:Number(E.target.value)||void 0}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0 disables wrapping"}),C.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Padding"}),C.jsx("input",{type:"number",min:0,max:200,step:1,value:j.padding??ne.padding,onChange:E=>T(j.id,{padding:Number(E.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),C.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Line height"}),C.jsx("input",{type:"number",min:.8,max:2,step:.05,value:j.lineHeight??ne.lineHeight,onChange:E=>T(j.id,{lineHeight:Number(E.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),C.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Tracking"}),C.jsx("input",{type:"number",min:-5,max:20,step:.5,value:j.letterSpacing??ne.letterSpacing,onChange:E=>T(j.id,{letterSpacing:Number(E.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Additional spacing between glyphs (px, card space)"})]})]}):null})(),b&&(()=>{const j=l.find(E=>E.id===b&&E.type==="image"&&E.qrText);return j?C.jsx(od,{layer:j,onPatch:E=>T(j.id,E)}):null})(),b&&(()=>{const j=l.find(E=>E.id===b&&E.type==="rect");return j?C.jsx("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:C.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[C.jsx("label",{className:"text-xs opacity-70",children:"Fill"}),C.jsx("input",{type:"color",value:j.fill??re.fill,onChange:E=>T(j.id,{fill:E.target.value}),className:"h-8 w-10 cursor-pointer"}),C.jsx("label",{className:"text-xs opacity-70",children:"Stroke"}),C.jsx("input",{type:"color",value:j.stroke??re.stroke??"#000000",onChange:E=>T(j.id,{stroke:E.target.value}),className:"h-8 w-10 cursor-pointer"}),C.jsx("label",{className:"text-xs opacity-70",children:"Stroke width"}),C.jsx("input",{type:"number",min:0,max:100,step:1,value:j.strokeWidth??re.strokeWidth,onChange:E=>T(j.id,{strokeWidth:Number(E.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Width in card pixels"}),C.jsx("label",{className:"text-xs opacity-70",children:"Radius"}),C.jsx("input",{type:"number",min:0,max:500,step:1,value:j.cornerRadius??re.cornerRadius,onChange:E=>T(j.id,{cornerRadius:Number(E.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Corner radius in card pixels"}),C.jsx("label",{className:"text-xs opacity-70",children:"Opacity"}),C.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((j.opacity??re.opacity)*100),onChange:E=>T(j.id,{opacity:Math.max(0,Math.min(1,Number(E.target.value)/100))}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0..100 %"}),C.jsx("label",{className:"text-xs opacity-70",children:"Width"}),C.jsx("input",{type:"number",min:1,max:It,step:1,value:j.width??re.width,onChange:E=>T(j.id,{width:Number(E.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),C.jsx("label",{className:"text-xs opacity-70",children:"Height"}),C.jsx("input",{type:"number",min:1,max:It,step:1,value:j.height??re.height,onChange:E=>T(j.id,{height:Number(E.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"})]})}):null})(),C.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:C.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[C.jsx(gt,{variant:"secondary",disabled:!b,onClick:()=>{if(!b)return;const j=l.find(M=>M.id===b);if(!j)return;const E=((j.rotation??0)-90)%360;T(b,{rotation:E<0?E+360:E})},children:"Rotate −90°"}),C.jsx(gt,{variant:"secondary",disabled:!b,onClick:()=>{if(!b)return;const j=l.find(M=>M.id===b);if(!j)return;const E=((j.rotation??0)+90)%360;T(b,{rotation:E})},children:"Rotate +90°"}),C.jsx(gt,{variant:"secondary",disabled:!b,onClick:()=>b&&O(b),children:"Bring to front"}),C.jsx(gt,{variant:"secondary",disabled:!b,onClick:()=>b&&q(b),children:"Send to back"}),C.jsx(gt,{variant:"destructive",disabled:!b,onClick:()=>{b&&(S(b),u(null))},children:"Delete layer"})]})}),C.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:C.jsxs("div",{className:"grid gap-3",children:[C.jsxs("div",{className:"grid gap-1.5",children:[C.jsxs("div",{className:"flex items-center justify-between text-sm",children:[C.jsx(me,{children:"Zoom"}),C.jsxs("span",{className:"tabular-nums opacity-70",children:[p.scale.toFixed(2),"×"]})]}),C.jsx(Je,{value:[p.scale],min:.5,max:4,step:.01,onValueChange:([j])=>d(E=>({...E,scale:nt(j??E.scale,.5,4)}))})]}),C.jsxs("div",{className:"grid gap-1.5",children:[C.jsxs("div",{className:"flex items-center justify-between text-sm",children:[C.jsx(me,{children:"Horizontal"}),C.jsxs("span",{className:"tabular-nums opacity-70",children:[p.tx.toFixed(0),"%"]})]}),C.jsx(Je,{value:[p.tx],min:-100,max:100,step:.1,onValueChange:([j])=>d(E=>({...E,tx:j}))})]}),C.jsxs("div",{className:"grid gap-1.5",children:[C.jsxs("div",{className:"flex items-center justify-between text-sm",children:[C.jsx(me,{children:"Vertical"}),C.jsxs("span",{className:"tabular-nums opacity-70",children:[p.ty.toFixed(0),"%"]})]}),C.jsx(Je,{value:[p.ty],min:-100,max:100,step:.1,onValueChange:([j])=>d(E=>({...E,ty:j}))})]})]})}),C.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:C.jsx("div",{className:"mt-3 grid gap-2 rounded-md border p-2 bg-background/60",children:C.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[C.jsx(me,{className:"opacity-70",children:"Background"}),C.jsx("label",{className:"text-xs opacity-70",children:"Color"}),C.jsx("input",{type:"color",value:c.color??Hn.color,onChange:j=>g(E=>({...E,color:j.target.value})),className:"h-8 w-10 cursor-pointer"}),C.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Opacity"}),C.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((c.alpha??Hn.alpha)*100),onChange:j=>g(E=>({...E,alpha:Math.max(0,Math.min(1,Number(j.target.value)/100))})),className:"w-20 rounded border px-2 py-1 text-sm",title:"0..100 %"}),C.jsx("span",{className:"text-xs opacity-60",children:"(0% = transparent, 100% = solid)"})]})})})]})})}),B=o?C.jsxs("div",{className:"shrink-0 space-y-2",children:[C.jsxs("div",{className:"flex items-center justify-between gap-2",children:[C.jsx(gt,{variant:"ghost",onClick:()=>{d(ae)},children:"Reset image"}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx(gt,{variant:"secondary",onClick:()=>{n(!1)},children:"Cancel"}),C.jsx(gt,{onClick:()=>{bt.setState(j=>({...j,transforms:{...j.transforms,[e.id]:Ht(p)},cardBackground:{...j.cardBackground,[e.id]:Ht(c)},layersByPhoto:{...j.layersByPhoto,[e.id]:Ht(l)}})),n(!1)},children:"Save"})]})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(gt,{variant:"secondary",onClick:async()=>{const j=window.prompt("QR text / URL:",Pt.text)??"";if(!j.trim())return;const E=await W(j.trim());u(E)},children:"Add QR"}),C.jsx(gt,{variant:"secondary",onClick:()=>{const j=k();u(j)},children:"Add text layer"}),C.jsx(gt,{variant:"secondary",onClick:()=>{const j=m();u(j)},children:"Add rectangle"})]})]}):C.jsxs(fr,{className:"shrink-0 space-y-2",children:[C.jsxs("div",{className:"flex items-center justify-between gap-2",children:[C.jsx(gt,{variant:"ghost",onClick:()=>{d(ae)},children:"Reset image"}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx(gt,{variant:"secondary",onClick:()=>{n(!1)},children:"Cancel"}),C.jsx(gt,{onClick:()=>{bt.setState(j=>({...j,transforms:{...j.transforms,[e.id]:Ht(p)},cardBackground:{...j.cardBackground,[e.id]:Ht(c)},layersByPhoto:{...j.layersByPhoto,[e.id]:Ht(l)}})),n(!1)},children:"Save"})]})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(gt,{variant:"secondary",onClick:async()=>{const j=window.prompt("QR text / URL:",Pt.text)??"";if(!j.trim())return;const E=await W(j.trim());u(E)},children:"Add QR"}),C.jsx(gt,{variant:"secondary",onClick:()=>{const j=k();u(j)},children:"Add text layer"}),C.jsx(gt,{variant:"secondary",onClick:()=>{const j=m();u(j)},children:"Add rectangle"})]})]});return o?C.jsxs("div",{"data-dnd-ignore":!0,className:"mx-auto max-w-[min(110rem,98vw)] px-4 py-4 overflow-auto flex flex-col gap-2",children:[G,F,B]}):C.jsx(vi,{open:t,onOpenChange:n,children:C.jsxs(dr,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden flex flex-col",children:[G,F,B]})})}function sd(){const{id:t}=Xi(),n=No();if(!t)return C.jsx(Zn,{to:"/",replace:!0});const e=bt(L.useCallback(r=>r.photos.find(o=>o.id===t),[t]));return e?C.jsx("div",{className:"mx-auto max-w-[min(110rem,98vw)] px-4 py-4",children:C.jsx(id,{open:!0,onOpenChange:r=>{r||n(-1)},photo:e,asPage:!0})}):C.jsx(Zn,{to:"/",replace:!0})}function ad(){return gs(),C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"sticky top-0 z-10 w-full py-3 text-center text-3xl font-bold bg-background border-b border-gray-300",children:"Story Squares v1.1"}),C.jsxs(Ki,{children:[C.jsx(mn,{path:"/",element:C.jsxs("main",{className:"mx-auto max-w-screen-md px-4 space-y-5",children:[C.jsx(Ya,{}),C.jsx(td,{})]})}),C.jsx(mn,{path:"/edit/:id",element:C.jsx(sd,{})}),C.jsx(mn,{path:"*",element:C.jsx(Zn,{to:"/",replace:!0})})]}),C.jsx(ed,{})]})}Ao.createRoot(document.getElementById("root")).render(C.jsx(Tt.StrictMode,{children:C.jsx(Qi,{children:C.jsx(ad,{})})}));export{It as C,ra as P,_i as e};
