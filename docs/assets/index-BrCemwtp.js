const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-4IF0YJUI.js","assets/jspdf-Cpx4AXLL.js","assets/vendor-react-CkEsgLSR.js","assets/vendor-ui-BqtEeXaX.js"])))=>i.map(i=>d[i]);
import{r as j,j as A,k as mi,m as gi,n as Be,C as bi,p as jo,q as Lo,S as Mo,L as Bo,t as gr,I as yi,T as Po,v as Oo,X as Fo,w as vi,R as Tt,a as ke}from"./vendor-react-CkEsgLSR.js";import{S as Uo,R as wi,I as Wo,T as xi,a as qo,b as _i,c as ki,P as Vo,C as Ci,V as Yo,L as Ei,d as Si,e as $o,f as Go,g as Ri,h as Ho,i as Zo,O as Ai,j as Xo,k as Ni,l as Ko,m as Ii,D as Ti,n as Qo,o as Di,p as zi,q as Jo,r as ts,s as es,t as ns}from"./vendor-ui-BqtEeXaX.js";import{_ as rs}from"./jspdf-Cpx4AXLL.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}})();if(typeof window<"u"){const t=n=>{const e=n?.reason&&(n.reason.message||String(n.reason))||"Unknown async error";console.error("Unhandled promise rejection:",n?.reason),setTimeout(()=>alert(`Error: ${e}`),0)};window.addEventListener("unhandledrejection",t)}function an(t){const n=document.documentElement,e=window.matchMedia("(prefers-color-scheme: dark)").matches,r=t==="dark"||t==="system"&&e;n.classList.toggle("dark",r)}function is(){j.useEffect(()=>{const t=localStorage.getItem("theme")??"system";an(t);const n=window.matchMedia("(prefers-color-scheme: dark)"),e=()=>{const o=localStorage.getItem("theme")??"system";o==="system"&&an(o)};n.addEventListener("change",e);const r=o=>{if(o.key==="theme"){const i=o.newValue??"system";an(i)}};return window.addEventListener("storage",r),()=>{n.removeEventListener("change",e),window.removeEventListener("storage",r)}},[])}function ji(t){var n,e,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(n=0;n<o;n++)t[n]&&(e=ji(t[n]))&&(r&&(r+=" "),r+=e)}else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Li(){for(var t,n,e=0,r="",o=arguments.length;e<o;e++)(t=arguments[e])&&(n=ji(t))&&(r&&(r+=" "),r+=n);return r}const br=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,yr=Li,Mi=(t,n)=>e=>{var r;if(n?.variants==null)return yr(t,e?.class,e?.className);const{variants:o,defaultVariants:i}=n,a=Object.keys(o).map(f=>{const c=e?.[f],m=i?.[f];if(c===null)return null;const g=br(c)||br(m);return o[f][g]}),s=e&&Object.entries(e).reduce((f,c)=>{let[m,g]=c;return g===void 0||(f[m]=g),f},{}),l=n==null||(r=n.compoundVariants)===null||r===void 0?void 0:r.reduce((f,c)=>{let{class:m,className:g,...u}=c;return Object.entries(u).every(y=>{let[d,v]=y;return Array.isArray(v)?v.includes({...i,...s}[d]):{...i,...s}[d]===v})?[...f,m,g]:f},[]);return yr(t,a,l,e?.class,e?.className)},Zn="-",os=t=>{const n=as(t),{conflictingClassGroups:e,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const s=a.split(Zn);return s[0]===""&&s.length!==1&&s.shift(),Bi(s,n)||ss(a)},getConflictingClassGroupIds:(a,s)=>{const l=e[a]||[];return s&&r[a]?[...l,...r[a]]:l}}},Bi=(t,n)=>{if(t.length===0)return n.classGroupId;const e=t[0],r=n.nextPart.get(e),o=r?Bi(t.slice(1),r):void 0;if(o)return o;if(n.validators.length===0)return;const i=t.join(Zn);return n.validators.find(({validator:a})=>a(i))?.classGroupId},vr=/^\[(.+)\]$/,ss=t=>{if(vr.test(t)){const n=vr.exec(t)[1],e=n?.substring(0,n.indexOf(":"));if(e)return"arbitrary.."+e}},as=t=>{const{theme:n,classGroups:e}=t,r={nextPart:new Map,validators:[]};for(const o in e)Fn(e[o],r,o,n);return r},Fn=(t,n,e,r)=>{t.forEach(o=>{if(typeof o=="string"){const i=o===""?n:wr(n,o);i.classGroupId=e;return}if(typeof o=="function"){if(ls(o)){Fn(o(r),n,e,r);return}n.validators.push({validator:o,classGroupId:e});return}Object.entries(o).forEach(([i,a])=>{Fn(a,wr(n,i),e,r)})})},wr=(t,n)=>{let e=t;return n.split(Zn).forEach(r=>{e.nextPart.has(r)||e.nextPart.set(r,{nextPart:new Map,validators:[]}),e=e.nextPart.get(r)}),e},ls=t=>t.isThemeGetter,cs=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,e=new Map,r=new Map;const o=(i,a)=>{e.set(i,a),n++,n>t&&(n=0,r=e,e=new Map)};return{get(i){let a=e.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return o(i,a),a},set(i,a){e.has(i)?e.set(i,a):o(i,a)}}},Un="!",Wn=":",ds=Wn.length,us=t=>{const{prefix:n,experimentalParseClassName:e}=t;let r=o=>{const i=[];let a=0,s=0,l=0,f;for(let y=0;y<o.length;y++){let d=o[y];if(a===0&&s===0){if(d===Wn){i.push(o.slice(l,y)),l=y+ds;continue}if(d==="/"){f=y;continue}}d==="["?a++:d==="]"?a--:d==="("?s++:d===")"&&s--}const c=i.length===0?o:o.substring(l),m=fs(c),g=m!==c,u=f&&f>l?f-l:void 0;return{modifiers:i,hasImportantModifier:g,baseClassName:m,maybePostfixModifierPosition:u}};if(n){const o=n+Wn,i=r;r=a=>a.startsWith(o)?i(a.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(e){const o=r;r=i=>e({className:i,parseClassName:o})}return r},fs=t=>t.endsWith(Un)?t.substring(0,t.length-1):t.startsWith(Un)?t.substring(1):t,hs=t=>{const n=Object.fromEntries(t.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const o=[];let i=[];return r.forEach(a=>{a[0]==="["||n[a]?(o.push(...i.sort(),a),i=[]):i.push(a)}),o.push(...i.sort()),o}},ps=t=>({cache:cs(t.cacheSize),parseClassName:us(t),sortModifiers:hs(t),...os(t)}),ms=/\s+/,gs=(t,n)=>{const{parseClassName:e,getClassGroupId:r,getConflictingClassGroupIds:o,sortModifiers:i}=n,a=[],s=t.trim().split(ms);let l="";for(let f=s.length-1;f>=0;f-=1){const c=s[f],{isExternal:m,modifiers:g,hasImportantModifier:u,baseClassName:y,maybePostfixModifierPosition:d}=e(c);if(m){l=c+(l.length>0?" "+l:l);continue}let v=!!d,b=r(v?y.substring(0,d):y);if(!b){if(!v){l=c+(l.length>0?" "+l:l);continue}if(b=r(y),!b){l=c+(l.length>0?" "+l:l);continue}v=!1}const x=i(g).join(":"),_=u?x+Un:x,k=_+b;if(a.includes(k))continue;a.push(k);const C=o(b,v);for(let N=0;N<C.length;++N){const D=C[N];a.push(_+D)}l=c+(l.length>0?" "+l:l)}return l};function bs(){let t=0,n,e,r="";for(;t<arguments.length;)(n=arguments[t++])&&(e=Pi(n))&&(r&&(r+=" "),r+=e);return r}const Pi=t=>{if(typeof t=="string")return t;let n,e="";for(let r=0;r<t.length;r++)t[r]&&(n=Pi(t[r]))&&(e&&(e+=" "),e+=n);return e};function ys(t,...n){let e,r,o,i=a;function a(l){const f=n.reduce((c,m)=>m(c),t());return e=ps(f),r=e.cache.get,o=e.cache.set,i=s,s(l)}function s(l){const f=r(l);if(f)return f;const c=gs(l,e);return o(l,c),c}return function(){return i(bs.apply(null,arguments))}}const kt=t=>{const n=e=>e[t]||[];return n.isThemeGetter=!0,n},Oi=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Fi=/^\((?:(\w[\w-]*):)?(.+)\)$/i,vs=/^\d+\/\d+$/,ws=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,xs=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,_s=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,ks=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Cs=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,le=t=>vs.test(t),ut=t=>!!t&&!Number.isNaN(Number(t)),Qt=t=>!!t&&Number.isInteger(Number(t)),ln=t=>t.endsWith("%")&&ut(t.slice(0,-1)),Yt=t=>ws.test(t),Es=()=>!0,Ss=t=>xs.test(t)&&!_s.test(t),Ui=()=>!1,Rs=t=>ks.test(t),As=t=>Cs.test(t),Ns=t=>!rt(t)&&!it(t),Is=t=>he(t,Vi,Ui),rt=t=>Oi.test(t),ne=t=>he(t,Yi,Ss),cn=t=>he(t,Ls,ut),xr=t=>he(t,Wi,Ui),Ts=t=>he(t,qi,As),Pe=t=>he(t,$i,Rs),it=t=>Fi.test(t),xe=t=>pe(t,Yi),Ds=t=>pe(t,Ms),_r=t=>pe(t,Wi),zs=t=>pe(t,Vi),js=t=>pe(t,qi),Oe=t=>pe(t,$i,!0),he=(t,n,e)=>{const r=Oi.exec(t);return r?r[1]?n(r[1]):e(r[2]):!1},pe=(t,n,e=!1)=>{const r=Fi.exec(t);return r?r[1]?n(r[1]):e:!1},Wi=t=>t==="position"||t==="percentage",qi=t=>t==="image"||t==="url",Vi=t=>t==="length"||t==="size"||t==="bg-size",Yi=t=>t==="length",Ls=t=>t==="number",Ms=t=>t==="family-name",$i=t=>t==="shadow",Bs=()=>{const t=kt("color"),n=kt("font"),e=kt("text"),r=kt("font-weight"),o=kt("tracking"),i=kt("leading"),a=kt("breakpoint"),s=kt("container"),l=kt("spacing"),f=kt("radius"),c=kt("shadow"),m=kt("inset-shadow"),g=kt("text-shadow"),u=kt("drop-shadow"),y=kt("blur"),d=kt("perspective"),v=kt("aspect"),b=kt("ease"),x=kt("animate"),_=()=>["auto","avoid","all","avoid-page","page","left","right","column"],k=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],C=()=>[...k(),it,rt],N=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto","contain","none"],I=()=>[it,rt,l],z=()=>[le,"full","auto",...I()],O=()=>[Qt,"none","subgrid",it,rt],M=()=>["auto",{span:["full",Qt,it,rt]},Qt,it,rt],w=()=>[Qt,"auto",it,rt],S=()=>["auto","min","max","fr",it,rt],h=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],E=()=>["start","end","center","stretch","center-safe","end-safe"],F=()=>["auto",...I()],W=()=>[le,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...I()],V=()=>[t,it,rt],Y=()=>[...k(),_r,xr,{position:[it,rt]}],tt=()=>["no-repeat",{repeat:["","x","y","space","round"]}],P=()=>["auto","cover","contain",zs,Is,{size:[it,rt]}],L=()=>[ln,xe,ne],K=()=>["","none","full",f,it,rt],X=()=>["",ut,xe,ne],H=()=>["solid","dashed","dotted","double"],ct=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ot=()=>[ut,ln,_r,xr],et=()=>["","none",y,it,rt],st=()=>["none",ut,it,rt],at=()=>["none",ut,it,rt],pt=()=>[ut,it,rt],gt=()=>[le,"full",...I()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Yt],breakpoint:[Yt],color:[Es],container:[Yt],"drop-shadow":[Yt],ease:["in","out","in-out"],font:[Ns],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Yt],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Yt],shadow:[Yt],spacing:["px",ut],text:[Yt],"text-shadow":[Yt],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",le,rt,it,v]}],container:["container"],columns:[{columns:[ut,rt,it,s]}],"break-after":[{"break-after":_()}],"break-before":[{"break-before":_()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:C()}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:z()}],"inset-x":[{"inset-x":z()}],"inset-y":[{"inset-y":z()}],start:[{start:z()}],end:[{end:z()}],top:[{top:z()}],right:[{right:z()}],bottom:[{bottom:z()}],left:[{left:z()}],visibility:["visible","invisible","collapse"],z:[{z:[Qt,"auto",it,rt]}],basis:[{basis:[le,"full","auto",s,...I()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ut,le,"auto","initial","none",rt]}],grow:[{grow:["",ut,it,rt]}],shrink:[{shrink:["",ut,it,rt]}],order:[{order:[Qt,"first","last","none",it,rt]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:M()}],"col-start":[{"col-start":w()}],"col-end":[{"col-end":w()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:M()}],"row-start":[{"row-start":w()}],"row-end":[{"row-end":w()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":S()}],"auto-rows":[{"auto-rows":S()}],gap:[{gap:I()}],"gap-x":[{"gap-x":I()}],"gap-y":[{"gap-y":I()}],"justify-content":[{justify:[...h(),"normal"]}],"justify-items":[{"justify-items":[...E(),"normal"]}],"justify-self":[{"justify-self":["auto",...E()]}],"align-content":[{content:["normal",...h()]}],"align-items":[{items:[...E(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...E(),{baseline:["","last"]}]}],"place-content":[{"place-content":h()}],"place-items":[{"place-items":[...E(),"baseline"]}],"place-self":[{"place-self":["auto",...E()]}],p:[{p:I()}],px:[{px:I()}],py:[{py:I()}],ps:[{ps:I()}],pe:[{pe:I()}],pt:[{pt:I()}],pr:[{pr:I()}],pb:[{pb:I()}],pl:[{pl:I()}],m:[{m:F()}],mx:[{mx:F()}],my:[{my:F()}],ms:[{ms:F()}],me:[{me:F()}],mt:[{mt:F()}],mr:[{mr:F()}],mb:[{mb:F()}],ml:[{ml:F()}],"space-x":[{"space-x":I()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":I()}],"space-y-reverse":["space-y-reverse"],size:[{size:W()}],w:[{w:[s,"screen",...W()]}],"min-w":[{"min-w":[s,"screen","none",...W()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[a]},...W()]}],h:[{h:["screen","lh",...W()]}],"min-h":[{"min-h":["screen","lh","none",...W()]}],"max-h":[{"max-h":["screen","lh",...W()]}],"font-size":[{text:["base",e,xe,ne]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,it,cn]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",ln,rt]}],"font-family":[{font:[Ds,rt,n]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,it,rt]}],"line-clamp":[{"line-clamp":[ut,"none",it,cn]}],leading:[{leading:[i,...I()]}],"list-image":[{"list-image":["none",it,rt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",it,rt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:V()}],"text-color":[{text:V()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...H(),"wavy"]}],"text-decoration-thickness":[{decoration:[ut,"from-font","auto",it,ne]}],"text-decoration-color":[{decoration:V()}],"underline-offset":[{"underline-offset":[ut,"auto",it,rt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",it,rt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",it,rt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Y()}],"bg-repeat":[{bg:tt()}],"bg-size":[{bg:P()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Qt,it,rt],radial:["",it,rt],conic:[Qt,it,rt]},js,Ts]}],"bg-color":[{bg:V()}],"gradient-from-pos":[{from:L()}],"gradient-via-pos":[{via:L()}],"gradient-to-pos":[{to:L()}],"gradient-from":[{from:V()}],"gradient-via":[{via:V()}],"gradient-to":[{to:V()}],rounded:[{rounded:K()}],"rounded-s":[{"rounded-s":K()}],"rounded-e":[{"rounded-e":K()}],"rounded-t":[{"rounded-t":K()}],"rounded-r":[{"rounded-r":K()}],"rounded-b":[{"rounded-b":K()}],"rounded-l":[{"rounded-l":K()}],"rounded-ss":[{"rounded-ss":K()}],"rounded-se":[{"rounded-se":K()}],"rounded-ee":[{"rounded-ee":K()}],"rounded-es":[{"rounded-es":K()}],"rounded-tl":[{"rounded-tl":K()}],"rounded-tr":[{"rounded-tr":K()}],"rounded-br":[{"rounded-br":K()}],"rounded-bl":[{"rounded-bl":K()}],"border-w":[{border:X()}],"border-w-x":[{"border-x":X()}],"border-w-y":[{"border-y":X()}],"border-w-s":[{"border-s":X()}],"border-w-e":[{"border-e":X()}],"border-w-t":[{"border-t":X()}],"border-w-r":[{"border-r":X()}],"border-w-b":[{"border-b":X()}],"border-w-l":[{"border-l":X()}],"divide-x":[{"divide-x":X()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":X()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...H(),"hidden","none"]}],"divide-style":[{divide:[...H(),"hidden","none"]}],"border-color":[{border:V()}],"border-color-x":[{"border-x":V()}],"border-color-y":[{"border-y":V()}],"border-color-s":[{"border-s":V()}],"border-color-e":[{"border-e":V()}],"border-color-t":[{"border-t":V()}],"border-color-r":[{"border-r":V()}],"border-color-b":[{"border-b":V()}],"border-color-l":[{"border-l":V()}],"divide-color":[{divide:V()}],"outline-style":[{outline:[...H(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ut,it,rt]}],"outline-w":[{outline:["",ut,xe,ne]}],"outline-color":[{outline:V()}],shadow:[{shadow:["","none",c,Oe,Pe]}],"shadow-color":[{shadow:V()}],"inset-shadow":[{"inset-shadow":["none",m,Oe,Pe]}],"inset-shadow-color":[{"inset-shadow":V()}],"ring-w":[{ring:X()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:V()}],"ring-offset-w":[{"ring-offset":[ut,ne]}],"ring-offset-color":[{"ring-offset":V()}],"inset-ring-w":[{"inset-ring":X()}],"inset-ring-color":[{"inset-ring":V()}],"text-shadow":[{"text-shadow":["none",g,Oe,Pe]}],"text-shadow-color":[{"text-shadow":V()}],opacity:[{opacity:[ut,it,rt]}],"mix-blend":[{"mix-blend":[...ct(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ct()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ut]}],"mask-image-linear-from-pos":[{"mask-linear-from":ot()}],"mask-image-linear-to-pos":[{"mask-linear-to":ot()}],"mask-image-linear-from-color":[{"mask-linear-from":V()}],"mask-image-linear-to-color":[{"mask-linear-to":V()}],"mask-image-t-from-pos":[{"mask-t-from":ot()}],"mask-image-t-to-pos":[{"mask-t-to":ot()}],"mask-image-t-from-color":[{"mask-t-from":V()}],"mask-image-t-to-color":[{"mask-t-to":V()}],"mask-image-r-from-pos":[{"mask-r-from":ot()}],"mask-image-r-to-pos":[{"mask-r-to":ot()}],"mask-image-r-from-color":[{"mask-r-from":V()}],"mask-image-r-to-color":[{"mask-r-to":V()}],"mask-image-b-from-pos":[{"mask-b-from":ot()}],"mask-image-b-to-pos":[{"mask-b-to":ot()}],"mask-image-b-from-color":[{"mask-b-from":V()}],"mask-image-b-to-color":[{"mask-b-to":V()}],"mask-image-l-from-pos":[{"mask-l-from":ot()}],"mask-image-l-to-pos":[{"mask-l-to":ot()}],"mask-image-l-from-color":[{"mask-l-from":V()}],"mask-image-l-to-color":[{"mask-l-to":V()}],"mask-image-x-from-pos":[{"mask-x-from":ot()}],"mask-image-x-to-pos":[{"mask-x-to":ot()}],"mask-image-x-from-color":[{"mask-x-from":V()}],"mask-image-x-to-color":[{"mask-x-to":V()}],"mask-image-y-from-pos":[{"mask-y-from":ot()}],"mask-image-y-to-pos":[{"mask-y-to":ot()}],"mask-image-y-from-color":[{"mask-y-from":V()}],"mask-image-y-to-color":[{"mask-y-to":V()}],"mask-image-radial":[{"mask-radial":[it,rt]}],"mask-image-radial-from-pos":[{"mask-radial-from":ot()}],"mask-image-radial-to-pos":[{"mask-radial-to":ot()}],"mask-image-radial-from-color":[{"mask-radial-from":V()}],"mask-image-radial-to-color":[{"mask-radial-to":V()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":k()}],"mask-image-conic-pos":[{"mask-conic":[ut]}],"mask-image-conic-from-pos":[{"mask-conic-from":ot()}],"mask-image-conic-to-pos":[{"mask-conic-to":ot()}],"mask-image-conic-from-color":[{"mask-conic-from":V()}],"mask-image-conic-to-color":[{"mask-conic-to":V()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Y()}],"mask-repeat":[{mask:tt()}],"mask-size":[{mask:P()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",it,rt]}],filter:[{filter:["","none",it,rt]}],blur:[{blur:et()}],brightness:[{brightness:[ut,it,rt]}],contrast:[{contrast:[ut,it,rt]}],"drop-shadow":[{"drop-shadow":["","none",u,Oe,Pe]}],"drop-shadow-color":[{"drop-shadow":V()}],grayscale:[{grayscale:["",ut,it,rt]}],"hue-rotate":[{"hue-rotate":[ut,it,rt]}],invert:[{invert:["",ut,it,rt]}],saturate:[{saturate:[ut,it,rt]}],sepia:[{sepia:["",ut,it,rt]}],"backdrop-filter":[{"backdrop-filter":["","none",it,rt]}],"backdrop-blur":[{"backdrop-blur":et()}],"backdrop-brightness":[{"backdrop-brightness":[ut,it,rt]}],"backdrop-contrast":[{"backdrop-contrast":[ut,it,rt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ut,it,rt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ut,it,rt]}],"backdrop-invert":[{"backdrop-invert":["",ut,it,rt]}],"backdrop-opacity":[{"backdrop-opacity":[ut,it,rt]}],"backdrop-saturate":[{"backdrop-saturate":[ut,it,rt]}],"backdrop-sepia":[{"backdrop-sepia":["",ut,it,rt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":I()}],"border-spacing-x":[{"border-spacing-x":I()}],"border-spacing-y":[{"border-spacing-y":I()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",it,rt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ut,"initial",it,rt]}],ease:[{ease:["linear","initial",b,it,rt]}],delay:[{delay:[ut,it,rt]}],animate:[{animate:["none",x,it,rt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[d,it,rt]}],"perspective-origin":[{"perspective-origin":C()}],rotate:[{rotate:st()}],"rotate-x":[{"rotate-x":st()}],"rotate-y":[{"rotate-y":st()}],"rotate-z":[{"rotate-z":st()}],scale:[{scale:at()}],"scale-x":[{"scale-x":at()}],"scale-y":[{"scale-y":at()}],"scale-z":[{"scale-z":at()}],"scale-3d":["scale-3d"],skew:[{skew:pt()}],"skew-x":[{"skew-x":pt()}],"skew-y":[{"skew-y":pt()}],transform:[{transform:[it,rt,"","none","gpu","cpu"]}],"transform-origin":[{origin:C()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:gt()}],"translate-x":[{"translate-x":gt()}],"translate-y":[{"translate-y":gt()}],"translate-z":[{"translate-z":gt()}],"translate-none":["translate-none"],accent:[{accent:V()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:V()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",it,rt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",it,rt]}],fill:[{fill:["none",...V()]}],"stroke-w":[{stroke:[ut,xe,ne,cn]}],stroke:[{stroke:["none",...V()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Ps=ys(Bs);function bt(...t){return Ps(Li(t))}const Os=Mi("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),xt=j.forwardRef(({className:t,variant:n,size:e,asChild:r=!1,...o},i)=>{const a=r?Uo:"button";return A.jsx(a,{className:bt(Os({variant:n,size:e,className:t})),ref:i,...o})});xt.displayName="Button";const Fs=/^(image\/(jpeg|png|webp|gif|avif|bmp|tiff))$/i;function Us(t){return Fs.test(t.type)}function Ws(t,n=36){const e=[];for(const r of t)if(Us(r)){if(e.length>=n)break;e.push({id:crypto.randomUUID(),url:URL.createObjectURL(r),name:r.name,size:r.size,type:r.type})}return e}function kr(t){for(const n of t)try{URL.revokeObjectURL(n.url)}catch{}}let Wt=null;function Fe(){if(!Wt)throw new Error("ConfigController: not initialized. Call Config.init().")}function Cr(t){if(t.MAX_CARDS!=null&&(!Number.isInteger(t.MAX_CARDS)||t.MAX_CARDS<=0))throw new Error("MAX_CARDS must be a positive integer.");if(t.CARD_EXPORT_SIZE!=null&&(!Number.isInteger(t.CARD_EXPORT_SIZE)||t.CARD_EXPORT_SIZE<=0))throw new Error("CARD_EXPORT_SIZE must be a positive integer.");if(t.PREVIEW_EXACT_SIZE!=null&&(!Number.isInteger(t.PREVIEW_EXACT_SIZE)||t.PREVIEW_EXACT_SIZE<=0))throw new Error("PREVIEW_EXACT_SIZE must be a positive integer.");if(t.PREVIEW_FAST_SIZE!=null&&(!Number.isInteger(t.PREVIEW_FAST_SIZE)||t.PREVIEW_FAST_SIZE<=0))throw new Error("PREVIEW_FAST_SIZE must be a positive integer.");if(t.PDF_JPEG_QUALITY!=null&&(t.PDF_JPEG_QUALITY<0||t.PDF_JPEG_QUALITY>1))throw new Error("PDF_JPEG_QUALITY must be within [0..1].");if(t.IMAGE_FIT_MODE!=null&&t.IMAGE_FIT_MODE!=="cover"&&t.IMAGE_FIT_MODE!=="contain")throw new Error("IMAGE_FIT_MODE must be 'cover' or 'contain'.");if(t.INITIAL_ALIGN_X!=null&&!["center","left","right"].includes(t.INITIAL_ALIGN_X))throw new Error("INITIAL_ALIGN_X must be 'center' | 'left' | 'right'.");if(t.INITIAL_ALIGN_Y!=null&&!["center","top","bottom"].includes(t.INITIAL_ALIGN_Y))throw new Error("INITIAL_ALIGN_Y must be 'center' | 'top' | 'bottom'.");if(t.FONT_CATALOG!=null&&!Array.isArray(t.FONT_CATALOG))throw new Error("FONT_CATALOG must be an array.");if(t.DEFAULT_CARD_LAYERS!=null&&!Array.isArray(t.DEFAULT_CARD_LAYERS))throw new Error("DEFAULT_CARD_LAYERS must be an array.");if(t.DEFAULTS!=null&&(typeof t.DEFAULTS!="object"||Array.isArray(t.DEFAULTS)))throw new Error("DEFAULTS must be an object.");if(t.NEAR_SQUARE_TOLERANCE!=null&&(t.NEAR_SQUARE_TOLERANCE<0||t.NEAR_SQUARE_TOLERANCE>.5))throw new Error("NEAR_SQUARE_TOLERANCE must be within [0..0.5].");if(t.NEAR_SQUARE_SCALE!=null&&(t.NEAR_SQUARE_SCALE<=0||t.NEAR_SQUARE_SCALE>1))throw new Error("NEAR_SQUARE_SCALE must be within (0..1].");if(t.LAYER_PROFILES!=null){if(typeof t.LAYER_PROFILES!="object"||Array.isArray(t.LAYER_PROFILES))throw new Error("LAYER_PROFILES must be an object.");for(const[n,e]of Object.entries(t.LAYER_PROFILES)){if(e==null||typeof e!="object"||Array.isArray(e))throw new Error(`LAYER_PROFILES['${n}'] must be an object.`);if(e.on!=null&&typeof e.on!="boolean")throw new Error(`LAYER_PROFILES['${n}'].on must be boolean if provided.`);if(e.landscape!=null&&!Array.isArray(e.landscape))throw new Error(`LAYER_PROFILES['${n}'].landscape must be an array if provided.`);if(e.portrait!=null&&!Array.isArray(e.portrait))throw new Error(`LAYER_PROFILES['${n}'].portrait must be an array if provided.`);if(e.square!=null&&!Array.isArray(e.square))throw new Error(`LAYER_PROFILES['${n}'].square must be an array if provided.`)}}}const vt={init(t){Wt=Object.freeze({...t})},get(){return Fe(),Wt},update(t){return Fe(),Cr(t),Wt=Object.freeze({...Wt,...t}),Wt},loadFromJson(t){Fe();const n=t;return Cr(n),Wt=Object.freeze({...Wt,...n}),Wt},toJson(){return Fe(),{...Wt}},async loadFromUrl(t){const n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error(`Config.loadFromUrl failed: ${n.status}`);const e=await n.json(),{schemaVersion:r,...o}=e??{};return this.loadFromJson(o)}};vt.init({});const qs="/ss/configs/default.json";await vt.loadFromUrl(qs);const Gi=vt.get().MAX_CARDS,It=vt.get().CARD_EXPORT_SIZE,Ye=vt.get().PREVIEW_EXACT_SIZE,Vs=vt.get().PREVIEW_FAST_SIZE,Ys=vt.get().PDF_JPEG_QUALITY,Er=vt.get().IMAGE_FIT_MODE,$s=vt.get().INITIAL_ALIGN_X,Gs=vt.get().INITIAL_ALIGN_Y,Hi=vt.get().FONT_CATALOG;vt.get().NEAR_SQUARE_TOLERANCE;vt.get().NEAR_SQUARE_SCALE;vt.get().DEFAULTS;vt.get().DEFAULT_CARD_LAYERS;var ce={},dn,Sr;function Hs(){return Sr||(Sr=1,dn=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),dn}var un={},Jt={},Rr;function ie(){if(Rr)return Jt;Rr=1;let t;const n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Jt.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17},Jt.getSymbolTotalCodewords=function(r){return n[r]},Jt.getBCHDigit=function(e){let r=0;for(;e!==0;)r++,e>>>=1;return r},Jt.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');t=r},Jt.isKanjiModeEnabled=function(){return typeof t<"u"},Jt.toSJIS=function(r){return t(r)},Jt}var fn={},Ar;function Xn(){return Ar||(Ar=1,function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function n(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}t.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},t.from=function(r,o){if(t.isValid(r))return r;try{return n(r)}catch{return o}}}(fn)),fn}var hn,Nr;function Zs(){if(Nr)return hn;Nr=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(n){const e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let r=0;r<e;r++)this.putBit((n>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}},hn=t,hn}var pn,Ir;function Xs(){if(Ir)return pn;Ir=1;function t(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}return t.prototype.set=function(n,e,r,o){const i=n*this.size+e;this.data[i]=r,o&&(this.reservedBit[i]=!0)},t.prototype.get=function(n,e){return this.data[n*this.size+e]},t.prototype.xor=function(n,e,r){this.data[n*this.size+e]^=r},t.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]},pn=t,pn}var mn={},Tr;function Ks(){return Tr||(Tr=1,function(t){const n=ie().getSymbolSize;t.getRowColCoords=function(r){if(r===1)return[];const o=Math.floor(r/7)+2,i=n(r),a=i===145?26:Math.ceil((i-13)/(2*o-2))*2,s=[i-7];for(let l=1;l<o-1;l++)s[l]=s[l-1]-a;return s.push(6),s.reverse()},t.getPositions=function(r){const o=[],i=t.getRowColCoords(r),a=i.length;for(let s=0;s<a;s++)for(let l=0;l<a;l++)s===0&&l===0||s===0&&l===a-1||s===a-1&&l===0||o.push([i[s],i[l]]);return o}}(mn)),mn}var gn={},Dr;function Qs(){if(Dr)return gn;Dr=1;const t=ie().getSymbolSize,n=7;return gn.getPositions=function(r){const o=t(r);return[[0,0],[o-n,0],[0,o-n]]},gn}var bn={},zr;function Js(){return zr||(zr=1,function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n={N1:3,N2:3,N3:40,N4:10};t.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},t.from=function(o){return t.isValid(o)?parseInt(o,10):void 0},t.getPenaltyN1=function(o){const i=o.size;let a=0,s=0,l=0,f=null,c=null;for(let m=0;m<i;m++){s=l=0,f=c=null;for(let g=0;g<i;g++){let u=o.get(m,g);u===f?s++:(s>=5&&(a+=n.N1+(s-5)),f=u,s=1),u=o.get(g,m),u===c?l++:(l>=5&&(a+=n.N1+(l-5)),c=u,l=1)}s>=5&&(a+=n.N1+(s-5)),l>=5&&(a+=n.N1+(l-5))}return a},t.getPenaltyN2=function(o){const i=o.size;let a=0;for(let s=0;s<i-1;s++)for(let l=0;l<i-1;l++){const f=o.get(s,l)+o.get(s,l+1)+o.get(s+1,l)+o.get(s+1,l+1);(f===4||f===0)&&a++}return a*n.N2},t.getPenaltyN3=function(o){const i=o.size;let a=0,s=0,l=0;for(let f=0;f<i;f++){s=l=0;for(let c=0;c<i;c++)s=s<<1&2047|o.get(f,c),c>=10&&(s===1488||s===93)&&a++,l=l<<1&2047|o.get(c,f),c>=10&&(l===1488||l===93)&&a++}return a*n.N3},t.getPenaltyN4=function(o){let i=0;const a=o.data.length;for(let l=0;l<a;l++)i+=o.data[l];return Math.abs(Math.ceil(i*100/a/5)-10)*n.N4};function e(r,o,i){switch(r){case t.Patterns.PATTERN000:return(o+i)%2===0;case t.Patterns.PATTERN001:return o%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(o+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return o*i%2+o*i%3===0;case t.Patterns.PATTERN110:return(o*i%2+o*i%3)%2===0;case t.Patterns.PATTERN111:return(o*i%3+(o+i)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}t.applyMask=function(o,i){const a=i.size;for(let s=0;s<a;s++)for(let l=0;l<a;l++)i.isReserved(l,s)||i.xor(l,s,e(o,l,s))},t.getBestMask=function(o,i){const a=Object.keys(t.Patterns).length;let s=0,l=1/0;for(let f=0;f<a;f++){i(f),t.applyMask(f,o);const c=t.getPenaltyN1(o)+t.getPenaltyN2(o)+t.getPenaltyN3(o)+t.getPenaltyN4(o);t.applyMask(f,o),c<l&&(l=c,s=f)}return s}}(bn)),bn}var Ue={},jr;function Zi(){if(jr)return Ue;jr=1;const t=Xn(),n=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],e=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Ue.getBlocksCount=function(o,i){switch(i){case t.L:return n[(o-1)*4+0];case t.M:return n[(o-1)*4+1];case t.Q:return n[(o-1)*4+2];case t.H:return n[(o-1)*4+3];default:return}},Ue.getTotalCodewordsCount=function(o,i){switch(i){case t.L:return e[(o-1)*4+0];case t.M:return e[(o-1)*4+1];case t.Q:return e[(o-1)*4+2];case t.H:return e[(o-1)*4+3];default:return}},Ue}var yn={},_e={},Lr;function ta(){if(Lr)return _e;Lr=1;const t=new Uint8Array(512),n=new Uint8Array(256);return function(){let r=1;for(let o=0;o<255;o++)t[o]=r,n[r]=o,r<<=1,r&256&&(r^=285);for(let o=255;o<512;o++)t[o]=t[o-255]}(),_e.log=function(r){if(r<1)throw new Error("log("+r+")");return n[r]},_e.exp=function(r){return t[r]},_e.mul=function(r,o){return r===0||o===0?0:t[n[r]+n[o]]},_e}var Mr;function ea(){return Mr||(Mr=1,function(t){const n=ta();t.mul=function(r,o){const i=new Uint8Array(r.length+o.length-1);for(let a=0;a<r.length;a++)for(let s=0;s<o.length;s++)i[a+s]^=n.mul(r[a],o[s]);return i},t.mod=function(r,o){let i=new Uint8Array(r);for(;i.length-o.length>=0;){const a=i[0];for(let l=0;l<o.length;l++)i[l]^=n.mul(o[l],a);let s=0;for(;s<i.length&&i[s]===0;)s++;i=i.slice(s)}return i},t.generateECPolynomial=function(r){let o=new Uint8Array([1]);for(let i=0;i<r;i++)o=t.mul(o,new Uint8Array([1,n.exp(i)]));return o}}(yn)),yn}var vn,Br;function na(){if(Br)return vn;Br=1;const t=ea();function n(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}return n.prototype.initialize=function(r){this.degree=r,this.genPoly=t.generateECPolynomial(this.degree)},n.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(r.length+this.degree);o.set(r);const i=t.mod(o,this.genPoly),a=this.degree-i.length;if(a>0){const s=new Uint8Array(this.degree);return s.set(i,a),s}return i},vn=n,vn}var wn={},xn={},_n={},Pr;function Xi(){return Pr||(Pr=1,_n.isValid=function(n){return!isNaN(n)&&n>=1&&n<=40}),_n}var Ut={},Or;function Ki(){if(Or)return Ut;Or=1;const t="[0-9]+",n="[A-Z $%*+\\-./:]+";let e="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";e=e.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+e+`)(?:.|[\r
]))+`;Ut.KANJI=new RegExp(e,"g"),Ut.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Ut.BYTE=new RegExp(r,"g"),Ut.NUMERIC=new RegExp(t,"g"),Ut.ALPHANUMERIC=new RegExp(n,"g");const o=new RegExp("^"+e+"$"),i=new RegExp("^"+t+"$"),a=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Ut.testKanji=function(l){return o.test(l)},Ut.testNumeric=function(l){return i.test(l)},Ut.testAlphanumeric=function(l){return a.test(l)},Ut}var Fr;function oe(){return Fr||(Fr=1,function(t){const n=Xi(),e=Ki();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,a){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!n.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?i.ccBits[0]:a<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return e.testNumeric(i)?t.NUMERIC:e.testAlphanumeric(i)?t.ALPHANUMERIC:e.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function r(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+o)}}t.from=function(i,a){if(t.isValid(i))return i;try{return r(i)}catch{return a}}}(xn)),xn}var Ur;function ra(){return Ur||(Ur=1,function(t){const n=ie(),e=Zi(),r=Xn(),o=oe(),i=Xi(),a=7973,s=n.getBCHDigit(a);function l(g,u,y){for(let d=1;d<=40;d++)if(u<=t.getCapacity(d,y,g))return d}function f(g,u){return o.getCharCountIndicator(g,u)+4}function c(g,u){let y=0;return g.forEach(function(d){const v=f(d.mode,u);y+=v+d.getBitsLength()}),y}function m(g,u){for(let y=1;y<=40;y++)if(c(g,y)<=t.getCapacity(y,u,o.MIXED))return y}t.from=function(u,y){return i.isValid(u)?parseInt(u,10):y},t.getCapacity=function(u,y,d){if(!i.isValid(u))throw new Error("Invalid QR Code version");typeof d>"u"&&(d=o.BYTE);const v=n.getSymbolTotalCodewords(u),b=e.getTotalCodewordsCount(u,y),x=(v-b)*8;if(d===o.MIXED)return x;const _=x-f(d,u);switch(d){case o.NUMERIC:return Math.floor(_/10*3);case o.ALPHANUMERIC:return Math.floor(_/11*2);case o.KANJI:return Math.floor(_/13);case o.BYTE:default:return Math.floor(_/8)}},t.getBestVersionForData=function(u,y){let d;const v=r.from(y,r.M);if(Array.isArray(u)){if(u.length>1)return m(u,v);if(u.length===0)return 1;d=u[0]}else d=u;return l(d.mode,d.getLength(),v)},t.getEncodedBits=function(u){if(!i.isValid(u)||u<7)throw new Error("Invalid QR Code version");let y=u<<12;for(;n.getBCHDigit(y)-s>=0;)y^=a<<n.getBCHDigit(y)-s;return u<<12|y}}(wn)),wn}var kn={},Wr;function ia(){if(Wr)return kn;Wr=1;const t=ie(),n=1335,e=21522,r=t.getBCHDigit(n);return kn.getEncodedBits=function(i,a){const s=i.bit<<3|a;let l=s<<10;for(;t.getBCHDigit(l)-r>=0;)l^=n<<t.getBCHDigit(l)-r;return(s<<10|l)^e},kn}var Cn={},En,qr;function oa(){if(qr)return En;qr=1;const t=oe();function n(e){this.mode=t.NUMERIC,this.data=e.toString()}return n.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let o,i,a;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),a=parseInt(i,10),r.put(a,10);const s=this.data.length-o;s>0&&(i=this.data.substr(o),a=parseInt(i,10),r.put(a,s*3+1))},En=n,En}var Sn,Vr;function sa(){if(Vr)return Sn;Vr=1;const t=oe(),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function e(r){this.mode=t.ALPHANUMERIC,this.data=r}return e.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(o){let i;for(i=0;i+2<=this.data.length;i+=2){let a=n.indexOf(this.data[i])*45;a+=n.indexOf(this.data[i+1]),o.put(a,11)}this.data.length%2&&o.put(n.indexOf(this.data[i]),6)},Sn=e,Sn}var Rn,Yr;function aa(){if(Yr)return Rn;Yr=1;const t=oe();function n(e){this.mode=t.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}return n.getBitsLength=function(r){return r*8},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(e){for(let r=0,o=this.data.length;r<o;r++)e.put(this.data[r],8)},Rn=n,Rn}var An,$r;function la(){if($r)return An;$r=1;const t=oe(),n=ie();function e(r){this.mode=t.KANJI,this.data=r}return e.getBitsLength=function(o){return o*13},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(r){let o;for(o=0;o<this.data.length;o++){let i=n.toSJIS(this.data[o]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),r.put(i,13)}},An=e,An}var Nn={exports:{}},Gr;function ca(){return Gr||(Gr=1,function(t){var n={single_source_shortest_paths:function(e,r,o){var i={},a={};a[r]=0;var s=n.PriorityQueue.make();s.push(r,0);for(var l,f,c,m,g,u,y,d,v;!s.empty();){l=s.pop(),f=l.value,m=l.cost,g=e[f]||{};for(c in g)g.hasOwnProperty(c)&&(u=g[c],y=m+u,d=a[c],v=typeof a[c]>"u",(v||d>y)&&(a[c]=y,s.push(c,y),i[c]=f))}if(typeof o<"u"&&typeof a[o]>"u"){var b=["Could not find a path from ",r," to ",o,"."].join("");throw new Error(b)}return i},extract_shortest_path_from_predecessor_list:function(e,r){for(var o=[],i=r;i;)o.push(i),e[i],i=e[i];return o.reverse(),o},find_path:function(e,r,o){var i=n.single_source_shortest_paths(e,r,o);return n.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(e){var r=n.PriorityQueue,o={},i;e=e||{};for(i in r)r.hasOwnProperty(i)&&(o[i]=r[i]);return o.queue=[],o.sorter=e.sorter||r.default_sorter,o},default_sorter:function(e,r){return e.cost-r.cost},push:function(e,r){var o={value:e,cost:r};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=n}(Nn)),Nn.exports}var Hr;function da(){return Hr||(Hr=1,function(t){const n=oe(),e=oa(),r=sa(),o=aa(),i=la(),a=Ki(),s=ie(),l=ca();function f(b){return unescape(encodeURIComponent(b)).length}function c(b,x,_){const k=[];let C;for(;(C=b.exec(_))!==null;)k.push({data:C[0],index:C.index,mode:x,length:C[0].length});return k}function m(b){const x=c(a.NUMERIC,n.NUMERIC,b),_=c(a.ALPHANUMERIC,n.ALPHANUMERIC,b);let k,C;return s.isKanjiModeEnabled()?(k=c(a.BYTE,n.BYTE,b),C=c(a.KANJI,n.KANJI,b)):(k=c(a.BYTE_KANJI,n.BYTE,b),C=[]),x.concat(_,k,C).sort(function(D,I){return D.index-I.index}).map(function(D){return{data:D.data,mode:D.mode,length:D.length}})}function g(b,x){switch(x){case n.NUMERIC:return e.getBitsLength(b);case n.ALPHANUMERIC:return r.getBitsLength(b);case n.KANJI:return i.getBitsLength(b);case n.BYTE:return o.getBitsLength(b)}}function u(b){return b.reduce(function(x,_){const k=x.length-1>=0?x[x.length-1]:null;return k&&k.mode===_.mode?(x[x.length-1].data+=_.data,x):(x.push(_),x)},[])}function y(b){const x=[];for(let _=0;_<b.length;_++){const k=b[_];switch(k.mode){case n.NUMERIC:x.push([k,{data:k.data,mode:n.ALPHANUMERIC,length:k.length},{data:k.data,mode:n.BYTE,length:k.length}]);break;case n.ALPHANUMERIC:x.push([k,{data:k.data,mode:n.BYTE,length:k.length}]);break;case n.KANJI:x.push([k,{data:k.data,mode:n.BYTE,length:f(k.data)}]);break;case n.BYTE:x.push([{data:k.data,mode:n.BYTE,length:f(k.data)}])}}return x}function d(b,x){const _={},k={start:{}};let C=["start"];for(let N=0;N<b.length;N++){const D=b[N],I=[];for(let z=0;z<D.length;z++){const O=D[z],M=""+N+z;I.push(M),_[M]={node:O,lastCount:0},k[M]={};for(let w=0;w<C.length;w++){const S=C[w];_[S]&&_[S].node.mode===O.mode?(k[S][M]=g(_[S].lastCount+O.length,O.mode)-g(_[S].lastCount,O.mode),_[S].lastCount+=O.length):(_[S]&&(_[S].lastCount=O.length),k[S][M]=g(O.length,O.mode)+4+n.getCharCountIndicator(O.mode,x))}}C=I}for(let N=0;N<C.length;N++)k[C[N]].end=0;return{map:k,table:_}}function v(b,x){let _;const k=n.getBestModeForData(b);if(_=n.from(x,k),_!==n.BYTE&&_.bit<k.bit)throw new Error('"'+b+'" cannot be encoded with mode '+n.toString(_)+`.
 Suggested mode is: `+n.toString(k));switch(_===n.KANJI&&!s.isKanjiModeEnabled()&&(_=n.BYTE),_){case n.NUMERIC:return new e(b);case n.ALPHANUMERIC:return new r(b);case n.KANJI:return new i(b);case n.BYTE:return new o(b)}}t.fromArray=function(x){return x.reduce(function(_,k){return typeof k=="string"?_.push(v(k,null)):k.data&&_.push(v(k.data,k.mode)),_},[])},t.fromString=function(x,_){const k=m(x,s.isKanjiModeEnabled()),C=y(k),N=d(C,_),D=l.find_path(N.map,"start","end"),I=[];for(let z=1;z<D.length-1;z++)I.push(N.table[D[z]].node);return t.fromArray(u(I))},t.rawSplit=function(x){return t.fromArray(m(x,s.isKanjiModeEnabled()))}}(Cn)),Cn}var Zr;function ua(){if(Zr)return un;Zr=1;const t=ie(),n=Xn(),e=Zs(),r=Xs(),o=Ks(),i=Qs(),a=Js(),s=Zi(),l=na(),f=ra(),c=ia(),m=oe(),g=da();function u(N,D){const I=N.size,z=i.getPositions(D);for(let O=0;O<z.length;O++){const M=z[O][0],w=z[O][1];for(let S=-1;S<=7;S++)if(!(M+S<=-1||I<=M+S))for(let h=-1;h<=7;h++)w+h<=-1||I<=w+h||(S>=0&&S<=6&&(h===0||h===6)||h>=0&&h<=6&&(S===0||S===6)||S>=2&&S<=4&&h>=2&&h<=4?N.set(M+S,w+h,!0,!0):N.set(M+S,w+h,!1,!0))}}function y(N){const D=N.size;for(let I=8;I<D-8;I++){const z=I%2===0;N.set(I,6,z,!0),N.set(6,I,z,!0)}}function d(N,D){const I=o.getPositions(D);for(let z=0;z<I.length;z++){const O=I[z][0],M=I[z][1];for(let w=-2;w<=2;w++)for(let S=-2;S<=2;S++)w===-2||w===2||S===-2||S===2||w===0&&S===0?N.set(O+w,M+S,!0,!0):N.set(O+w,M+S,!1,!0)}}function v(N,D){const I=N.size,z=f.getEncodedBits(D);let O,M,w;for(let S=0;S<18;S++)O=Math.floor(S/3),M=S%3+I-8-3,w=(z>>S&1)===1,N.set(O,M,w,!0),N.set(M,O,w,!0)}function b(N,D,I){const z=N.size,O=c.getEncodedBits(D,I);let M,w;for(M=0;M<15;M++)w=(O>>M&1)===1,M<6?N.set(M,8,w,!0):M<8?N.set(M+1,8,w,!0):N.set(z-15+M,8,w,!0),M<8?N.set(8,z-M-1,w,!0):M<9?N.set(8,15-M-1+1,w,!0):N.set(8,15-M-1,w,!0);N.set(z-8,8,1,!0)}function x(N,D){const I=N.size;let z=-1,O=I-1,M=7,w=0;for(let S=I-1;S>0;S-=2)for(S===6&&S--;;){for(let h=0;h<2;h++)if(!N.isReserved(O,S-h)){let E=!1;w<D.length&&(E=(D[w]>>>M&1)===1),N.set(O,S-h,E),M--,M===-1&&(w++,M=7)}if(O+=z,O<0||I<=O){O-=z,z=-z;break}}}function _(N,D,I){const z=new e;I.forEach(function(h){z.put(h.mode.bit,4),z.put(h.getLength(),m.getCharCountIndicator(h.mode,N)),h.write(z)});const O=t.getSymbolTotalCodewords(N),M=s.getTotalCodewordsCount(N,D),w=(O-M)*8;for(z.getLengthInBits()+4<=w&&z.put(0,4);z.getLengthInBits()%8!==0;)z.putBit(0);const S=(w-z.getLengthInBits())/8;for(let h=0;h<S;h++)z.put(h%2?17:236,8);return k(z,N,D)}function k(N,D,I){const z=t.getSymbolTotalCodewords(D),O=s.getTotalCodewordsCount(D,I),M=z-O,w=s.getBlocksCount(D,I),S=z%w,h=w-S,E=Math.floor(z/w),F=Math.floor(M/w),W=F+1,V=E-F,Y=new l(V);let tt=0;const P=new Array(w),L=new Array(w);let K=0;const X=new Uint8Array(N.buffer);for(let st=0;st<w;st++){const at=st<h?F:W;P[st]=X.slice(tt,tt+at),L[st]=Y.encode(P[st]),tt+=at,K=Math.max(K,at)}const H=new Uint8Array(z);let ct=0,ot,et;for(ot=0;ot<K;ot++)for(et=0;et<w;et++)ot<P[et].length&&(H[ct++]=P[et][ot]);for(ot=0;ot<V;ot++)for(et=0;et<w;et++)H[ct++]=L[et][ot];return H}function C(N,D,I,z){let O;if(Array.isArray(N))O=g.fromArray(N);else if(typeof N=="string"){let E=D;if(!E){const F=g.rawSplit(N);E=f.getBestVersionForData(F,I)}O=g.fromString(N,E||40)}else throw new Error("Invalid data");const M=f.getBestVersionForData(O,I);if(!M)throw new Error("The amount of data is too big to be stored in a QR Code");if(!D)D=M;else if(D<M)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+M+`.
`);const w=_(D,I,O),S=t.getSymbolSize(D),h=new r(S);return u(h,D),y(h),d(h,D),b(h,I,0),D>=7&&v(h,D),x(h,w),isNaN(z)&&(z=a.getBestMask(h,b.bind(null,h,I))),a.applyMask(z,h),b(h,I,z),{modules:h,version:D,errorCorrectionLevel:I,maskPattern:z,segments:O}}return un.create=function(D,I){if(typeof D>"u"||D==="")throw new Error("No input text");let z=n.M,O,M;return typeof I<"u"&&(z=n.from(I.errorCorrectionLevel,n.M),O=f.from(I.version),M=a.from(I.maskPattern),I.toSJISFunc&&t.setToSJISFunction(I.toSJISFunc)),C(D,O,z,M)},un}var In={},Tn={},Xr;function Qi(){return Xr||(Xr=1,function(t){function n(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let r=e.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+e);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(i){return[i,i]}))),r.length===6&&r.push("F","F");const o=parseInt(r.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+r.slice(0,6).join("")}}t.getOptions=function(r){r||(r={}),r.color||(r.color={});const o=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,i=r.width&&r.width>=21?r.width:void 0,a=r.scale||4;return{width:i,scale:i?4:a,margin:o,color:{dark:n(r.color.dark||"#000000ff"),light:n(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},t.getScale=function(r,o){return o.width&&o.width>=r+o.margin*2?o.width/(r+o.margin*2):o.scale},t.getImageWidth=function(r,o){const i=t.getScale(r,o);return Math.floor((r+o.margin*2)*i)},t.qrToImageData=function(r,o,i){const a=o.modules.size,s=o.modules.data,l=t.getScale(a,i),f=Math.floor((a+i.margin*2)*l),c=i.margin*l,m=[i.color.light,i.color.dark];for(let g=0;g<f;g++)for(let u=0;u<f;u++){let y=(g*f+u)*4,d=i.color.light;if(g>=c&&u>=c&&g<f-c&&u<f-c){const v=Math.floor((g-c)/l),b=Math.floor((u-c)/l);d=m[s[v*a+b]?1:0]}r[y++]=d.r,r[y++]=d.g,r[y++]=d.b,r[y]=d.a}}}(Tn)),Tn}var Kr;function fa(){return Kr||(Kr=1,function(t){const n=Qi();function e(o,i,a){o.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=a,i.width=a,i.style.height=a+"px",i.style.width=a+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,a,s){let l=s,f=a;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),a||(f=r()),l=n.getOptions(l);const c=n.getImageWidth(i.modules.size,l),m=f.getContext("2d"),g=m.createImageData(c,c);return n.qrToImageData(g.data,i,l),e(m,f,c),m.putImageData(g,0,0),f},t.renderToDataURL=function(i,a,s){let l=s;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),l||(l={});const f=t.render(i,a,l),c=l.type||"image/png",m=l.rendererOpts||{};return f.toDataURL(c,m.quality)}}(In)),In}var Dn={},Qr;function ha(){if(Qr)return Dn;Qr=1;const t=Qi();function n(o,i){const a=o.a/255,s=i+'="'+o.hex+'"';return a<1?s+" "+i+'-opacity="'+a.toFixed(2).slice(1)+'"':s}function e(o,i,a){let s=o+i;return typeof a<"u"&&(s+=" "+a),s}function r(o,i,a){let s="",l=0,f=!1,c=0;for(let m=0;m<o.length;m++){const g=Math.floor(m%i),u=Math.floor(m/i);!g&&!f&&(f=!0),o[m]?(c++,m>0&&g>0&&o[m-1]||(s+=f?e("M",g+a,.5+u+a):e("m",l,0),l=0,f=!1),g+1<i&&o[m+1]||(s+=e("h",c),c=0)):l++}return s}return Dn.render=function(i,a,s){const l=t.getOptions(a),f=i.modules.size,c=i.modules.data,m=f+l.margin*2,g=l.color.light.a?"<path "+n(l.color.light,"fill")+' d="M0 0h'+m+"v"+m+'H0z"/>':"",u="<path "+n(l.color.dark,"stroke")+' d="'+r(c,f,l.margin)+'"/>',y='viewBox="0 0 '+m+" "+m+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+y+' shape-rendering="crispEdges">'+g+u+`</svg>
`;return typeof s=="function"&&s(null,v),v},Dn}var Jr;function pa(){if(Jr)return ce;Jr=1;const t=Hs(),n=ua(),e=fa(),r=ha();function o(i,a,s,l,f){const c=[].slice.call(arguments,1),m=c.length,g=typeof c[m-1]=="function";if(!g&&!t())throw new Error("Callback required as last argument");if(g){if(m<2)throw new Error("Too few arguments provided");m===2?(f=s,s=a,a=l=void 0):m===3&&(a.getContext&&typeof f>"u"?(f=l,l=void 0):(f=l,l=s,s=a,a=void 0))}else{if(m<1)throw new Error("Too few arguments provided");return m===1?(s=a,a=l=void 0):m===2&&!a.getContext&&(l=s,s=a,a=void 0),new Promise(function(u,y){try{const d=n.create(s,l);u(i(d,a,l))}catch(d){y(d)}})}try{const u=n.create(s,l);f(null,i(u,a,l))}catch(u){f(u)}}return ce.create=n.create,ce.toCanvas=o.bind(null,e.render),ce.toDataURL=o.bind(null,e.renderToDataURL),ce.toString=o.bind(null,function(i,a,s){return r.render(i,s)}),ce}var ma=pa();const ga=mi(ma);async function qn(t,n=512,e=1){const r={errorCorrectionLevel:"M",type:"image/png",margin:e,width:n,color:{dark:"#000000",light:"#ffffff"}};return ga.toDataURL(t,r)}const Kn=(()=>{const t=vt.get().DEFAULTS?.BACKGROUND;return{color:typeof t?.color=="string"?t.color:"#ffffff",alpha:Math.max(0,Math.min(1,typeof t?.alpha=="number"?t.alpha:1))}})(),re={scale:1,tx:0,ty:0},zn=(t,n,e)=>Math.max(n,Math.min(e,t)),$t=(t,n)=>typeof t=="number"?t:n;function ba(t){return new Promise((n,e)=>{const r=new Image;r.onload=()=>n({w:r.naturalWidth,h:r.naturalHeight}),r.onerror=e,r.src=t})}function ya(t,n,e,r,o,i,a=1){const s=e/t,l=e/n,f=Math.min(s,l)*a,c=t*f,m=n*f,g=o==="left"?0:o==="right"?e-c:(e-c)/2,u=i==="top"?0:i==="bottom"?e-m:(e-m)/2,y=(g-(e-c)/2)/e*100,d=(u-(e-m)/2)/e*100;return{tx:Math.max(-100,Math.min(100,y)),ty:Math.max(-100,Math.min(100,d))}}const ft=gi((t,n)=>({photos:[],max:Gi,fitModeByPhoto:{},setFitMode:(e,r)=>t(o=>({fitModeByPhoto:{...o.fitModeByPhoto,[e]:r}})),transforms:{},layersByPhoto:{},cardBackground:{},setCardBackground:(e,r)=>t(o=>{const i=o.cardBackground[e]??Kn,a={color:r.color??i.color,alpha:Math.max(0,Math.min(1,r.alpha??i.alpha))};return{cardBackground:{...o.cardBackground,[e]:a}}}),setTransform:(e,r)=>t(o=>{const i=o.transforms[e]??re,a={scale:zn(r.scale??i.scale,.5,4),...r.scaleAbs!=null?{scaleAbs:Math.max(1e-4,r.scaleAbs)}:i.scaleAbs!=null?{scaleAbs:i.scaleAbs}:{},tx:zn(r.tx??i.tx,-100,100),ty:zn(r.ty??i.ty,-100,100)};return{transforms:{...o.transforms,[e]:a}}}),resetTransform:e=>t(r=>{const{[e]:o,...i}=r.transforms;return{transforms:i}}),add:(e,r)=>{if(!e?.length)return;const{photos:o,max:i}=n(),a=Math.max(0,i-o.length);if(a<=0){alert(`Достигнут лимит коллекции: ${i} карточек.`);return}let s=e;if(e.length>a&&(alert(`Можно добавить только ${a} из ${e.length} — лимит коллекции ${i}.`),s=e.slice(0,a)),t({photos:[...o,...s]}),r?.skipInit)return;r?.skipInit||t(f=>{const c={...f.fitModeByPhoto};for(const m of s)c[m.id]==null&&(c[m.id]=Er);return{fitModeByPhoto:c}});const l=vt.get().DEFAULT_CARD_LAYERS??[];if(l.length){for(const f of s)for(const c of l)if(c?.type==="text"){const m=$t(c.y,It-140);n().addTextLayer(f.id,{x:typeof c.x=="number"?c.x:40,y:m,text:typeof c.text=="string"?c.text:void 0,fontFamily:typeof c.fontFamily=="string"?c.fontFamily:void 0,fontSize:typeof c.fontSize=="number"?c.fontSize:void 0,fontStyle:typeof c.fontStyle=="string"?c.fontStyle:void 0,fill:typeof c.fill=="string"?c.fill:void 0,align:["left","center","right"].includes(c.align)?c.align:void 0,lineHeight:typeof c.lineHeight=="number"?c.lineHeight:void 0,letterSpacing:typeof c.letterSpacing=="number"?c.letterSpacing:void 0,width:typeof c.width=="number"?c.width:void 0,rotation:typeof c.rotation=="number"?c.rotation:void 0,name:typeof c.name=="string"?c.name:void 0})}else if(c?.type==="rect"){const m=$t(c.y,40);n().addRectLayer(f.id,{x:typeof c.x=="number"?c.x:40,y:m,width:typeof c.width=="number"?c.width:void 0,height:typeof c.height=="number"?c.height:void 0,fill:typeof c.fill=="string"?c.fill:void 0,stroke:typeof c.stroke=="string"?c.stroke:void 0,strokeWidth:typeof c.strokeWidth=="number"?c.strokeWidth:void 0,cornerRadius:typeof c.cornerRadius=="number"?c.cornerRadius:void 0,opacity:typeof c.opacity=="number"?c.opacity:void 0,rotation:typeof c.rotation=="number"?c.rotation:void 0,name:typeof c.name=="string"?c.name:void 0})}else if(c?.type==="qr"){const m=$t(c.y,40),g=Math.max(1,Math.round(typeof c.size=="number"?c.size:512));(async()=>{const u=await n().addQrLayer(f.id,typeof c.text=="string"?c.text:"",g);n().updateLayer(f.id,u,{x:typeof c.x=="number"?c.x:40,y:m,name:typeof c.name=="string"?c.name:void 0})})()}}for(const f of s)(async()=>{try{const{w:c,h:m}=await ba(f.url),g=vt.get(),u=Math.max(0,Number(g.NEAR_SQUARE_TOLERANCE??0)),y=Number(g.NEAR_SQUARE_SCALE??1),d=It,v=d/c,b=d/m,x=Math.min(v,b),_=Math.max(v,b),k=Er==="contain",C=c/m,N=Math.abs(C-1)<=u;let D=1;k?D=N?y:1:D=_/x;const{tx:I,ty:z}=ya(c,m,d,"contain",$s,Gs,D);n().setTransform(f.id,{tx:I,ty:z,scale:Math.max(.5,Math.min(4,re.scale*D))});const O=vt.get().LAYER_PROFILES?.orientation;if(O&&O.on!==!1){let M;C>1+u?M="landscape":C<1-u?M="portrait":M="square";const w=M==="landscape"?O.landscape??[]:M==="portrait"?O.portrait??[]:O.square??[];for(const S of w)if(!(!S||typeof S!="object")){if(S.type==="text"){const h=$t(S.y,It-140);n().addTextLayer(f.id,{x:typeof S.x=="number"?S.x:40,y:h,text:typeof S.text=="string"?S.text:void 0,fontFamily:typeof S.fontFamily=="string"?S.fontFamily:void 0,fontSize:typeof S.fontSize=="number"?S.fontSize:void 0,fontStyle:typeof S.fontStyle=="string"?S.fontStyle:void 0,fill:typeof S.fill=="string"?S.fill:void 0,align:["left","center","right"].includes(S.align)?S.align:void 0,lineHeight:typeof S.lineHeight=="number"?S.lineHeight:void 0,letterSpacing:typeof S.letterSpacing=="number"?S.letterSpacing:void 0,width:typeof S.width=="number"?S.width:void 0,rotation:typeof S.rotation=="number"?S.rotation:void 0,name:typeof S.name=="string"?S.name:void 0})}else if(S.type==="rect"){const h=$t(S.y,40);n().addRectLayer(f.id,{x:typeof S.x=="number"?S.x:40,y:h,width:typeof S.width=="number"?S.width:void 0,height:typeof S.height=="number"?S.height:void 0,fill:typeof S.fill=="string"?S.fill:void 0,stroke:typeof S.stroke=="string"?S.stroke:void 0,strokeWidth:typeof S.strokeWidth=="number"?S.strokeWidth:void 0,cornerRadius:typeof S.cornerRadius=="number"?S.cornerRadius:void 0,opacity:typeof S.opacity=="number"?S.opacity:void 0,rotation:typeof S.rotation=="number"?S.rotation:void 0,name:typeof S.name=="string"?S.name:void 0})}else if(S.type==="qr"){const h=$t(S.y,40),E=Math.max(1,Math.round(typeof S.size=="number"?S.size:512)),F=await n().addQrLayer(f.id,typeof S.text=="string"?S.text:"",E);n().updateLayer(f.id,F,{x:typeof S.x=="number"?S.x:40,y:h,rotation:typeof S.rotation=="number"?S.rotation:void 0,name:typeof S.name=="string"?S.name:void 0})}}}}catch{}})()},clear:()=>{const e=n().photos;e.length&&kr(e),t({photos:[],transforms:{},layersByPhoto:{},cardBackground:{},fitModeByPhoto:{}})},remove:e=>t(r=>{const o=r.photos.findIndex(f=>f.id===e);if(o===-1)return null;kr([r.photos[o]]);const{[e]:i,...a}=r.transforms,s={...r.layersByPhoto};delete s[e];const l={...r.fitModeByPhoto};return delete l[e],{photos:r.photos.filter(f=>f.id!==e),transforms:a,layersByPhoto:s,fitModeByPhoto:l}}),addTextLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const f=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=vt.get().DEFAULTS?.TEXT??{},m=$t(c.y,It-140),g=f??m,u={id:o,type:"text",x:typeof c.x=="number"?c.x:40,y:g,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,text:typeof c.text=="string"?c.text:"New text",fontFamily:typeof c.fontFamily=="string"?c.fontFamily:"Georgia, serif",fontSize:typeof c.fontSize=="number"?c.fontSize:36,fontStyle:typeof c.fontStyle=="string"?c.fontStyle:"",fill:typeof c.fill=="string"?c.fill:"#111",align:["left","center","right"].includes(c.align)?c.align:"left",verticalAlign:["top","middle","bottom"].includes(c.verticalAlign)?c.verticalAlign:"top",padding:typeof c.padding=="number"?c.padding:0,lineHeight:typeof c.lineHeight=="number"?c.lineHeight:1.25,letterSpacing:typeof c.letterSpacing=="number"?c.letterSpacing:0,width:typeof c.width=="number"?c.width:void 0,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,u]}}}),o},addRectLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const f=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=vt.get().DEFAULTS?.RECT??{},m=$t(c.y,40),g=f??m,u={id:o,type:"rect",x:typeof c.x=="number"?c.x:40,y:g,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,width:typeof c.width=="number"?c.width:600,height:typeof c.height=="number"?c.height:300,fill:typeof c.fill=="string"?c.fill:"#ffffff",stroke:typeof c.stroke=="string"?c.stroke:void 0,strokeWidth:typeof c.strokeWidth=="number"?c.strokeWidth:0,cornerRadius:typeof c.cornerRadius=="number"?c.cornerRadius:0,opacity:typeof c.opacity=="number"?c.opacity:1,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,u]}}}),o},addImageLayer:(e,r={})=>{const o=crypto.randomUUID();return t(i=>{const a=i.layersByPhoto[e]??[],s=a.length?Math.max(...a.map(y=>y.z))+1:1,l={...r};delete l.id,delete l.type,delete l.z;const f=typeof l.y=="number"?l.y:void 0;"y"in l&&delete l.y;const c=vt.get().DEFAULTS?.IMAGE??{},m=$t(c.y,40),g=f??m,u={id:o,type:"image",x:typeof c.x=="number"?c.x:40,y:g,rotation:0,scaleX:1,scaleY:1,visible:!0,z:s,src:"",w:typeof c.w=="number"?c.w:void 0,h:typeof c.h=="number"?c.h:void 0,...l};return{layersByPhoto:{...i.layersByPhoto,[e]:[...a,u]}}}),o},addQrLayer:async(e,r,o=512)=>{const i=vt.get().DEFAULTS?.QR??{},a=Math.max(1,Math.round(typeof o=="number"?o:i.size??512)),s=await qn(r,a,1);return n().addImageLayer(e,{src:s,x:typeof i.x=="number"?i.x:40,y:typeof i.y=="number"?i.y:40,w:a,h:a,qrText:r})},updateQrLayer:async(e,r,o)=>{const a=n().layersByPhoto[e]??[],s=a.findIndex(g=>g.id===r&&g.type==="image");if(s===-1)return;const l=a[s];if(!l.qrText&&!o.text)return;const f=o.text??l.qrText??"",c=Math.max(1,Math.round(o.size??l.w??l.h??512)),m=await qn(f,c,1);n().updateLayer(e,r,{src:m,w:c,h:c,...f?{qrText:f}:{}})},updateLayer:(e,r,o)=>t(i=>{const a=i.layersByPhoto[e]??[],s=a.findIndex(g=>g.id===r);if(s===-1)return null;const l=a[s],f={...o};delete f.id,delete f.type;const c={...l,...f},m=[...a];return m[s]=c,{layersByPhoto:{...i.layersByPhoto,[e]:m}}}),removeLayer:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[],a=i.filter(s=>s.id!==r);return a===i?null:{layersByPhoto:{...o.layersByPhoto,[e]:a}}}),bringToFront:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=Math.max(...i.map(l=>l.z)),s=i.map(l=>l.id===r?{...l,z:a+1}:l);return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),sendToBack:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=Math.min(...i.map(l=>l.z)),s=i.map(l=>l.id===r?{...l,z:a-1}:l);return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),setLayersOrder:(e,r)=>t(o=>{const i=o.layersByPhoto[e]??[];if(!i.length)return null;const a=new Map(i.map(f=>[f.id,f])),s=[];let l=1;for(const f of r){const c=a.get(f);c&&s.push({...c,z:l++})}for(const f of i)r.includes(f.id)||s.push({...f,z:l++});return{layersByPhoto:{...o.layersByPhoto,[e]:s}}}),reorderPhotos:e=>t(r=>{if(!Array.isArray(e)||!e.length)return null;const o=new Map(r.photos.map(a=>[a.id,a])),i=e.map(a=>o.get(a)).filter(Boolean);for(const a of r.photos)e.includes(a.id)||i.push(a);return{photos:i}})}));function va(t){const n=t.replace(/^\uFEFF/,"").replace(/\r\n?/g,`
`).split(`
`).filter(Boolean);if(!n.length)return{rows:[],hasRelative:!1};const e=n[0].toLowerCase(),r=e.includes(";")&&!e.includes(",")?";":",",o=new RegExp(`\\s*(?:"([^"]*)"|([^${r}\\n]*))\\s*(?:${r}|$)`,"g");function i(f){const c=f.toLowerCase();switch(c){case"fontsize":return"fontSize";case"fontstyle":return"fontStyle";case"lineheight":return"lineHeight";case"letterspacing":return"letterSpacing";default:return c}}let a=null;{const f=n[0].toLowerCase();if(/\burl\b/.test(f)){o.lastIndex=0;const c=[];let m;for(;m=o.exec(n[0]);){const g=m[1]??m[2]??"",u=(m[1]?g.replace(/""/g,'"'):g).trim();if(u&&c.push(u),m.index+m[0].length>=n[0].length)break}c.map(g=>g.toLowerCase()).includes("url")&&(a=c)}}const s=[];for(let f=0;f<n.length;f++){const c=n[f];if(!c.trim()||f===0&&a)continue;const m=[];o.lastIndex=0;let g,u=0;for(;(g=o.exec(c))&&u++<1e3;){const x=g[1]??g[2]??"",_=(g[1]?x.replace(/""/g,'"'):x).trim();if(m.push(_),g.index+g[0].length>=c.length)break}if(!m.length)continue;if(!a){const x=(m[0]??"").trim();if(!x)continue;const _=(m[1]??"").trim()||void 0;s.push({url:x,caption:_});continue}const y={};a.forEach((x,_)=>y[x.trim().toLowerCase()]=m[_]??"");const d=(y.url??"").trim();if(!d)continue;const v=(y.caption??"").trim()||void 0,b={};for(const[x,_]of Object.entries(y)){const k=_?.trim(),C=/^layer_([^_]+)_(.+)$/i.exec(x.trim());if(C&&k){const N=`layer_${C[1]}`.toLowerCase(),D=i(C[2]);b[N]||(b[N]={}),b[N][D]=k}}s.push({url:d,caption:v,layers:Object.keys(b).length?b:void 0})}const l=s.some(f=>wa(f.url));return{rows:s,hasRelative:l}}function Ji(t){return/^https?:\/\//i.test(t)}function to(t){return/^data:/i.test(t)}function wa(t){return!(Ji(t)||to(t)||/^blob:/.test(t))}function We(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var jn={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var ti;function xa(){return ti||(ti=1,function(t,n){(function(e){t.exports=e()})(function(){return function e(r,o,i){function a(f,c){if(!o[f]){if(!r[f]){var m=typeof We=="function"&&We;if(!c&&m)return m(f,!0);if(s)return s(f,!0);var g=new Error("Cannot find module '"+f+"'");throw g.code="MODULE_NOT_FOUND",g}var u=o[f]={exports:{}};r[f][0].call(u.exports,function(y){var d=r[f][1][y];return a(d||y)},u,u.exports,e,r,o,i)}return o[f].exports}for(var s=typeof We=="function"&&We,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(e,r,o){var i=e("./utils"),a=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(l){for(var f,c,m,g,u,y,d,v=[],b=0,x=l.length,_=x,k=i.getTypeOf(l)!=="string";b<l.length;)_=x-b,m=k?(f=l[b++],c=b<x?l[b++]:0,b<x?l[b++]:0):(f=l.charCodeAt(b++),c=b<x?l.charCodeAt(b++):0,b<x?l.charCodeAt(b++):0),g=f>>2,u=(3&f)<<4|c>>4,y=1<_?(15&c)<<2|m>>6:64,d=2<_?63&m:64,v.push(s.charAt(g)+s.charAt(u)+s.charAt(y)+s.charAt(d));return v.join("")},o.decode=function(l){var f,c,m,g,u,y,d=0,v=0,b="data:";if(l.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var x,_=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&_--,l.charAt(l.length-2)===s.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=a.uint8array?new Uint8Array(0|_):new Array(0|_);d<l.length;)f=s.indexOf(l.charAt(d++))<<2|(g=s.indexOf(l.charAt(d++)))>>4,c=(15&g)<<4|(u=s.indexOf(l.charAt(d++)))>>2,m=(3&u)<<6|(y=s.indexOf(l.charAt(d++))),x[v++]=f,u!==64&&(x[v++]=c),y!==64&&(x[v++]=m);return x}},{"./support":30,"./utils":32}],2:[function(e,r,o){var i=e("./external"),a=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function f(c,m,g,u,y){this.compressedSize=c,this.uncompressedSize=m,this.crc32=g,this.compression=u,this.compressedContent=y}f.prototype={getContentWorker:function(){var c=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),m=this;return c.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(c,m,g){return c.pipe(new s).pipe(new l("uncompressedSize")).pipe(m.compressWorker(g)).pipe(new l("compressedSize")).withStreamInfo("compression",m)},r.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,o){var i=e("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},o.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,o){var i=e("./utils"),a=function(){for(var s,l=[],f=0;f<256;f++){s=f;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;l[f]=s}return l}();r.exports=function(s,l){return s!==void 0&&s.length?i.getTypeOf(s)!=="string"?function(f,c,m,g){var u=a,y=g+m;f^=-1;for(var d=g;d<y;d++)f=f>>>8^u[255&(f^c[d])];return-1^f}(0|l,s,s.length,0):function(f,c,m,g){var u=a,y=g+m;f^=-1;for(var d=g;d<y;d++)f=f>>>8^u[255&(f^c.charCodeAt(d))];return-1^f}(0|l,s,s.length,0):0}},{"./utils":32}],5:[function(e,r,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(e,r,o){var i=null;i=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:i}},{lie:37}],7:[function(e,r,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=e("pako"),s=e("./utils"),l=e("./stream/GenericWorker"),f=i?"uint8array":"array";function c(m,g){l.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=g,this.meta={}}o.magic="\b\0",s.inherits(c,l),c.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(f,m.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(g){m.push({data:g,meta:m.meta})}},o.compressWorker=function(m){return new c("Deflate",m)},o.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,o){function i(u,y){var d,v="";for(d=0;d<y;d++)v+=String.fromCharCode(255&u),u>>>=8;return v}function a(u,y,d,v,b,x){var _,k,C=u.file,N=u.compression,D=x!==f.utf8encode,I=s.transformTo("string",x(C.name)),z=s.transformTo("string",f.utf8encode(C.name)),O=C.comment,M=s.transformTo("string",x(O)),w=s.transformTo("string",f.utf8encode(O)),S=z.length!==C.name.length,h=w.length!==O.length,E="",F="",W="",V=C.dir,Y=C.date,tt={crc32:0,compressedSize:0,uncompressedSize:0};y&&!d||(tt.crc32=u.crc32,tt.compressedSize=u.compressedSize,tt.uncompressedSize=u.uncompressedSize);var P=0;y&&(P|=8),D||!S&&!h||(P|=2048);var L=0,K=0;V&&(L|=16),b==="UNIX"?(K=798,L|=function(H,ct){var ot=H;return H||(ot=ct?16893:33204),(65535&ot)<<16}(C.unixPermissions,V)):(K=20,L|=function(H){return 63&(H||0)}(C.dosPermissions)),_=Y.getUTCHours(),_<<=6,_|=Y.getUTCMinutes(),_<<=5,_|=Y.getUTCSeconds()/2,k=Y.getUTCFullYear()-1980,k<<=4,k|=Y.getUTCMonth()+1,k<<=5,k|=Y.getUTCDate(),S&&(F=i(1,1)+i(c(I),4)+z,E+="up"+i(F.length,2)+F),h&&(W=i(1,1)+i(c(M),4)+w,E+="uc"+i(W.length,2)+W);var X="";return X+=`
\0`,X+=i(P,2),X+=N.magic,X+=i(_,2),X+=i(k,2),X+=i(tt.crc32,4),X+=i(tt.compressedSize,4),X+=i(tt.uncompressedSize,4),X+=i(I.length,2),X+=i(E.length,2),{fileRecord:m.LOCAL_FILE_HEADER+X+I+E,dirRecord:m.CENTRAL_FILE_HEADER+i(K,2)+X+i(M.length,2)+"\0\0\0\0"+i(L,4)+i(v,4)+I+E+M}}var s=e("../utils"),l=e("../stream/GenericWorker"),f=e("../utf8"),c=e("../crc32"),m=e("../signature");function g(u,y,d,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=d,this.encodeFileName=v,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(g,l),g.prototype.push=function(u){var y=u.meta.percent||0,d=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,l.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:d?(y+100*(d-v-1))/d:100}}))},g.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var y=this.streamFiles&&!u.file.dir;if(y){var d=a(u,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(u){this.accumulate=!1;var y=this.streamFiles&&!u.file.dir,d=a(u,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),y)this.push({data:function(v){return m.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var u=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var d=this.bytesWritten-u,v=function(b,x,_,k,C){var N=s.transformTo("string",C(k));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(b,2)+i(b,2)+i(x,4)+i(_,4)+i(N.length,2)+N}(this.dirRecords.length,d,u,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(u){this._sources.push(u);var y=this;return u.on("data",function(d){y.processChunk(d)}),u.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),u.on("error",function(d){y.error(d)}),this},g.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(u){var y=this._sources;if(!l.prototype.error.call(this,u))return!1;for(var d=0;d<y.length;d++)try{y[d].error(u)}catch{}return!0},g.prototype.lock=function(){l.prototype.lock.call(this);for(var u=this._sources,y=0;y<u.length;y++)u[y].lock()},r.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,o){var i=e("../compressions"),a=e("./ZipFileWorker");o.generateWorker=function(s,l,f){var c=new a(l.streamFiles,f,l.platform,l.encodeFileName),m=0;try{s.forEach(function(g,u){m++;var y=function(x,_){var k=x||_,C=i[k];if(!C)throw new Error(k+" is not a valid compression method !");return C}(u.options.compression,l.compression),d=u.options.compressionOptions||l.compressionOptions||{},v=u.dir,b=u.date;u._compressWorker(y,d).withStreamInfo("file",{name:g,dir:v,date:b,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(c)}),c.entriesCount=m}catch(g){c.error(g)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,o){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var s in this)typeof this[s]!="function"&&(a[s]=this[s]);return a}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(a,s){return new i().loadAsync(a,s)},i.external=e("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,o){var i=e("./utils"),a=e("./external"),s=e("./utf8"),l=e("./zipEntries"),f=e("./stream/Crc32Probe"),c=e("./nodejsUtils");function m(g){return new a.Promise(function(u,y){var d=g.decompressed.getContentWorker().pipe(new f);d.on("error",function(v){y(v)}).on("end",function(){d.streamInfo.crc32!==g.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}r.exports=function(g,u){var y=this;return u=i.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),c.isNode&&c.isStream(g)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",g,!0,u.optimizedBinaryString,u.base64).then(function(d){var v=new l(u);return v.load(d),v}).then(function(d){var v=[a.Promise.resolve(d)],b=d.files;if(u.checkCRC32)for(var x=0;x<b.length;x++)v.push(m(b[x]));return a.Promise.all(v)}).then(function(d){for(var v=d.shift(),b=v.files,x=0;x<b.length;x++){var _=b[x],k=_.fileNameStr,C=i.resolve(_.fileNameStr);y.file(C,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:u.createFolders}),_.dir||(y.file(C).unsafeOriginalName=k)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,o){var i=e("../utils"),a=e("../stream/GenericWorker");function s(l,f){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(f)}i.inherits(s,a),s.prototype._bindStream=function(l){var f=this;(this._stream=l).pause(),l.on("data",function(c){f.push({data:c,meta:{percent:0}})}).on("error",function(c){f.isPaused?this.generatedError=c:f.error(c)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,o){var i=e("readable-stream").Readable;function a(s,l,f){i.call(this,l),this._helper=s;var c=this;s.on("data",function(m,g){c.push(m)||c._helper.pause(),f&&f(g)}).on("error",function(m){c.emit("error",m)}).on("end",function(){c.push(null)})}e("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,r,o){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,a)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var a=new Buffer(i);return a.fill(0),a},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(e,r,o){function i(C,N,D){var I,z=s.getTypeOf(N),O=s.extend(D||{},c);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(C=b(C)),O.createFolders&&(I=v(C))&&x.call(this,I,!0);var M=z==="string"&&O.binary===!1&&O.base64===!1;D&&D.binary!==void 0||(O.binary=!M),(N instanceof m&&N.uncompressedSize===0||O.dir||!N||N.length===0)&&(O.base64=!1,O.binary=!0,N="",O.compression="STORE",z="string");var w=null;w=N instanceof m||N instanceof l?N:y.isNode&&y.isStream(N)?new d(C,N):s.prepareContent(C,N,O.binary,O.optimizedBinaryString,O.base64);var S=new g(C,w,O);this.files[C]=S}var a=e("./utf8"),s=e("./utils"),l=e("./stream/GenericWorker"),f=e("./stream/StreamHelper"),c=e("./defaults"),m=e("./compressedObject"),g=e("./zipObject"),u=e("./generate"),y=e("./nodejsUtils"),d=e("./nodejs/NodejsStreamInputAdapter"),v=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var N=C.lastIndexOf("/");return 0<N?C.substring(0,N):""},b=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},x=function(C,N){return N=N!==void 0?N:c.createFolders,C=b(C),this.files[C]||i.call(this,C,null,{dir:!0,createFolders:N}),this.files[C]};function _(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var N,D,I;for(N in this.files)I=this.files[N],(D=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&C(D,I)},filter:function(C){var N=[];return this.forEach(function(D,I){C(D,I)&&N.push(I)}),N},file:function(C,N,D){if(arguments.length!==1)return C=this.root+C,i.call(this,C,N,D),this;if(_(C)){var I=C;return this.filter(function(O,M){return!M.dir&&I.test(O)})}var z=this.files[this.root+C];return z&&!z.dir?z:null},folder:function(C){if(!C)return this;if(_(C))return this.filter(function(z,O){return O.dir&&C.test(z)});var N=this.root+C,D=x.call(this,N),I=this.clone();return I.root=D.name,I},remove:function(C){C=this.root+C;var N=this.files[C];if(N||(C.slice(-1)!=="/"&&(C+="/"),N=this.files[C]),N&&!N.dir)delete this.files[C];else for(var D=this.filter(function(z,O){return O.name.slice(0,C.length)===C}),I=0;I<D.length;I++)delete this.files[D[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var N,D={};try{if((D=s.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");s.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var I=D.comment||this.comment||"";N=u.generateWorker(this,D,I)}catch(z){(N=new l("error")).error(z)}return new f(N,D.type||"string",D.mimeType)},generateAsync:function(C,N){return this.generateInternalStream(C).accumulate(N)},generateNodeStream:function(C,N){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(N)}};r.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,o){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,o){var i=e("./DataReader");function a(s){i.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}e("../utils").inherits(a,i),a.prototype.byteAt=function(s){return this.data[this.zero+s]},a.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),f=s.charCodeAt(1),c=s.charCodeAt(2),m=s.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===l&&this.data[g+1]===f&&this.data[g+2]===c&&this.data[g+3]===m)return g-this.zero;return-1},a.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),f=s.charCodeAt(1),c=s.charCodeAt(2),m=s.charCodeAt(3),g=this.readData(4);return l===g[0]&&f===g[1]&&c===g[2]&&m===g[3]},a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,r,o){var i=e("../utils");function a(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var l,f=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)f=(f<<8)+this.byteAt(l);return this.index+=s,f},readString:function(s){return i.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},r.exports=a},{"../utils":32}],19:[function(e,r,o){var i=e("./Uint8ArrayReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,o){var i=e("./DataReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},a.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},a.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,r,o){var i=e("./ArrayReader");function a(s){i.call(this,s)}e("../utils").inherits(a,i),a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,o){var i=e("../utils"),a=e("../support"),s=e("./ArrayReader"),l=e("./StringReader"),f=e("./NodeBufferReader"),c=e("./Uint8ArrayReader");r.exports=function(m){var g=i.getTypeOf(m);return i.checkSupport(g),g!=="string"||a.uint8array?g==="nodebuffer"?new f(m):a.uint8array?new c(i.transformTo("uint8array",m)):new s(i.transformTo("array",m)):new l(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,o){var i=e("./GenericWorker"),a=e("../utils");function s(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(s,i),s.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,o){var i=e("./GenericWorker"),a=e("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,i),s.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,o){var i=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(s,a),s.prototype.processChunk=function(l){if(l){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,o){var i=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){f.dataIsReady=!0,f.data=c,f.max=c&&c.length||0,f.type=i.getTypeOf(c),f.isPaused||f._tickAndRepeat()},function(c){f.error(c)})}i.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,f);break;case"uint8array":l=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":l=this.data.slice(this.index,f)}return this.index=f,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,o){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,s){return this._listeners[a].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,s){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,s)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var s=this;return a.on("data",function(l){s.processChunk(l)}),a.on("end",function(){s.end()}),a.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,s){return this.extraStreamInfo[a]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(e,r,o){var i=e("../utils"),a=e("./ConvertWorker"),s=e("./GenericWorker"),l=e("../base64"),f=e("../support"),c=e("../external"),m=null;if(f.nodestream)try{m=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(y,d){return new c.Promise(function(v,b){var x=[],_=y._internalType,k=y._outputType,C=y._mimeType;y.on("data",function(N,D){x.push(N),d&&d(D)}).on("error",function(N){x=[],b(N)}).on("end",function(){try{var N=function(D,I,z){switch(D){case"blob":return i.newBlob(i.transformTo("arraybuffer",I),z);case"base64":return l.encode(I);default:return i.transformTo(D,I)}}(k,function(D,I){var z,O=0,M=null,w=0;for(z=0;z<I.length;z++)w+=I[z].length;switch(D){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(M=new Uint8Array(w),z=0;z<I.length;z++)M.set(I[z],O),O+=I[z].length;return M;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+D+"'")}}(_,x),C);v(N)}catch(D){b(D)}x=[]}).resume()})}function u(y,d,v){var b=d;switch(d){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=d,this._mimeType=v,i.checkSupport(b),this._worker=y.pipe(new a(b)),y.lock()}catch(x){this._worker=new s("error"),this._worker.error(x)}}u.prototype={accumulate:function(y){return g(this,y)},on:function(y,d){var v=this;return y==="data"?this._worker.on(y,function(b){d.call(v,b.data,b.meta)}):this._worker.on(y,function(){i.delay(d,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var i=new ArrayBuffer(0);try{o.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),o.blob=a.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!e("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,o){for(var i=e("./utils"),a=e("./support"),s=e("./nodejsUtils"),l=e("./stream/GenericWorker"),f=new Array(256),c=0;c<256;c++)f[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;f[254]=f[254]=1;function m(){l.call(this,"utf-8 decode"),this.leftOver=null}function g(){l.call(this,"utf-8 encode")}o.utf8encode=function(u){return a.nodebuffer?s.newBufferFrom(u,"utf-8"):function(y){var d,v,b,x,_,k=y.length,C=0;for(x=0;x<k;x++)(64512&(v=y.charCodeAt(x)))==55296&&x+1<k&&(64512&(b=y.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),x++),C+=v<128?1:v<2048?2:v<65536?3:4;for(d=a.uint8array?new Uint8Array(C):new Array(C),x=_=0;_<C;x++)(64512&(v=y.charCodeAt(x)))==55296&&x+1<k&&(64512&(b=y.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),x++),v<128?d[_++]=v:(v<2048?d[_++]=192|v>>>6:(v<65536?d[_++]=224|v>>>12:(d[_++]=240|v>>>18,d[_++]=128|v>>>12&63),d[_++]=128|v>>>6&63),d[_++]=128|63&v);return d}(u)},o.utf8decode=function(u){return a.nodebuffer?i.transformTo("nodebuffer",u).toString("utf-8"):function(y){var d,v,b,x,_=y.length,k=new Array(2*_);for(d=v=0;d<_;)if((b=y[d++])<128)k[v++]=b;else if(4<(x=f[b]))k[v++]=65533,d+=x-1;else{for(b&=x===2?31:x===3?15:7;1<x&&d<_;)b=b<<6|63&y[d++],x--;1<x?k[v++]=65533:b<65536?k[v++]=b:(b-=65536,k[v++]=55296|b>>10&1023,k[v++]=56320|1023&b)}return k.length!==v&&(k.subarray?k=k.subarray(0,v):k.length=v),i.applyFromCharCode(k)}(u=i.transformTo(a.uint8array?"uint8array":"array",u))},i.inherits(m,l),m.prototype.processChunk=function(u){var y=i.transformTo(a.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var d=y;(y=new Uint8Array(d.length+this.leftOver.length)).set(this.leftOver,0),y.set(d,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(x,_){var k;for((_=_||x.length)>x.length&&(_=x.length),k=_-1;0<=k&&(192&x[k])==128;)k--;return k<0||k===0?_:k+f[x[k]]>_?k:_}(y),b=y;v!==y.length&&(a.uint8array?(b=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(b=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:o.utf8decode(b),meta:u.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=m,i.inherits(g,l),g.prototype.processChunk=function(u){this.push({data:o.utf8encode(u.data),meta:u.meta})},o.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,o){var i=e("./support"),a=e("./base64"),s=e("./nodejsUtils"),l=e("./external");function f(d){return d}function c(d,v){for(var b=0;b<d.length;++b)v[b]=255&d.charCodeAt(b);return v}e("setimmediate"),o.newBlob=function(d,v){o.checkSupport("blob");try{return new Blob([d],{type:v})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(d),b.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(d,v,b){var x=[],_=0,k=d.length;if(k<=b)return String.fromCharCode.apply(null,d);for(;_<k;)v==="array"||v==="nodebuffer"?x.push(String.fromCharCode.apply(null,d.slice(_,Math.min(_+b,k)))):x.push(String.fromCharCode.apply(null,d.subarray(_,Math.min(_+b,k)))),_+=b;return x.join("")},stringifyByChar:function(d){for(var v="",b=0;b<d.length;b++)v+=String.fromCharCode(d[b]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function g(d){var v=65536,b=o.getTypeOf(d),x=!0;if(b==="uint8array"?x=m.applyCanBeUsed.uint8array:b==="nodebuffer"&&(x=m.applyCanBeUsed.nodebuffer),x)for(;1<v;)try{return m.stringifyByChunk(d,b,v)}catch{v=Math.floor(v/2)}return m.stringifyByChar(d)}function u(d,v){for(var b=0;b<d.length;b++)v[b]=d[b];return v}o.applyFromCharCode=g;var y={};y.string={string:f,array:function(d){return c(d,new Array(d.length))},arraybuffer:function(d){return y.string.uint8array(d).buffer},uint8array:function(d){return c(d,new Uint8Array(d.length))},nodebuffer:function(d){return c(d,s.allocBuffer(d.length))}},y.array={string:g,array:f,arraybuffer:function(d){return new Uint8Array(d).buffer},uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return s.newBufferFrom(d)}},y.arraybuffer={string:function(d){return g(new Uint8Array(d))},array:function(d){return u(new Uint8Array(d),new Array(d.byteLength))},arraybuffer:f,uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return s.newBufferFrom(new Uint8Array(d))}},y.uint8array={string:g,array:function(d){return u(d,new Array(d.length))},arraybuffer:function(d){return d.buffer},uint8array:f,nodebuffer:function(d){return s.newBufferFrom(d)}},y.nodebuffer={string:g,array:function(d){return u(d,new Array(d.length))},arraybuffer:function(d){return y.nodebuffer.uint8array(d).buffer},uint8array:function(d){return u(d,new Uint8Array(d.length))},nodebuffer:f},o.transformTo=function(d,v){if(v=v||"",!d)return v;o.checkSupport(d);var b=o.getTypeOf(v);return y[b][d](v)},o.resolve=function(d){for(var v=d.split("/"),b=[],x=0;x<v.length;x++){var _=v[x];_==="."||_===""&&x!==0&&x!==v.length-1||(_===".."?b.pop():b.push(_))}return b.join("/")},o.getTypeOf=function(d){return typeof d=="string"?"string":Object.prototype.toString.call(d)==="[object Array]"?"array":i.nodebuffer&&s.isBuffer(d)?"nodebuffer":i.uint8array&&d instanceof Uint8Array?"uint8array":i.arraybuffer&&d instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(d){if(!i[d.toLowerCase()])throw new Error(d+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(d){var v,b,x="";for(b=0;b<(d||"").length;b++)x+="\\x"+((v=d.charCodeAt(b))<16?"0":"")+v.toString(16).toUpperCase();return x},o.delay=function(d,v,b){setImmediate(function(){d.apply(b||null,v||[])})},o.inherits=function(d,v){function b(){}b.prototype=v.prototype,d.prototype=new b},o.extend=function(){var d,v,b={};for(d=0;d<arguments.length;d++)for(v in arguments[d])Object.prototype.hasOwnProperty.call(arguments[d],v)&&b[v]===void 0&&(b[v]=arguments[d][v]);return b},o.prepareContent=function(d,v,b,x,_){return l.Promise.resolve(v).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,N){var D=new FileReader;D.onload=function(I){C(I.target.result)},D.onerror=function(I){N(I.target.error)},D.readAsArrayBuffer(k)}):k}).then(function(k){var C=o.getTypeOf(k);return C?(C==="arraybuffer"?k=o.transformTo("uint8array",k):C==="string"&&(_?k=a.decode(k):b&&x!==!0&&(k=function(N){return c(N,i.uint8array?new Uint8Array(N.length):new Array(N.length))}(k))),k):l.Promise.reject(new Error("Can't read the data of '"+d+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,o){var i=e("./reader/readerFor"),a=e("./utils"),s=e("./signature"),l=e("./zipEntry"),f=e("./support");function c(m){this.files=[],this.loadOptions=m}c.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(g)+", expected "+a.pretty(m)+")")}},isSignature:function(m,g){var u=this.reader.index;this.reader.setIndex(m);var y=this.reader.readString(4)===g;return this.reader.setIndex(u),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),g=f.uint8array?"uint8array":"array",u=a.transformTo(g,m);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,g,u,y=this.zip64EndOfCentralSize-44;0<y;)m=this.reader.readInt(2),g=this.reader.readInt(4),u=this.reader.readData(g),this.zip64ExtensibleData[m]={id:m,length:g,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,g;for(m=0;m<this.files.length;m++)g=this.files[m],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(m=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var g=m;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var y=g-u;if(0<y)this.isSignature(g,s.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(m){this.reader=i(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,o){var i=e("./reader/readerFor"),a=e("./utils"),s=e("./compressedObject"),l=e("./crc32"),f=e("./utf8"),c=e("./compressions"),m=e("./support");function g(u,y){this.options=u,this.loadOptions=y}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var y,d;if(u.skip(22),this.fileNameLength=u.readInt(2),d=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(d),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var b in c)if(Object.prototype.hasOwnProperty.call(c,b)&&c[b].magic===v)return c[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,y,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var y=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(y),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var y,d,v,b=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<b;)y=u.readInt(2),d=u.readInt(2),v=u.readData(d),this.extraFields[y]={id:y,length:d,value:v};u.setIndex(b)},handleUTF8:function(){var u=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var d=a.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(d)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var b=a.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var y=i(u.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:f.utf8decode(y.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var y=i(u.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:f.utf8decode(y.readData(u.length-5))}return null}},r.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,o){function i(y,d,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=d,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),l=e("./utf8"),f=e("./compressedObject"),c=e("./stream/GenericWorker");i.prototype={internalStream:function(y){var d=null,v="string";try{if(!y)throw new Error("No output type specified.");var b=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),d=this._decompressWorker();var x=!this._dataBinary;x&&!b&&(d=d.pipe(new l.Utf8EncodeWorker)),!x&&b&&(d=d.pipe(new l.Utf8DecodeWorker))}catch(_){(d=new c("error")).error(_)}return new a(d,v,"")},async:function(y,d){return this.internalStream(y).accumulate(d)},nodeStream:function(y,d){return this.internalStream(y||"nodebuffer").toNodejsStream(d)},_compressWorker:function(y,d){if(this._data instanceof f&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),f.createWorkerFrom(v,y,d)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof c?this._data:new s(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<m.length;u++)i.prototype[m[u]]=g;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,o){(function(i){var a,s,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var f=0,c=new l(y),m=i.document.createTextNode("");c.observe(m,{characterData:!0}),a=function(){m.data=f=++f%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var d=i.document.createElement("script");d.onreadystatechange=function(){y(),d.onreadystatechange=null,d.parentNode.removeChild(d),d=null},i.document.documentElement.appendChild(d)}:function(){setTimeout(y,0)};else{var g=new i.MessageChannel;g.port1.onmessage=y,a=function(){g.port2.postMessage(0)}}var u=[];function y(){var d,v;s=!0;for(var b=u.length;b;){for(v=u,u=[],d=-1;++d<b;)v[d]();b=u.length}s=!1}r.exports=function(d){u.push(d)!==1||s||a()}}).call(this,typeof Be<"u"?Be:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,o){var i=e("immediate");function a(){}var s={},l=["REJECTED"],f=["FULFILLED"],c=["PENDING"];function m(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,b!==a&&d(this,b)}function g(b,x,_){this.promise=b,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function u(b,x,_){i(function(){var k;try{k=x(_)}catch(C){return s.reject(b,C)}k===b?s.reject(b,new TypeError("Cannot resolve promise with itself")):s.resolve(b,k)})}function y(b){var x=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof x=="function")return function(){x.apply(b,arguments)}}function d(b,x){var _=!1;function k(D){_||(_=!0,s.reject(b,D))}function C(D){_||(_=!0,s.resolve(b,D))}var N=v(function(){x(C,k)});N.status==="error"&&k(N.value)}function v(b,x){var _={};try{_.value=b(x),_.status="success"}catch(k){_.status="error",_.value=k}return _}(r.exports=m).prototype.finally=function(b){if(typeof b!="function")return this;var x=this.constructor;return this.then(function(_){return x.resolve(b()).then(function(){return _})},function(_){return x.resolve(b()).then(function(){throw _})})},m.prototype.catch=function(b){return this.then(null,b)},m.prototype.then=function(b,x){if(typeof b!="function"&&this.state===f||typeof x!="function"&&this.state===l)return this;var _=new this.constructor(a);return this.state!==c?u(_,this.state===f?b:x,this.outcome):this.queue.push(new g(_,b,x)),_},g.prototype.callFulfilled=function(b){s.resolve(this.promise,b)},g.prototype.otherCallFulfilled=function(b){u(this.promise,this.onFulfilled,b)},g.prototype.callRejected=function(b){s.reject(this.promise,b)},g.prototype.otherCallRejected=function(b){u(this.promise,this.onRejected,b)},s.resolve=function(b,x){var _=v(y,x);if(_.status==="error")return s.reject(b,_.value);var k=_.value;if(k)d(b,k);else{b.state=f,b.outcome=x;for(var C=-1,N=b.queue.length;++C<N;)b.queue[C].callFulfilled(x)}return b},s.reject=function(b,x){b.state=l,b.outcome=x;for(var _=-1,k=b.queue.length;++_<k;)b.queue[_].callRejected(x);return b},m.resolve=function(b){return b instanceof this?b:s.resolve(new this(a),b)},m.reject=function(b){var x=new this(a);return s.reject(x,b)},m.all=function(b){var x=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=b.length,k=!1;if(!_)return this.resolve([]);for(var C=new Array(_),N=0,D=-1,I=new this(a);++D<_;)z(b[D],D);return I;function z(O,M){x.resolve(O).then(function(w){C[M]=w,++N!==_||k||(k=!0,s.resolve(I,C))},function(w){k||(k=!0,s.reject(I,w))})}},m.race=function(b){var x=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=b.length,k=!1;if(!_)return this.resolve([]);for(var C=-1,N=new this(a);++C<_;)D=b[C],x.resolve(D).then(function(I){k||(k=!0,s.resolve(N,I))},function(I){k||(k=!0,s.reject(N,I))});var D;return N}},{immediate:36}],38:[function(e,r,o){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,o){var i=e("./zlib/deflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/messages"),f=e("./zlib/zstream"),c=Object.prototype.toString,m=0,g=-1,u=0,y=8;function d(b){if(!(this instanceof d))return new d(b);this.options=a.assign({level:g,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},b||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var _=i.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(_!==m)throw new Error(l[_]);if(x.header&&i.deflateSetHeader(this.strm,x.header),x.dictionary){var k;if(k=typeof x.dictionary=="string"?s.string2buf(x.dictionary):c.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(_=i.deflateSetDictionary(this.strm,k))!==m)throw new Error(l[_]);this._dict_set=!0}}function v(b,x){var _=new d(x);if(_.push(b,!0),_.err)throw _.msg||l[_.err];return _.result}d.prototype.push=function(b,x){var _,k,C=this.strm,N=this.options.chunkSize;if(this.ended)return!1;k=x===~~x?x:x===!0?4:0,typeof b=="string"?C.input=s.string2buf(b):c.call(b)==="[object ArrayBuffer]"?C.input=new Uint8Array(b):C.input=b,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(N),C.next_out=0,C.avail_out=N),(_=i.deflate(C,k))!==1&&_!==m)return this.onEnd(_),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(a.shrinkBuf(C.output,C.next_out))):this.onData(a.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&_!==1);return k===4?(_=i.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===m):k!==2||(this.onEnd(m),!(C.avail_out=0))},d.prototype.onData=function(b){this.chunks.push(b)},d.prototype.onEnd=function(b){b===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},o.Deflate=d,o.deflate=v,o.deflateRaw=function(b,x){return(x=x||{}).raw=!0,v(b,x)},o.gzip=function(b,x){return(x=x||{}).gzip=!0,v(b,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,o){var i=e("./zlib/inflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/constants"),f=e("./zlib/messages"),c=e("./zlib/zstream"),m=e("./zlib/gzheader"),g=Object.prototype.toString;function u(d){if(!(this instanceof u))return new u(d);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},d||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||d&&d.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var b=i.inflateInit2(this.strm,v.windowBits);if(b!==l.Z_OK)throw new Error(f[b]);this.header=new m,i.inflateGetHeader(this.strm,this.header)}function y(d,v){var b=new u(v);if(b.push(d,!0),b.err)throw b.msg||f[b.err];return b.result}u.prototype.push=function(d,v){var b,x,_,k,C,N,D=this.strm,I=this.options.chunkSize,z=this.options.dictionary,O=!1;if(this.ended)return!1;x=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof d=="string"?D.input=s.binstring2buf(d):g.call(d)==="[object ArrayBuffer]"?D.input=new Uint8Array(d):D.input=d,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new a.Buf8(I),D.next_out=0,D.avail_out=I),(b=i.inflate(D,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&z&&(N=typeof z=="string"?s.string2buf(z):g.call(z)==="[object ArrayBuffer]"?new Uint8Array(z):z,b=i.inflateSetDictionary(this.strm,N)),b===l.Z_BUF_ERROR&&O===!0&&(b=l.Z_OK,O=!1),b!==l.Z_STREAM_END&&b!==l.Z_OK)return this.onEnd(b),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&b!==l.Z_STREAM_END&&(D.avail_in!==0||x!==l.Z_FINISH&&x!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=s.utf8border(D.output,D.next_out),k=D.next_out-_,C=s.buf2string(D.output,_),D.next_out=k,D.avail_out=I-k,k&&a.arraySet(D.output,D.output,_,k,0),this.onData(C)):this.onData(a.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(O=!0)}while((0<D.avail_in||D.avail_out===0)&&b!==l.Z_STREAM_END);return b===l.Z_STREAM_END&&(x=l.Z_FINISH),x===l.Z_FINISH?(b=i.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===l.Z_OK):x!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(D.avail_out=0))},u.prototype.onData=function(d){this.chunks.push(d)},u.prototype.onEnd=function(d){d===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},o.Inflate=u,o.inflate=y,o.inflateRaw=function(d,v){return(v=v||{}).raw=!0,y(d,v)},o.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(l){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var c=f.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var m in c)c.hasOwnProperty(m)&&(l[m]=c[m])}}return l},o.shrinkBuf=function(l,f){return l.length===f?l:l.subarray?l.subarray(0,f):(l.length=f,l)};var a={arraySet:function(l,f,c,m,g){if(f.subarray&&l.subarray)l.set(f.subarray(c,c+m),g);else for(var u=0;u<m;u++)l[g+u]=f[c+u]},flattenChunks:function(l){var f,c,m,g,u,y;for(f=m=0,c=l.length;f<c;f++)m+=l[f].length;for(y=new Uint8Array(m),f=g=0,c=l.length;f<c;f++)u=l[f],y.set(u,g),g+=u.length;return y}},s={arraySet:function(l,f,c,m,g){for(var u=0;u<m;u++)l[g+u]=f[c+u]},flattenChunks:function(l){return[].concat.apply([],l)}};o.setTyped=function(l){l?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,a)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,s))},o.setTyped(i)},{}],42:[function(e,r,o){var i=e("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new i.Buf8(256),f=0;f<256;f++)l[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function c(m,g){if(g<65537&&(m.subarray&&s||!m.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(m,g));for(var u="",y=0;y<g;y++)u+=String.fromCharCode(m[y]);return u}l[254]=l[254]=1,o.string2buf=function(m){var g,u,y,d,v,b=m.length,x=0;for(d=0;d<b;d++)(64512&(u=m.charCodeAt(d)))==55296&&d+1<b&&(64512&(y=m.charCodeAt(d+1)))==56320&&(u=65536+(u-55296<<10)+(y-56320),d++),x+=u<128?1:u<2048?2:u<65536?3:4;for(g=new i.Buf8(x),d=v=0;v<x;d++)(64512&(u=m.charCodeAt(d)))==55296&&d+1<b&&(64512&(y=m.charCodeAt(d+1)))==56320&&(u=65536+(u-55296<<10)+(y-56320),d++),u<128?g[v++]=u:(u<2048?g[v++]=192|u>>>6:(u<65536?g[v++]=224|u>>>12:(g[v++]=240|u>>>18,g[v++]=128|u>>>12&63),g[v++]=128|u>>>6&63),g[v++]=128|63&u);return g},o.buf2binstring=function(m){return c(m,m.length)},o.binstring2buf=function(m){for(var g=new i.Buf8(m.length),u=0,y=g.length;u<y;u++)g[u]=m.charCodeAt(u);return g},o.buf2string=function(m,g){var u,y,d,v,b=g||m.length,x=new Array(2*b);for(u=y=0;u<b;)if((d=m[u++])<128)x[y++]=d;else if(4<(v=l[d]))x[y++]=65533,u+=v-1;else{for(d&=v===2?31:v===3?15:7;1<v&&u<b;)d=d<<6|63&m[u++],v--;1<v?x[y++]=65533:d<65536?x[y++]=d:(d-=65536,x[y++]=55296|d>>10&1023,x[y++]=56320|1023&d)}return c(x,y)},o.utf8border=function(m,g){var u;for((g=g||m.length)>m.length&&(g=m.length),u=g-1;0<=u&&(192&m[u])==128;)u--;return u<0||u===0?g:u+l[m[u]]>g?u:g}},{"./common":41}],43:[function(e,r,o){r.exports=function(i,a,s,l){for(var f=65535&i|0,c=i>>>16&65535|0,m=0;s!==0;){for(s-=m=2e3<s?2e3:s;c=c+(f=f+a[l++]|0)|0,--m;);f%=65521,c%=65521}return f|c<<16|0}},{}],44:[function(e,r,o){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,o){var i=function(){for(var a,s=[],l=0;l<256;l++){a=l;for(var f=0;f<8;f++)a=1&a?3988292384^a>>>1:a>>>1;s[l]=a}return s}();r.exports=function(a,s,l,f){var c=i,m=f+l;a^=-1;for(var g=f;g<m;g++)a=a>>>8^c[255&(a^s[g])];return-1^a}},{}],46:[function(e,r,o){var i,a=e("../utils/common"),s=e("./trees"),l=e("./adler32"),f=e("./crc32"),c=e("./messages"),m=0,g=4,u=0,y=-2,d=-1,v=4,b=2,x=8,_=9,k=286,C=30,N=19,D=2*k+1,I=15,z=3,O=258,M=O+z+1,w=42,S=113,h=1,E=2,F=3,W=4;function V(p,$){return p.msg=c[$],$}function Y(p){return(p<<1)-(4<p?9:0)}function tt(p){for(var $=p.length;0<=--$;)p[$]=0}function P(p){var $=p.state,q=$.pending;q>p.avail_out&&(q=p.avail_out),q!==0&&(a.arraySet(p.output,$.pending_buf,$.pending_out,q,p.next_out),p.next_out+=q,$.pending_out+=q,p.total_out+=q,p.avail_out-=q,$.pending-=q,$.pending===0&&($.pending_out=0))}function L(p,$){s._tr_flush_block(p,0<=p.block_start?p.block_start:-1,p.strstart-p.block_start,$),p.block_start=p.strstart,P(p.strm)}function K(p,$){p.pending_buf[p.pending++]=$}function X(p,$){p.pending_buf[p.pending++]=$>>>8&255,p.pending_buf[p.pending++]=255&$}function H(p,$){var q,T,R=p.max_chain_length,B=p.strstart,G=p.prev_length,Z=p.nice_match,U=p.strstart>p.w_size-M?p.strstart-(p.w_size-M):0,Q=p.window,nt=p.w_mask,J=p.prev,lt=p.strstart+O,ht=Q[B+G-1],dt=Q[B+G];p.prev_length>=p.good_match&&(R>>=2),Z>p.lookahead&&(Z=p.lookahead);do if(Q[(q=$)+G]===dt&&Q[q+G-1]===ht&&Q[q]===Q[B]&&Q[++q]===Q[B+1]){B+=2,q++;do;while(Q[++B]===Q[++q]&&Q[++B]===Q[++q]&&Q[++B]===Q[++q]&&Q[++B]===Q[++q]&&Q[++B]===Q[++q]&&Q[++B]===Q[++q]&&Q[++B]===Q[++q]&&Q[++B]===Q[++q]&&B<lt);if(T=O-(lt-B),B=lt-O,G<T){if(p.match_start=$,Z<=(G=T))break;ht=Q[B+G-1],dt=Q[B+G]}}while(($=J[$&nt])>U&&--R!=0);return G<=p.lookahead?G:p.lookahead}function ct(p){var $,q,T,R,B,G,Z,U,Q,nt,J=p.w_size;do{if(R=p.window_size-p.lookahead-p.strstart,p.strstart>=J+(J-M)){for(a.arraySet(p.window,p.window,J,J,0),p.match_start-=J,p.strstart-=J,p.block_start-=J,$=q=p.hash_size;T=p.head[--$],p.head[$]=J<=T?T-J:0,--q;);for($=q=J;T=p.prev[--$],p.prev[$]=J<=T?T-J:0,--q;);R+=J}if(p.strm.avail_in===0)break;if(G=p.strm,Z=p.window,U=p.strstart+p.lookahead,Q=R,nt=void 0,nt=G.avail_in,Q<nt&&(nt=Q),q=nt===0?0:(G.avail_in-=nt,a.arraySet(Z,G.input,G.next_in,nt,U),G.state.wrap===1?G.adler=l(G.adler,Z,nt,U):G.state.wrap===2&&(G.adler=f(G.adler,Z,nt,U)),G.next_in+=nt,G.total_in+=nt,nt),p.lookahead+=q,p.lookahead+p.insert>=z)for(B=p.strstart-p.insert,p.ins_h=p.window[B],p.ins_h=(p.ins_h<<p.hash_shift^p.window[B+1])&p.hash_mask;p.insert&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[B+z-1])&p.hash_mask,p.prev[B&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=B,B++,p.insert--,!(p.lookahead+p.insert<z)););}while(p.lookahead<M&&p.strm.avail_in!==0)}function ot(p,$){for(var q,T;;){if(p.lookahead<M){if(ct(p),p.lookahead<M&&$===m)return h;if(p.lookahead===0)break}if(q=0,p.lookahead>=z&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+z-1])&p.hash_mask,q=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),q!==0&&p.strstart-q<=p.w_size-M&&(p.match_length=H(p,q)),p.match_length>=z)if(T=s._tr_tally(p,p.strstart-p.match_start,p.match_length-z),p.lookahead-=p.match_length,p.match_length<=p.max_lazy_match&&p.lookahead>=z){for(p.match_length--;p.strstart++,p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+z-1])&p.hash_mask,q=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart,--p.match_length!=0;);p.strstart++}else p.strstart+=p.match_length,p.match_length=0,p.ins_h=p.window[p.strstart],p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+1])&p.hash_mask;else T=s._tr_tally(p,0,p.window[p.strstart]),p.lookahead--,p.strstart++;if(T&&(L(p,!1),p.strm.avail_out===0))return h}return p.insert=p.strstart<z-1?p.strstart:z-1,$===g?(L(p,!0),p.strm.avail_out===0?F:W):p.last_lit&&(L(p,!1),p.strm.avail_out===0)?h:E}function et(p,$){for(var q,T,R;;){if(p.lookahead<M){if(ct(p),p.lookahead<M&&$===m)return h;if(p.lookahead===0)break}if(q=0,p.lookahead>=z&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+z-1])&p.hash_mask,q=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),p.prev_length=p.match_length,p.prev_match=p.match_start,p.match_length=z-1,q!==0&&p.prev_length<p.max_lazy_match&&p.strstart-q<=p.w_size-M&&(p.match_length=H(p,q),p.match_length<=5&&(p.strategy===1||p.match_length===z&&4096<p.strstart-p.match_start)&&(p.match_length=z-1)),p.prev_length>=z&&p.match_length<=p.prev_length){for(R=p.strstart+p.lookahead-z,T=s._tr_tally(p,p.strstart-1-p.prev_match,p.prev_length-z),p.lookahead-=p.prev_length-1,p.prev_length-=2;++p.strstart<=R&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+z-1])&p.hash_mask,q=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),--p.prev_length!=0;);if(p.match_available=0,p.match_length=z-1,p.strstart++,T&&(L(p,!1),p.strm.avail_out===0))return h}else if(p.match_available){if((T=s._tr_tally(p,0,p.window[p.strstart-1]))&&L(p,!1),p.strstart++,p.lookahead--,p.strm.avail_out===0)return h}else p.match_available=1,p.strstart++,p.lookahead--}return p.match_available&&(T=s._tr_tally(p,0,p.window[p.strstart-1]),p.match_available=0),p.insert=p.strstart<z-1?p.strstart:z-1,$===g?(L(p,!0),p.strm.avail_out===0?F:W):p.last_lit&&(L(p,!1),p.strm.avail_out===0)?h:E}function st(p,$,q,T,R){this.good_length=p,this.max_lazy=$,this.nice_length=q,this.max_chain=T,this.func=R}function at(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*D),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*N+1)),tt(this.dyn_ltree),tt(this.dyn_dtree),tt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(I+1),this.heap=new a.Buf16(2*k+1),tt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*k+1),tt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pt(p){var $;return p&&p.state?(p.total_in=p.total_out=0,p.data_type=b,($=p.state).pending=0,$.pending_out=0,$.wrap<0&&($.wrap=-$.wrap),$.status=$.wrap?w:S,p.adler=$.wrap===2?0:1,$.last_flush=m,s._tr_init($),u):V(p,y)}function gt(p){var $=pt(p);return $===u&&function(q){q.window_size=2*q.w_size,tt(q.head),q.max_lazy_match=i[q.level].max_lazy,q.good_match=i[q.level].good_length,q.nice_match=i[q.level].nice_length,q.max_chain_length=i[q.level].max_chain,q.strstart=0,q.block_start=0,q.lookahead=0,q.insert=0,q.match_length=q.prev_length=z-1,q.match_available=0,q.ins_h=0}(p.state),$}function Et(p,$,q,T,R,B){if(!p)return y;var G=1;if($===d&&($=6),T<0?(G=0,T=-T):15<T&&(G=2,T-=16),R<1||_<R||q!==x||T<8||15<T||$<0||9<$||B<0||v<B)return V(p,y);T===8&&(T=9);var Z=new at;return(p.state=Z).strm=p,Z.wrap=G,Z.gzhead=null,Z.w_bits=T,Z.w_size=1<<Z.w_bits,Z.w_mask=Z.w_size-1,Z.hash_bits=R+7,Z.hash_size=1<<Z.hash_bits,Z.hash_mask=Z.hash_size-1,Z.hash_shift=~~((Z.hash_bits+z-1)/z),Z.window=new a.Buf8(2*Z.w_size),Z.head=new a.Buf16(Z.hash_size),Z.prev=new a.Buf16(Z.w_size),Z.lit_bufsize=1<<R+6,Z.pending_buf_size=4*Z.lit_bufsize,Z.pending_buf=new a.Buf8(Z.pending_buf_size),Z.d_buf=1*Z.lit_bufsize,Z.l_buf=3*Z.lit_bufsize,Z.level=$,Z.strategy=B,Z.method=q,gt(p)}i=[new st(0,0,0,0,function(p,$){var q=65535;for(q>p.pending_buf_size-5&&(q=p.pending_buf_size-5);;){if(p.lookahead<=1){if(ct(p),p.lookahead===0&&$===m)return h;if(p.lookahead===0)break}p.strstart+=p.lookahead,p.lookahead=0;var T=p.block_start+q;if((p.strstart===0||p.strstart>=T)&&(p.lookahead=p.strstart-T,p.strstart=T,L(p,!1),p.strm.avail_out===0)||p.strstart-p.block_start>=p.w_size-M&&(L(p,!1),p.strm.avail_out===0))return h}return p.insert=0,$===g?(L(p,!0),p.strm.avail_out===0?F:W):(p.strstart>p.block_start&&(L(p,!1),p.strm.avail_out),h)}),new st(4,4,8,4,ot),new st(4,5,16,8,ot),new st(4,6,32,32,ot),new st(4,4,16,16,et),new st(8,16,32,32,et),new st(8,16,128,128,et),new st(8,32,128,256,et),new st(32,128,258,1024,et),new st(32,258,258,4096,et)],o.deflateInit=function(p,$){return Et(p,$,x,15,8,0)},o.deflateInit2=Et,o.deflateReset=gt,o.deflateResetKeep=pt,o.deflateSetHeader=function(p,$){return p&&p.state?p.state.wrap!==2?y:(p.state.gzhead=$,u):y},o.deflate=function(p,$){var q,T,R,B;if(!p||!p.state||5<$||$<0)return p?V(p,y):y;if(T=p.state,!p.output||!p.input&&p.avail_in!==0||T.status===666&&$!==g)return V(p,p.avail_out===0?-5:y);if(T.strm=p,q=T.last_flush,T.last_flush=$,T.status===w)if(T.wrap===2)p.adler=0,K(T,31),K(T,139),K(T,8),T.gzhead?(K(T,(T.gzhead.text?1:0)+(T.gzhead.hcrc?2:0)+(T.gzhead.extra?4:0)+(T.gzhead.name?8:0)+(T.gzhead.comment?16:0)),K(T,255&T.gzhead.time),K(T,T.gzhead.time>>8&255),K(T,T.gzhead.time>>16&255),K(T,T.gzhead.time>>24&255),K(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),K(T,255&T.gzhead.os),T.gzhead.extra&&T.gzhead.extra.length&&(K(T,255&T.gzhead.extra.length),K(T,T.gzhead.extra.length>>8&255)),T.gzhead.hcrc&&(p.adler=f(p.adler,T.pending_buf,T.pending,0)),T.gzindex=0,T.status=69):(K(T,0),K(T,0),K(T,0),K(T,0),K(T,0),K(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),K(T,3),T.status=S);else{var G=x+(T.w_bits-8<<4)<<8;G|=(2<=T.strategy||T.level<2?0:T.level<6?1:T.level===6?2:3)<<6,T.strstart!==0&&(G|=32),G+=31-G%31,T.status=S,X(T,G),T.strstart!==0&&(X(T,p.adler>>>16),X(T,65535&p.adler)),p.adler=1}if(T.status===69)if(T.gzhead.extra){for(R=T.pending;T.gzindex<(65535&T.gzhead.extra.length)&&(T.pending!==T.pending_buf_size||(T.gzhead.hcrc&&T.pending>R&&(p.adler=f(p.adler,T.pending_buf,T.pending-R,R)),P(p),R=T.pending,T.pending!==T.pending_buf_size));)K(T,255&T.gzhead.extra[T.gzindex]),T.gzindex++;T.gzhead.hcrc&&T.pending>R&&(p.adler=f(p.adler,T.pending_buf,T.pending-R,R)),T.gzindex===T.gzhead.extra.length&&(T.gzindex=0,T.status=73)}else T.status=73;if(T.status===73)if(T.gzhead.name){R=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>R&&(p.adler=f(p.adler,T.pending_buf,T.pending-R,R)),P(p),R=T.pending,T.pending===T.pending_buf_size)){B=1;break}B=T.gzindex<T.gzhead.name.length?255&T.gzhead.name.charCodeAt(T.gzindex++):0,K(T,B)}while(B!==0);T.gzhead.hcrc&&T.pending>R&&(p.adler=f(p.adler,T.pending_buf,T.pending-R,R)),B===0&&(T.gzindex=0,T.status=91)}else T.status=91;if(T.status===91)if(T.gzhead.comment){R=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>R&&(p.adler=f(p.adler,T.pending_buf,T.pending-R,R)),P(p),R=T.pending,T.pending===T.pending_buf_size)){B=1;break}B=T.gzindex<T.gzhead.comment.length?255&T.gzhead.comment.charCodeAt(T.gzindex++):0,K(T,B)}while(B!==0);T.gzhead.hcrc&&T.pending>R&&(p.adler=f(p.adler,T.pending_buf,T.pending-R,R)),B===0&&(T.status=103)}else T.status=103;if(T.status===103&&(T.gzhead.hcrc?(T.pending+2>T.pending_buf_size&&P(p),T.pending+2<=T.pending_buf_size&&(K(T,255&p.adler),K(T,p.adler>>8&255),p.adler=0,T.status=S)):T.status=S),T.pending!==0){if(P(p),p.avail_out===0)return T.last_flush=-1,u}else if(p.avail_in===0&&Y($)<=Y(q)&&$!==g)return V(p,-5);if(T.status===666&&p.avail_in!==0)return V(p,-5);if(p.avail_in!==0||T.lookahead!==0||$!==m&&T.status!==666){var Z=T.strategy===2?function(U,Q){for(var nt;;){if(U.lookahead===0&&(ct(U),U.lookahead===0)){if(Q===m)return h;break}if(U.match_length=0,nt=s._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++,nt&&(L(U,!1),U.strm.avail_out===0))return h}return U.insert=0,Q===g?(L(U,!0),U.strm.avail_out===0?F:W):U.last_lit&&(L(U,!1),U.strm.avail_out===0)?h:E}(T,$):T.strategy===3?function(U,Q){for(var nt,J,lt,ht,dt=U.window;;){if(U.lookahead<=O){if(ct(U),U.lookahead<=O&&Q===m)return h;if(U.lookahead===0)break}if(U.match_length=0,U.lookahead>=z&&0<U.strstart&&(J=dt[lt=U.strstart-1])===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]){ht=U.strstart+O;do;while(J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&J===dt[++lt]&&lt<ht);U.match_length=O-(ht-lt),U.match_length>U.lookahead&&(U.match_length=U.lookahead)}if(U.match_length>=z?(nt=s._tr_tally(U,1,U.match_length-z),U.lookahead-=U.match_length,U.strstart+=U.match_length,U.match_length=0):(nt=s._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++),nt&&(L(U,!1),U.strm.avail_out===0))return h}return U.insert=0,Q===g?(L(U,!0),U.strm.avail_out===0?F:W):U.last_lit&&(L(U,!1),U.strm.avail_out===0)?h:E}(T,$):i[T.level].func(T,$);if(Z!==F&&Z!==W||(T.status=666),Z===h||Z===F)return p.avail_out===0&&(T.last_flush=-1),u;if(Z===E&&($===1?s._tr_align(T):$!==5&&(s._tr_stored_block(T,0,0,!1),$===3&&(tt(T.head),T.lookahead===0&&(T.strstart=0,T.block_start=0,T.insert=0))),P(p),p.avail_out===0))return T.last_flush=-1,u}return $!==g?u:T.wrap<=0?1:(T.wrap===2?(K(T,255&p.adler),K(T,p.adler>>8&255),K(T,p.adler>>16&255),K(T,p.adler>>24&255),K(T,255&p.total_in),K(T,p.total_in>>8&255),K(T,p.total_in>>16&255),K(T,p.total_in>>24&255)):(X(T,p.adler>>>16),X(T,65535&p.adler)),P(p),0<T.wrap&&(T.wrap=-T.wrap),T.pending!==0?u:1)},o.deflateEnd=function(p){var $;return p&&p.state?($=p.state.status)!==w&&$!==69&&$!==73&&$!==91&&$!==103&&$!==S&&$!==666?V(p,y):(p.state=null,$===S?V(p,-3):u):y},o.deflateSetDictionary=function(p,$){var q,T,R,B,G,Z,U,Q,nt=$.length;if(!p||!p.state||(B=(q=p.state).wrap)===2||B===1&&q.status!==w||q.lookahead)return y;for(B===1&&(p.adler=l(p.adler,$,nt,0)),q.wrap=0,nt>=q.w_size&&(B===0&&(tt(q.head),q.strstart=0,q.block_start=0,q.insert=0),Q=new a.Buf8(q.w_size),a.arraySet(Q,$,nt-q.w_size,q.w_size,0),$=Q,nt=q.w_size),G=p.avail_in,Z=p.next_in,U=p.input,p.avail_in=nt,p.next_in=0,p.input=$,ct(q);q.lookahead>=z;){for(T=q.strstart,R=q.lookahead-(z-1);q.ins_h=(q.ins_h<<q.hash_shift^q.window[T+z-1])&q.hash_mask,q.prev[T&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=T,T++,--R;);q.strstart=T,q.lookahead=z-1,ct(q)}return q.strstart+=q.lookahead,q.block_start=q.strstart,q.insert=q.lookahead,q.lookahead=0,q.match_length=q.prev_length=z-1,q.match_available=0,p.next_in=Z,p.input=U,p.avail_in=G,q.wrap=B,u},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,o){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,o){r.exports=function(i,a){var s,l,f,c,m,g,u,y,d,v,b,x,_,k,C,N,D,I,z,O,M,w,S,h,E;s=i.state,l=i.next_in,h=i.input,f=l+(i.avail_in-5),c=i.next_out,E=i.output,m=c-(a-i.avail_out),g=c+(i.avail_out-257),u=s.dmax,y=s.wsize,d=s.whave,v=s.wnext,b=s.window,x=s.hold,_=s.bits,k=s.lencode,C=s.distcode,N=(1<<s.lenbits)-1,D=(1<<s.distbits)-1;t:do{_<15&&(x+=h[l++]<<_,_+=8,x+=h[l++]<<_,_+=8),I=k[x&N];e:for(;;){if(x>>>=z=I>>>24,_-=z,(z=I>>>16&255)===0)E[c++]=65535&I;else{if(!(16&z)){if((64&z)==0){I=k[(65535&I)+(x&(1<<z)-1)];continue e}if(32&z){s.mode=12;break t}i.msg="invalid literal/length code",s.mode=30;break t}O=65535&I,(z&=15)&&(_<z&&(x+=h[l++]<<_,_+=8),O+=x&(1<<z)-1,x>>>=z,_-=z),_<15&&(x+=h[l++]<<_,_+=8,x+=h[l++]<<_,_+=8),I=C[x&D];n:for(;;){if(x>>>=z=I>>>24,_-=z,!(16&(z=I>>>16&255))){if((64&z)==0){I=C[(65535&I)+(x&(1<<z)-1)];continue n}i.msg="invalid distance code",s.mode=30;break t}if(M=65535&I,_<(z&=15)&&(x+=h[l++]<<_,(_+=8)<z&&(x+=h[l++]<<_,_+=8)),u<(M+=x&(1<<z)-1)){i.msg="invalid distance too far back",s.mode=30;break t}if(x>>>=z,_-=z,(z=c-m)<M){if(d<(z=M-z)&&s.sane){i.msg="invalid distance too far back",s.mode=30;break t}if(S=b,(w=0)===v){if(w+=y-z,z<O){for(O-=z;E[c++]=b[w++],--z;);w=c-M,S=E}}else if(v<z){if(w+=y+v-z,(z-=v)<O){for(O-=z;E[c++]=b[w++],--z;);if(w=0,v<O){for(O-=z=v;E[c++]=b[w++],--z;);w=c-M,S=E}}}else if(w+=v-z,z<O){for(O-=z;E[c++]=b[w++],--z;);w=c-M,S=E}for(;2<O;)E[c++]=S[w++],E[c++]=S[w++],E[c++]=S[w++],O-=3;O&&(E[c++]=S[w++],1<O&&(E[c++]=S[w++]))}else{for(w=c-M;E[c++]=E[w++],E[c++]=E[w++],E[c++]=E[w++],2<(O-=3););O&&(E[c++]=E[w++],1<O&&(E[c++]=E[w++]))}break}}break}}while(l<f&&c<g);l-=O=_>>3,x&=(1<<(_-=O<<3))-1,i.next_in=l,i.next_out=c,i.avail_in=l<f?f-l+5:5-(l-f),i.avail_out=c<g?g-c+257:257-(c-g),s.hold=x,s.bits=_}},{}],49:[function(e,r,o){var i=e("../utils/common"),a=e("./adler32"),s=e("./crc32"),l=e("./inffast"),f=e("./inftrees"),c=1,m=2,g=0,u=-2,y=1,d=852,v=592;function b(w){return(w>>>24&255)+(w>>>8&65280)+((65280&w)<<8)+((255&w)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(w){var S;return w&&w.state?(S=w.state,w.total_in=w.total_out=S.total=0,w.msg="",S.wrap&&(w.adler=1&S.wrap),S.mode=y,S.last=0,S.havedict=0,S.dmax=32768,S.head=null,S.hold=0,S.bits=0,S.lencode=S.lendyn=new i.Buf32(d),S.distcode=S.distdyn=new i.Buf32(v),S.sane=1,S.back=-1,g):u}function k(w){var S;return w&&w.state?((S=w.state).wsize=0,S.whave=0,S.wnext=0,_(w)):u}function C(w,S){var h,E;return w&&w.state?(E=w.state,S<0?(h=0,S=-S):(h=1+(S>>4),S<48&&(S&=15)),S&&(S<8||15<S)?u:(E.window!==null&&E.wbits!==S&&(E.window=null),E.wrap=h,E.wbits=S,k(w))):u}function N(w,S){var h,E;return w?(E=new x,(w.state=E).window=null,(h=C(w,S))!==g&&(w.state=null),h):u}var D,I,z=!0;function O(w){if(z){var S;for(D=new i.Buf32(512),I=new i.Buf32(32),S=0;S<144;)w.lens[S++]=8;for(;S<256;)w.lens[S++]=9;for(;S<280;)w.lens[S++]=7;for(;S<288;)w.lens[S++]=8;for(f(c,w.lens,0,288,D,0,w.work,{bits:9}),S=0;S<32;)w.lens[S++]=5;f(m,w.lens,0,32,I,0,w.work,{bits:5}),z=!1}w.lencode=D,w.lenbits=9,w.distcode=I,w.distbits=5}function M(w,S,h,E){var F,W=w.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new i.Buf8(W.wsize)),E>=W.wsize?(i.arraySet(W.window,S,h-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(E<(F=W.wsize-W.wnext)&&(F=E),i.arraySet(W.window,S,h-E,F,W.wnext),(E-=F)?(i.arraySet(W.window,S,h-E,E,0),W.wnext=E,W.whave=W.wsize):(W.wnext+=F,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=F))),0}o.inflateReset=k,o.inflateReset2=C,o.inflateResetKeep=_,o.inflateInit=function(w){return N(w,15)},o.inflateInit2=N,o.inflate=function(w,S){var h,E,F,W,V,Y,tt,P,L,K,X,H,ct,ot,et,st,at,pt,gt,Et,p,$,q,T,R=0,B=new i.Buf8(4),G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!w||!w.state||!w.output||!w.input&&w.avail_in!==0)return u;(h=w.state).mode===12&&(h.mode=13),V=w.next_out,F=w.output,tt=w.avail_out,W=w.next_in,E=w.input,Y=w.avail_in,P=h.hold,L=h.bits,K=Y,X=tt,$=g;t:for(;;)switch(h.mode){case y:if(h.wrap===0){h.mode=13;break}for(;L<16;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}if(2&h.wrap&&P===35615){B[h.check=0]=255&P,B[1]=P>>>8&255,h.check=s(h.check,B,2,0),L=P=0,h.mode=2;break}if(h.flags=0,h.head&&(h.head.done=!1),!(1&h.wrap)||(((255&P)<<8)+(P>>8))%31){w.msg="incorrect header check",h.mode=30;break}if((15&P)!=8){w.msg="unknown compression method",h.mode=30;break}if(L-=4,p=8+(15&(P>>>=4)),h.wbits===0)h.wbits=p;else if(p>h.wbits){w.msg="invalid window size",h.mode=30;break}h.dmax=1<<p,w.adler=h.check=1,h.mode=512&P?10:12,L=P=0;break;case 2:for(;L<16;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}if(h.flags=P,(255&h.flags)!=8){w.msg="unknown compression method",h.mode=30;break}if(57344&h.flags){w.msg="unknown header flags set",h.mode=30;break}h.head&&(h.head.text=P>>8&1),512&h.flags&&(B[0]=255&P,B[1]=P>>>8&255,h.check=s(h.check,B,2,0)),L=P=0,h.mode=3;case 3:for(;L<32;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}h.head&&(h.head.time=P),512&h.flags&&(B[0]=255&P,B[1]=P>>>8&255,B[2]=P>>>16&255,B[3]=P>>>24&255,h.check=s(h.check,B,4,0)),L=P=0,h.mode=4;case 4:for(;L<16;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}h.head&&(h.head.xflags=255&P,h.head.os=P>>8),512&h.flags&&(B[0]=255&P,B[1]=P>>>8&255,h.check=s(h.check,B,2,0)),L=P=0,h.mode=5;case 5:if(1024&h.flags){for(;L<16;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}h.length=P,h.head&&(h.head.extra_len=P),512&h.flags&&(B[0]=255&P,B[1]=P>>>8&255,h.check=s(h.check,B,2,0)),L=P=0}else h.head&&(h.head.extra=null);h.mode=6;case 6:if(1024&h.flags&&(Y<(H=h.length)&&(H=Y),H&&(h.head&&(p=h.head.extra_len-h.length,h.head.extra||(h.head.extra=new Array(h.head.extra_len)),i.arraySet(h.head.extra,E,W,H,p)),512&h.flags&&(h.check=s(h.check,E,H,W)),Y-=H,W+=H,h.length-=H),h.length))break t;h.length=0,h.mode=7;case 7:if(2048&h.flags){if(Y===0)break t;for(H=0;p=E[W+H++],h.head&&p&&h.length<65536&&(h.head.name+=String.fromCharCode(p)),p&&H<Y;);if(512&h.flags&&(h.check=s(h.check,E,H,W)),Y-=H,W+=H,p)break t}else h.head&&(h.head.name=null);h.length=0,h.mode=8;case 8:if(4096&h.flags){if(Y===0)break t;for(H=0;p=E[W+H++],h.head&&p&&h.length<65536&&(h.head.comment+=String.fromCharCode(p)),p&&H<Y;);if(512&h.flags&&(h.check=s(h.check,E,H,W)),Y-=H,W+=H,p)break t}else h.head&&(h.head.comment=null);h.mode=9;case 9:if(512&h.flags){for(;L<16;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}if(P!==(65535&h.check)){w.msg="header crc mismatch",h.mode=30;break}L=P=0}h.head&&(h.head.hcrc=h.flags>>9&1,h.head.done=!0),w.adler=h.check=0,h.mode=12;break;case 10:for(;L<32;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}w.adler=h.check=b(P),L=P=0,h.mode=11;case 11:if(h.havedict===0)return w.next_out=V,w.avail_out=tt,w.next_in=W,w.avail_in=Y,h.hold=P,h.bits=L,2;w.adler=h.check=1,h.mode=12;case 12:if(S===5||S===6)break t;case 13:if(h.last){P>>>=7&L,L-=7&L,h.mode=27;break}for(;L<3;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}switch(h.last=1&P,L-=1,3&(P>>>=1)){case 0:h.mode=14;break;case 1:if(O(h),h.mode=20,S!==6)break;P>>>=2,L-=2;break t;case 2:h.mode=17;break;case 3:w.msg="invalid block type",h.mode=30}P>>>=2,L-=2;break;case 14:for(P>>>=7&L,L-=7&L;L<32;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}if((65535&P)!=(P>>>16^65535)){w.msg="invalid stored block lengths",h.mode=30;break}if(h.length=65535&P,L=P=0,h.mode=15,S===6)break t;case 15:h.mode=16;case 16:if(H=h.length){if(Y<H&&(H=Y),tt<H&&(H=tt),H===0)break t;i.arraySet(F,E,W,H,V),Y-=H,W+=H,tt-=H,V+=H,h.length-=H;break}h.mode=12;break;case 17:for(;L<14;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}if(h.nlen=257+(31&P),P>>>=5,L-=5,h.ndist=1+(31&P),P>>>=5,L-=5,h.ncode=4+(15&P),P>>>=4,L-=4,286<h.nlen||30<h.ndist){w.msg="too many length or distance symbols",h.mode=30;break}h.have=0,h.mode=18;case 18:for(;h.have<h.ncode;){for(;L<3;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}h.lens[G[h.have++]]=7&P,P>>>=3,L-=3}for(;h.have<19;)h.lens[G[h.have++]]=0;if(h.lencode=h.lendyn,h.lenbits=7,q={bits:h.lenbits},$=f(0,h.lens,0,19,h.lencode,0,h.work,q),h.lenbits=q.bits,$){w.msg="invalid code lengths set",h.mode=30;break}h.have=0,h.mode=19;case 19:for(;h.have<h.nlen+h.ndist;){for(;st=(R=h.lencode[P&(1<<h.lenbits)-1])>>>16&255,at=65535&R,!((et=R>>>24)<=L);){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}if(at<16)P>>>=et,L-=et,h.lens[h.have++]=at;else{if(at===16){for(T=et+2;L<T;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}if(P>>>=et,L-=et,h.have===0){w.msg="invalid bit length repeat",h.mode=30;break}p=h.lens[h.have-1],H=3+(3&P),P>>>=2,L-=2}else if(at===17){for(T=et+3;L<T;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}L-=et,p=0,H=3+(7&(P>>>=et)),P>>>=3,L-=3}else{for(T=et+7;L<T;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}L-=et,p=0,H=11+(127&(P>>>=et)),P>>>=7,L-=7}if(h.have+H>h.nlen+h.ndist){w.msg="invalid bit length repeat",h.mode=30;break}for(;H--;)h.lens[h.have++]=p}}if(h.mode===30)break;if(h.lens[256]===0){w.msg="invalid code -- missing end-of-block",h.mode=30;break}if(h.lenbits=9,q={bits:h.lenbits},$=f(c,h.lens,0,h.nlen,h.lencode,0,h.work,q),h.lenbits=q.bits,$){w.msg="invalid literal/lengths set",h.mode=30;break}if(h.distbits=6,h.distcode=h.distdyn,q={bits:h.distbits},$=f(m,h.lens,h.nlen,h.ndist,h.distcode,0,h.work,q),h.distbits=q.bits,$){w.msg="invalid distances set",h.mode=30;break}if(h.mode=20,S===6)break t;case 20:h.mode=21;case 21:if(6<=Y&&258<=tt){w.next_out=V,w.avail_out=tt,w.next_in=W,w.avail_in=Y,h.hold=P,h.bits=L,l(w,X),V=w.next_out,F=w.output,tt=w.avail_out,W=w.next_in,E=w.input,Y=w.avail_in,P=h.hold,L=h.bits,h.mode===12&&(h.back=-1);break}for(h.back=0;st=(R=h.lencode[P&(1<<h.lenbits)-1])>>>16&255,at=65535&R,!((et=R>>>24)<=L);){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}if(st&&(240&st)==0){for(pt=et,gt=st,Et=at;st=(R=h.lencode[Et+((P&(1<<pt+gt)-1)>>pt)])>>>16&255,at=65535&R,!(pt+(et=R>>>24)<=L);){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}P>>>=pt,L-=pt,h.back+=pt}if(P>>>=et,L-=et,h.back+=et,h.length=at,st===0){h.mode=26;break}if(32&st){h.back=-1,h.mode=12;break}if(64&st){w.msg="invalid literal/length code",h.mode=30;break}h.extra=15&st,h.mode=22;case 22:if(h.extra){for(T=h.extra;L<T;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}h.length+=P&(1<<h.extra)-1,P>>>=h.extra,L-=h.extra,h.back+=h.extra}h.was=h.length,h.mode=23;case 23:for(;st=(R=h.distcode[P&(1<<h.distbits)-1])>>>16&255,at=65535&R,!((et=R>>>24)<=L);){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}if((240&st)==0){for(pt=et,gt=st,Et=at;st=(R=h.distcode[Et+((P&(1<<pt+gt)-1)>>pt)])>>>16&255,at=65535&R,!(pt+(et=R>>>24)<=L);){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}P>>>=pt,L-=pt,h.back+=pt}if(P>>>=et,L-=et,h.back+=et,64&st){w.msg="invalid distance code",h.mode=30;break}h.offset=at,h.extra=15&st,h.mode=24;case 24:if(h.extra){for(T=h.extra;L<T;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}h.offset+=P&(1<<h.extra)-1,P>>>=h.extra,L-=h.extra,h.back+=h.extra}if(h.offset>h.dmax){w.msg="invalid distance too far back",h.mode=30;break}h.mode=25;case 25:if(tt===0)break t;if(H=X-tt,h.offset>H){if((H=h.offset-H)>h.whave&&h.sane){w.msg="invalid distance too far back",h.mode=30;break}ct=H>h.wnext?(H-=h.wnext,h.wsize-H):h.wnext-H,H>h.length&&(H=h.length),ot=h.window}else ot=F,ct=V-h.offset,H=h.length;for(tt<H&&(H=tt),tt-=H,h.length-=H;F[V++]=ot[ct++],--H;);h.length===0&&(h.mode=21);break;case 26:if(tt===0)break t;F[V++]=h.length,tt--,h.mode=21;break;case 27:if(h.wrap){for(;L<32;){if(Y===0)break t;Y--,P|=E[W++]<<L,L+=8}if(X-=tt,w.total_out+=X,h.total+=X,X&&(w.adler=h.check=h.flags?s(h.check,F,X,V-X):a(h.check,F,X,V-X)),X=tt,(h.flags?P:b(P))!==h.check){w.msg="incorrect data check",h.mode=30;break}L=P=0}h.mode=28;case 28:if(h.wrap&&h.flags){for(;L<32;){if(Y===0)break t;Y--,P+=E[W++]<<L,L+=8}if(P!==(4294967295&h.total)){w.msg="incorrect length check",h.mode=30;break}L=P=0}h.mode=29;case 29:$=1;break t;case 30:$=-3;break t;case 31:return-4;case 32:default:return u}return w.next_out=V,w.avail_out=tt,w.next_in=W,w.avail_in=Y,h.hold=P,h.bits=L,(h.wsize||X!==w.avail_out&&h.mode<30&&(h.mode<27||S!==4))&&M(w,w.output,w.next_out,X-w.avail_out)?(h.mode=31,-4):(K-=w.avail_in,X-=w.avail_out,w.total_in+=K,w.total_out+=X,h.total+=X,h.wrap&&X&&(w.adler=h.check=h.flags?s(h.check,F,X,w.next_out-X):a(h.check,F,X,w.next_out-X)),w.data_type=h.bits+(h.last?64:0)+(h.mode===12?128:0)+(h.mode===20||h.mode===15?256:0),(K==0&&X===0||S===4)&&$===g&&($=-5),$)},o.inflateEnd=function(w){if(!w||!w.state)return u;var S=w.state;return S.window&&(S.window=null),w.state=null,g},o.inflateGetHeader=function(w,S){var h;return w&&w.state?(2&(h=w.state).wrap)==0?u:((h.head=S).done=!1,g):u},o.inflateSetDictionary=function(w,S){var h,E=S.length;return w&&w.state?(h=w.state).wrap!==0&&h.mode!==11?u:h.mode===11&&a(1,S,E,0)!==h.check?-3:M(w,S,E,E)?(h.mode=31,-4):(h.havedict=1,g):u},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,o){var i=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(c,m,g,u,y,d,v,b){var x,_,k,C,N,D,I,z,O,M=b.bits,w=0,S=0,h=0,E=0,F=0,W=0,V=0,Y=0,tt=0,P=0,L=null,K=0,X=new i.Buf16(16),H=new i.Buf16(16),ct=null,ot=0;for(w=0;w<=15;w++)X[w]=0;for(S=0;S<u;S++)X[m[g+S]]++;for(F=M,E=15;1<=E&&X[E]===0;E--);if(E<F&&(F=E),E===0)return y[d++]=20971520,y[d++]=20971520,b.bits=1,0;for(h=1;h<E&&X[h]===0;h++);for(F<h&&(F=h),w=Y=1;w<=15;w++)if(Y<<=1,(Y-=X[w])<0)return-1;if(0<Y&&(c===0||E!==1))return-1;for(H[1]=0,w=1;w<15;w++)H[w+1]=H[w]+X[w];for(S=0;S<u;S++)m[g+S]!==0&&(v[H[m[g+S]]++]=S);if(D=c===0?(L=ct=v,19):c===1?(L=a,K-=257,ct=s,ot-=257,256):(L=l,ct=f,-1),w=h,N=d,V=S=P=0,k=-1,C=(tt=1<<(W=F))-1,c===1&&852<tt||c===2&&592<tt)return 1;for(;;){for(I=w-V,O=v[S]<D?(z=0,v[S]):v[S]>D?(z=ct[ot+v[S]],L[K+v[S]]):(z=96,0),x=1<<w-V,h=_=1<<W;y[N+(P>>V)+(_-=x)]=I<<24|z<<16|O|0,_!==0;);for(x=1<<w-1;P&x;)x>>=1;if(x!==0?(P&=x-1,P+=x):P=0,S++,--X[w]==0){if(w===E)break;w=m[g+v[S]]}if(F<w&&(P&C)!==k){for(V===0&&(V=F),N+=h,Y=1<<(W=w-V);W+V<E&&!((Y-=X[W+V])<=0);)W++,Y<<=1;if(tt+=1<<W,c===1&&852<tt||c===2&&592<tt)return 1;y[k=P&C]=F<<24|W<<16|N-d|0}}return P!==0&&(y[N+P]=w-V<<24|64<<16|0),b.bits=F,0}},{"../utils/common":41}],51:[function(e,r,o){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,o){var i=e("../utils/common"),a=0,s=1;function l(R){for(var B=R.length;0<=--B;)R[B]=0}var f=0,c=29,m=256,g=m+1+c,u=30,y=19,d=2*g+1,v=15,b=16,x=7,_=256,k=16,C=17,N=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],M=new Array(2*(g+2));l(M);var w=new Array(2*u);l(w);var S=new Array(512);l(S);var h=new Array(256);l(h);var E=new Array(c);l(E);var F,W,V,Y=new Array(u);function tt(R,B,G,Z,U){this.static_tree=R,this.extra_bits=B,this.extra_base=G,this.elems=Z,this.max_length=U,this.has_stree=R&&R.length}function P(R,B){this.dyn_tree=R,this.max_code=0,this.stat_desc=B}function L(R){return R<256?S[R]:S[256+(R>>>7)]}function K(R,B){R.pending_buf[R.pending++]=255&B,R.pending_buf[R.pending++]=B>>>8&255}function X(R,B,G){R.bi_valid>b-G?(R.bi_buf|=B<<R.bi_valid&65535,K(R,R.bi_buf),R.bi_buf=B>>b-R.bi_valid,R.bi_valid+=G-b):(R.bi_buf|=B<<R.bi_valid&65535,R.bi_valid+=G)}function H(R,B,G){X(R,G[2*B],G[2*B+1])}function ct(R,B){for(var G=0;G|=1&R,R>>>=1,G<<=1,0<--B;);return G>>>1}function ot(R,B,G){var Z,U,Q=new Array(v+1),nt=0;for(Z=1;Z<=v;Z++)Q[Z]=nt=nt+G[Z-1]<<1;for(U=0;U<=B;U++){var J=R[2*U+1];J!==0&&(R[2*U]=ct(Q[J]++,J))}}function et(R){var B;for(B=0;B<g;B++)R.dyn_ltree[2*B]=0;for(B=0;B<u;B++)R.dyn_dtree[2*B]=0;for(B=0;B<y;B++)R.bl_tree[2*B]=0;R.dyn_ltree[2*_]=1,R.opt_len=R.static_len=0,R.last_lit=R.matches=0}function st(R){8<R.bi_valid?K(R,R.bi_buf):0<R.bi_valid&&(R.pending_buf[R.pending++]=R.bi_buf),R.bi_buf=0,R.bi_valid=0}function at(R,B,G,Z){var U=2*B,Q=2*G;return R[U]<R[Q]||R[U]===R[Q]&&Z[B]<=Z[G]}function pt(R,B,G){for(var Z=R.heap[G],U=G<<1;U<=R.heap_len&&(U<R.heap_len&&at(B,R.heap[U+1],R.heap[U],R.depth)&&U++,!at(B,Z,R.heap[U],R.depth));)R.heap[G]=R.heap[U],G=U,U<<=1;R.heap[G]=Z}function gt(R,B,G){var Z,U,Q,nt,J=0;if(R.last_lit!==0)for(;Z=R.pending_buf[R.d_buf+2*J]<<8|R.pending_buf[R.d_buf+2*J+1],U=R.pending_buf[R.l_buf+J],J++,Z===0?H(R,U,B):(H(R,(Q=h[U])+m+1,B),(nt=D[Q])!==0&&X(R,U-=E[Q],nt),H(R,Q=L(--Z),G),(nt=I[Q])!==0&&X(R,Z-=Y[Q],nt)),J<R.last_lit;);H(R,_,B)}function Et(R,B){var G,Z,U,Q=B.dyn_tree,nt=B.stat_desc.static_tree,J=B.stat_desc.has_stree,lt=B.stat_desc.elems,ht=-1;for(R.heap_len=0,R.heap_max=d,G=0;G<lt;G++)Q[2*G]!==0?(R.heap[++R.heap_len]=ht=G,R.depth[G]=0):Q[2*G+1]=0;for(;R.heap_len<2;)Q[2*(U=R.heap[++R.heap_len]=ht<2?++ht:0)]=1,R.depth[U]=0,R.opt_len--,J&&(R.static_len-=nt[2*U+1]);for(B.max_code=ht,G=R.heap_len>>1;1<=G;G--)pt(R,Q,G);for(U=lt;G=R.heap[1],R.heap[1]=R.heap[R.heap_len--],pt(R,Q,1),Z=R.heap[1],R.heap[--R.heap_max]=G,R.heap[--R.heap_max]=Z,Q[2*U]=Q[2*G]+Q[2*Z],R.depth[U]=(R.depth[G]>=R.depth[Z]?R.depth[G]:R.depth[Z])+1,Q[2*G+1]=Q[2*Z+1]=U,R.heap[1]=U++,pt(R,Q,1),2<=R.heap_len;);R.heap[--R.heap_max]=R.heap[1],function(dt,St){var Gt,_t,Ht,yt,se,ee,Lt=St.dyn_tree,je=St.max_code,Le=St.stat_desc.static_tree,rn=St.stat_desc.has_stree,on=St.stat_desc.extra_bits,Me=St.stat_desc.extra_base,wt=St.stat_desc.max_length,Rt=0;for(yt=0;yt<=v;yt++)dt.bl_count[yt]=0;for(Lt[2*dt.heap[dt.heap_max]+1]=0,Gt=dt.heap_max+1;Gt<d;Gt++)wt<(yt=Lt[2*Lt[2*(_t=dt.heap[Gt])+1]+1]+1)&&(yt=wt,Rt++),Lt[2*_t+1]=yt,je<_t||(dt.bl_count[yt]++,se=0,Me<=_t&&(se=on[_t-Me]),ee=Lt[2*_t],dt.opt_len+=ee*(yt+se),rn&&(dt.static_len+=ee*(Le[2*_t+1]+se)));if(Rt!==0){do{for(yt=wt-1;dt.bl_count[yt]===0;)yt--;dt.bl_count[yt]--,dt.bl_count[yt+1]+=2,dt.bl_count[wt]--,Rt-=2}while(0<Rt);for(yt=wt;yt!==0;yt--)for(_t=dt.bl_count[yt];_t!==0;)je<(Ht=dt.heap[--Gt])||(Lt[2*Ht+1]!==yt&&(dt.opt_len+=(yt-Lt[2*Ht+1])*Lt[2*Ht],Lt[2*Ht+1]=yt),_t--)}}(R,B),ot(Q,ht,R.bl_count)}function p(R,B,G){var Z,U,Q=-1,nt=B[1],J=0,lt=7,ht=4;for(nt===0&&(lt=138,ht=3),B[2*(G+1)+1]=65535,Z=0;Z<=G;Z++)U=nt,nt=B[2*(Z+1)+1],++J<lt&&U===nt||(J<ht?R.bl_tree[2*U]+=J:U!==0?(U!==Q&&R.bl_tree[2*U]++,R.bl_tree[2*k]++):J<=10?R.bl_tree[2*C]++:R.bl_tree[2*N]++,Q=U,ht=(J=0)===nt?(lt=138,3):U===nt?(lt=6,3):(lt=7,4))}function $(R,B,G){var Z,U,Q=-1,nt=B[1],J=0,lt=7,ht=4;for(nt===0&&(lt=138,ht=3),Z=0;Z<=G;Z++)if(U=nt,nt=B[2*(Z+1)+1],!(++J<lt&&U===nt)){if(J<ht)for(;H(R,U,R.bl_tree),--J!=0;);else U!==0?(U!==Q&&(H(R,U,R.bl_tree),J--),H(R,k,R.bl_tree),X(R,J-3,2)):J<=10?(H(R,C,R.bl_tree),X(R,J-3,3)):(H(R,N,R.bl_tree),X(R,J-11,7));Q=U,ht=(J=0)===nt?(lt=138,3):U===nt?(lt=6,3):(lt=7,4)}}l(Y);var q=!1;function T(R,B,G,Z){X(R,(f<<1)+(Z?1:0),3),function(U,Q,nt,J){st(U),K(U,nt),K(U,~nt),i.arraySet(U.pending_buf,U.window,Q,nt,U.pending),U.pending+=nt}(R,B,G)}o._tr_init=function(R){q||(function(){var B,G,Z,U,Q,nt=new Array(v+1);for(U=Z=0;U<c-1;U++)for(E[U]=Z,B=0;B<1<<D[U];B++)h[Z++]=U;for(h[Z-1]=U,U=Q=0;U<16;U++)for(Y[U]=Q,B=0;B<1<<I[U];B++)S[Q++]=U;for(Q>>=7;U<u;U++)for(Y[U]=Q<<7,B=0;B<1<<I[U]-7;B++)S[256+Q++]=U;for(G=0;G<=v;G++)nt[G]=0;for(B=0;B<=143;)M[2*B+1]=8,B++,nt[8]++;for(;B<=255;)M[2*B+1]=9,B++,nt[9]++;for(;B<=279;)M[2*B+1]=7,B++,nt[7]++;for(;B<=287;)M[2*B+1]=8,B++,nt[8]++;for(ot(M,g+1,nt),B=0;B<u;B++)w[2*B+1]=5,w[2*B]=ct(B,5);F=new tt(M,D,m+1,g,v),W=new tt(w,I,0,u,v),V=new tt(new Array(0),z,0,y,x)}(),q=!0),R.l_desc=new P(R.dyn_ltree,F),R.d_desc=new P(R.dyn_dtree,W),R.bl_desc=new P(R.bl_tree,V),R.bi_buf=0,R.bi_valid=0,et(R)},o._tr_stored_block=T,o._tr_flush_block=function(R,B,G,Z){var U,Q,nt=0;0<R.level?(R.strm.data_type===2&&(R.strm.data_type=function(J){var lt,ht=4093624447;for(lt=0;lt<=31;lt++,ht>>>=1)if(1&ht&&J.dyn_ltree[2*lt]!==0)return a;if(J.dyn_ltree[18]!==0||J.dyn_ltree[20]!==0||J.dyn_ltree[26]!==0)return s;for(lt=32;lt<m;lt++)if(J.dyn_ltree[2*lt]!==0)return s;return a}(R)),Et(R,R.l_desc),Et(R,R.d_desc),nt=function(J){var lt;for(p(J,J.dyn_ltree,J.l_desc.max_code),p(J,J.dyn_dtree,J.d_desc.max_code),Et(J,J.bl_desc),lt=y-1;3<=lt&&J.bl_tree[2*O[lt]+1]===0;lt--);return J.opt_len+=3*(lt+1)+5+5+4,lt}(R),U=R.opt_len+3+7>>>3,(Q=R.static_len+3+7>>>3)<=U&&(U=Q)):U=Q=G+5,G+4<=U&&B!==-1?T(R,B,G,Z):R.strategy===4||Q===U?(X(R,2+(Z?1:0),3),gt(R,M,w)):(X(R,4+(Z?1:0),3),function(J,lt,ht,dt){var St;for(X(J,lt-257,5),X(J,ht-1,5),X(J,dt-4,4),St=0;St<dt;St++)X(J,J.bl_tree[2*O[St]+1],3);$(J,J.dyn_ltree,lt-1),$(J,J.dyn_dtree,ht-1)}(R,R.l_desc.max_code+1,R.d_desc.max_code+1,nt+1),gt(R,R.dyn_ltree,R.dyn_dtree)),et(R),Z&&st(R)},o._tr_tally=function(R,B,G){return R.pending_buf[R.d_buf+2*R.last_lit]=B>>>8&255,R.pending_buf[R.d_buf+2*R.last_lit+1]=255&B,R.pending_buf[R.l_buf+R.last_lit]=255&G,R.last_lit++,B===0?R.dyn_ltree[2*G]++:(R.matches++,B--,R.dyn_ltree[2*(h[G]+m+1)]++,R.dyn_dtree[2*L(B)]++),R.last_lit===R.lit_bufsize-1},o._tr_align=function(R){X(R,2,3),H(R,_,M),function(B){B.bi_valid===16?(K(B,B.bi_buf),B.bi_buf=0,B.bi_valid=0):8<=B.bi_valid&&(B.pending_buf[B.pending++]=255&B.bi_buf,B.bi_buf>>=8,B.bi_valid-=8)}(R)}},{"../utils/common":41}],53:[function(e,r,o){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,o){(function(i){(function(a,s){if(!a.setImmediate){var l,f,c,m,g=1,u={},y=!1,d=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(k){process.nextTick(function(){x(k)})}:function(){if(a.postMessage&&!a.importScripts){var k=!0,C=a.onmessage;return a.onmessage=function(){k=!1},a.postMessage("","*"),a.onmessage=C,k}}()?(m="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",_,!1):a.attachEvent("onmessage",_),function(k){a.postMessage(m+k,"*")}):a.MessageChannel?((c=new MessageChannel).port1.onmessage=function(k){x(k.data)},function(k){c.port2.postMessage(k)}):d&&"onreadystatechange"in d.createElement("script")?(f=d.documentElement,function(k){var C=d.createElement("script");C.onreadystatechange=function(){x(k),C.onreadystatechange=null,f.removeChild(C),C=null},f.appendChild(C)}):function(k){setTimeout(x,0,k)},v.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var C=new Array(arguments.length-1),N=0;N<C.length;N++)C[N]=arguments[N+1];var D={callback:k,args:C};return u[g]=D,l(g),g++},v.clearImmediate=b}function b(k){delete u[k]}function x(k){if(y)setTimeout(x,0,k);else{var C=u[k];if(C){y=!0;try{(function(N){var D=N.callback,I=N.args;switch(I.length){case 0:D();break;case 1:D(I[0]);break;case 2:D(I[0],I[1]);break;case 3:D(I[0],I[1],I[2]);break;default:D.apply(s,I)}})(C)}finally{b(k),y=!1}}}}function _(k){k.source===a&&typeof k.data=="string"&&k.data.indexOf(m)===0&&x(+k.data.slice(m.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Be<"u"?Be:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(jn)),jn.exports}var _a=xa();const Qn=mi(_a);function ka(t){const n=t?.toLowerCase()||"";return n.includes("jpeg")?"jpeg":n.includes("png")?"png":n.includes("webp")?"webp":n.includes("gif")?"gif":n.includes("bmp")?"bmp":n.includes("avif")?"avif":"jpg"}async function Ca(t){try{const n=await fetch(t,{cache:"no-store"});if(n.ok){const e=await n.blob();return{blob:e,mime:e.type||"image/jpeg"}}}catch{}try{const n=await Ea(t),{blob:e,mime:r}=await Sa(n);return{blob:e,mime:r}}catch{throw new Error("Unable to read image bytes (fetch/canvas failed).")}}function Ea(t){return new Promise((n,e)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>n(r),r.onerror=e,r.src=t})}function Sa(t){return new Promise((n,e)=>{const r=Math.max(1,t.naturalWidth||t.width||1),o=Math.max(1,t.naturalHeight||t.height||1),i=document.createElement("canvas");i.width=r,i.height=o;const a=i.getContext("2d");if(!a)return e(new Error("Canvas2D unavailable"));a.drawImage(t,0,0,r,o),i.toBlob(s=>{if(!s)return e(new Error("Canvas toBlob failed (tainted?)"));n({blob:s,mime:s.type||"image/png"})},"image/png",.92)})}async function Ra(t){const n=t?.imageFormat??"jpeg",e=Math.max(.5,Math.min(.95,t?.quality??.8)),r=ft.getState(),o=r.photos,i=o.length;let a=0;const s=new Qn,l=s.folder("images");if(!l)throw new Error("ZIP: cannot create images/");const f={schemaVersion:1,createdAt:new Date().toISOString(),appConfigSnapshot:{MAX_CARDS:Gi,CARD_EXPORT_SIZE:It,PREVIEW_EXACT_SIZE:Ye,PREVIEW_FAST_SIZE:Vs},images:[],cards:[]};for(let m=0;m<o.length;m++){const g=o[m];let u=null,y="image/jpeg";try{const k=await Ca(g.url);u=k.blob,y=k.mime||y}catch{u=null}if(u){const k=(u.type||"").toLowerCase();if(n==="jpeg"){if(!/jpe?g/.test(k)||e!==.8)try{u=await Na(u,e),y="image/jpeg"}catch{}}else if(n==="png"&&!/png/.test(k))try{u=await Ia(u),y="image/png"}catch{}}const d=ka(y),v=`images/${g.id}.${d}`;u?(l.file(`${g.id}.${d}`,u),f.images.push({id:g.id,path:v,mime:y,size:u.size,source:{type:"embedded"}})):f.images.push({id:g.id,path:v,mime:y,source:{type:"url"}});const b=r.transforms[g.id]??{scale:1,tx:0,ty:0},x=r.cardBackground?.[g.id],_=(r.layersByPhoto[g.id]??[]).map(Aa);f.cards.push({photoId:g.id,order:m,transform:b,background:x,layers:_}),a++,t?.onProgress?.({done:a,total:i})}return s.file("manifest.json",JSON.stringify(f,null,2)),await s.generateAsync({type:"blob",compression:"DEFLATE"})}function Aa(t){if(!t)return t;if(t.type==="image"&&t.qrText){const{src:n,...e}=t;return e}if(t.type==="image"&&typeof t.src=="string"&&t.src.startsWith("data:")){const{src:n,...e}=t;return e}return{...t}}async function eo(t){const n=URL.createObjectURL(t);try{return await new Promise((e,r)=>{const o=new Image;o.onload=()=>e(o),o.onerror=r,o.src=n})}finally{URL.revokeObjectURL(n)}}async function Na(t,n){const e=await eo(t),r=document.createElement("canvas");r.width=Math.max(1,e.naturalWidth||e.width||1),r.height=Math.max(1,e.naturalHeight||e.height||1);const o=r.getContext("2d");if(!o)throw new Error("Canvas2D unavailable");o.drawImage(e,0,0);const i=r.toDataURL("image/jpeg",n);return await(await fetch(i)).blob()}async function Ia(t){const n=await eo(t),e=document.createElement("canvas");e.width=Math.max(1,n.naturalWidth||n.width||1),e.height=Math.max(1,n.naturalHeight||n.height||1);const r=e.getContext("2d");if(!r)throw new Error("Canvas2D unavailable");r.drawImage(n,0,0);const o=e.toDataURL("image/png");return await(await fetch(o)).blob()}async function no(t){const n=[],e=await Qn.loadAsync(t),r=e.file("manifest.json");if(!r)throw new Error("manifest.json not found in zip");const o=await r.async("string");let i;try{i=JSON.parse(o)}catch{throw new Error("manifest.json is not valid JSON")}if(i.schemaVersion!==1)throw new Error(`Unsupported schemaVersion: ${i.schemaVersion}`);const a=new Map;for(const g of i.images){const u=e.file(g.path);if(!u){n.push(`Image file missing in zip: ${g.path}`);continue}try{const y=await u.async("blob"),d=URL.createObjectURL(y);a.set(g.id,d)}catch{n.push(`Failed to read image: ${g.path}`)}}const s=[],l={},f={},c={},m=[...i.cards].sort((g,u)=>g.order-u.order);for(const g of m){const u=a.get(g.photoId);u?s.push({id:g.photoId,url:u}):(n.push(`Missing image for card photoId=${g.photoId}. Card will appear without photo.`),s.push({id:g.photoId,url:Ta})),l[g.photoId]={...g.transform},g.background&&(c[g.photoId]={...g.background});const y=Array.isArray(g.layers)?g.layers.slice():[];for(const d of y)if(d&&d.type==="image"&&d.qrText&&!d.src){const v=Math.max(1,Math.round(d.w??d.h??512));d.src=await qn(d.qrText,v,1),d.w==null&&(d.w=v),d.h==null&&(d.h=v)}f[g.photoId]=y}return ft.setState({photos:s,transforms:l,layersByPhoto:f,cardBackground:c}),{warnings:n}}const Ta="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=",Ce=gi(t=>({busy:!1,busyText:void 0,progress:void 0,setBusy:(n,e,r)=>t({busy:n,busyText:n?e:void 0,progress:n?r:void 0}),start:n=>t({busy:!0,busyText:n??"Loading...",progress:0}),setProgress:(n,e)=>t(r=>({progress:Math.max(0,Math.min(100,n)),busyText:e??r.busyText})),stop:()=>t({busy:!1,busyText:void 0,progress:void 0})}));function Da(){const t=j.useRef(null),n=j.useRef(null),e=j.useRef(null),r=ft(g=>g.photos),o=ft(g=>g.add),i=ft(g=>g.clear),a=j.useCallback(g=>{if(!g?.length)return;const u=Array.from(g),y=Ws(u);o(y)},[o]),s=j.useCallback(g=>{a(g.target.files),g.target.value=""},[a]);async function l(g){const u=g.target.files?.[0];if(!u)return;const y=await u.text();g.target.value="";const{rows:d,hasRelative:v}=va(y);if(!d.length)return;if(v){alert("В этом CSV есть относительные пути. В текущей сборке локальная папка не поддерживается. Пожалуйста, используйте полные URL (http/https) или добавьте изображения кнопкой “Choose images”.");return}const b=Ce.getState();b.start("Importing CSV…");try{await m(d,null)}finally{b.stop()}}function f(g){return new Promise(u=>setTimeout(u,g))}async function c(g,u,y=4e3,d=50){const v=Date.now()+y,b=u.map(x=>x.toLowerCase());for(;Date.now()<v;){const _=ft.getState().layersByPhoto[g]??[],k=new Set(_.map(N=>typeof N?.name=="string"?N.name.toLowerCase():"").filter(Boolean));if(b.filter(N=>!k.has(N)).length===0)return[];await f(d)}return u}async function m(g,u){const y=Ce.getState(),d=ft.getState(),v=d.photos.length,b=d.max,x=Math.max(0,b-v);if(x<=0){alert(`Достигнут лимит коллекции: ${b} карточек.`);return}const _=Math.min(x,g.length);_<g.length&&alert(`Будут импортированы только ${_} из ${g.length} — лимит коллекции ${b}.`);const k=g.slice(0,_),C=[];let N=0,D=0;for(let S=0;S<k.length;S++){const h=k[S];try{let E=null,F="image";if(Ji(h.url)){const Y=await fetch(h.url,{mode:"cors"});if(!Y.ok)throw new Error(`HTTP ${Y.status}`);E=await Y.blob(),F=h.url.split("/").pop()||F}else if(to(h.url))E=await(await fetch(h.url)).blob(),F="data.png";else throw new Error("Relative paths are disabled in this build");const W=URL.createObjectURL(E),V=crypto.randomUUID();C.push({id:V,url:W,name:F}),N++}catch(E){console.warn("CSV import skip:",h.url,E),D++}y.setProgress(Math.round((S+1)/k.length*100),`Importing CSV… (${S+1}/${k.length})`)}const I=ft.getState().add;I(C);const M=ft.getState().photos.slice(v).map(S=>S.id),w=k.slice(0,M.length);for(let S=0;S<w.length;S++){const h=w[S],E=M[S];if(!h.layers)continue;const F=Object.keys(h.layers).map(P=>P.toLowerCase());(await c(E,F,4e3,50)).length;const V=ft.getState(),Y=V.layersByPhoto[E]??[],tt=P=>["x","y","w","h","width","height","fontSize","rotation","letterSpacing","lineHeight","padding","opacity","strokeWidth"].includes(P);for(const[P,L]of Object.entries(h.layers)){const K=String(P).toLowerCase(),X=Y.filter(H=>typeof H?.name=="string"&&H.name.toLowerCase()===K);if(X.length)for(const H of X)for(const[ct,ot]of Object.entries(L)){const et=ct;if(H.type==="image"&&H.qrText!==void 0){if(et==="text"){await V.updateQrLayer(E,H.id,{text:ot});continue}if(et==="size"){const at=parseInt(ot,10);Number.isNaN(at)||await V.updateQrLayer(E,H.id,{size:at});continue}}const st={};if(et==="text"?st.text=ot:et==="fill"?st.fill=ot:et==="align"?st.align=ot:et==="vertical_align"||et==="verticalalign"?st.verticalAlign=ot:et==="fontfamily"||et==="font_family"?st.fontFamily=ot:(et==="fontstyle"||et==="font_style")&&(st.fontStyle=ot),tt(et)){const at=parseFloat(ot);Number.isNaN(at)||(st[et]=at)}Object.keys(st).length&&V.updateLayer(E,H.id,st)}}y.setProgress(Math.round((S+1)/w.length*100),`Applying CSV overrides… (${S+1}/${w.length})`)}D&&alert(`CSV import: добавлено ${N}, пропущено ${D}`)}return A.jsx("section",{className:"mt-4 space-y-4",children:A.jsxs("div",{className:"flex items-center justify-between gap-2",children:[A.jsxs("div",{className:"text-sm opacity-80",children:["Cards: ",A.jsx("b",{children:r.length})]}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx("input",{ref:t,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:s}),A.jsx("input",{ref:n,type:"file",accept:".csv,text/csv",className:"hidden",onChange:l}),A.jsx("input",{ref:e,type:"file",accept:".zip,application/zip",className:"hidden",onChange:async g=>{const u=g.currentTarget,y=u.files?.[0];if(u.value="",!!y)try{const{warnings:d}=await no(y);d.length&&alert(`Import finished with warnings:
`+d.join(`
`))}catch(d){setTimeout(()=>{alert(`Cannot open .zip: ${d?.message??String(d)}`)},0)}}}),A.jsx(xt,{variant:"secondary",onClick:()=>e.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Open collection (.zip)"}),A.jsx("button",{onClick:()=>n.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Import CSV"}),A.jsx("button",{onClick:()=>t.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Choose images"}),A.jsx(xt,{variant:"destructive",onClick:i,disabled:!r.length,children:"Clear"})]})]})})}const ro=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:bt("rounded-xl border bg-card text-card-foreground shadow",t),...n}));ro.displayName="Card";const za=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:bt("flex flex-col space-y-1.5 p-6",t),...n}));za.displayName="CardHeader";const ja=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:bt("font-semibold leading-none tracking-tight",t),...n}));ja.displayName="CardTitle";const La=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:bt("text-sm text-muted-foreground",t),...n}));La.displayName="CardDescription";const Ma=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:bt("p-6 pt-0",t),...n}));Ma.displayName="CardContent";const Ba=j.forwardRef(({className:t,...n},e)=>A.jsx("div",{ref:e,className:bt("flex items-center p-6 pt-0",t),...n}));Ba.displayName="CardFooter";const Jn=j.forwardRef(({className:t,value:n,...e},r)=>A.jsx(wi,{ref:r,className:bt("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...e,children:A.jsx(Wo,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));Jn.displayName=wi.displayName;const io=Ho,oo=Zo,tr=j.forwardRef(({className:t,children:n,...e},r)=>A.jsxs(xi,{ref:r,className:bt("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...e,children:[n,A.jsx(qo,{asChild:!0,children:A.jsx(bi,{className:"h-4 w-4 opacity-50"})})]}));tr.displayName=xi.displayName;const so=j.forwardRef(({className:t,...n},e)=>A.jsx(_i,{ref:e,className:bt("flex cursor-default items-center justify-center py-1",t),...n,children:A.jsx(jo,{className:"h-4 w-4"})}));so.displayName=_i.displayName;const ao=j.forwardRef(({className:t,...n},e)=>A.jsx(ki,{ref:e,className:bt("flex cursor-default items-center justify-center py-1",t),...n,children:A.jsx(bi,{className:"h-4 w-4"})}));ao.displayName=ki.displayName;const er=j.forwardRef(({className:t,children:n,position:e="popper",...r},o)=>A.jsx(Vo,{children:A.jsxs(Ci,{ref:o,className:bt("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:e,...r,children:[A.jsx(so,{}),A.jsx(Yo,{className:bt("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),A.jsx(ao,{})]})}));er.displayName=Ci.displayName;const Pa=j.forwardRef(({className:t,...n},e)=>A.jsx(Ei,{ref:e,className:bt("px-2 py-1.5 text-sm font-semibold",t),...n}));Pa.displayName=Ei.displayName;const ue=j.forwardRef(({className:t,children:n,...e},r)=>A.jsxs(Si,{ref:r,className:bt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e,children:[A.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:A.jsx($o,{children:A.jsx(Lo,{className:"h-4 w-4"})})}),A.jsx(Go,{children:n})]}));ue.displayName=Si.displayName;const Oa=j.forwardRef(({className:t,...n},e)=>A.jsx(Ri,{ref:e,className:bt("-mx-1 my-1 h-px bg-muted",t),...n}));Oa.displayName=Ri.displayName;const Fa=[];function lo(t,n=""){const[e,r]=j.useState(null),[o,i]=j.useState("idle");return j.useEffect(()=>{if(!t){r(null),i("idle");return}let a=!1;const s=new Image;return n&&(s.crossOrigin=n),i("loading"),s.onload=()=>{a||(r(s),i("loaded"))},s.onerror=()=>{a||(r(null),i("failed"))},s.src=t,()=>{a=!0}},[t,n]),[e,o]}function Ua({layer:t,k:n,onSelect:e,updateLayer:r,selectedId:o,forwardRef:i}){const[a]=lo(t.src||"","anonymous"),s=o===t.id,l=j.useRef(null),f=s&&i?i:l,c=t.x*n,m=t.y*n,g=a?.naturalWidth??0,u=a?.naturalHeight??0,y=Math.max(1,t.w?t.w*n:g*n||1),d=Math.max(1,t.h?t.h*n:u*n||1);return A.jsx(yi,{ref:f,draggable:!0,image:a??void 0,x:c,y:m,width:y,height:d,rotation:t.rotation,visible:t.visible,onMouseDown:()=>e(t.id),onTap:()=>e(t.id),onDragEnd:v=>{r(t.photoId,t.id,{x:v.target.x()/n,y:v.target.y()/n})},onTransformEnd:v=>{const b=v.target,x=typeof b.scaleX=="function"?b.scaleX():1,_=typeof b.scaleY=="function"?b.scaleY():1,k=typeof b.width=="function"?b.width():y,C=typeof b.height=="function"?b.height():d,N={x:b.x()/n,y:b.y()/n,rotation:b.rotation(),scaleX:1,scaleY:1,w:Math.max(1,Math.round(k*x/n)),h:Math.max(1,Math.round(C*_/n))};typeof b.scaleX=="function"&&b.scaleX(1),typeof b.scaleY=="function"&&b.scaleY(1),r(t.photoId,t.id,N)}},t.id)}const Je=j.forwardRef(function({photoId:n,size:e,selectedId:r,onSelect:o,transformOverride:i},a){const l=j.useRef(null),f=ft(M=>M.photos.find(w=>w.id===n)?.url),c=ft(M=>M.transforms[n]??re),m=ft(M=>M.setTransform),g=i??c,u=ft(M=>M.layersByPhoto[n]??Fa,Object.is).map(M=>({...M,photoId:n})),y=ft(M=>M.updateLayer),d=ft(M=>M.cardBackground?.[n]??Kn,Object.is),[v,b]=lo(f??"","anonymous"),x=b==="loaded";j.useImperativeHandle(a,()=>({toDataURL:M=>{const w=l.current;if(!w)return null;const S=M&&M>0?M/e:1;return w.toDataURL({pixelRatio:S,mimeType:"image/png"})},isReady:()=>!!l.current&&x}));const _=j.useRef(null),k=j.useRef(null);j.useEffect(()=>{const M=_.current,w=k.current;M&&w&&r?(M.nodes([w]),M.getLayer()?.batchDraw()):M&&!r&&(M.nodes([]),M.getLayer()?.batchDraw())},[r]);const C=e/It,N=j.useMemo(()=>u.find(M=>M.id===r),[u,r]),D=!!(N?.type==="image"&&N?.qrText);function I(M,w,S){const h=w/M.width,E=w/M.height,W=Math.min(h,E)*(S?.scale??1),V=M.width*W,Y=M.height*W,tt=(w-V)/2+(S?.tx??0)/100*w,P=(w-Y)/2+(S?.ty??0)/100*w;return{x:tt*C,y:P*C,width:V*C,height:Y*C}}const z=(M,w,S)=>Math.max(w,Math.min(S,M)),O=j.useCallback(M=>{M.evt.preventDefault();const w=M.evt.deltaY||0;if(!Number.isFinite(w)||w===0)return;const S=Math.pow(1.0015,-w),h=ft.getState().transforms[n]??re,E=z(h.scale*S,.5,4);E!==h.scale&&m(n,{scale:E})},[n,m]);return A.jsx(Mo,{ref:l,width:e,height:e,pixelRatio:1,listening:!0,style:{width:"100%",height:"100%"},onWheel:O,onMouseDown:M=>{M.target===M.target.getStage()&&o(null)},onTouchStart:M=>{M.target===M.target.getStage()&&o(null)},children:A.jsxs(Bo,{children:[A.jsx(gr,{x:0,y:0,width:e,height:e,fill:d.color,opacity:d.alpha,listening:!1}),v?A.jsx(yi,{image:v,...I(v,It,g),listening:!1}):null,u.slice().sort((M,w)=>M.z-w.z).map(M=>{if(M.type==="text"){const w=M,h=r===w.id?k:void 0,E=w.x*C,F=w.y*C,W=(w.fontSize??16)*C,V=w.width?w.width*C:void 0,Y=(w.padding??0)*C,tt=(w.letterSpacing??0)*C;return A.jsx(Po,{ref:h,draggable:!0,x:E,y:F,text:w.text,fontFamily:w.fontFamily||"Georgia, serif",fontSize:W,fontStyle:w.fontStyle,fill:w.fill,width:V,align:w.align,lineHeight:w.lineHeight??1.25,padding:Y,letterSpacing:tt,rotation:w.rotation,scaleX:1,scaleY:1,visible:w.visible,perfectDrawEnabled:!1,onTransform:P=>{const L=P.target,K=typeof L.scaleX=="function"?L.scaleX():1,X=typeof L.width=="function"?L.width():void 0;X!==void 0&&K&&K!==1&&(L.width(Math.max(4,Math.round(X*K))),typeof L.scaleX=="function"&&L.scaleX(1),typeof L.scaleY=="function"&&L.scaleY(1),L.getLayer()?.batchDraw())},onMouseDown:()=>o(w.id),onTap:()=>o(w.id),onDragEnd:P=>{y(n,w.id,{x:P.target.x()/C,y:P.target.y()/C})},onTransformEnd:P=>{const L=P.target,K=typeof L.scaleX=="function"?L.scaleX():1,X=typeof L.width=="function"?L.width():void 0,H={x:L.x()/C,y:L.y()/C,rotation:L.rotation(),scaleX:1,scaleY:1,width:X!==void 0?Math.max(4,Math.round(X*K/C)):void 0};typeof L.scaleX=="function"&&L.scaleX(1),typeof L.scaleY=="function"&&L.scaleY(1),y(n,w.id,H)}},w.id)}if(M.type==="rect"){const w=M,h=r===w.id?k:void 0,E=w.x*C,F=w.y*C,W=Math.max(1,(w.width??100)*C),V=Math.max(1,(w.height??100)*C),Y=Math.max(0,(w.strokeWidth??0)*C),tt=Math.max(0,(w.cornerRadius??0)*C);return A.jsx(gr,{ref:h,draggable:!0,x:E,y:F,width:W,height:V,rotation:w.rotation,fill:w.fill??"#ffffff",stroke:w.stroke,strokeWidth:Y,cornerRadius:tt,visible:w.visible,opacity:Math.max(0,Math.min(1,w.opacity??1)),onMouseDown:()=>o(w.id),onTap:()=>o(w.id),onDragEnd:P=>{y(n,w.id,{x:P.target.x()/C,y:P.target.y()/C})},onTransformEnd:P=>{const L=P.target,K=typeof L.scaleX=="function"?L.scaleX():1,X=typeof L.scaleY=="function"?L.scaleY():1,H=typeof L.width=="function"?L.width():W,ct=typeof L.height=="function"?L.height():V,ot={x:L.x()/C,y:L.y()/C,rotation:L.rotation(),scaleX:1,scaleY:1,width:Math.max(1,Math.round(H*K/C)),height:Math.max(1,Math.round(ct*X/C))};typeof L.scaleX=="function"&&L.scaleX(1),typeof L.scaleY=="function"&&L.scaleY(1),y(n,w.id,ot)}},w.id)}if(M.type==="image"){const w=r===M.id;return A.jsx(Ua,{layer:M,k:C,selectedId:r,onSelect:o,updateLayer:y,forwardRef:w?k:void 0},M.id)}return null}),r&&A.jsx(Oo,{ref:_,rotateEnabled:!0,enabledAnchors:["middle-left","middle-right","top-center","bottom-center","top-left","top-right","bottom-left","bottom-right"],borderStroke:"#fff",anchorStroke:"#fff",anchorFill:"#111",anchorSize:7,keepRatio:D,centeredScaling:!1,boundBoxFunc:(M,w)=>{const h=Math.max(6,w.width),E=Math.max(6,w.height);return{...w,width:h,height:E}}})]})})}),co=Qo,Wa=Xo,uo=j.forwardRef(({className:t,...n},e)=>A.jsx(Ai,{ref:e,className:bt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));uo.displayName=Ai.displayName;const nr=j.forwardRef(({className:t,children:n,...e},r)=>A.jsxs(Wa,{children:[A.jsx(uo,{}),A.jsxs(Ni,{ref:r,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e,children:[n,A.jsxs(Ko,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[A.jsx(Fo,{className:"h-4 w-4"}),A.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));nr.displayName=Ni.displayName;const rr=({className:t,...n})=>A.jsx("div",{className:bt("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});rr.displayName="DialogHeader";const ir=({className:t,...n})=>A.jsx("div",{className:bt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});ir.displayName="DialogFooter";const or=j.forwardRef(({className:t,...n},e)=>A.jsx(Ii,{ref:e,className:bt("text-lg font-semibold leading-none tracking-tight",t),...n}));or.displayName=Ii.displayName;const fo=j.forwardRef(({className:t,...n},e)=>A.jsx(Ti,{ref:e,className:bt("text-sm text-muted-foreground",t),...n}));fo.displayName=Ti.displayName;const qa=Mi("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),de=j.forwardRef(({className:t,...n},e)=>A.jsx(Di,{ref:e,className:bt(qa(),t),...n}));de.displayName=Di.displayName;const $e=j.forwardRef(({className:t,...n},e)=>A.jsxs(zi,{ref:e,className:bt("relative flex w-full touch-none select-none items-center",t),...n,children:[A.jsx(Jo,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:A.jsx(ts,{className:"absolute h-full bg-primary"})}),A.jsx(es,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));$e.displayName=zi.displayName;const Ln=new Map;function He(t){const n=t.trim();if(n.startsWith('"')){const e=n.indexOf('"',1);return e>1?n.slice(1,e):n.replace(/["']/g,"")}return n.split(",")[0].replace(/["']/g,"").trim()}function Va(t){const n=He(t);return Hi.find(e=>He(e.family).toLowerCase()===n.toLowerCase())}function Ya(t,n){if(document.getElementById(n))return;const e=document.createElement("link");e.id=n,e.rel="stylesheet",e.href=t;const r=document.createElement("link");r.rel="preconnect",r.href="https://fonts.googleapis.com";const o=document.createElement("link");o.rel="preconnect",o.href="https://fonts.gstatic.com",o.crossOrigin="anonymous",document.head.appendChild(r),document.head.appendChild(o),document.head.appendChild(e)}function $a(t){const n=He(t);if(Ln.has(n))return Ln.get(n);const e=(async()=>{const r=Va(t);r&&r.cssHref&&Ya(r.cssHref,`font-css-${r.id}`);try{const o=document;o?.fonts?.ready&&typeof o.fonts.ready.then=="function"&&await o.fonts.ready}catch{}try{document.fonts?.load&&await document.fonts.load(`1em ${He(t)}`)}catch{}})();return Ln.set(n,e),e}const Ga=[],qe="__none__";function Ha({photoId:t,layer:n}){const e=ft(s=>s.updateQrLayer),[r,o]=j.useState(n.qrText??""),[i,a]=j.useState(Math.max(1,Math.round(n.w??n.h??512)));return j.useEffect(()=>{o(n.qrText??""),a(Math.max(1,Math.round(n.w??n.h??512)))},[n.id,n.qrText,n.w,n.h]),A.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-foreground/10",children:"QR"}),A.jsx("span",{className:"opacity-70 text-sm",children:"This layer is a QR code"})]}),A.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[A.jsx("label",{className:"text-xs opacity-70",children:"QR text / URL"}),A.jsx("input",{type:"text",value:r,onChange:s=>o(s.target.value),className:"flex-1 min-w-[16rem] rounded border px-2 py-1 text-sm",placeholder:"https://example.com"}),A.jsx("label",{className:"text-xs opacity-70",children:"Size (px)"}),A.jsx("input",{type:"number",min:1,max:It,step:1,value:i,onChange:s=>a(Math.max(1,Number(s.target.value)||1)),className:"w-28 rounded border px-2 py-1 text-sm",title:"QR side size in card pixels"}),A.jsx(xt,{variant:"secondary",onClick:async()=>{await e(t,n.id,{text:r.trim(),size:i})},children:"Update QR"})]})]})}function Za({open:t,onOpenChange:n,photo:e,canvasRef:r}){const o=ft(E=>E.addTextLayer),i=ft(E=>E.addRectLayer),a=ft(E=>E.addQrLayer),s=ft(E=>E.transforms[e.id]??re),l=ft(E=>E.setTransform),[f,c]=j.useState(s),[m,g]=j.useState(null),u=j.useRef(null),y=j.useCallback(E=>{if(!m||!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(E.key))return;E.preventDefault();const W=E.altKey?1:E.shiftKey?20:5;let V=0,Y=0;E.key==="ArrowLeft"&&(V=-W),E.key==="ArrowRight"&&(V=W),E.key==="ArrowUp"&&(Y=-W),E.key==="ArrowDown"&&(Y=W);const tt=ft.getState(),P=(tt.layersByPhoto[e.id]??[]).find(X=>X.id===m);if(!P)return;const L=P.x+V,K=P.y+Y;tt.updateLayer(e.id,m,{x:L,y:K})},[e.id,m]),d=ft(E=>E.updateLayer),v=ft(E=>E.removeLayer),b=ft(E=>E.bringToFront),x=ft(E=>E.sendToBack),_=ft(E=>E.layersByPhoto[e.id]??Ga,Object.is),k=j.useRef(null),C=r??k,N=ft(E=>E.cardBackground?.[e.id]??Kn,Object.is),D=ft(E=>E.setCardBackground),I=(E,F)=>E.scale===F.scale&&E.tx===F.tx&&E.ty===F.ty,z=j.useRef(s);j.useEffect(()=>{t&&setTimeout(()=>u.current?.focus(),0)},[t,m]),j.useEffect(()=>{t&&(z.current=s,c(s))},[t,s]);const O=j.useRef(null),[M,w]=j.useState(0),S=j.useCallback(()=>{const E=O.current;if(!E)return;const F=Math.round(E.clientWidth);F&&w(F)},[]);j.useEffect(()=>{const E=O.current;if(!E)return;const F=new ResizeObserver(S);return F.observe(E),S(),()=>F.disconnect()},[S]),j.useEffect(()=>{t&&(requestAnimationFrame(S),setTimeout(S,50))},[t,S]);const h=j.useCallback((E,F)=>{const W=E.id.slice(0,6);let V="Layer";return E.type==="text"?V="Text":E.type==="rect"?V="Rect":E.type==="image"&&E.qrText?V="QR":E.type==="image"&&(V="Image"),`${V} #${F+1} (${W})`},[]);return j.useEffect(()=>{if(!m)return;(_??[]).some(F=>F.id===m)||g(null)},[_,m]),A.jsx(co,{open:t,onOpenChange:n,children:A.jsxs(nr,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden flex flex-col",children:[A.jsxs(rr,{className:"shrink-0",children:[A.jsx(or,{children:"Edit card"}),A.jsx(fo,{className:"sr-only",children:"Adjust zoom/position and edit layers."})]}),A.jsx("div",{className:"flex-1 overflow-auto",children:A.jsxs("div",{className:"grid gap-4",children:[A.jsx("div",{ref:u,tabIndex:0,onKeyDown:y,className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20 outline-none focus:outline-none",children:A.jsx("div",{className:"relative aspect-square overflow-hidden rounded-xl",ref:O,children:M>0&&A.jsx("div",{className:"absolute inset-0 pointer-events-auto z-0",children:A.jsx(Je,{"data-dnd-ignore":!0,ref:C,photoId:e.id,size:M,selectedId:m,onSelect:g,transformOverride:f})})})}),A.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx(de,{className:"whitespace-nowrap",children:"Layers"}),A.jsxs(io,{value:m??qe,onValueChange:E=>g(E===qe?null:E),children:[A.jsx(tr,{className:"w-[18rem]",children:A.jsx(oo,{placeholder:_.length?"Select a layer…":"No layers"})}),A.jsx(er,{children:_.length===0?A.jsx(ue,{value:qe,disabled:!0,children:"No layers"}):A.jsxs(A.Fragment,{children:[A.jsx(ue,{value:qe,disabled:!0,children:"Select a layer…"}),_.slice().sort((E,F)=>E.z-F.z).map((E,F)=>A.jsx(ue,{value:E.id,children:h(E,F)},E.id))]})})]}),A.jsx("div",{className:"ml-auto"})]})}),m&&(()=>{const E=_.find(F=>F.id===m&&F.type==="text");return E?A.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[A.jsx("label",{className:"text-xs opacity-70",children:"Text"}),A.jsx("textarea",{value:E.text,onChange:F=>d(e.id,E.id,{text:F.target.value}),rows:3,className:"resize-y w-full rounded border px-2 py-1 text-sm bg-background"}),A.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[A.jsx("label",{className:"text-xs opacity-70",children:"Size"}),A.jsx("input",{type:"number",min:8,max:240,step:1,value:E.fontSize??36,onChange:F=>d(e.id,E.id,{fontSize:Number(F.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),A.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${E.fontStyle?.includes("bold")?"bg-foreground/10":""}`,onClick:()=>{const F=E.fontStyle?.includes("bold"),V=`${E.fontStyle?.includes("italic")?"italic":""} ${F?"":"bold"}`.trim();d(e.id,E.id,{fontStyle:V})},children:"Bold"}),A.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${E.fontStyle?.includes("italic")?"bg-foreground/10":""}`,onClick:()=>{const F=E.fontStyle?.includes("bold"),V=`${E.fontStyle?.includes("italic")?"":"italic"} ${F?"bold":""}`.trim();d(e.id,E.id,{fontStyle:V})},children:"Italic"}),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Color"}),A.jsx("input",{type:"color",value:E.fill??"#111111",onChange:F=>d(e.id,E.id,{fill:F.target.value}),className:"h-8 w-10 cursor-pointer"})]}),A.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[A.jsx("label",{className:"text-xs opacity-70",children:"Font"}),A.jsx("select",{value:E.fontFamily??"Georgia, serif",onChange:async F=>{const W=F.target.value;await $a(W),d(e.id,E.id,{fontFamily:W})},className:"rounded border px-2 py-1 text-sm",children:Hi.map(F=>A.jsx("option",{value:F.family,children:F.label},F.id))})]}),A.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[A.jsx("label",{className:"text-xs opacity-70",children:"Align"}),["left","center","right"].map(F=>A.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${E.align===F?"bg-foreground/10":""}`,onClick:()=>d(e.id,E.id,{align:F}),children:F},F)),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Wrap width"}),A.jsx("input",{type:"number",min:0,max:It,step:10,value:E.width??0,onChange:F=>d(e.id,E.id,{width:Number(F.target.value)||void 0}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0 disables wrapping"}),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Padding"}),A.jsx("input",{type:"number",min:0,max:200,step:1,value:E.padding??0,onChange:F=>d(e.id,E.id,{padding:Number(F.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Line height"}),A.jsx("input",{type:"number",min:.8,max:2,step:.05,value:E.lineHeight??1.25,onChange:F=>d(e.id,E.id,{lineHeight:Number(F.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Tracking"}),A.jsx("input",{type:"number",min:-5,max:20,step:.5,value:E.letterSpacing??0,onChange:F=>d(e.id,E.id,{letterSpacing:Number(F.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Additional spacing between glyphs (px, card space)"})]})]}):null})(),m&&(()=>{const E=_.find(F=>F.id===m&&F.type==="image"&&F.qrText);return E?A.jsx(Ha,{photoId:e.id,layer:E}):null})(),m&&(()=>{const E=_.find(F=>F.id===m&&F.type==="rect");return E?A.jsx("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:A.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[A.jsx("label",{className:"text-xs opacity-70",children:"Fill"}),A.jsx("input",{type:"color",value:E.fill??"#ffffff",onChange:F=>d(e.id,E.id,{fill:F.target.value}),className:"h-8 w-10 cursor-pointer"}),A.jsx("label",{className:"text-xs opacity-70",children:"Stroke"}),A.jsx("input",{type:"color",value:E.stroke??"#000000",onChange:F=>d(e.id,E.id,{stroke:F.target.value}),className:"h-8 w-10 cursor-pointer"}),A.jsx("label",{className:"text-xs opacity-70",children:"Stroke width"}),A.jsx("input",{type:"number",min:0,max:100,step:1,value:E.strokeWidth??0,onChange:F=>d(e.id,E.id,{strokeWidth:Number(F.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Width in card pixels"}),A.jsx("label",{className:"text-xs opacity-70",children:"Radius"}),A.jsx("input",{type:"number",min:0,max:500,step:1,value:E.cornerRadius??0,onChange:F=>d(e.id,E.id,{cornerRadius:Number(F.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Corner radius in card pixels"}),A.jsx("label",{className:"text-xs opacity-70",children:"Opacity"}),A.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((E.opacity??1)*100),onChange:F=>d(e.id,E.id,{opacity:Math.max(0,Math.min(1,Number(F.target.value)/100))}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0..100 %"}),A.jsx("label",{className:"text-xs opacity-70",children:"Width"}),A.jsx("input",{type:"number",min:1,max:It,step:1,value:E.width??1,onChange:F=>d(e.id,E.id,{width:Number(F.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),A.jsx("label",{className:"text-xs opacity-70",children:"Height"}),A.jsx("input",{type:"number",min:1,max:It,step:1,value:E.height??1,onChange:F=>d(e.id,E.id,{height:Number(F.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"})]})}):null})(),A.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:A.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[A.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>{if(!m)return;const F=(ft.getState().layersByPhoto[e.id]??[]).find(Y=>Y.id===m);if(!F)return;const V=((F.rotation??0)-90)%360;d(e.id,m,{rotation:V<0?V+360:V})},children:"Rotate −90°"}),A.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>{if(!m)return;const F=(ft.getState().layersByPhoto[e.id]??[]).find(Y=>Y.id===m);if(!F)return;const V=((F.rotation??0)+90)%360;d(e.id,m,{rotation:V})},children:"Rotate +90°"}),A.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>m&&b(e.id,m),children:"Bring to front"}),A.jsx(xt,{variant:"secondary",disabled:!m,onClick:()=>m&&x(e.id,m),children:"Send to back"}),A.jsx(xt,{variant:"destructive",disabled:!m,onClick:()=>{m&&(v(e.id,m),g(null))},children:"Delete layer"})]})}),A.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:A.jsxs("div",{className:"grid gap-3",children:[A.jsxs("div",{className:"grid gap-1.5",children:[A.jsxs("div",{className:"flex items-center justify-between text-sm",children:[A.jsx(de,{children:"Zoom"}),A.jsxs("span",{className:"tabular-nums opacity-70",children:[f.scale.toFixed(2),"×"]})]}),A.jsx($e,{value:[f.scale],min:1,max:3,step:.01,onValueChange:([E])=>c(F=>({...F,scale:E}))})]}),A.jsxs("div",{className:"grid gap-1.5",children:[A.jsxs("div",{className:"flex items-center justify-between text-sm",children:[A.jsx(de,{children:"Horizontal"}),A.jsxs("span",{className:"tabular-nums opacity-70",children:[f.tx.toFixed(0),"%"]})]}),A.jsx($e,{value:[f.tx],min:-100,max:100,step:.1,onValueChange:([E])=>c(F=>({...F,tx:E}))})]}),A.jsxs("div",{className:"grid gap-1.5",children:[A.jsxs("div",{className:"flex items-center justify-between text-sm",children:[A.jsx(de,{children:"Vertical"}),A.jsxs("span",{className:"tabular-nums opacity-70",children:[f.ty.toFixed(0),"%"]})]}),A.jsx($e,{value:[f.ty],min:-100,max:100,step:.1,onValueChange:([E])=>c(F=>({...F,ty:E}))})]})]})}),A.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:A.jsx("div",{className:"mt-3 grid gap-2 rounded-md border p-2 bg-background/60",children:A.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[A.jsx(de,{className:"opacity-70",children:"Background"}),A.jsx("label",{className:"text-xs opacity-70",children:"Color"}),A.jsx("input",{type:"color",value:N.color,onChange:E=>D(e.id,{color:E.target.value}),className:"h-8 w-10 cursor-pointer"}),A.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Opacity"}),A.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((N.alpha??1)*100),onChange:E=>D(e.id,{alpha:Math.max(0,Math.min(1,Number(E.target.value)/100))}),className:"w-20 rounded border px-2 py-1 text-sm",title:"0..100 %"}),A.jsx("span",{className:"text-xs opacity-60",children:"(0% = transparent, 100% = solid)"})]})})})]})}),A.jsxs(ir,{className:"shrink-0 space-y-2",children:[A.jsxs("div",{className:"flex items-center justify-between gap-2",children:[A.jsx(xt,{variant:"ghost",onClick:()=>{c(re)},children:"Reset image"}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx(xt,{variant:"secondary",onClick:()=>{I(z.current,s)||l(e.id,z.current),n(!1)},children:"Cancel"}),A.jsx(xt,{onClick:()=>{I(f,s)||l(e.id,f),n(!1)},children:"Save"})]})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx(xt,{variant:"secondary",onClick:async()=>{const E=window.prompt("QR text / URL:","https://example.com")??"";if(!E.trim())return;const F=await a(e.id,E.trim());g(F)},children:"Add QR"}),A.jsx(xt,{variant:"secondary",onClick:()=>{const E=o(e.id);g(E)},children:"Add text layer"}),A.jsx(xt,{variant:"secondary",onClick:()=>{const E=i(e.id);g(E)},children:"Add rectangle"})]})]})]})})}function Xa(t,n="card"){return(t.replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||n).slice(0,100)}function Ka(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function Qa({open:t,onOpenChange:n,photo:e,transform:r,layers:o,snapshot:i,onEdit:a}){const[s,l]=j.useState(null),[f,c]=j.useState(!1),m=j.useRef(null),[g,u]=j.useState(0);j.useEffect(()=>{const _=m.current;if(!_)return;const k=()=>u(Math.round(_.clientWidth));k();const C=new ResizeObserver(k);return C.observe(_),()=>C.disconnect()},[]);const y=j.useRef(null),[d,v]=j.useState(Ye),b=j.useMemo(()=>t?A.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:d,height:d,overflow:"hidden"},children:A.jsx(Je,{ref:y,photoId:e.id,size:d,selectedId:null,onSelect:()=>{}})}):null,[t,e.id,d]);async function x(_){v(_),await new Promise(C=>setTimeout(C,0));try{const C=document;C?.fonts?.ready&&typeof C.fonts.ready.then=="function"&&await C.fonts.ready}catch{}const k=Date.now()+1e3;for(;!y.current?.isReady?.()&&!(Date.now()>k);)await new Promise(C=>setTimeout(C,30));return y.current?.toDataURL(_)??null}return j.useEffect(()=>{let _=!1;if(!t){l(null);return}return(async()=>{c(!0);const k=Math.max(Ye,g||Ye);let C=null;i&&(C=i(k)),C||(C=await x(k)),!_&&(l(C),c(!1))})(),()=>{_=!0}},[t,g,e.id,r.scale,r.tx,r.ty,o,i]),A.jsxs(co,{"data-dnd-ignore":!0,open:t,onOpenChange:n,children:[b,A.jsxs(nr,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden",children:[A.jsx(rr,{children:A.jsx(ns,{asChild:!0,children:A.jsx(or,{children:"Preview"})})}),A.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:A.jsxs("div",{ref:m,className:"relative aspect-square overflow-hidden rounded-xl",children:[s?A.jsx("img",{src:s,alt:e.name,className:"absolute inset-0 w-full h-full object-contain"}):A.jsx("div",{className:"h-24"}),A.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${f?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!f,children:A.jsx("div",{className:"h-7 w-7 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]})}),A.jsxs(ir,{className:"mt-2 gap-2",children:[A.jsx(xt,{variant:"secondary",onClick:()=>{n(!1),a?.()},children:"Edit"}),A.jsx(xt,{variant:"secondary",onClick:()=>n(!1),children:"Close"}),A.jsx(xt,{onClick:async()=>{const _=i&&i(It)||await x(It);_&&Ka(_,`${Xa(e.name||"card")}.png`)},children:"Save PNG"})]})]})]})}async function Ja(t,n=It){const e=document.createElement("div");e.style.position="fixed",e.style.left="-10000px",e.style.top="-10000px",e.style.width=`${n}px`,e.style.height=`${n}px`,document.body.appendChild(e);const r=j.createRef(),o=vi.createRoot(e);o.render(j.createElement(Je,{ref:r,photoId:t,size:n,selectedId:null,onSelect:()=>{}})),await new Promise(s=>setTimeout(s,0));try{const s=document;s?.fonts?.ready&&typeof s.fonts.ready.then=="function"&&await s.fonts.ready}catch{}const i=Date.now()+1500;for(;!r.current?.isReady?.()&&!(Date.now()>i);)await new Promise(s=>setTimeout(s,25));const a=r.current?.toDataURL(n)??"";return o.unmount(),e.remove(),a}async function ho(t,n=It){return Ja(t,n)}function tl(t,n){const e=document.createElement("a");e.href=t,e.download=n,document.body.appendChild(e),e.click(),e.remove()}function el({photo:t}){const n=ft(N=>N.remove),e=ft(N=>N.transforms[t.id]??re),r=ft(N=>N.layersByPhoto),[o,i]=j.useState(!1),[a,s]=j.useState(!1),l=j.useRef(null),f=j.useRef(null),[c,m]=j.useState(0);j.useEffect(()=>{const N=f.current;if(!N)return;const D=()=>m(N.clientWidth);D();const I=new ResizeObserver(D);return I.observe(N),()=>I.disconnect()},[]);const g=j.useRef(null),[u,y]=j.useState(512),d=A.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:u,height:u,overflow:"hidden"},children:A.jsx(Je,{ref:g,photoId:t.id,size:u,selectedId:null,onSelect:()=>{}})}),[v,b]=j.useState(null),[x,_]=j.useState(!0),k=j.useRef(null);j.useEffect(()=>{if(o)return;const N=window.devicePixelRatio||1,D=Math.max(384,Math.min(1024,Math.round((c||300)*N)));return y(D),k.current&&window.clearTimeout(k.current),k.current=window.setTimeout(async()=>{_(!0);try{const O=document;O?.fonts?.ready&&typeof O.fonts.ready.then=="function"&&await O.fonts.ready}catch{}const I=Date.now()+800;for(;!g.current?.isReady?.()&&!(Date.now()>I);)await new Promise(O=>setTimeout(O,25));const z=g.current?.toDataURL(D)??null;b(z),_(!1)},150),()=>{k.current&&(window.clearTimeout(k.current),k.current=null)}},[c,o,t.id,e.scale,e.tx,e.ty,r[t.id]]);const C=j.useCallback(async()=>{const N=await ho(t.id,It);if(!N)return;const I=(t.name||"card").replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||"card";tl(N,`${I}.png`)},[t.id,t.name]);return A.jsxs(A.Fragment,{children:[d,A.jsxs("div",{className:"overflow-hidden rounded-xl border border-foreground/15 bg-foreground/[0.02]",children:[A.jsxs("div",{ref:f,onClick:()=>s(!0),className:"relative aspect-square w-full overflow-hidden cursor-zoom-in",children:[A.jsx("button",{"aria-label":"Remove image",title:"Remove",onClick:N=>{N.stopPropagation(),n(t.id)},className:"absolute right-1 top-1 z-10 rounded-md bg-background/80 px-1.5 py-0.5 text-[11px] shadow hover:bg-background",children:"×"}),v?A.jsx("img",{src:v,alt:t.name,className:"h-full w-full object-cover"}):A.jsx("div",{className:"h-full w-full bg-foreground/[0.06]"}),A.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${x?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!x,children:A.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]}),A.jsxs("div",{className:"flex items-center justify-between gap-2 border-t bg-background/70 px-2 py-1.5 supports-[backdrop-filter]:bg-background/60",children:[A.jsx("button",{"aria-label":"Edit card",title:"Edit",onClick:N=>{N.stopPropagation(),i(!0)},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Edit"}),A.jsx("button",{"aria-label":"Save PNG",title:"Save PNG",onClick:N=>{N.stopPropagation(),C()},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Save PNG"})]})]}),A.jsx(Qa,{open:a,onOpenChange:s,photo:t,transform:e,layers:r[t.id],snapshot:N=>l.current?.toDataURL(N)??null,onEdit:()=>i(!0)}),A.jsx(Za,{open:o,onOpenChange:i,photo:t,canvasRef:l})]})}function nl(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return j.useMemo(()=>r=>{n.forEach(o=>o(r))},n)}const tn=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function me(t){const n=Object.prototype.toString.call(t);return n==="[object Window]"||n==="[object global]"}function sr(t){return"nodeType"in t}function Dt(t){var n,e;return t?me(t)?t:sr(t)&&(n=(e=t.ownerDocument)==null?void 0:e.defaultView)!=null?n:window:window}function ar(t){const{Document:n}=Dt(t);return t instanceof n}function Te(t){return me(t)?!1:t instanceof Dt(t).HTMLElement}function po(t){return t instanceof Dt(t).SVGElement}function ge(t){return t?me(t)?t.document:sr(t)?ar(t)?t:Te(t)||po(t)?t.ownerDocument:document:document:document}const qt=tn?j.useLayoutEffect:j.useEffect;function lr(t){const n=j.useRef(t);return qt(()=>{n.current=t}),j.useCallback(function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return n.current==null?void 0:n.current(...r)},[])}function rl(){const t=j.useRef(null),n=j.useCallback((r,o)=>{t.current=setInterval(r,o)},[]),e=j.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[n,e]}function Ae(t,n){n===void 0&&(n=[t]);const e=j.useRef(t);return qt(()=>{e.current!==t&&(e.current=t)},n),e}function De(t,n){const e=j.useRef();return j.useMemo(()=>{const r=t(e.current);return e.current=r,r},[...n])}function Ze(t){const n=lr(t),e=j.useRef(null),r=j.useCallback(o=>{o!==e.current&&n?.(o,e.current),e.current=o},[]);return[e,r]}function Vn(t){const n=j.useRef();return j.useEffect(()=>{n.current=t},[t]),n.current}let Mn={};function ze(t,n){return j.useMemo(()=>{if(n)return n;const e=Mn[t]==null?0:Mn[t]+1;return Mn[t]=e,t+"-"+e},[t,n])}function mo(t){return function(n){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return r.reduce((i,a)=>{const s=Object.entries(a);for(const[l,f]of s){const c=i[l];c!=null&&(i[l]=c+t*f)}return i},{...n})}}const fe=mo(1),Xe=mo(-1);function il(t){return"clientX"in t&&"clientY"in t}function cr(t){if(!t)return!1;const{KeyboardEvent:n}=Dt(t.target);return n&&t instanceof n}function ol(t){if(!t)return!1;const{TouchEvent:n}=Dt(t.target);return n&&t instanceof n}function Yn(t){if(ol(t)){if(t.touches&&t.touches.length){const{clientX:n,clientY:e}=t.touches[0];return{x:n,y:e}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:n,clientY:e}=t.changedTouches[0];return{x:n,y:e}}}return il(t)?{x:t.clientX,y:t.clientY}:null}const Ne=Object.freeze({Translate:{toString(t){if(!t)return;const{x:n,y:e}=t;return"translate3d("+(n?Math.round(n):0)+"px, "+(e?Math.round(e):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:n,scaleY:e}=t;return"scaleX("+n+") scaleY("+e+")"}},Transform:{toString(t){if(t)return[Ne.Translate.toString(t),Ne.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:n,duration:e,easing:r}=t;return n+" "+e+"ms "+r}}}),ei="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function sl(t){return t.matches(ei)?t:t.querySelector(ei)}const al={display:"none"};function ll(t){let{id:n,value:e}=t;return Tt.createElement("div",{id:n,style:al},e)}function cl(t){let{id:n,announcement:e,ariaLiveType:r="assertive"}=t;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Tt.createElement("div",{id:n,style:o,role:"status","aria-live":r,"aria-atomic":!0},e)}function dl(){const[t,n]=j.useState("");return{announce:j.useCallback(r=>{r!=null&&n(r)},[]),announcement:t}}const go=j.createContext(null);function ul(t){const n=j.useContext(go);j.useEffect(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(t)},[t,n])}function fl(){const[t]=j.useState(()=>new Set),n=j.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[j.useCallback(r=>{let{type:o,event:i}=r;t.forEach(a=>{var s;return(s=a[o])==null?void 0:s.call(a,i)})},[t]),n]}const hl={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},pl={onDragStart(t){let{active:n}=t;return"Picked up draggable item "+n.id+"."},onDragOver(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was moved over droppable area "+e.id+".":"Draggable item "+n.id+" is no longer over a droppable area."},onDragEnd(t){let{active:n,over:e}=t;return e?"Draggable item "+n.id+" was dropped over droppable area "+e.id:"Draggable item "+n.id+" was dropped."},onDragCancel(t){let{active:n}=t;return"Dragging was cancelled. Draggable item "+n.id+" was dropped."}};function ml(t){let{announcements:n=pl,container:e,hiddenTextDescribedById:r,screenReaderInstructions:o=hl}=t;const{announce:i,announcement:a}=dl(),s=ze("DndLiveRegion"),[l,f]=j.useState(!1);if(j.useEffect(()=>{f(!0)},[]),ul(j.useMemo(()=>({onDragStart(m){let{active:g}=m;i(n.onDragStart({active:g}))},onDragMove(m){let{active:g,over:u}=m;n.onDragMove&&i(n.onDragMove({active:g,over:u}))},onDragOver(m){let{active:g,over:u}=m;i(n.onDragOver({active:g,over:u}))},onDragEnd(m){let{active:g,over:u}=m;i(n.onDragEnd({active:g,over:u}))},onDragCancel(m){let{active:g,over:u}=m;i(n.onDragCancel({active:g,over:u}))}}),[i,n])),!l)return null;const c=Tt.createElement(Tt.Fragment,null,Tt.createElement(ll,{id:r,value:o.draggable}),Tt.createElement(cl,{id:s,announcement:a}));return e?ke.createPortal(c,e):c}var Ct;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ct||(Ct={}));function Ke(){}function ni(t,n){return j.useMemo(()=>({sensor:t,options:n??{}}),[t,n])}function gl(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return j.useMemo(()=>[...n].filter(r=>r!=null),[...n])}const Pt=Object.freeze({x:0,y:0});function bl(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function yl(t,n){let{data:{value:e}}=t,{data:{value:r}}=n;return e-r}function vl(t,n){let{data:{value:e}}=t,{data:{value:r}}=n;return r-e}function wl(t,n){if(!t||t.length===0)return null;const[e]=t;return e[n]}function ri(t,n,e){return n===void 0&&(n=t.left),e===void 0&&(e=t.top),{x:n+t.width*.5,y:e+t.height*.5}}const xl=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:r}=t;const o=ri(n,n.left,n.top),i=[];for(const a of r){const{id:s}=a,l=e.get(s);if(l){const f=bl(ri(l),o);i.push({id:s,data:{droppableContainer:a,value:f}})}}return i.sort(yl)};function _l(t,n){const e=Math.max(n.top,t.top),r=Math.max(n.left,t.left),o=Math.min(n.left+n.width,t.left+t.width),i=Math.min(n.top+n.height,t.top+t.height),a=o-r,s=i-e;if(r<o&&e<i){const l=n.width*n.height,f=t.width*t.height,c=a*s,m=c/(l+f-c);return Number(m.toFixed(4))}return 0}const kl=t=>{let{collisionRect:n,droppableRects:e,droppableContainers:r}=t;const o=[];for(const i of r){const{id:a}=i,s=e.get(a);if(s){const l=_l(s,n);l>0&&o.push({id:a,data:{droppableContainer:i,value:l}})}}return o.sort(vl)};function Cl(t,n,e){return{...t,scaleX:n&&e?n.width/e.width:1,scaleY:n&&e?n.height/e.height:1}}function bo(t,n){return t&&n?{x:t.left-n.left,y:t.top-n.top}:Pt}function El(t){return function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.reduce((a,s)=>({...a,top:a.top+t*s.y,bottom:a.bottom+t*s.y,left:a.left+t*s.x,right:a.right+t*s.x}),{...e})}}const Sl=El(1);function Rl(t){if(t.startsWith("matrix3d(")){const n=t.slice(9,-1).split(/, /);return{x:+n[12],y:+n[13],scaleX:+n[0],scaleY:+n[5]}}else if(t.startsWith("matrix(")){const n=t.slice(7,-1).split(/, /);return{x:+n[4],y:+n[5],scaleX:+n[0],scaleY:+n[3]}}return null}function Al(t,n,e){const r=Rl(n);if(!r)return t;const{scaleX:o,scaleY:i,x:a,y:s}=r,l=t.left-a-(1-o)*parseFloat(e),f=t.top-s-(1-i)*parseFloat(e.slice(e.indexOf(" ")+1)),c=o?t.width/o:t.width,m=i?t.height/i:t.height;return{width:c,height:m,top:f,right:l+c,bottom:f+m,left:l}}const Nl={ignoreTransform:!1};function be(t,n){n===void 0&&(n=Nl);let e=t.getBoundingClientRect();if(n.ignoreTransform){const{transform:f,transformOrigin:c}=Dt(t).getComputedStyle(t);f&&(e=Al(e,f,c))}const{top:r,left:o,width:i,height:a,bottom:s,right:l}=e;return{top:r,left:o,width:i,height:a,bottom:s,right:l}}function ii(t){return be(t,{ignoreTransform:!0})}function Il(t){const n=t.innerWidth,e=t.innerHeight;return{top:0,left:0,right:n,bottom:e,width:n,height:e}}function Tl(t,n){return n===void 0&&(n=Dt(t).getComputedStyle(t)),n.position==="fixed"}function Dl(t,n){n===void 0&&(n=Dt(t).getComputedStyle(t));const e=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=n[o];return typeof i=="string"?e.test(i):!1})}function dr(t,n){const e=[];function r(o){if(n!=null&&e.length>=n||!o)return e;if(ar(o)&&o.scrollingElement!=null&&!e.includes(o.scrollingElement))return e.push(o.scrollingElement),e;if(!Te(o)||po(o)||e.includes(o))return e;const i=Dt(t).getComputedStyle(o);return o!==t&&Dl(o,i)&&e.push(o),Tl(o,i)?e:r(o.parentNode)}return t?r(t):e}function yo(t){const[n]=dr(t,1);return n??null}function Bn(t){return!tn||!t?null:me(t)?t:sr(t)?ar(t)||t===ge(t).scrollingElement?window:Te(t)?t:null:null}function vo(t){return me(t)?t.scrollX:t.scrollLeft}function wo(t){return me(t)?t.scrollY:t.scrollTop}function $n(t){return{x:vo(t),y:wo(t)}}var At;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(At||(At={}));function xo(t){return!tn||!t?!1:t===document.scrollingElement}function _o(t){const n={x:0,y:0},e=xo(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-e.width,y:t.scrollHeight-e.height},o=t.scrollTop<=n.y,i=t.scrollLeft<=n.x,a=t.scrollTop>=r.y,s=t.scrollLeft>=r.x;return{isTop:o,isLeft:i,isBottom:a,isRight:s,maxScroll:r,minScroll:n}}const zl={x:.2,y:.2};function jl(t,n,e,r,o){let{top:i,left:a,right:s,bottom:l}=e;r===void 0&&(r=10),o===void 0&&(o=zl);const{isTop:f,isBottom:c,isLeft:m,isRight:g}=_o(t),u={x:0,y:0},y={x:0,y:0},d={height:n.height*o.y,width:n.width*o.x};return!f&&i<=n.top+d.height?(u.y=At.Backward,y.y=r*Math.abs((n.top+d.height-i)/d.height)):!c&&l>=n.bottom-d.height&&(u.y=At.Forward,y.y=r*Math.abs((n.bottom-d.height-l)/d.height)),!g&&s>=n.right-d.width?(u.x=At.Forward,y.x=r*Math.abs((n.right-d.width-s)/d.width)):!m&&a<=n.left+d.width&&(u.x=At.Backward,y.x=r*Math.abs((n.left+d.width-a)/d.width)),{direction:u,speed:y}}function Ll(t){if(t===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:n,left:e,right:r,bottom:o}=t.getBoundingClientRect();return{top:n,left:e,right:r,bottom:o,width:t.clientWidth,height:t.clientHeight}}function ko(t){return t.reduce((n,e)=>fe(n,$n(e)),Pt)}function Ml(t){return t.reduce((n,e)=>n+vo(e),0)}function Bl(t){return t.reduce((n,e)=>n+wo(e),0)}function Pl(t,n){if(n===void 0&&(n=be),!t)return;const{top:e,left:r,bottom:o,right:i}=n(t);yo(t)&&(o<=0||i<=0||e>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const Ol=[["x",["left","right"],Ml],["y",["top","bottom"],Bl]];class ur{constructor(n,e){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=dr(e),o=ko(r);this.rect={...n},this.width=n.width,this.height=n.height;for(const[i,a,s]of Ol)for(const l of a)Object.defineProperty(this,l,{get:()=>{const f=s(r),c=o[i]-f;return this.rect[l]+c},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ee{constructor(n){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...e)})},this.target=n}add(n,e,r){var o;(o=this.target)==null||o.addEventListener(n,e,r),this.listeners.push([n,e,r])}}function Fl(t){const{EventTarget:n}=Dt(t);return t instanceof n?t:ge(t)}function Pn(t,n){const e=Math.abs(t.x),r=Math.abs(t.y);return typeof n=="number"?Math.sqrt(e**2+r**2)>n:"x"in n&&"y"in n?e>n.x&&r>n.y:"x"in n?e>n.x:"y"in n?r>n.y:!1}var Bt;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Bt||(Bt={}));function oi(t){t.preventDefault()}function Ul(t){t.stopPropagation()}var mt;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(mt||(mt={}));const Co={start:[mt.Space,mt.Enter],cancel:[mt.Esc],end:[mt.Space,mt.Enter,mt.Tab]},Wl=(t,n)=>{let{currentCoordinates:e}=n;switch(t.code){case mt.Right:return{...e,x:e.x+25};case mt.Left:return{...e,x:e.x-25};case mt.Down:return{...e,y:e.y+25};case mt.Up:return{...e,y:e.y-25}}};class Eo{constructor(n){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=n;const{event:{target:e}}=n;this.props=n,this.listeners=new Ee(ge(e)),this.windowListeners=new Ee(Dt(e)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Bt.Resize,this.handleCancel),this.windowListeners.add(Bt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Bt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:n,onStart:e}=this.props,r=n.node.current;r&&Pl(r),e(Pt)}handleKeyDown(n){if(cr(n)){const{active:e,context:r,options:o}=this.props,{keyboardCodes:i=Co,coordinateGetter:a=Wl,scrollBehavior:s="smooth"}=o,{code:l}=n;if(i.end.includes(l)){this.handleEnd(n);return}if(i.cancel.includes(l)){this.handleCancel(n);return}const{collisionRect:f}=r.current,c=f?{x:f.left,y:f.top}:Pt;this.referenceCoordinates||(this.referenceCoordinates=c);const m=a(n,{active:e,context:r.current,currentCoordinates:c});if(m){const g=Xe(m,c),u={x:0,y:0},{scrollableAncestors:y}=r.current;for(const d of y){const v=n.code,{isTop:b,isRight:x,isLeft:_,isBottom:k,maxScroll:C,minScroll:N}=_o(d),D=Ll(d),I={x:Math.min(v===mt.Right?D.right-D.width/2:D.right,Math.max(v===mt.Right?D.left:D.left+D.width/2,m.x)),y:Math.min(v===mt.Down?D.bottom-D.height/2:D.bottom,Math.max(v===mt.Down?D.top:D.top+D.height/2,m.y))},z=v===mt.Right&&!x||v===mt.Left&&!_,O=v===mt.Down&&!k||v===mt.Up&&!b;if(z&&I.x!==m.x){const M=d.scrollLeft+g.x,w=v===mt.Right&&M<=C.x||v===mt.Left&&M>=N.x;if(w&&!g.y){d.scrollTo({left:M,behavior:s});return}w?u.x=d.scrollLeft-M:u.x=v===mt.Right?d.scrollLeft-C.x:d.scrollLeft-N.x,u.x&&d.scrollBy({left:-u.x,behavior:s});break}else if(O&&I.y!==m.y){const M=d.scrollTop+g.y,w=v===mt.Down&&M<=C.y||v===mt.Up&&M>=N.y;if(w&&!g.x){d.scrollTo({top:M,behavior:s});return}w?u.y=d.scrollTop-M:u.y=v===mt.Down?d.scrollTop-C.y:d.scrollTop-N.y,u.y&&d.scrollBy({top:-u.y,behavior:s});break}}this.handleMove(n,fe(Xe(m,this.referenceCoordinates),u))}}}handleMove(n,e){const{onMove:r}=this.props;n.preventDefault(),r(e)}handleEnd(n){const{onEnd:e}=this.props;n.preventDefault(),this.detach(),e()}handleCancel(n){const{onCancel:e}=this.props;n.preventDefault(),this.detach(),e()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Eo.activators=[{eventName:"onKeyDown",handler:(t,n,e)=>{let{keyboardCodes:r=Co,onActivation:o}=n,{active:i}=e;const{code:a}=t.nativeEvent;if(r.start.includes(a)){const s=i.activatorNode.current;return s&&t.target!==s?!1:(t.preventDefault(),o?.({event:t.nativeEvent}),!0)}return!1}}];function si(t){return!!(t&&"distance"in t)}function ai(t){return!!(t&&"delay"in t)}class fr{constructor(n,e,r){var o;r===void 0&&(r=Fl(n.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=n,this.events=e;const{event:i}=n,{target:a}=i;this.props=n,this.events=e,this.document=ge(a),this.documentListeners=new Ee(this.document),this.listeners=new Ee(r),this.windowListeners=new Ee(Dt(a)),this.initialCoordinates=(o=Yn(i))!=null?o:Pt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:n,props:{options:{activationConstraint:e,bypassActivationConstraint:r}}}=this;if(this.listeners.add(n.move.name,this.handleMove,{passive:!1}),this.listeners.add(n.end.name,this.handleEnd),n.cancel&&this.listeners.add(n.cancel.name,this.handleCancel),this.windowListeners.add(Bt.Resize,this.handleCancel),this.windowListeners.add(Bt.DragStart,oi),this.windowListeners.add(Bt.VisibilityChange,this.handleCancel),this.windowListeners.add(Bt.ContextMenu,oi),this.documentListeners.add(Bt.Keydown,this.handleKeydown),e){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(ai(e)){this.timeoutId=setTimeout(this.handleStart,e.delay),this.handlePending(e);return}if(si(e)){this.handlePending(e);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(n,e){const{active:r,onPending:o}=this.props;o(r,n,this.initialCoordinates,e)}handleStart(){const{initialCoordinates:n}=this,{onStart:e}=this.props;n&&(this.activated=!0,this.documentListeners.add(Bt.Click,Ul,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Bt.SelectionChange,this.removeTextSelection),e(n))}handleMove(n){var e;const{activated:r,initialCoordinates:o,props:i}=this,{onMove:a,options:{activationConstraint:s}}=i;if(!o)return;const l=(e=Yn(n))!=null?e:Pt,f=Xe(o,l);if(!r&&s){if(si(s)){if(s.tolerance!=null&&Pn(f,s.tolerance))return this.handleCancel();if(Pn(f,s.distance))return this.handleStart()}if(ai(s)&&Pn(f,s.tolerance))return this.handleCancel();this.handlePending(s,f);return}n.cancelable&&n.preventDefault(),a(l)}handleEnd(){const{onAbort:n,onEnd:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleCancel(){const{onAbort:n,onCancel:e}=this.props;this.detach(),this.activated||n(this.props.active),e()}handleKeydown(n){n.code===mt.Esc&&this.handleCancel()}removeTextSelection(){var n;(n=this.document.getSelection())==null||n.removeAllRanges()}}const ql={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class hr extends fr{constructor(n){const{event:e}=n,r=ge(e.target);super(n,ql,r)}}hr.activators=[{eventName:"onPointerDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;return!e.isPrimary||e.button!==0?!1:(r?.({event:e}),!0)}}];const Vl={move:{name:"mousemove"},end:{name:"mouseup"}};var Gn;(function(t){t[t.RightClick=2]="RightClick"})(Gn||(Gn={}));class Yl extends fr{constructor(n){super(n,Vl,ge(n.event.target))}}Yl.activators=[{eventName:"onMouseDown",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;return e.button===Gn.RightClick?!1:(r?.({event:e}),!0)}}];const On={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class So extends fr{constructor(n){super(n,On)}static setup(){return window.addEventListener(On.move.name,n,{capture:!1,passive:!1}),function(){window.removeEventListener(On.move.name,n)};function n(){}}}So.activators=[{eventName:"onTouchStart",handler:(t,n)=>{let{nativeEvent:e}=t,{onActivation:r}=n;const{touches:o}=e;return o.length>1?!1:(r?.({event:e}),!0)}}];var Se;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Se||(Se={}));var Qe;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(Qe||(Qe={}));function $l(t){let{acceleration:n,activator:e=Se.Pointer,canScroll:r,draggingRect:o,enabled:i,interval:a=5,order:s=Qe.TreeOrder,pointerCoordinates:l,scrollableAncestors:f,scrollableAncestorRects:c,delta:m,threshold:g}=t;const u=Hl({delta:m,disabled:!i}),[y,d]=rl(),v=j.useRef({x:0,y:0}),b=j.useRef({x:0,y:0}),x=j.useMemo(()=>{switch(e){case Se.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Se.DraggableRect:return o}},[e,o,l]),_=j.useRef(null),k=j.useCallback(()=>{const N=_.current;if(!N)return;const D=v.current.x*b.current.x,I=v.current.y*b.current.y;N.scrollBy(D,I)},[]),C=j.useMemo(()=>s===Qe.TreeOrder?[...f].reverse():f,[s,f]);j.useEffect(()=>{if(!i||!f.length||!x){d();return}for(const N of C){if(r?.(N)===!1)continue;const D=f.indexOf(N),I=c[D];if(!I)continue;const{direction:z,speed:O}=jl(N,I,x,n,g);for(const M of["x","y"])u[M][z[M]]||(O[M]=0,z[M]=0);if(O.x>0||O.y>0){d(),_.current=N,y(k,a),v.current=O,b.current=z;return}}v.current={x:0,y:0},b.current={x:0,y:0},d()},[n,k,r,d,i,a,JSON.stringify(x),JSON.stringify(u),y,f,C,c,JSON.stringify(g)])}const Gl={x:{[At.Backward]:!1,[At.Forward]:!1},y:{[At.Backward]:!1,[At.Forward]:!1}};function Hl(t){let{delta:n,disabled:e}=t;const r=Vn(n);return De(o=>{if(e||!r||!o)return Gl;const i={x:Math.sign(n.x-r.x),y:Math.sign(n.y-r.y)};return{x:{[At.Backward]:o.x[At.Backward]||i.x===-1,[At.Forward]:o.x[At.Forward]||i.x===1},y:{[At.Backward]:o.y[At.Backward]||i.y===-1,[At.Forward]:o.y[At.Forward]||i.y===1}}},[e,n,r])}function Zl(t,n){const e=n!=null?t.get(n):void 0,r=e?e.node.current:null;return De(o=>{var i;return n==null?null:(i=r??o)!=null?i:null},[r,n])}function Xl(t,n){return j.useMemo(()=>t.reduce((e,r)=>{const{sensor:o}=r,i=o.activators.map(a=>({eventName:a.eventName,handler:n(a.handler,r)}));return[...e,...i]},[]),[t,n])}var Ie;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Ie||(Ie={}));var Hn;(function(t){t.Optimized="optimized"})(Hn||(Hn={}));const li=new Map;function Kl(t,n){let{dragging:e,dependencies:r,config:o}=n;const[i,a]=j.useState(null),{frequency:s,measure:l,strategy:f}=o,c=j.useRef(t),m=v(),g=Ae(m),u=j.useCallback(function(b){b===void 0&&(b=[]),!g.current&&a(x=>x===null?b:x.concat(b.filter(_=>!x.includes(_))))},[g]),y=j.useRef(null),d=De(b=>{if(m&&!e)return li;if(!b||b===li||c.current!==t||i!=null){const x=new Map;for(let _ of t){if(!_)continue;if(i&&i.length>0&&!i.includes(_.id)&&_.rect.current){x.set(_.id,_.rect.current);continue}const k=_.node.current,C=k?new ur(l(k),k):null;_.rect.current=C,C&&x.set(_.id,C)}return x}return b},[t,i,e,m,l]);return j.useEffect(()=>{c.current=t},[t]),j.useEffect(()=>{m||u()},[e,m]),j.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),j.useEffect(()=>{m||typeof s!="number"||y.current!==null||(y.current=setTimeout(()=>{u(),y.current=null},s))},[s,m,u,...r]),{droppableRects:d,measureDroppableContainers:u,measuringScheduled:i!=null};function v(){switch(f){case Ie.Always:return!1;case Ie.BeforeDragging:return e;default:return!e}}}function Ro(t,n){return De(e=>t?e||(typeof n=="function"?n(t):t):null,[n,t])}function Ql(t,n){return Ro(t,n)}function Jl(t){let{callback:n,disabled:e}=t;const r=lr(n),o=j.useMemo(()=>{if(e||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,e]);return j.useEffect(()=>()=>o?.disconnect(),[o]),o}function en(t){let{callback:n,disabled:e}=t;const r=lr(n),o=j.useMemo(()=>{if(e||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[e]);return j.useEffect(()=>()=>o?.disconnect(),[o]),o}function tc(t){return new ur(be(t),t)}function ci(t,n,e){n===void 0&&(n=tc);const[r,o]=j.useState(null);function i(){o(l=>{if(!t)return null;if(t.isConnected===!1){var f;return(f=l??e)!=null?f:null}const c=n(t);return JSON.stringify(l)===JSON.stringify(c)?l:c})}const a=Jl({callback(l){if(t)for(const f of l){const{type:c,target:m}=f;if(c==="childList"&&m instanceof HTMLElement&&m.contains(t)){i();break}}}}),s=en({callback:i});return qt(()=>{i(),t?(s?.observe(t),a?.observe(document.body,{childList:!0,subtree:!0})):(s?.disconnect(),a?.disconnect())},[t]),r}function ec(t){const n=Ro(t);return bo(t,n)}const di=[];function nc(t){const n=j.useRef(t),e=De(r=>t?r&&r!==di&&t&&n.current&&t.parentNode===n.current.parentNode?r:dr(t):di,[t]);return j.useEffect(()=>{n.current=t},[t]),e}function rc(t){const[n,e]=j.useState(null),r=j.useRef(t),o=j.useCallback(i=>{const a=Bn(i.target);a&&e(s=>s?(s.set(a,$n(a)),new Map(s)):null)},[]);return j.useEffect(()=>{const i=r.current;if(t!==i){a(i);const s=t.map(l=>{const f=Bn(l);return f?(f.addEventListener("scroll",o,{passive:!0}),[f,$n(f)]):null}).filter(l=>l!=null);e(s.length?new Map(s):null),r.current=t}return()=>{a(t),a(i)};function a(s){s.forEach(l=>{const f=Bn(l);f?.removeEventListener("scroll",o)})}},[o,t]),j.useMemo(()=>t.length?n?Array.from(n.values()).reduce((i,a)=>fe(i,a),Pt):ko(t):Pt,[t,n])}function ui(t,n){n===void 0&&(n=[]);const e=j.useRef(null);return j.useEffect(()=>{e.current=null},n),j.useEffect(()=>{const r=t!==Pt;r&&!e.current&&(e.current=t),!r&&e.current&&(e.current=null)},[t]),e.current?Xe(t,e.current):Pt}function ic(t){j.useEffect(()=>{if(!tn)return;const n=t.map(e=>{let{sensor:r}=e;return r.setup==null?void 0:r.setup()});return()=>{for(const e of n)e?.()}},t.map(n=>{let{sensor:e}=n;return e}))}function oc(t,n){return j.useMemo(()=>t.reduce((e,r)=>{let{eventName:o,handler:i}=r;return e[o]=a=>{i(a,n)},e},{}),[t,n])}function Ao(t){return j.useMemo(()=>t?Il(t):null,[t])}const fi=[];function sc(t,n){n===void 0&&(n=be);const[e]=t,r=Ao(e?Dt(e):null),[o,i]=j.useState(fi);function a(){i(()=>t.length?t.map(l=>xo(l)?r:new ur(n(l),l)):fi)}const s=en({callback:a});return qt(()=>{s?.disconnect(),a(),t.forEach(l=>s?.observe(l))},[t]),o}function ac(t){if(!t)return null;if(t.children.length>1)return t;const n=t.children[0];return Te(n)?n:t}function lc(t){let{measure:n}=t;const[e,r]=j.useState(null),o=j.useCallback(f=>{for(const{target:c}of f)if(Te(c)){r(m=>{const g=n(c);return m?{...m,width:g.width,height:g.height}:g});break}},[n]),i=en({callback:o}),a=j.useCallback(f=>{const c=ac(f);i?.disconnect(),c&&i?.observe(c),r(c?n(c):null)},[n,i]),[s,l]=Ze(a);return j.useMemo(()=>({nodeRef:s,rect:e,setRef:l}),[e,s,l])}const cc=[{sensor:hr,options:{}},{sensor:Eo,options:{}}],dc={current:{}},Ge={draggable:{measure:ii},droppable:{measure:ii,strategy:Ie.WhileDragging,frequency:Hn.Optimized},dragOverlay:{measure:be}};class Re extends Map{get(n){var e;return n!=null&&(e=super.get(n))!=null?e:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(n=>{let{disabled:e}=n;return!e})}getNodeFor(n){var e,r;return(e=(r=this.get(n))==null?void 0:r.node.current)!=null?e:void 0}}const uc={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Re,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ke},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ge,measureDroppableContainers:Ke,windowRect:null,measuringScheduled:!1},fc={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ke,draggableNodes:new Map,over:null,measureDroppableContainers:Ke},nn=j.createContext(fc),No=j.createContext(uc);function hc(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Re}}}function pc(t,n){switch(n.type){case Ct.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:n.initialCoordinates,active:n.active}};case Ct.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:n.coordinates.x-t.draggable.initialCoordinates.x,y:n.coordinates.y-t.draggable.initialCoordinates.y}}};case Ct.DragEnd:case Ct.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ct.RegisterDroppable:{const{element:e}=n,{id:r}=e,o=new Re(t.droppable.containers);return o.set(r,e),{...t,droppable:{...t.droppable,containers:o}}}case Ct.SetDroppableDisabled:{const{id:e,key:r,disabled:o}=n,i=t.droppable.containers.get(e);if(!i||r!==i.key)return t;const a=new Re(t.droppable.containers);return a.set(e,{...i,disabled:o}),{...t,droppable:{...t.droppable,containers:a}}}case Ct.UnregisterDroppable:{const{id:e,key:r}=n,o=t.droppable.containers.get(e);if(!o||r!==o.key)return t;const i=new Re(t.droppable.containers);return i.delete(e),{...t,droppable:{...t.droppable,containers:i}}}default:return t}}function mc(t){let{disabled:n}=t;const{active:e,activatorEvent:r,draggableNodes:o}=j.useContext(nn),i=Vn(r),a=Vn(e?.id);return j.useEffect(()=>{if(!n&&!r&&i&&a!=null){if(!cr(i)||document.activeElement===i.target)return;const s=o.get(a);if(!s)return;const{activatorNode:l,node:f}=s;if(!l.current&&!f.current)return;requestAnimationFrame(()=>{for(const c of[l.current,f.current]){if(!c)continue;const m=sl(c);if(m){m.focus();break}}})}},[r,n,o,a,i]),null}function gc(t,n){let{transform:e,...r}=n;return t!=null&&t.length?t.reduce((o,i)=>i({transform:o,...r}),e):e}function bc(t){return j.useMemo(()=>({draggable:{...Ge.draggable,...t?.draggable},droppable:{...Ge.droppable,...t?.droppable},dragOverlay:{...Ge.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function yc(t){let{activeNode:n,measure:e,initialRect:r,config:o=!0}=t;const i=j.useRef(!1),{x:a,y:s}=typeof o=="boolean"?{x:o,y:o}:o;qt(()=>{if(!a&&!s||!n){i.current=!1;return}if(i.current||!r)return;const f=n?.node.current;if(!f||f.isConnected===!1)return;const c=e(f),m=bo(c,r);if(a||(m.x=0),s||(m.y=0),i.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const g=yo(f);g&&g.scrollBy({top:m.y,left:m.x})}},[n,a,s,r,e])}const Io=j.createContext({...Pt,scaleX:1,scaleY:1});var te;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(te||(te={}));const vc=j.memo(function(n){var e,r,o,i;let{id:a,accessibility:s,autoScroll:l=!0,children:f,sensors:c=cc,collisionDetection:m=kl,measuring:g,modifiers:u,...y}=n;const d=j.useReducer(pc,void 0,hc),[v,b]=d,[x,_]=fl(),[k,C]=j.useState(te.Uninitialized),N=k===te.Initialized,{draggable:{active:D,nodes:I,translate:z},droppable:{containers:O}}=v,M=D!=null?I.get(D):null,w=j.useRef({initial:null,translated:null}),S=j.useMemo(()=>{var wt;return D!=null?{id:D,data:(wt=M?.data)!=null?wt:dc,rect:w}:null},[D,M]),h=j.useRef(null),[E,F]=j.useState(null),[W,V]=j.useState(null),Y=Ae(y,Object.values(y)),tt=ze("DndDescribedBy",a),P=j.useMemo(()=>O.getEnabled(),[O]),L=bc(g),{droppableRects:K,measureDroppableContainers:X,measuringScheduled:H}=Kl(P,{dragging:N,dependencies:[z.x,z.y],config:L.droppable}),ct=Zl(I,D),ot=j.useMemo(()=>W?Yn(W):null,[W]),et=Me(),st=Ql(ct,L.draggable.measure);yc({activeNode:D!=null?I.get(D):null,config:et.layoutShiftCompensation,initialRect:st,measure:L.draggable.measure});const at=ci(ct,L.draggable.measure,st),pt=ci(ct?ct.parentElement:null),gt=j.useRef({activatorEvent:null,active:null,activeNode:ct,collisionRect:null,collisions:null,droppableRects:K,draggableNodes:I,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Et=O.getNodeFor((e=gt.current.over)==null?void 0:e.id),p=lc({measure:L.dragOverlay.measure}),$=(r=p.nodeRef.current)!=null?r:ct,q=N?(o=p.rect)!=null?o:at:null,T=!!(p.nodeRef.current&&p.rect),R=ec(T?null:at),B=Ao($?Dt($):null),G=nc(N?Et??ct:null),Z=sc(G),U=gc(u,{transform:{x:z.x-R.x,y:z.y-R.y,scaleX:1,scaleY:1},activatorEvent:W,active:S,activeNodeRect:at,containerNodeRect:pt,draggingNodeRect:q,over:gt.current.over,overlayNodeRect:p.rect,scrollableAncestors:G,scrollableAncestorRects:Z,windowRect:B}),Q=ot?fe(ot,z):null,nt=rc(G),J=ui(nt),lt=ui(nt,[at]),ht=fe(U,J),dt=q?Sl(q,U):null,St=S&&dt?m({active:S,collisionRect:dt,droppableRects:K,droppableContainers:P,pointerCoordinates:Q}):null,Gt=wl(St,"id"),[_t,Ht]=j.useState(null),yt=T?U:fe(U,lt),se=Cl(yt,(i=_t?.rect)!=null?i:null,at),ee=j.useRef(null),Lt=j.useCallback((wt,Rt)=>{let{sensor:zt,options:Zt}=Rt;if(h.current==null)return;const Mt=I.get(h.current);if(!Mt)return;const jt=wt.nativeEvent,Ot=new zt({active:h.current,activeNode:Mt,event:jt,options:Zt,context:gt,onAbort(Nt){if(!I.get(Nt))return;const{onDragAbort:Ft}=Y.current,Vt={id:Nt};Ft?.(Vt),x({type:"onDragAbort",event:Vt})},onPending(Nt,Xt,Ft,Vt){if(!I.get(Nt))return;const{onDragPending:ve}=Y.current,Kt={id:Nt,constraint:Xt,initialCoordinates:Ft,offset:Vt};ve?.(Kt),x({type:"onDragPending",event:Kt})},onStart(Nt){const Xt=h.current;if(Xt==null)return;const Ft=I.get(Xt);if(!Ft)return;const{onDragStart:Vt}=Y.current,ye={activatorEvent:jt,active:{id:Xt,data:Ft.data,rect:w}};ke.unstable_batchedUpdates(()=>{Vt?.(ye),C(te.Initializing),b({type:Ct.DragStart,initialCoordinates:Nt,active:Xt}),x({type:"onDragStart",event:ye}),F(ee.current),V(jt)})},onMove(Nt){b({type:Ct.DragMove,coordinates:Nt})},onEnd:ae(Ct.DragEnd),onCancel:ae(Ct.DragCancel)});ee.current=Ot;function ae(Nt){return async function(){const{active:Ft,collisions:Vt,over:ye,scrollAdjustedTranslate:ve}=gt.current;let Kt=null;if(Ft&&ve){const{cancelDrop:we}=Y.current;Kt={activatorEvent:jt,active:Ft,collisions:Vt,delta:ve,over:ye},Nt===Ct.DragEnd&&typeof we=="function"&&await Promise.resolve(we(Kt))&&(Nt=Ct.DragCancel)}h.current=null,ke.unstable_batchedUpdates(()=>{b({type:Nt}),C(te.Uninitialized),Ht(null),F(null),V(null),ee.current=null;const we=Nt===Ct.DragEnd?"onDragEnd":"onDragCancel";if(Kt){const sn=Y.current[we];sn?.(Kt),x({type:we,event:Kt})}})}}},[I]),je=j.useCallback((wt,Rt)=>(zt,Zt)=>{const Mt=zt.nativeEvent,jt=I.get(Zt);if(h.current!==null||!jt||Mt.dndKit||Mt.defaultPrevented)return;const Ot={active:jt};wt(zt,Rt.options,Ot)===!0&&(Mt.dndKit={capturedBy:Rt.sensor},h.current=Zt,Lt(zt,Rt))},[I,Lt]),Le=Xl(c,je);ic(c),qt(()=>{at&&k===te.Initializing&&C(te.Initialized)},[at,k]),j.useEffect(()=>{const{onDragMove:wt}=Y.current,{active:Rt,activatorEvent:zt,collisions:Zt,over:Mt}=gt.current;if(!Rt||!zt)return;const jt={active:Rt,activatorEvent:zt,collisions:Zt,delta:{x:ht.x,y:ht.y},over:Mt};ke.unstable_batchedUpdates(()=>{wt?.(jt),x({type:"onDragMove",event:jt})})},[ht.x,ht.y]),j.useEffect(()=>{const{active:wt,activatorEvent:Rt,collisions:zt,droppableContainers:Zt,scrollAdjustedTranslate:Mt}=gt.current;if(!wt||h.current==null||!Rt||!Mt)return;const{onDragOver:jt}=Y.current,Ot=Zt.get(Gt),ae=Ot&&Ot.rect.current?{id:Ot.id,rect:Ot.rect.current,data:Ot.data,disabled:Ot.disabled}:null,Nt={active:wt,activatorEvent:Rt,collisions:zt,delta:{x:Mt.x,y:Mt.y},over:ae};ke.unstable_batchedUpdates(()=>{Ht(ae),jt?.(Nt),x({type:"onDragOver",event:Nt})})},[Gt]),qt(()=>{gt.current={activatorEvent:W,active:S,activeNode:ct,collisionRect:dt,collisions:St,droppableRects:K,draggableNodes:I,draggingNode:$,draggingNodeRect:q,droppableContainers:O,over:_t,scrollableAncestors:G,scrollAdjustedTranslate:ht},w.current={initial:q,translated:dt}},[S,ct,St,dt,I,$,q,K,O,_t,G,ht]),$l({...et,delta:z,draggingRect:dt,pointerCoordinates:Q,scrollableAncestors:G,scrollableAncestorRects:Z});const rn=j.useMemo(()=>({active:S,activeNode:ct,activeNodeRect:at,activatorEvent:W,collisions:St,containerNodeRect:pt,dragOverlay:p,draggableNodes:I,droppableContainers:O,droppableRects:K,over:_t,measureDroppableContainers:X,scrollableAncestors:G,scrollableAncestorRects:Z,measuringConfiguration:L,measuringScheduled:H,windowRect:B}),[S,ct,at,W,St,pt,p,I,O,K,_t,X,G,Z,L,H,B]),on=j.useMemo(()=>({activatorEvent:W,activators:Le,active:S,activeNodeRect:at,ariaDescribedById:{draggable:tt},dispatch:b,draggableNodes:I,over:_t,measureDroppableContainers:X}),[W,Le,S,at,b,tt,I,_t,X]);return Tt.createElement(go.Provider,{value:_},Tt.createElement(nn.Provider,{value:on},Tt.createElement(No.Provider,{value:rn},Tt.createElement(Io.Provider,{value:se},f)),Tt.createElement(mc,{disabled:s?.restoreFocus===!1})),Tt.createElement(ml,{...s,hiddenTextDescribedById:tt}));function Me(){const wt=E?.autoScrollEnabled===!1,Rt=typeof l=="object"?l.enabled===!1:l===!1,zt=N&&!wt&&!Rt;return typeof l=="object"?{...l,enabled:zt}:{enabled:zt}}}),wc=j.createContext(null),hi="button",xc="Draggable";function _c(t){let{id:n,data:e,disabled:r=!1,attributes:o}=t;const i=ze(xc),{activators:a,activatorEvent:s,active:l,activeNodeRect:f,ariaDescribedById:c,draggableNodes:m,over:g}=j.useContext(nn),{role:u=hi,roleDescription:y="draggable",tabIndex:d=0}=o??{},v=l?.id===n,b=j.useContext(v?Io:wc),[x,_]=Ze(),[k,C]=Ze(),N=oc(a,n),D=Ae(e);qt(()=>(m.set(n,{id:n,key:i,node:x,activatorNode:k,data:D}),()=>{const z=m.get(n);z&&z.key===i&&m.delete(n)}),[m,n]);const I=j.useMemo(()=>({role:u,tabIndex:d,"aria-disabled":r,"aria-pressed":v&&u===hi?!0:void 0,"aria-roledescription":y,"aria-describedby":c.draggable}),[r,u,d,v,y,c.draggable]);return{active:l,activatorEvent:s,activeNodeRect:f,attributes:I,isDragging:v,listeners:r?void 0:N,node:x,over:g,setNodeRef:_,setActivatorNodeRef:C,transform:b}}function kc(){return j.useContext(No)}const Cc="Droppable",Ec={timeout:25};function Sc(t){let{data:n,disabled:e=!1,id:r,resizeObserverConfig:o}=t;const i=ze(Cc),{active:a,dispatch:s,over:l,measureDroppableContainers:f}=j.useContext(nn),c=j.useRef({disabled:e}),m=j.useRef(!1),g=j.useRef(null),u=j.useRef(null),{disabled:y,updateMeasurementsFor:d,timeout:v}={...Ec,...o},b=Ae(d??r),x=j.useCallback(()=>{if(!m.current){m.current=!0;return}u.current!=null&&clearTimeout(u.current),u.current=setTimeout(()=>{f(Array.isArray(b.current)?b.current:[b.current]),u.current=null},v)},[v]),_=en({callback:x,disabled:y||!a}),k=j.useCallback((I,z)=>{_&&(z&&(_.unobserve(z),m.current=!1),I&&_.observe(I))},[_]),[C,N]=Ze(k),D=Ae(n);return j.useEffect(()=>{!_||!C.current||(_.disconnect(),m.current=!1,_.observe(C.current))},[C,_]),j.useEffect(()=>(s({type:Ct.RegisterDroppable,element:{id:r,key:i,disabled:e,node:C,rect:g,data:D}}),()=>s({type:Ct.UnregisterDroppable,key:i,id:r})),[r]),j.useEffect(()=>{e!==c.current.disabled&&(s({type:Ct.SetDroppableDisabled,id:r,key:i,disabled:e}),c.current.disabled=e)},[r,i,e,s]),{active:a,rect:g,isOver:l?.id===r,node:C,over:l,setNodeRef:N}}function pr(t,n,e){const r=t.slice();return r.splice(e<0?r.length+e:e,0,r.splice(n,1)[0]),r}function Rc(t,n){return t.reduce((e,r,o)=>{const i=n.get(r);return i&&(e[o]=i),e},Array(t.length))}function Ve(t){return t!==null&&t>=0}function Ac(t,n){if(t===n)return!0;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function Nc(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const mr=t=>{let{rects:n,activeIndex:e,overIndex:r,index:o}=t;const i=pr(n,r,e),a=n[o],s=i[o];return!s||!a?null:{x:s.left-a.left,y:s.top-a.top,scaleX:s.width/a.width,scaleY:s.height/a.height}},To="Sortable",Do=Tt.createContext({activeIndex:-1,containerId:To,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:mr,disabled:{draggable:!1,droppable:!1}});function Ic(t){let{children:n,id:e,items:r,strategy:o=mr,disabled:i=!1}=t;const{active:a,dragOverlay:s,droppableRects:l,over:f,measureDroppableContainers:c}=kc(),m=ze(To,e),g=s.rect!==null,u=j.useMemo(()=>r.map(N=>typeof N=="object"&&"id"in N?N.id:N),[r]),y=a!=null,d=a?u.indexOf(a.id):-1,v=f?u.indexOf(f.id):-1,b=j.useRef(u),x=!Ac(u,b.current),_=v!==-1&&d===-1||x,k=Nc(i);qt(()=>{x&&y&&c(u)},[x,u,y,c]),j.useEffect(()=>{b.current=u},[u]);const C=j.useMemo(()=>({activeIndex:d,containerId:m,disabled:k,disableTransforms:_,items:u,overIndex:v,useDragOverlay:g,sortedRects:Rc(u,l),strategy:o}),[d,m,k.draggable,k.droppable,_,u,v,l,g,o]);return Tt.createElement(Do.Provider,{value:C},n)}const Tc=t=>{let{id:n,items:e,activeIndex:r,overIndex:o}=t;return pr(e,r,o).indexOf(n)},Dc=t=>{let{containerId:n,isSorting:e,wasDragging:r,index:o,items:i,newIndex:a,previousItems:s,previousContainerId:l,transition:f}=t;return!f||!r||s!==i&&o===a?!1:e?!0:a!==o&&n===l},zc={duration:200,easing:"ease"},zo="transform",jc=Ne.Transition.toString({property:zo,duration:0,easing:"linear"}),Lc={roleDescription:"sortable"};function Mc(t){let{disabled:n,index:e,node:r,rect:o}=t;const[i,a]=j.useState(null),s=j.useRef(e);return qt(()=>{if(!n&&e!==s.current&&r.current){const l=o.current;if(l){const f=be(r.current,{ignoreTransform:!0}),c={x:l.left-f.left,y:l.top-f.top,scaleX:l.width/f.width,scaleY:l.height/f.height};(c.x||c.y)&&a(c)}}e!==s.current&&(s.current=e)},[n,e,r,o]),j.useEffect(()=>{i&&a(null)},[i]),i}function Bc(t){let{animateLayoutChanges:n=Dc,attributes:e,disabled:r,data:o,getNewIndex:i=Tc,id:a,strategy:s,resizeObserverConfig:l,transition:f=zc}=t;const{items:c,containerId:m,activeIndex:g,disabled:u,disableTransforms:y,sortedRects:d,overIndex:v,useDragOverlay:b,strategy:x}=j.useContext(Do),_=Pc(r,u),k=c.indexOf(a),C=j.useMemo(()=>({sortable:{containerId:m,index:k,items:c},...o}),[m,o,k,c]),N=j.useMemo(()=>c.slice(c.indexOf(a)),[c,a]),{rect:D,node:I,isOver:z,setNodeRef:O}=Sc({id:a,data:C,disabled:_.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...l}}),{active:M,activatorEvent:w,activeNodeRect:S,attributes:h,setNodeRef:E,listeners:F,isDragging:W,over:V,setActivatorNodeRef:Y,transform:tt}=_c({id:a,data:C,attributes:{...Lc,...e},disabled:_.draggable}),P=nl(O,E),L=!!M,K=L&&!y&&Ve(g)&&Ve(v),X=!b&&W,H=X&&K?tt:null,ot=K?H??(s??x)({rects:d,activeNodeRect:S,activeIndex:g,overIndex:v,index:k}):null,et=Ve(g)&&Ve(v)?i({id:a,items:c,activeIndex:g,overIndex:v}):k,st=M?.id,at=j.useRef({activeId:st,items:c,newIndex:et,containerId:m}),pt=c!==at.current.items,gt=n({active:M,containerId:m,isDragging:W,isSorting:L,id:a,index:k,items:c,newIndex:at.current.newIndex,previousItems:at.current.items,previousContainerId:at.current.containerId,transition:f,wasDragging:at.current.activeId!=null}),Et=Mc({disabled:!gt,index:k,node:I,rect:D});return j.useEffect(()=>{L&&at.current.newIndex!==et&&(at.current.newIndex=et),m!==at.current.containerId&&(at.current.containerId=m),c!==at.current.items&&(at.current.items=c)},[L,et,m,c]),j.useEffect(()=>{if(st===at.current.activeId)return;if(st!=null&&at.current.activeId==null){at.current.activeId=st;return}const $=setTimeout(()=>{at.current.activeId=st},50);return()=>clearTimeout($)},[st]),{active:M,activeIndex:g,attributes:h,data:C,rect:D,index:k,newIndex:et,items:c,isOver:z,isSorting:L,isDragging:W,listeners:F,node:I,overIndex:v,over:V,setNodeRef:P,setActivatorNodeRef:Y,setDroppableNodeRef:O,setDraggableNodeRef:E,transform:Et??ot,transition:p()};function p(){if(Et||pt&&at.current.newIndex===k)return jc;if(!(X&&!cr(w)||!f)&&(L||gt))return Ne.Transition.toString({...f,property:zo})}}function Pc(t,n){var e,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(e=t?.draggable)!=null?e:n.draggable,droppable:(r=t?.droppable)!=null?r:n.droppable}}mt.Down,mt.Right,mt.Up,mt.Left;function Oc({id:t,children:n}){const{attributes:e,listeners:r,setNodeRef:o,transform:i,transition:a,isDragging:s,isSorting:l}=Bc({id:t}),f={transform:Ne.Translate.toString(i),transition:a,position:"relative",zIndex:s?9999:l?2:1,cursor:s?"grabbing":"grab",touchAction:"none"};return A.jsx("div",{ref:o,style:f,...e,...r,children:n})}async function Fc(t,n={}){const e=n.format??"png",r=Math.max(.5,Math.min(.95,n.quality??.8)),o=new Qn,i=o.folder("images");if(!i)throw new Error("ZIP: cannot create images/");for(let a=0;a<t.length;a++){const s=await ho(t[a].id,It),l=e==="jpeg"?await Wc(s,r):s,f=e==="jpeg"?"jpg":"png",c=`card-${String(a+1).padStart(3,"0")}.${f}`;i.file(c,Uc(l)),n.onProgress?.({done:a+1,total:t.length})}return o.generateAsync({type:"blob",compression:"DEFLATE"})}function Uc(t){const n=t.indexOf(","),e=t.slice(n+1),r=atob(e),o=new Uint8Array(r.length);for(let i=0;i<r.length;i++)o[i]=r.charCodeAt(i);return o}async function Wc(t,n){const e=await qc(t),r=document.createElement("canvas");r.width=Math.max(1,e.naturalWidth||e.width||1),r.height=Math.max(1,e.naturalHeight||e.height||1);const o=r.getContext("2d");if(!o)throw new Error("Canvas2D unavailable");return o.drawImage(e,0,0),r.toDataURL("image/jpeg",n)}function qc(t){return new Promise((n,e)=>{const r=new Image;r.onload=()=>n(r),r.onerror=e,r.src=t})}function pi(t){const n=t/1e3;return n<60?`${n.toFixed(1)}s`:`${Math.floor(n/60)}m ${(n%60).toFixed(0)}s`}class Vc extends hr{static activators=[{eventName:"onPointerDown",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}class Yc extends So{static activators=[{eventName:"onTouchStart",handler:({nativeEvent:n})=>!n.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}function $c(){const t=ft(k=>k.photos),n=ft(k=>k.reorderPhotos),[e,r]=j.useState(!1),[o,i]=j.useState(null),a=j.useRef(!1),[s,l]=j.useState("jpeg"),[f,c]=j.useState(Ys*100),m=o?.pct??0,g=j.useMemo(()=>{if(!o)return"";const k=o.etaMs??0;return`Rendering ${o.done}/${o.total} • ${m}% • elapsed ${pi(o.elapsedMs)}${o.done<o.total?` • ETA ${pi(k)}`:""}`},[o,m]);j.useEffect(()=>{o&&o.done>=o.total&&i(null)},[o]);const u=j.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{r(!0),i({done:0,total:t.length,elapsedMs:0,pct:0});const k=performance.now(),C=await Fc(t,{format:s,quality:s==="jpeg"?f/100:void 0,onProgress:({done:I,total:z})=>{const O=performance.now()-k,M=Math.round(I/z*100);i({done:I,total:z,elapsedMs:O,pct:M})}}),N=URL.createObjectURL(C),D=document.createElement("a");D.href=N,D.download="story-squares-images.zip",document.body.appendChild(D),D.click(),D.remove(),URL.revokeObjectURL(N)}finally{r(!1),a.current=!1}}},[t,s,f]),y=j.useCallback(async()=>{if(!(!t.length||a.current)){a.current=!0;try{r(!0);const{exportCardsToPdf:k}=await rs(async()=>{const{exportCardsToPdf:z}=await import("./pdf-4IF0YJUI.js");return{exportCardsToPdf:z}},__vite__mapDeps([0,1,2,3])),C=await k(t,{format:s,quality:s==="jpeg"?f/100:void 0,onProgress:z=>i(z)}),N=new Blob([C],{type:"application/pdf"}),D=URL.createObjectURL(N),I=document.createElement("a");I.href=D,I.download="story-squares.pdf",document.body.appendChild(I),I.click(),I.remove(),URL.revokeObjectURL(D)}finally{r(!1),a.current=!1}}},[t,s,f]),d=j.useCallback(async()=>{r(!0);try{const k=await Ra({imageFormat:s,quality:s==="jpeg"?f/100:void 0,onProgress:({done:D,total:I})=>i({done:D,total:I,elapsedMs:0,pct:Math.round(D/I*100)})}),C=URL.createObjectURL(k),N=document.createElement("a");N.href=C,N.download="story-squares.zip",document.body.appendChild(N),N.click(),N.remove(),URL.revokeObjectURL(C)}finally{r(!1)}},[s,f]),v=Tt.useRef(null),b=j.useCallback(async k=>{try{const{warnings:C}=await no(k);C.length&&alert(`Import finished with warnings:
`+C.join(`
`))}catch(C){alert("Import failed: "+(C?.message||String(C)))}},[]),x=gl(ni(Vc,{activationConstraint:{distance:6}}),ni(Yc,{activationConstraint:{delay:120,tolerance:6}})),_=t.map(k=>k.id);return A.jsxs("section",{className:"space-y-3",children:[A.jsx(vc,{sensors:x,collisionDetection:xl,onDragEnd:({active:k,over:C})=>{if(!C||k.id===C.id)return;const N=_.indexOf(String(k.id)),D=_.indexOf(String(C.id));if(N===-1||D===-1)return;const I=pr(_,N,D);n(I)},children:A.jsx(Ic,{items:_,strategy:mr,children:A.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:t.map(k=>A.jsx(Oc,{id:k.id,children:A.jsx(el,{photo:k})},k.id))})})}),t.length>0&&A.jsxs(ro,{className:"p-4",children:[A.jsx("div",{className:"mb-3 text-sm font-medium",children:"Export the collection to..."}),o&&A.jsxs(A.Fragment,{children:[A.jsx(Jn,{value:m,className:"mb-1 h-2"}),A.jsx("div",{className:"mb-3 text-xs opacity-70",children:g})]}),A.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("span",{className:"opacity-70",children:"Format"}),A.jsxs(io,{value:s,onValueChange:k=>l(k),children:[A.jsx(tr,{className:"w-28 h-8",children:A.jsx(oo,{placeholder:"Format"})}),A.jsxs(er,{children:[A.jsx(ue,{value:"jpeg",children:"JPEG (small)"}),A.jsx(ue,{value:"png",children:"PNG (lossless)"})]})]})]}),s==="jpeg"&&A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("span",{className:"opacity-70",children:"Quality"}),A.jsx("input",{type:"range",min:50,max:95,step:5,value:f,onChange:k=>c(Number(k.target.value))}),A.jsxs("span",{className:"tabular-nums",children:[f,"%"]})]}),A.jsx("div",{className:"grow"}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx(xt,{type:"button",size:"sm",onClick:d,disabled:!t.length||e,children:"Save collection (.zip)"}),A.jsx("input",{ref:v,type:"file",accept:".zip,application/zip",className:"hidden",onChange:k=>{const C=k.currentTarget.files?.[0];C&&b(C),k.currentTarget.value=""}}),A.jsx(xt,{type:"button",size:"sm",onClick:u,disabled:!t.length||e,children:"Export images (.zip)"}),A.jsx(xt,{type:"button",size:"sm",onClick:y,disabled:!t.length||e,children:e?"Exporting…":"Export PDF"})]})]})]})]})}function Gc(){const t=Ce(r=>r.busy),n=Ce(r=>r.busyText),e=Ce(r=>r.progress);return t?A.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/60 backdrop-blur-sm","aria-live":"polite","aria-busy":"true",role:"status",children:A.jsxs("div",{className:"flex min-w-64 flex-col items-stretch gap-3 rounded-2xl border bg-background px-4 py-3 shadow-lg",children:[A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent","aria-hidden":"true"}),A.jsx("div",{className:"text-sm",children:n??"Loading..."})]}),typeof e=="number"&&A.jsx(Jn,{value:e,className:"h-2"})]})}):null}function Hc(){return is(),A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"sticky top-0 z-10 w-full py-3 text-center text-3xl font-bold bg-background border-b border-gray-300",children:"Story Squares v1.1"}),A.jsxs("main",{className:"mx-auto max-w-screen-md px-4 space-y-5",children:[A.jsx(Da,{}),A.jsx($c,{})]}),A.jsx(Gc,{})]})}vi.createRoot(document.getElementById("root")).render(A.jsx(Tt.StrictMode,{children:A.jsx(Hc,{})}));export{It as C,Ys as P,ho as e};
