const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-DFNxJSZd.js","assets/jspdf-Cd6LZobY.js","assets/vendor-react-DeE0Jy05.js","assets/vendor-ui-BRjI84Zm.js"])))=>i.map(i=>d[i]);
import{r as h,j as d,k as Cs,m as Es,R as ae,C as eo,n as Rs,p as Ss,S as Ns,L as As,q as nr,I as to,T as ks,t as Is,X as Ts,v as no,a as lt}from"./vendor-react-DeE0Jy05.js";import{S as Ds,R as ro,I as Ms,T as oo,a as js,b as so,c as io,P as Ls,C as ao,V as Ps,L as lo,d as co,e as Bs,f as _s,g as uo,h as zs,i as Fs,O as fo,j as Os,k as ho,l as Us,m as go,D as mo,n as qs,o as po,p as bo,q as Ys,r as Vs,s as $s,t as Gs}from"./vendor-ui-BRjI84Zm.js";import{_ as Hs}from"./jspdf-Cd6LZobY.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function Ot(e){const t=document.documentElement,n=window.matchMedia("(prefers-color-scheme: dark)").matches,r=e==="dark"||e==="system"&&n;t.classList.toggle("dark",r)}function Xs(){h.useEffect(()=>{const e=localStorage.getItem("theme")??"system";Ot(e);const t=window.matchMedia("(prefers-color-scheme: dark)"),n=()=>{const o=localStorage.getItem("theme")??"system";o==="system"&&Ot(o)};t.addEventListener("change",n);const r=o=>{if(o.key==="theme"){const s=o.newValue??"system";Ot(s)}};return window.addEventListener("storage",r),()=>{t.removeEventListener("change",n),window.removeEventListener("storage",r)}},[])}function yo(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=yo(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function xo(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=yo(e))&&(r&&(r+=" "),r+=t);return r}const rr=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,or=xo,vo=(e,t)=>n=>{var r;if(t?.variants==null)return or(e,n?.class,n?.className);const{variants:o,defaultVariants:s}=t,i=Object.keys(o).map(c=>{const u=n?.[c],f=s?.[c];if(u===null)return null;const b=rr(u)||rr(f);return o[c][b]}),l=n&&Object.entries(n).reduce((c,u)=>{let[f,b]=u;return b===void 0||(c[f]=b),c},{}),a=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:f,className:b,...p}=u;return Object.entries(p).every(S=>{let[v,A]=S;return Array.isArray(A)?A.includes({...s,...l}[v]):{...s,...l}[v]===A})?[...c,f,b]:c},[]);return or(e,i,a,n?.class,n?.className)},In="-",Ws=e=>{const t=Ks(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:i=>{const l=i.split(In);return l[0]===""&&l.length!==1&&l.shift(),wo(l,t)||Qs(i)},getConflictingClassGroupIds:(i,l)=>{const a=n[i]||[];return l&&r[i]?[...a,...r[i]]:a}}},wo=(e,t)=>{if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),o=r?wo(e.slice(1),r):void 0;if(o)return o;if(t.validators.length===0)return;const s=e.join(In);return t.validators.find(({validator:i})=>i(s))?.classGroupId},sr=/^\[(.+)\]$/,Qs=e=>{if(sr.test(e)){const t=sr.exec(e)[1],n=t?.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Ks=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const o in n)vn(n[o],r,o,t);return r},vn=(e,t,n,r)=>{e.forEach(o=>{if(typeof o=="string"){const s=o===""?t:ir(t,o);s.classGroupId=n;return}if(typeof o=="function"){if(Js(o)){vn(o(r),t,n,r);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([s,i])=>{vn(i,ir(t,s),n,r)})})},ir=(e,t)=>{let n=e;return t.split(In).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Js=e=>e.isThemeGetter,Zs=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const o=(s,i)=>{n.set(s,i),t++,t>e&&(t=0,r=n,n=new Map)};return{get(s){let i=n.get(s);if(i!==void 0)return i;if((i=r.get(s))!==void 0)return o(s,i),i},set(s,i){n.has(s)?n.set(s,i):o(s,i)}}},wn="!",Cn=":",ei=Cn.length,ti=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=o=>{const s=[];let i=0,l=0,a=0,c;for(let S=0;S<o.length;S++){let v=o[S];if(i===0&&l===0){if(v===Cn){s.push(o.slice(a,S)),a=S+ei;continue}if(v==="/"){c=S;continue}}v==="["?i++:v==="]"?i--:v==="("?l++:v===")"&&l--}const u=s.length===0?o:o.substring(a),f=ni(u),b=f!==u,p=c&&c>a?c-a:void 0;return{modifiers:s,hasImportantModifier:b,baseClassName:f,maybePostfixModifierPosition:p}};if(t){const o=t+Cn,s=r;r=i=>i.startsWith(o)?s(i.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:i,maybePostfixModifierPosition:void 0}}if(n){const o=r;r=s=>n({className:s,parseClassName:o})}return r},ni=e=>e.endsWith(wn)?e.substring(0,e.length-1):e.startsWith(wn)?e.substring(1):e,ri=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const o=[];let s=[];return r.forEach(i=>{i[0]==="["||t[i]?(o.push(...s.sort(),i),s=[]):s.push(i)}),o.push(...s.sort()),o}},oi=e=>({cache:Zs(e.cacheSize),parseClassName:ti(e),sortModifiers:ri(e),...Ws(e)}),si=/\s+/,ii=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o,sortModifiers:s}=t,i=[],l=e.trim().split(si);let a="";for(let c=l.length-1;c>=0;c-=1){const u=l[c],{isExternal:f,modifiers:b,hasImportantModifier:p,baseClassName:S,maybePostfixModifierPosition:v}=n(u);if(f){a=u+(a.length>0?" "+a:a);continue}let A=!!v,N=r(A?S.substring(0,v):S);if(!N){if(!A){a=u+(a.length>0?" "+a:a);continue}if(N=r(S),!N){a=u+(a.length>0?" "+a:a);continue}A=!1}const k=s(b).join(":"),R=p?k+wn:k,w=R+N;if(i.includes(w))continue;i.push(w);const T=o(N,A);for(let E=0;E<T.length;++E){const x=T[E];i.push(R+x)}a=u+(a.length>0?" "+a:a)}return a};function ai(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=Co(t))&&(r&&(r+=" "),r+=n);return r}const Co=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=Co(e[r]))&&(n&&(n+=" "),n+=t);return n};function li(e,...t){let n,r,o,s=i;function i(a){const c=t.reduce((u,f)=>f(u),e());return n=oi(c),r=n.cache.get,o=n.cache.set,s=l,l(a)}function l(a){const c=r(a);if(c)return c;const u=ii(a,n);return o(a,u),u}return function(){return s(ai.apply(null,arguments))}}const ee=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},Eo=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Ro=/^\((?:(\w[\w-]*):)?(.+)\)$/i,ci=/^\d+\/\d+$/,di=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ui=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,fi=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,hi=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,gi=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,$e=e=>ci.test(e),z=e=>!!e&&!Number.isNaN(Number(e)),je=e=>!!e&&Number.isInteger(Number(e)),Ut=e=>e.endsWith("%")&&z(e.slice(0,-1)),Ne=e=>di.test(e),mi=()=>!0,pi=e=>ui.test(e)&&!fi.test(e),So=()=>!1,bi=e=>hi.test(e),yi=e=>gi.test(e),xi=e=>!L(e)&&!P(e),vi=e=>Ke(e,ko,So),L=e=>Eo.test(e),Be=e=>Ke(e,Io,pi),qt=e=>Ke(e,Si,z),ar=e=>Ke(e,No,So),wi=e=>Ke(e,Ao,yi),vt=e=>Ke(e,To,bi),P=e=>Ro.test(e),it=e=>Je(e,Io),Ci=e=>Je(e,Ni),lr=e=>Je(e,No),Ei=e=>Je(e,ko),Ri=e=>Je(e,Ao),wt=e=>Je(e,To,!0),Ke=(e,t,n)=>{const r=Eo.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},Je=(e,t,n=!1)=>{const r=Ro.exec(e);return r?r[1]?t(r[1]):n:!1},No=e=>e==="position"||e==="percentage",Ao=e=>e==="image"||e==="url",ko=e=>e==="length"||e==="size"||e==="bg-size",Io=e=>e==="length",Si=e=>e==="number",Ni=e=>e==="family-name",To=e=>e==="shadow",Ai=()=>{const e=ee("color"),t=ee("font"),n=ee("text"),r=ee("font-weight"),o=ee("tracking"),s=ee("leading"),i=ee("breakpoint"),l=ee("container"),a=ee("spacing"),c=ee("radius"),u=ee("shadow"),f=ee("inset-shadow"),b=ee("text-shadow"),p=ee("drop-shadow"),S=ee("blur"),v=ee("perspective"),A=ee("aspect"),N=ee("ease"),k=ee("animate"),R=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],T=()=>[...w(),P,L],E=()=>["auto","hidden","clip","visible","scroll"],x=()=>["auto","contain","none"],m=()=>[P,L,a],y=()=>[$e,"full","auto",...m()],D=()=>[je,"none","subgrid",P,L],I=()=>["auto",{span:["full",je,P,L]},je,P,L],M=()=>[je,"auto",P,L],g=()=>["auto","min","max","fr",P,L],C=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],F=()=>["start","end","center","stretch","center-safe","end-safe"],_=()=>["auto",...m()],U=()=>[$e,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...m()],j=()=>[e,P,L],B=()=>[...w(),lr,ar,{position:[P,L]}],J=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Z=()=>["auto","cover","contain",Ei,vi,{size:[P,L]}],G=()=>[Ut,it,Be],Y=()=>["","none","full",c,P,L],H=()=>["",z,it,Be],de=()=>["solid","dashed","dotted","double"],ne=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],q=()=>[z,Ut,lr,ar],Q=()=>["","none",S,P,L],K=()=>["none",z,P,L],O=()=>["none",z,P,L],Ee=()=>[z,P,L],le=()=>[$e,"full",...m()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ne],breakpoint:[Ne],color:[mi],container:[Ne],"drop-shadow":[Ne],ease:["in","out","in-out"],font:[xi],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ne],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ne],shadow:[Ne],spacing:["px",z],text:[Ne],"text-shadow":[Ne],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",$e,L,P,A]}],container:["container"],columns:[{columns:[z,L,P,l]}],"break-after":[{"break-after":R()}],"break-before":[{"break-before":R()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:T()}],overflow:[{overflow:E()}],"overflow-x":[{"overflow-x":E()}],"overflow-y":[{"overflow-y":E()}],overscroll:[{overscroll:x()}],"overscroll-x":[{"overscroll-x":x()}],"overscroll-y":[{"overscroll-y":x()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:y()}],"inset-x":[{"inset-x":y()}],"inset-y":[{"inset-y":y()}],start:[{start:y()}],end:[{end:y()}],top:[{top:y()}],right:[{right:y()}],bottom:[{bottom:y()}],left:[{left:y()}],visibility:["visible","invisible","collapse"],z:[{z:[je,"auto",P,L]}],basis:[{basis:[$e,"full","auto",l,...m()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[z,$e,"auto","initial","none",L]}],grow:[{grow:["",z,P,L]}],shrink:[{shrink:["",z,P,L]}],order:[{order:[je,"first","last","none",P,L]}],"grid-cols":[{"grid-cols":D()}],"col-start-end":[{col:I()}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":D()}],"row-start-end":[{row:I()}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":g()}],"auto-rows":[{"auto-rows":g()}],gap:[{gap:m()}],"gap-x":[{"gap-x":m()}],"gap-y":[{"gap-y":m()}],"justify-content":[{justify:[...C(),"normal"]}],"justify-items":[{"justify-items":[...F(),"normal"]}],"justify-self":[{"justify-self":["auto",...F()]}],"align-content":[{content:["normal",...C()]}],"align-items":[{items:[...F(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...F(),{baseline:["","last"]}]}],"place-content":[{"place-content":C()}],"place-items":[{"place-items":[...F(),"baseline"]}],"place-self":[{"place-self":["auto",...F()]}],p:[{p:m()}],px:[{px:m()}],py:[{py:m()}],ps:[{ps:m()}],pe:[{pe:m()}],pt:[{pt:m()}],pr:[{pr:m()}],pb:[{pb:m()}],pl:[{pl:m()}],m:[{m:_()}],mx:[{mx:_()}],my:[{my:_()}],ms:[{ms:_()}],me:[{me:_()}],mt:[{mt:_()}],mr:[{mr:_()}],mb:[{mb:_()}],ml:[{ml:_()}],"space-x":[{"space-x":m()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":m()}],"space-y-reverse":["space-y-reverse"],size:[{size:U()}],w:[{w:[l,"screen",...U()]}],"min-w":[{"min-w":[l,"screen","none",...U()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[i]},...U()]}],h:[{h:["screen","lh",...U()]}],"min-h":[{"min-h":["screen","lh","none",...U()]}],"max-h":[{"max-h":["screen","lh",...U()]}],"font-size":[{text:["base",n,it,Be]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,P,qt]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Ut,L]}],"font-family":[{font:[Ci,L,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,P,L]}],"line-clamp":[{"line-clamp":[z,"none",P,qt]}],leading:[{leading:[s,...m()]}],"list-image":[{"list-image":["none",P,L]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",P,L]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:j()}],"text-color":[{text:j()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:[z,"from-font","auto",P,Be]}],"text-decoration-color":[{decoration:j()}],"underline-offset":[{"underline-offset":[z,"auto",P,L]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:m()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",P,L]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",P,L]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:B()}],"bg-repeat":[{bg:J()}],"bg-size":[{bg:Z()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},je,P,L],radial:["",P,L],conic:[je,P,L]},Ri,wi]}],"bg-color":[{bg:j()}],"gradient-from-pos":[{from:G()}],"gradient-via-pos":[{via:G()}],"gradient-to-pos":[{to:G()}],"gradient-from":[{from:j()}],"gradient-via":[{via:j()}],"gradient-to":[{to:j()}],rounded:[{rounded:Y()}],"rounded-s":[{"rounded-s":Y()}],"rounded-e":[{"rounded-e":Y()}],"rounded-t":[{"rounded-t":Y()}],"rounded-r":[{"rounded-r":Y()}],"rounded-b":[{"rounded-b":Y()}],"rounded-l":[{"rounded-l":Y()}],"rounded-ss":[{"rounded-ss":Y()}],"rounded-se":[{"rounded-se":Y()}],"rounded-ee":[{"rounded-ee":Y()}],"rounded-es":[{"rounded-es":Y()}],"rounded-tl":[{"rounded-tl":Y()}],"rounded-tr":[{"rounded-tr":Y()}],"rounded-br":[{"rounded-br":Y()}],"rounded-bl":[{"rounded-bl":Y()}],"border-w":[{border:H()}],"border-w-x":[{"border-x":H()}],"border-w-y":[{"border-y":H()}],"border-w-s":[{"border-s":H()}],"border-w-e":[{"border-e":H()}],"border-w-t":[{"border-t":H()}],"border-w-r":[{"border-r":H()}],"border-w-b":[{"border-b":H()}],"border-w-l":[{"border-l":H()}],"divide-x":[{"divide-x":H()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":H()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...de(),"hidden","none"]}],"divide-style":[{divide:[...de(),"hidden","none"]}],"border-color":[{border:j()}],"border-color-x":[{"border-x":j()}],"border-color-y":[{"border-y":j()}],"border-color-s":[{"border-s":j()}],"border-color-e":[{"border-e":j()}],"border-color-t":[{"border-t":j()}],"border-color-r":[{"border-r":j()}],"border-color-b":[{"border-b":j()}],"border-color-l":[{"border-l":j()}],"divide-color":[{divide:j()}],"outline-style":[{outline:[...de(),"none","hidden"]}],"outline-offset":[{"outline-offset":[z,P,L]}],"outline-w":[{outline:["",z,it,Be]}],"outline-color":[{outline:j()}],shadow:[{shadow:["","none",u,wt,vt]}],"shadow-color":[{shadow:j()}],"inset-shadow":[{"inset-shadow":["none",f,wt,vt]}],"inset-shadow-color":[{"inset-shadow":j()}],"ring-w":[{ring:H()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:j()}],"ring-offset-w":[{"ring-offset":[z,Be]}],"ring-offset-color":[{"ring-offset":j()}],"inset-ring-w":[{"inset-ring":H()}],"inset-ring-color":[{"inset-ring":j()}],"text-shadow":[{"text-shadow":["none",b,wt,vt]}],"text-shadow-color":[{"text-shadow":j()}],opacity:[{opacity:[z,P,L]}],"mix-blend":[{"mix-blend":[...ne(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ne()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[z]}],"mask-image-linear-from-pos":[{"mask-linear-from":q()}],"mask-image-linear-to-pos":[{"mask-linear-to":q()}],"mask-image-linear-from-color":[{"mask-linear-from":j()}],"mask-image-linear-to-color":[{"mask-linear-to":j()}],"mask-image-t-from-pos":[{"mask-t-from":q()}],"mask-image-t-to-pos":[{"mask-t-to":q()}],"mask-image-t-from-color":[{"mask-t-from":j()}],"mask-image-t-to-color":[{"mask-t-to":j()}],"mask-image-r-from-pos":[{"mask-r-from":q()}],"mask-image-r-to-pos":[{"mask-r-to":q()}],"mask-image-r-from-color":[{"mask-r-from":j()}],"mask-image-r-to-color":[{"mask-r-to":j()}],"mask-image-b-from-pos":[{"mask-b-from":q()}],"mask-image-b-to-pos":[{"mask-b-to":q()}],"mask-image-b-from-color":[{"mask-b-from":j()}],"mask-image-b-to-color":[{"mask-b-to":j()}],"mask-image-l-from-pos":[{"mask-l-from":q()}],"mask-image-l-to-pos":[{"mask-l-to":q()}],"mask-image-l-from-color":[{"mask-l-from":j()}],"mask-image-l-to-color":[{"mask-l-to":j()}],"mask-image-x-from-pos":[{"mask-x-from":q()}],"mask-image-x-to-pos":[{"mask-x-to":q()}],"mask-image-x-from-color":[{"mask-x-from":j()}],"mask-image-x-to-color":[{"mask-x-to":j()}],"mask-image-y-from-pos":[{"mask-y-from":q()}],"mask-image-y-to-pos":[{"mask-y-to":q()}],"mask-image-y-from-color":[{"mask-y-from":j()}],"mask-image-y-to-color":[{"mask-y-to":j()}],"mask-image-radial":[{"mask-radial":[P,L]}],"mask-image-radial-from-pos":[{"mask-radial-from":q()}],"mask-image-radial-to-pos":[{"mask-radial-to":q()}],"mask-image-radial-from-color":[{"mask-radial-from":j()}],"mask-image-radial-to-color":[{"mask-radial-to":j()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[z]}],"mask-image-conic-from-pos":[{"mask-conic-from":q()}],"mask-image-conic-to-pos":[{"mask-conic-to":q()}],"mask-image-conic-from-color":[{"mask-conic-from":j()}],"mask-image-conic-to-color":[{"mask-conic-to":j()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:B()}],"mask-repeat":[{mask:J()}],"mask-size":[{mask:Z()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",P,L]}],filter:[{filter:["","none",P,L]}],blur:[{blur:Q()}],brightness:[{brightness:[z,P,L]}],contrast:[{contrast:[z,P,L]}],"drop-shadow":[{"drop-shadow":["","none",p,wt,vt]}],"drop-shadow-color":[{"drop-shadow":j()}],grayscale:[{grayscale:["",z,P,L]}],"hue-rotate":[{"hue-rotate":[z,P,L]}],invert:[{invert:["",z,P,L]}],saturate:[{saturate:[z,P,L]}],sepia:[{sepia:["",z,P,L]}],"backdrop-filter":[{"backdrop-filter":["","none",P,L]}],"backdrop-blur":[{"backdrop-blur":Q()}],"backdrop-brightness":[{"backdrop-brightness":[z,P,L]}],"backdrop-contrast":[{"backdrop-contrast":[z,P,L]}],"backdrop-grayscale":[{"backdrop-grayscale":["",z,P,L]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[z,P,L]}],"backdrop-invert":[{"backdrop-invert":["",z,P,L]}],"backdrop-opacity":[{"backdrop-opacity":[z,P,L]}],"backdrop-saturate":[{"backdrop-saturate":[z,P,L]}],"backdrop-sepia":[{"backdrop-sepia":["",z,P,L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":m()}],"border-spacing-x":[{"border-spacing-x":m()}],"border-spacing-y":[{"border-spacing-y":m()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",P,L]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[z,"initial",P,L]}],ease:[{ease:["linear","initial",N,P,L]}],delay:[{delay:[z,P,L]}],animate:[{animate:["none",k,P,L]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[v,P,L]}],"perspective-origin":[{"perspective-origin":T()}],rotate:[{rotate:K()}],"rotate-x":[{"rotate-x":K()}],"rotate-y":[{"rotate-y":K()}],"rotate-z":[{"rotate-z":K()}],scale:[{scale:O()}],"scale-x":[{"scale-x":O()}],"scale-y":[{"scale-y":O()}],"scale-z":[{"scale-z":O()}],"scale-3d":["scale-3d"],skew:[{skew:Ee()}],"skew-x":[{"skew-x":Ee()}],"skew-y":[{"skew-y":Ee()}],transform:[{transform:[P,L,"","none","gpu","cpu"]}],"transform-origin":[{origin:T()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:le()}],"translate-x":[{"translate-x":le()}],"translate-y":[{"translate-y":le()}],"translate-z":[{"translate-z":le()}],"translate-none":["translate-none"],accent:[{accent:j()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:j()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",P,L]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":m()}],"scroll-mx":[{"scroll-mx":m()}],"scroll-my":[{"scroll-my":m()}],"scroll-ms":[{"scroll-ms":m()}],"scroll-me":[{"scroll-me":m()}],"scroll-mt":[{"scroll-mt":m()}],"scroll-mr":[{"scroll-mr":m()}],"scroll-mb":[{"scroll-mb":m()}],"scroll-ml":[{"scroll-ml":m()}],"scroll-p":[{"scroll-p":m()}],"scroll-px":[{"scroll-px":m()}],"scroll-py":[{"scroll-py":m()}],"scroll-ps":[{"scroll-ps":m()}],"scroll-pe":[{"scroll-pe":m()}],"scroll-pt":[{"scroll-pt":m()}],"scroll-pr":[{"scroll-pr":m()}],"scroll-pb":[{"scroll-pb":m()}],"scroll-pl":[{"scroll-pl":m()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",P,L]}],fill:[{fill:["none",...j()]}],"stroke-w":[{stroke:[z,it,Be,qt]}],stroke:[{stroke:["none",...j()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},ki=li(Ai);function X(...e){return ki(xo(e))}const Ii=vo("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),re=h.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...o},s)=>{const i=r?Ds:"button";return d.jsx(i,{className:X(Ii({variant:t,size:n,className:e})),ref:s,...o})});re.displayName="Button";const Ti=/^(image\/(jpeg|png|webp|gif|avif|bmp|tiff))$/i;function Di(e){return Ti.test(e.type)}function Mi(e,t=36){const n=[];for(const r of e)if(Di(r)){if(n.length>=t)break;n.push({id:crypto.randomUUID(),url:URL.createObjectURL(r),name:r.name,size:r.size,type:r.type})}return n}function cr(e){for(const t of e)try{URL.revokeObjectURL(t.url)}catch{}}let we=null;function Ct(){if(!we)throw new Error("ConfigController: not initialized. Call Config.init().")}function dr(e){if(e.MAX_CARDS!=null&&(!Number.isInteger(e.MAX_CARDS)||e.MAX_CARDS<=0))throw new Error("MAX_CARDS must be a positive integer.");if(e.CARD_EXPORT_SIZE!=null&&(!Number.isInteger(e.CARD_EXPORT_SIZE)||e.CARD_EXPORT_SIZE<=0))throw new Error("CARD_EXPORT_SIZE must be a positive integer.");if(e.PREVIEW_EXACT_SIZE!=null&&(!Number.isInteger(e.PREVIEW_EXACT_SIZE)||e.PREVIEW_EXACT_SIZE<=0))throw new Error("PREVIEW_EXACT_SIZE must be a positive integer.");if(e.PREVIEW_FAST_SIZE!=null&&(!Number.isInteger(e.PREVIEW_FAST_SIZE)||e.PREVIEW_FAST_SIZE<=0))throw new Error("PREVIEW_FAST_SIZE must be a positive integer.");if(e.PDF_JPEG_QUALITY!=null&&(e.PDF_JPEG_QUALITY<0||e.PDF_JPEG_QUALITY>1))throw new Error("PDF_JPEG_QUALITY must be within [0..1].");if(e.IMAGE_FIT_MODE!=null&&e.IMAGE_FIT_MODE!=="cover"&&e.IMAGE_FIT_MODE!=="contain")throw new Error("IMAGE_FIT_MODE must be 'cover' or 'contain'.");if(e.INITIAL_ALIGN_X!=null&&!["center","left","right"].includes(e.INITIAL_ALIGN_X))throw new Error("INITIAL_ALIGN_X must be 'center' | 'left' | 'right'.");if(e.INITIAL_ALIGN_Y!=null&&!["center","top","bottom"].includes(e.INITIAL_ALIGN_Y))throw new Error("INITIAL_ALIGN_Y must be 'center' | 'top' | 'bottom'.");if(e.FONT_CATALOG!=null&&!Array.isArray(e.FONT_CATALOG))throw new Error("FONT_CATALOG must be an array.");if(e.DEFAULT_CARD_LAYERS!=null&&!Array.isArray(e.DEFAULT_CARD_LAYERS))throw new Error("DEFAULT_CARD_LAYERS must be an array.");if(e.DEFAULTS!=null&&(typeof e.DEFAULTS!="object"||Array.isArray(e.DEFAULTS)))throw new Error("DEFAULTS must be an object.");if(e.NEAR_SQUARE_TOLERANCE!=null&&(e.NEAR_SQUARE_TOLERANCE<0||e.NEAR_SQUARE_TOLERANCE>.5))throw new Error("NEAR_SQUARE_TOLERANCE must be within [0..0.5].");if(e.NEAR_SQUARE_SCALE!=null&&(e.NEAR_SQUARE_SCALE<=0||e.NEAR_SQUARE_SCALE>1))throw new Error("NEAR_SQUARE_SCALE must be within (0..1].");if(e.LAYER_PROFILES!=null){if(typeof e.LAYER_PROFILES!="object"||Array.isArray(e.LAYER_PROFILES))throw new Error("LAYER_PROFILES must be an object.");for(const[t,n]of Object.entries(e.LAYER_PROFILES)){if(n==null||typeof n!="object"||Array.isArray(n))throw new Error(`LAYER_PROFILES['${t}'] must be an object.`);if(n.on!=null&&typeof n.on!="boolean")throw new Error(`LAYER_PROFILES['${t}'].on must be boolean if provided.`);if(n.landscape!=null&&!Array.isArray(n.landscape))throw new Error(`LAYER_PROFILES['${t}'].landscape must be an array if provided.`);if(n.portrait!=null&&!Array.isArray(n.portrait))throw new Error(`LAYER_PROFILES['${t}'].portrait must be an array if provided.`);if(n.square!=null&&!Array.isArray(n.square))throw new Error(`LAYER_PROFILES['${t}'].square must be an array if provided.`)}}}const W={init(e){we=Object.freeze({...e})},get(){return Ct(),we},update(e){return Ct(),dr(e),we=Object.freeze({...we,...e}),we},loadFromJson(e){Ct();const t=e;return dr(t),we=Object.freeze({...we,...t}),we},toJson(){return Ct(),{...we}},async loadFromUrl(e){const t=await fetch(e,{cache:"no-store"});if(!t.ok)throw new Error(`Config.loadFromUrl failed: ${t.status}`);const n=await t.json(),{schemaVersion:r,...o}=n??{};return this.loadFromJson(o)}};W.init({});const ji="/ss/configs/default.json";await W.loadFromUrl(ji);const Li=W.get().MAX_CARDS,ce=W.get().CARD_EXPORT_SIZE,Yt=W.get().PREVIEW_EXACT_SIZE;W.get().PREVIEW_FAST_SIZE;const Pi=W.get().PDF_JPEG_QUALITY,En=W.get().IMAGE_FIT_MODE,Bi=W.get().INITIAL_ALIGN_X,_i=W.get().INITIAL_ALIGN_Y,Do=W.get().FONT_CATALOG;W.get().NEAR_SQUARE_TOLERANCE;W.get().NEAR_SQUARE_SCALE;W.get().DEFAULTS;W.get().DEFAULT_CARD_LAYERS;var Ge={},Vt,ur;function zi(){return ur||(ur=1,Vt=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Vt}var $t={},Le={},fr;function _e(){if(fr)return Le;fr=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Le.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17},Le.getSymbolTotalCodewords=function(r){return t[r]},Le.getBCHDigit=function(n){let r=0;for(;n!==0;)r++,n>>>=1;return r},Le.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');e=r},Le.isKanjiModeEnabled=function(){return typeof e<"u"},Le.toSJIS=function(r){return e(r)},Le}var Gt={},hr;function Tn(){return hr||(hr=1,function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+n)}}e.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},e.from=function(r,o){if(e.isValid(r))return r;try{return t(r)}catch{return o}}}(Gt)),Gt}var Ht,gr;function Fi(){if(gr)return Ht;gr=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let r=0;r<n;r++)this.putBit((t>>>n-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},Ht=e,Ht}var Xt,mr;function Oi(){if(mr)return Xt;mr=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,n,r,o){const s=t*this.size+n;this.data[s]=r,o&&(this.reservedBit[s]=!0)},e.prototype.get=function(t,n){return this.data[t*this.size+n]},e.prototype.xor=function(t,n,r){this.data[t*this.size+n]^=r},e.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},Xt=e,Xt}var Wt={},pr;function Ui(){return pr||(pr=1,function(e){const t=_e().getSymbolSize;e.getRowColCoords=function(r){if(r===1)return[];const o=Math.floor(r/7)+2,s=t(r),i=s===145?26:Math.ceil((s-13)/(2*o-2))*2,l=[s-7];for(let a=1;a<o-1;a++)l[a]=l[a-1]-i;return l.push(6),l.reverse()},e.getPositions=function(r){const o=[],s=e.getRowColCoords(r),i=s.length;for(let l=0;l<i;l++)for(let a=0;a<i;a++)l===0&&a===0||l===0&&a===i-1||l===i-1&&a===0||o.push([s[l],s[a]]);return o}}(Wt)),Wt}var Qt={},br;function qi(){if(br)return Qt;br=1;const e=_e().getSymbolSize,t=7;return Qt.getPositions=function(r){const o=e(r);return[[0,0],[o-t,0],[0,o-t]]},Qt}var Kt={},yr;function Yi(){return yr||(yr=1,function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const s=o.size;let i=0,l=0,a=0,c=null,u=null;for(let f=0;f<s;f++){l=a=0,c=u=null;for(let b=0;b<s;b++){let p=o.get(f,b);p===c?l++:(l>=5&&(i+=t.N1+(l-5)),c=p,l=1),p=o.get(b,f),p===u?a++:(a>=5&&(i+=t.N1+(a-5)),u=p,a=1)}l>=5&&(i+=t.N1+(l-5)),a>=5&&(i+=t.N1+(a-5))}return i},e.getPenaltyN2=function(o){const s=o.size;let i=0;for(let l=0;l<s-1;l++)for(let a=0;a<s-1;a++){const c=o.get(l,a)+o.get(l,a+1)+o.get(l+1,a)+o.get(l+1,a+1);(c===4||c===0)&&i++}return i*t.N2},e.getPenaltyN3=function(o){const s=o.size;let i=0,l=0,a=0;for(let c=0;c<s;c++){l=a=0;for(let u=0;u<s;u++)l=l<<1&2047|o.get(c,u),u>=10&&(l===1488||l===93)&&i++,a=a<<1&2047|o.get(u,c),u>=10&&(a===1488||a===93)&&i++}return i*t.N3},e.getPenaltyN4=function(o){let s=0;const i=o.data.length;for(let a=0;a<i;a++)s+=o.data[a];return Math.abs(Math.ceil(s*100/i/5)-10)*t.N4};function n(r,o,s){switch(r){case e.Patterns.PATTERN000:return(o+s)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return s%3===0;case e.Patterns.PATTERN011:return(o+s)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(s/3))%2===0;case e.Patterns.PATTERN101:return o*s%2+o*s%3===0;case e.Patterns.PATTERN110:return(o*s%2+o*s%3)%2===0;case e.Patterns.PATTERN111:return(o*s%3+(o+s)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}e.applyMask=function(o,s){const i=s.size;for(let l=0;l<i;l++)for(let a=0;a<i;a++)s.isReserved(a,l)||s.xor(a,l,n(o,a,l))},e.getBestMask=function(o,s){const i=Object.keys(e.Patterns).length;let l=0,a=1/0;for(let c=0;c<i;c++){s(c),e.applyMask(c,o);const u=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(c,o),u<a&&(a=u,l=c)}return l}}(Kt)),Kt}var Et={},xr;function Mo(){if(xr)return Et;xr=1;const e=Tn(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Et.getBlocksCount=function(o,s){switch(s){case e.L:return t[(o-1)*4+0];case e.M:return t[(o-1)*4+1];case e.Q:return t[(o-1)*4+2];case e.H:return t[(o-1)*4+3];default:return}},Et.getTotalCodewordsCount=function(o,s){switch(s){case e.L:return n[(o-1)*4+0];case e.M:return n[(o-1)*4+1];case e.Q:return n[(o-1)*4+2];case e.H:return n[(o-1)*4+3];default:return}},Et}var Jt={},at={},vr;function Vi(){if(vr)return at;vr=1;const e=new Uint8Array(512),t=new Uint8Array(256);return function(){let r=1;for(let o=0;o<255;o++)e[o]=r,t[r]=o,r<<=1,r&256&&(r^=285);for(let o=255;o<512;o++)e[o]=e[o-255]}(),at.log=function(r){if(r<1)throw new Error("log("+r+")");return t[r]},at.exp=function(r){return e[r]},at.mul=function(r,o){return r===0||o===0?0:e[t[r]+t[o]]},at}var wr;function $i(){return wr||(wr=1,function(e){const t=Vi();e.mul=function(r,o){const s=new Uint8Array(r.length+o.length-1);for(let i=0;i<r.length;i++)for(let l=0;l<o.length;l++)s[i+l]^=t.mul(r[i],o[l]);return s},e.mod=function(r,o){let s=new Uint8Array(r);for(;s.length-o.length>=0;){const i=s[0];for(let a=0;a<o.length;a++)s[a]^=t.mul(o[a],i);let l=0;for(;l<s.length&&s[l]===0;)l++;s=s.slice(l)}return s},e.generateECPolynomial=function(r){let o=new Uint8Array([1]);for(let s=0;s<r;s++)o=e.mul(o,new Uint8Array([1,t.exp(s)]));return o}}(Jt)),Jt}var Zt,Cr;function Gi(){if(Cr)return Zt;Cr=1;const e=$i();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(r){this.degree=r,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(r.length+this.degree);o.set(r);const s=e.mod(o,this.genPoly),i=this.degree-s.length;if(i>0){const l=new Uint8Array(this.degree);return l.set(s,i),l}return s},Zt=t,Zt}var en={},tn={},nn={},Er;function jo(){return Er||(Er=1,nn.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),nn}var ve={},Rr;function Lo(){if(Rr)return ve;Rr=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;ve.KANJI=new RegExp(n,"g"),ve.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),ve.BYTE=new RegExp(r,"g"),ve.NUMERIC=new RegExp(e,"g"),ve.ALPHANUMERIC=new RegExp(t,"g");const o=new RegExp("^"+n+"$"),s=new RegExp("^"+e+"$"),i=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return ve.testKanji=function(a){return o.test(a)},ve.testNumeric=function(a){return s.test(a)},ve.testAlphanumeric=function(a){return i.test(a)},ve}var Sr;function ze(){return Sr||(Sr=1,function(e){const t=jo(),n=Lo();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(s,i){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!t.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?s.ccBits[0]:i<27?s.ccBits[1]:s.ccBits[2]},e.getBestModeForData=function(s){return n.testNumeric(s)?e.NUMERIC:n.testAlphanumeric(s)?e.ALPHANUMERIC:n.testKanji(s)?e.KANJI:e.BYTE},e.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},e.isValid=function(s){return s&&s.bit&&s.ccBits};function r(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(s,i){if(e.isValid(s))return s;try{return r(s)}catch{return i}}}(tn)),tn}var Nr;function Hi(){return Nr||(Nr=1,function(e){const t=_e(),n=Mo(),r=Tn(),o=ze(),s=jo(),i=7973,l=t.getBCHDigit(i);function a(b,p,S){for(let v=1;v<=40;v++)if(p<=e.getCapacity(v,S,b))return v}function c(b,p){return o.getCharCountIndicator(b,p)+4}function u(b,p){let S=0;return b.forEach(function(v){const A=c(v.mode,p);S+=A+v.getBitsLength()}),S}function f(b,p){for(let S=1;S<=40;S++)if(u(b,S)<=e.getCapacity(S,p,o.MIXED))return S}e.from=function(p,S){return s.isValid(p)?parseInt(p,10):S},e.getCapacity=function(p,S,v){if(!s.isValid(p))throw new Error("Invalid QR Code version");typeof v>"u"&&(v=o.BYTE);const A=t.getSymbolTotalCodewords(p),N=n.getTotalCodewordsCount(p,S),k=(A-N)*8;if(v===o.MIXED)return k;const R=k-c(v,p);switch(v){case o.NUMERIC:return Math.floor(R/10*3);case o.ALPHANUMERIC:return Math.floor(R/11*2);case o.KANJI:return Math.floor(R/13);case o.BYTE:default:return Math.floor(R/8)}},e.getBestVersionForData=function(p,S){let v;const A=r.from(S,r.M);if(Array.isArray(p)){if(p.length>1)return f(p,A);if(p.length===0)return 1;v=p[0]}else v=p;return a(v.mode,v.getLength(),A)},e.getEncodedBits=function(p){if(!s.isValid(p)||p<7)throw new Error("Invalid QR Code version");let S=p<<12;for(;t.getBCHDigit(S)-l>=0;)S^=i<<t.getBCHDigit(S)-l;return p<<12|S}}(en)),en}var rn={},Ar;function Xi(){if(Ar)return rn;Ar=1;const e=_e(),t=1335,n=21522,r=e.getBCHDigit(t);return rn.getEncodedBits=function(s,i){const l=s.bit<<3|i;let a=l<<10;for(;e.getBCHDigit(a)-r>=0;)a^=t<<e.getBCHDigit(a)-r;return(l<<10|a)^n},rn}var on={},sn,kr;function Wi(){if(kr)return sn;kr=1;const e=ze();function t(n){this.mode=e.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(r){let o,s,i;for(o=0;o+3<=this.data.length;o+=3)s=this.data.substr(o,3),i=parseInt(s,10),r.put(i,10);const l=this.data.length-o;l>0&&(s=this.data.substr(o),i=parseInt(s,10),r.put(i,l*3+1))},sn=t,sn}var an,Ir;function Qi(){if(Ir)return an;Ir=1;const e=ze(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(r){this.mode=e.ALPHANUMERIC,this.data=r}return n.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(o){let s;for(s=0;s+2<=this.data.length;s+=2){let i=t.indexOf(this.data[s])*45;i+=t.indexOf(this.data[s+1]),o.put(i,11)}this.data.length%2&&o.put(t.indexOf(this.data[s]),6)},an=n,an}var ln,Tr;function Ki(){if(Tr)return ln;Tr=1;const e=ze();function t(n){this.mode=e.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(r){return r*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let r=0,o=this.data.length;r<o;r++)n.put(this.data[r],8)},ln=t,ln}var cn,Dr;function Ji(){if(Dr)return cn;Dr=1;const e=ze(),t=_e();function n(r){this.mode=e.KANJI,this.data=r}return n.getBitsLength=function(o){return o*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let o;for(o=0;o<this.data.length;o++){let s=t.toSJIS(this.data[o]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),r.put(s,13)}},cn=n,cn}var dn={exports:{}},Mr;function Zi(){return Mr||(Mr=1,function(e){var t={single_source_shortest_paths:function(n,r,o){var s={},i={};i[r]=0;var l=t.PriorityQueue.make();l.push(r,0);for(var a,c,u,f,b,p,S,v,A;!l.empty();){a=l.pop(),c=a.value,f=a.cost,b=n[c]||{};for(u in b)b.hasOwnProperty(u)&&(p=b[u],S=f+p,v=i[u],A=typeof i[u]>"u",(A||v>S)&&(i[u]=S,l.push(u,S),s[u]=c))}if(typeof o<"u"&&typeof i[o]>"u"){var N=["Could not find a path from ",r," to ",o,"."].join("");throw new Error(N)}return s},extract_shortest_path_from_predecessor_list:function(n,r){for(var o=[],s=r;s;)o.push(s),n[s],s=n[s];return o.reverse(),o},find_path:function(n,r,o){var s=t.single_source_shortest_paths(n,r,o);return t.extract_shortest_path_from_predecessor_list(s,o)},PriorityQueue:{make:function(n){var r=t.PriorityQueue,o={},s;n=n||{};for(s in r)r.hasOwnProperty(s)&&(o[s]=r[s]);return o.queue=[],o.sorter=n.sorter||r.default_sorter,o},default_sorter:function(n,r){return n.cost-r.cost},push:function(n,r){var o={value:n,cost:r};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t}(dn)),dn.exports}var jr;function ea(){return jr||(jr=1,function(e){const t=ze(),n=Wi(),r=Qi(),o=Ki(),s=Ji(),i=Lo(),l=_e(),a=Zi();function c(N){return unescape(encodeURIComponent(N)).length}function u(N,k,R){const w=[];let T;for(;(T=N.exec(R))!==null;)w.push({data:T[0],index:T.index,mode:k,length:T[0].length});return w}function f(N){const k=u(i.NUMERIC,t.NUMERIC,N),R=u(i.ALPHANUMERIC,t.ALPHANUMERIC,N);let w,T;return l.isKanjiModeEnabled()?(w=u(i.BYTE,t.BYTE,N),T=u(i.KANJI,t.KANJI,N)):(w=u(i.BYTE_KANJI,t.BYTE,N),T=[]),k.concat(R,w,T).sort(function(x,m){return x.index-m.index}).map(function(x){return{data:x.data,mode:x.mode,length:x.length}})}function b(N,k){switch(k){case t.NUMERIC:return n.getBitsLength(N);case t.ALPHANUMERIC:return r.getBitsLength(N);case t.KANJI:return s.getBitsLength(N);case t.BYTE:return o.getBitsLength(N)}}function p(N){return N.reduce(function(k,R){const w=k.length-1>=0?k[k.length-1]:null;return w&&w.mode===R.mode?(k[k.length-1].data+=R.data,k):(k.push(R),k)},[])}function S(N){const k=[];for(let R=0;R<N.length;R++){const w=N[R];switch(w.mode){case t.NUMERIC:k.push([w,{data:w.data,mode:t.ALPHANUMERIC,length:w.length},{data:w.data,mode:t.BYTE,length:w.length}]);break;case t.ALPHANUMERIC:k.push([w,{data:w.data,mode:t.BYTE,length:w.length}]);break;case t.KANJI:k.push([w,{data:w.data,mode:t.BYTE,length:c(w.data)}]);break;case t.BYTE:k.push([{data:w.data,mode:t.BYTE,length:c(w.data)}])}}return k}function v(N,k){const R={},w={start:{}};let T=["start"];for(let E=0;E<N.length;E++){const x=N[E],m=[];for(let y=0;y<x.length;y++){const D=x[y],I=""+E+y;m.push(I),R[I]={node:D,lastCount:0},w[I]={};for(let M=0;M<T.length;M++){const g=T[M];R[g]&&R[g].node.mode===D.mode?(w[g][I]=b(R[g].lastCount+D.length,D.mode)-b(R[g].lastCount,D.mode),R[g].lastCount+=D.length):(R[g]&&(R[g].lastCount=D.length),w[g][I]=b(D.length,D.mode)+4+t.getCharCountIndicator(D.mode,k))}}T=m}for(let E=0;E<T.length;E++)w[T[E]].end=0;return{map:w,table:R}}function A(N,k){let R;const w=t.getBestModeForData(N);if(R=t.from(k,w),R!==t.BYTE&&R.bit<w.bit)throw new Error('"'+N+'" cannot be encoded with mode '+t.toString(R)+`.
 Suggested mode is: `+t.toString(w));switch(R===t.KANJI&&!l.isKanjiModeEnabled()&&(R=t.BYTE),R){case t.NUMERIC:return new n(N);case t.ALPHANUMERIC:return new r(N);case t.KANJI:return new s(N);case t.BYTE:return new o(N)}}e.fromArray=function(k){return k.reduce(function(R,w){return typeof w=="string"?R.push(A(w,null)):w.data&&R.push(A(w.data,w.mode)),R},[])},e.fromString=function(k,R){const w=f(k,l.isKanjiModeEnabled()),T=S(w),E=v(T,R),x=a.find_path(E.map,"start","end"),m=[];for(let y=1;y<x.length-1;y++)m.push(E.table[x[y]].node);return e.fromArray(p(m))},e.rawSplit=function(k){return e.fromArray(f(k,l.isKanjiModeEnabled()))}}(on)),on}var Lr;function ta(){if(Lr)return $t;Lr=1;const e=_e(),t=Tn(),n=Fi(),r=Oi(),o=Ui(),s=qi(),i=Yi(),l=Mo(),a=Gi(),c=Hi(),u=Xi(),f=ze(),b=ea();function p(E,x){const m=E.size,y=s.getPositions(x);for(let D=0;D<y.length;D++){const I=y[D][0],M=y[D][1];for(let g=-1;g<=7;g++)if(!(I+g<=-1||m<=I+g))for(let C=-1;C<=7;C++)M+C<=-1||m<=M+C||(g>=0&&g<=6&&(C===0||C===6)||C>=0&&C<=6&&(g===0||g===6)||g>=2&&g<=4&&C>=2&&C<=4?E.set(I+g,M+C,!0,!0):E.set(I+g,M+C,!1,!0))}}function S(E){const x=E.size;for(let m=8;m<x-8;m++){const y=m%2===0;E.set(m,6,y,!0),E.set(6,m,y,!0)}}function v(E,x){const m=o.getPositions(x);for(let y=0;y<m.length;y++){const D=m[y][0],I=m[y][1];for(let M=-2;M<=2;M++)for(let g=-2;g<=2;g++)M===-2||M===2||g===-2||g===2||M===0&&g===0?E.set(D+M,I+g,!0,!0):E.set(D+M,I+g,!1,!0)}}function A(E,x){const m=E.size,y=c.getEncodedBits(x);let D,I,M;for(let g=0;g<18;g++)D=Math.floor(g/3),I=g%3+m-8-3,M=(y>>g&1)===1,E.set(D,I,M,!0),E.set(I,D,M,!0)}function N(E,x,m){const y=E.size,D=u.getEncodedBits(x,m);let I,M;for(I=0;I<15;I++)M=(D>>I&1)===1,I<6?E.set(I,8,M,!0):I<8?E.set(I+1,8,M,!0):E.set(y-15+I,8,M,!0),I<8?E.set(8,y-I-1,M,!0):I<9?E.set(8,15-I-1+1,M,!0):E.set(8,15-I-1,M,!0);E.set(y-8,8,1,!0)}function k(E,x){const m=E.size;let y=-1,D=m-1,I=7,M=0;for(let g=m-1;g>0;g-=2)for(g===6&&g--;;){for(let C=0;C<2;C++)if(!E.isReserved(D,g-C)){let F=!1;M<x.length&&(F=(x[M]>>>I&1)===1),E.set(D,g-C,F),I--,I===-1&&(M++,I=7)}if(D+=y,D<0||m<=D){D-=y,y=-y;break}}}function R(E,x,m){const y=new n;m.forEach(function(C){y.put(C.mode.bit,4),y.put(C.getLength(),f.getCharCountIndicator(C.mode,E)),C.write(y)});const D=e.getSymbolTotalCodewords(E),I=l.getTotalCodewordsCount(E,x),M=(D-I)*8;for(y.getLengthInBits()+4<=M&&y.put(0,4);y.getLengthInBits()%8!==0;)y.putBit(0);const g=(M-y.getLengthInBits())/8;for(let C=0;C<g;C++)y.put(C%2?17:236,8);return w(y,E,x)}function w(E,x,m){const y=e.getSymbolTotalCodewords(x),D=l.getTotalCodewordsCount(x,m),I=y-D,M=l.getBlocksCount(x,m),g=y%M,C=M-g,F=Math.floor(y/M),_=Math.floor(I/M),U=_+1,j=F-_,B=new a(j);let J=0;const Z=new Array(M),G=new Array(M);let Y=0;const H=new Uint8Array(E.buffer);for(let K=0;K<M;K++){const O=K<C?_:U;Z[K]=H.slice(J,J+O),G[K]=B.encode(Z[K]),J+=O,Y=Math.max(Y,O)}const de=new Uint8Array(y);let ne=0,q,Q;for(q=0;q<Y;q++)for(Q=0;Q<M;Q++)q<Z[Q].length&&(de[ne++]=Z[Q][q]);for(q=0;q<j;q++)for(Q=0;Q<M;Q++)de[ne++]=G[Q][q];return de}function T(E,x,m,y){let D;if(Array.isArray(E))D=b.fromArray(E);else if(typeof E=="string"){let F=x;if(!F){const _=b.rawSplit(E);F=c.getBestVersionForData(_,m)}D=b.fromString(E,F||40)}else throw new Error("Invalid data");const I=c.getBestVersionForData(D,m);if(!I)throw new Error("The amount of data is too big to be stored in a QR Code");if(!x)x=I;else if(x<I)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+I+`.
`);const M=R(x,m,D),g=e.getSymbolSize(x),C=new r(g);return p(C,x),S(C),v(C,x),N(C,m,0),x>=7&&A(C,x),k(C,M),isNaN(y)&&(y=i.getBestMask(C,N.bind(null,C,m))),i.applyMask(y,C),N(C,m,y),{modules:C,version:x,errorCorrectionLevel:m,maskPattern:y,segments:D}}return $t.create=function(x,m){if(typeof x>"u"||x==="")throw new Error("No input text");let y=t.M,D,I;return typeof m<"u"&&(y=t.from(m.errorCorrectionLevel,t.M),D=c.from(m.version),I=i.from(m.maskPattern),m.toSJISFunc&&e.setToSJISFunction(m.toSJISFunc)),T(x,D,y,I)},$t}var un={},fn={},Pr;function Po(){return Pr||(Pr=1,function(e){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let r=n.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+n);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(s){return[s,s]}))),r.length===6&&r.push("F","F");const o=parseInt(r.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+r.slice(0,6).join("")}}e.getOptions=function(r){r||(r={}),r.color||(r.color={});const o=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,s=r.width&&r.width>=21?r.width:void 0,i=r.scale||4;return{width:s,scale:s?4:i,margin:o,color:{dark:t(r.color.dark||"#000000ff"),light:t(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},e.getScale=function(r,o){return o.width&&o.width>=r+o.margin*2?o.width/(r+o.margin*2):o.scale},e.getImageWidth=function(r,o){const s=e.getScale(r,o);return Math.floor((r+o.margin*2)*s)},e.qrToImageData=function(r,o,s){const i=o.modules.size,l=o.modules.data,a=e.getScale(i,s),c=Math.floor((i+s.margin*2)*a),u=s.margin*a,f=[s.color.light,s.color.dark];for(let b=0;b<c;b++)for(let p=0;p<c;p++){let S=(b*c+p)*4,v=s.color.light;if(b>=u&&p>=u&&b<c-u&&p<c-u){const A=Math.floor((b-u)/a),N=Math.floor((p-u)/a);v=f[l[A*i+N]?1:0]}r[S++]=v.r,r[S++]=v.g,r[S++]=v.b,r[S]=v.a}}}(fn)),fn}var Br;function na(){return Br||(Br=1,function(e){const t=Po();function n(o,s,i){o.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=i,s.width=i,s.style.height=i+"px",s.style.width=i+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(s,i,l){let a=l,c=i;typeof a>"u"&&(!i||!i.getContext)&&(a=i,i=void 0),i||(c=r()),a=t.getOptions(a);const u=t.getImageWidth(s.modules.size,a),f=c.getContext("2d"),b=f.createImageData(u,u);return t.qrToImageData(b.data,s,a),n(f,c,u),f.putImageData(b,0,0),c},e.renderToDataURL=function(s,i,l){let a=l;typeof a>"u"&&(!i||!i.getContext)&&(a=i,i=void 0),a||(a={});const c=e.render(s,i,a),u=a.type||"image/png",f=a.rendererOpts||{};return c.toDataURL(u,f.quality)}}(un)),un}var hn={},_r;function ra(){if(_r)return hn;_r=1;const e=Po();function t(o,s){const i=o.a/255,l=s+'="'+o.hex+'"';return i<1?l+" "+s+'-opacity="'+i.toFixed(2).slice(1)+'"':l}function n(o,s,i){let l=o+s;return typeof i<"u"&&(l+=" "+i),l}function r(o,s,i){let l="",a=0,c=!1,u=0;for(let f=0;f<o.length;f++){const b=Math.floor(f%s),p=Math.floor(f/s);!b&&!c&&(c=!0),o[f]?(u++,f>0&&b>0&&o[f-1]||(l+=c?n("M",b+i,.5+p+i):n("m",a,0),a=0,c=!1),b+1<s&&o[f+1]||(l+=n("h",u),u=0)):a++}return l}return hn.render=function(s,i,l){const a=e.getOptions(i),c=s.modules.size,u=s.modules.data,f=c+a.margin*2,b=a.color.light.a?"<path "+t(a.color.light,"fill")+' d="M0 0h'+f+"v"+f+'H0z"/>':"",p="<path "+t(a.color.dark,"stroke")+' d="'+r(u,c,a.margin)+'"/>',S='viewBox="0 0 '+f+" "+f+'"',A='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+S+' shape-rendering="crispEdges">'+b+p+`</svg>
`;return typeof l=="function"&&l(null,A),A},hn}var zr;function oa(){if(zr)return Ge;zr=1;const e=zi(),t=ta(),n=na(),r=ra();function o(s,i,l,a,c){const u=[].slice.call(arguments,1),f=u.length,b=typeof u[f-1]=="function";if(!b&&!e())throw new Error("Callback required as last argument");if(b){if(f<2)throw new Error("Too few arguments provided");f===2?(c=l,l=i,i=a=void 0):f===3&&(i.getContext&&typeof c>"u"?(c=a,a=void 0):(c=a,a=l,l=i,i=void 0))}else{if(f<1)throw new Error("Too few arguments provided");return f===1?(l=i,i=a=void 0):f===2&&!i.getContext&&(a=l,l=i,i=void 0),new Promise(function(p,S){try{const v=t.create(l,a);p(s(v,i,a))}catch(v){S(v)}})}try{const p=t.create(l,a);c(null,s(p,i,a))}catch(p){c(p)}}return Ge.create=t.create,Ge.toCanvas=o.bind(null,n.render),Ge.toDataURL=o.bind(null,n.renderToDataURL),Ge.toString=o.bind(null,function(s,i,l){return r.render(s,l)}),Ge}var sa=oa();const ia=Cs(sa);async function Fr(e,t=512,n=1){const r={errorCorrectionLevel:"M",type:"image/png",margin:n,width:t,color:{dark:"#000000",light:"#ffffff"}};return ia.toDataURL(e,r)}const Dn=(()=>{const e=W.get().DEFAULTS?.BACKGROUND;return{color:typeof e?.color=="string"?e.color:"#ffffff",alpha:Math.max(0,Math.min(1,typeof e?.alpha=="number"?e.alpha:1))}})(),Qe={scale:1,tx:0,ty:0},gn=(e,t,n)=>Math.max(t,Math.min(n,e)),Ae=(e,t)=>typeof e=="number"?e:t;function aa(e){return new Promise((t,n)=>{const r=new Image;r.onload=()=>t({w:r.naturalWidth,h:r.naturalHeight}),r.onerror=n,r.src=e})}function la(e,t,n,r,o,s,i=1){const l=n/e,a=n/t,c=(r==="cover"?Math.max(l,a):Math.min(l,a))*i,u=e*c,f=t*c,b=o==="left"?0:o==="right"?n-u:(n-u)/2,p=s==="top"?0:s==="bottom"?n-f:(n-f)/2,S=(b-(n-u)/2)/n*100,v=(p-(n-f)/2)/n*100;return{tx:Math.max(-100,Math.min(100,S)),ty:Math.max(-100,Math.min(100,v))}}const $=Es((e,t)=>({photos:[],max:Li,transforms:{},layersByPhoto:{},cardBackground:{},setCardBackground:(n,r)=>e(o=>{const s=o.cardBackground[n]??Dn,i={color:r.color??s.color,alpha:Math.max(0,Math.min(1,r.alpha??s.alpha))};return{cardBackground:{...o.cardBackground,[n]:i}}}),setTransform:(n,r)=>e(o=>{const s=o.transforms[n]??Qe,i={scale:gn(r.scale??s.scale,.5,4),tx:gn(r.tx??s.tx,-100,100),ty:gn(r.ty??s.ty,-100,100)};return{transforms:{...o.transforms,[n]:i}}}),resetTransform:n=>e(r=>{const{[n]:o,...s}=r.transforms;return{transforms:s}}),add:n=>{if(!n?.length)return;const{photos:r,max:o}=t(),s=Math.max(0,o-r.length);if(!s)return;const i=n.slice(0,s);e({photos:[...r,...i]});const l=W.get().DEFAULT_CARD_LAYERS??[];if(l.length){for(const a of i)for(const c of l)if(c?.type==="text"){const u=Ae(c.y,ce-140);t().addTextLayer(a.id,{x:typeof c.x=="number"?c.x:40,y:u,text:typeof c.text=="string"?c.text:void 0,fontFamily:typeof c.fontFamily=="string"?c.fontFamily:void 0,fontSize:typeof c.fontSize=="number"?c.fontSize:void 0,fontStyle:typeof c.fontStyle=="string"?c.fontStyle:void 0,fill:typeof c.fill=="string"?c.fill:void 0,align:["left","center","right"].includes(c.align)?c.align:void 0,lineHeight:typeof c.lineHeight=="number"?c.lineHeight:void 0,letterSpacing:typeof c.letterSpacing=="number"?c.letterSpacing:void 0,width:typeof c.width=="number"?c.width:void 0})}else if(c?.type==="rect"){const u=Ae(c.y,40);t().addRectLayer(a.id,{x:typeof c.x=="number"?c.x:40,y:u,width:typeof c.width=="number"?c.width:void 0,height:typeof c.height=="number"?c.height:void 0,fill:typeof c.fill=="string"?c.fill:void 0,stroke:typeof c.stroke=="string"?c.stroke:void 0,strokeWidth:typeof c.strokeWidth=="number"?c.strokeWidth:void 0,cornerRadius:typeof c.cornerRadius=="number"?c.cornerRadius:void 0,opacity:typeof c.opacity=="number"?c.opacity:void 0})}else if(c?.type==="qr"){const u=Ae(c.y,40),f=Math.max(1,Math.round(typeof c.size=="number"?c.size:512));(async()=>{await t().addQrLayer(a.id,typeof c.text=="string"?c.text:"",f);const b=t().layersByPhoto[a.id]??[],p=b[b.length-1];p&&p.type==="image"&&t().updateLayer(a.id,p.id,{x:typeof c.x=="number"?c.x:40,y:u})})()}}for(const a of i)(async()=>{try{const{w:c,h:u}=await aa(a.url),f=W.get(),b=Math.max(0,Number(f.NEAR_SQUARE_TOLERANCE??0)),p=Number(f.NEAR_SQUARE_SCALE??1),S=En==="contain",v=c/u,A=Math.abs(v-1)<=b,N=S&&A?p:1,{tx:k,ty:R}=la(c,u,ce,En,Bi,_i,N);t().setTransform(a.id,{tx:k,ty:R,scale:Math.max(.5,Math.min(4,Qe.scale*N))});const w=W.get().LAYER_PROFILES?.orientation;if(w&&w.on!==!1){let T;v>1+b?T="landscape":v<1-b?T="portrait":T="square";const E=T==="landscape"?w.landscape??[]:T==="portrait"?w.portrait??[]:w.square??[];for(const x of E)if(!(!x||typeof x!="object")){if(x.type==="text"){const m=Ae(x.y,ce-140);t().addTextLayer(a.id,{x:typeof x.x=="number"?x.x:40,y:m,text:typeof x.text=="string"?x.text:void 0,fontFamily:typeof x.fontFamily=="string"?x.fontFamily:void 0,fontSize:typeof x.fontSize=="number"?x.fontSize:void 0,fontStyle:typeof x.fontStyle=="string"?x.fontStyle:void 0,fill:typeof x.fill=="string"?x.fill:void 0,align:["left","center","right"].includes(x.align)?x.align:void 0,lineHeight:typeof x.lineHeight=="number"?x.lineHeight:void 0,letterSpacing:typeof x.letterSpacing=="number"?x.letterSpacing:void 0,width:typeof x.width=="number"?x.width:void 0,padding:typeof x.padding=="number"?x.padding:void 0})}else if(x.type==="rect"){const m=Ae(x.y,40);t().addRectLayer(a.id,{x:typeof x.x=="number"?x.x:40,y:m,width:typeof x.width=="number"?x.width:void 0,height:typeof x.height=="number"?x.height:void 0,fill:typeof x.fill=="string"?x.fill:void 0,stroke:typeof x.stroke=="string"?x.stroke:void 0,strokeWidth:typeof x.strokeWidth=="number"?x.strokeWidth:void 0,cornerRadius:typeof x.cornerRadius=="number"?x.cornerRadius:void 0,opacity:typeof x.opacity=="number"?x.opacity:void 0})}else if(x.type==="qr"){const m=Ae(x.y,40),y=Math.max(1,Math.round(typeof x.size=="number"?x.size:512)),D=await t().addQrLayer(a.id,typeof x.text=="string"?x.text:"",y);t().updateLayer(a.id,D,{x:typeof x.x=="number"?x.x:40,y:m})}}}}catch{}})()},clear:()=>{const n=t().photos;n.length&&cr(n),e({photos:[],transforms:{},layersByPhoto:{},cardBackground:{}})},remove:n=>e(r=>{const o=r.photos.findIndex(a=>a.id===n);if(o===-1)return null;cr([r.photos[o]]);const{[n]:s,...i}=r.transforms,l={...r.layersByPhoto};return delete l[n],{photos:r.photos.filter(a=>a.id!==n),transforms:i,layersByPhoto:l}}),addTextLayer:(n,r={})=>{const o=crypto.randomUUID();return e(s=>{const i=s.layersByPhoto[n]??[],l=i.length?Math.max(...i.map(S=>S.z))+1:1,a={...r};delete a.id,delete a.type,delete a.z;const c=typeof a.y=="number"?a.y:void 0;"y"in a&&delete a.y;const u=W.get().DEFAULTS?.TEXT??{},f=Ae(u.y,ce-140),b=c??f,p={id:o,type:"text",x:typeof u.x=="number"?u.x:40,y:b,rotation:0,scaleX:1,scaleY:1,visible:!0,z:l,text:typeof u.text=="string"?u.text:"New text",fontFamily:typeof u.fontFamily=="string"?u.fontFamily:"Georgia, serif",fontSize:typeof u.fontSize=="number"?u.fontSize:36,fontStyle:typeof u.fontStyle=="string"?u.fontStyle:"",fill:typeof u.fill=="string"?u.fill:"#111",align:["left","center","right"].includes(u.align)?u.align:"left",verticalAlign:["top","middle","bottom"].includes(u.verticalAlign)?u.verticalAlign:"top",padding:typeof u.padding=="number"?u.padding:0,lineHeight:typeof u.lineHeight=="number"?u.lineHeight:1.25,letterSpacing:typeof u.letterSpacing=="number"?u.letterSpacing:0,width:typeof u.width=="number"?u.width:void 0,...a};return{layersByPhoto:{...s.layersByPhoto,[n]:[...i,p]}}}),o},addRectLayer:(n,r={})=>{const o=crypto.randomUUID();return e(s=>{const i=s.layersByPhoto[n]??[],l=i.length?Math.max(...i.map(S=>S.z))+1:1,a={...r};delete a.id,delete a.type,delete a.z;const c=typeof a.y=="number"?a.y:void 0;"y"in a&&delete a.y;const u=W.get().DEFAULTS?.RECT??{},f=Ae(u.y,40),b=c??f,p={id:o,type:"rect",x:typeof u.x=="number"?u.x:40,y:b,rotation:0,scaleX:1,scaleY:1,visible:!0,z:l,width:typeof u.width=="number"?u.width:600,height:typeof u.height=="number"?u.height:300,fill:typeof u.fill=="string"?u.fill:"#ffffff",stroke:typeof u.stroke=="string"?u.stroke:void 0,strokeWidth:typeof u.strokeWidth=="number"?u.strokeWidth:0,cornerRadius:typeof u.cornerRadius=="number"?u.cornerRadius:0,opacity:typeof u.opacity=="number"?u.opacity:1,...a};return{layersByPhoto:{...s.layersByPhoto,[n]:[...i,p]}}}),o},addImageLayer:(n,r={})=>{const o=crypto.randomUUID();return e(s=>{const i=s.layersByPhoto[n]??[],l=i.length?Math.max(...i.map(S=>S.z))+1:1,a={...r};delete a.id,delete a.type,delete a.z;const c=typeof a.y=="number"?a.y:void 0;"y"in a&&delete a.y;const u=W.get().DEFAULTS?.IMAGE??{},f=Ae(u.y,40),b=c??f,p={id:o,type:"image",x:typeof u.x=="number"?u.x:40,y:b,rotation:0,scaleX:1,scaleY:1,visible:!0,z:l,src:"",w:typeof u.w=="number"?u.w:void 0,h:typeof u.h=="number"?u.h:void 0,...a};return{layersByPhoto:{...s.layersByPhoto,[n]:[...i,p]}}}),o},addQrLayer:async(n,r,o=512)=>{const s=W.get().DEFAULTS?.QR??{},i=Math.max(1,Math.round(typeof o=="number"?o:s.size??512)),l=await Fr(r,i,1);return t().addImageLayer(n,{src:l,x:typeof s.x=="number"?s.x:40,y:typeof s.y=="number"?s.y:40,w:i,h:i,qrText:r})},updateQrLayer:async(n,r,o)=>{const i=t().layersByPhoto[n]??[],l=i.findIndex(b=>b.id===r&&b.type==="image");if(l===-1)return;const a=i[l];if(!a.qrText&&!o.text)return;const c=o.text??a.qrText??"",u=Math.max(1,Math.round(o.size??a.w??a.h??512)),f=await Fr(c,u,1);t().updateLayer(n,r,{src:f,w:u,h:u,...c?{qrText:c}:{}})},updateLayer:(n,r,o)=>e(s=>{const i=s.layersByPhoto[n]??[],l=i.findIndex(b=>b.id===r);if(l===-1)return null;const a=i[l],c={...o};delete c.id,delete c.type;const u={...a,...c},f=[...i];return f[l]=u,{layersByPhoto:{...s.layersByPhoto,[n]:f}}}),removeLayer:(n,r)=>e(o=>{const s=o.layersByPhoto[n]??[],i=s.filter(l=>l.id!==r);return i===s?null:{layersByPhoto:{...o.layersByPhoto,[n]:i}}}),bringToFront:(n,r)=>e(o=>{const s=o.layersByPhoto[n]??[];if(!s.length)return null;const i=Math.max(...s.map(a=>a.z)),l=s.map(a=>a.id===r?{...a,z:i+1}:a);return{layersByPhoto:{...o.layersByPhoto,[n]:l}}}),sendToBack:(n,r)=>e(o=>{const s=o.layersByPhoto[n]??[];if(!s.length)return null;const i=Math.min(...s.map(a=>a.z)),l=s.map(a=>a.id===r?{...a,z:i-1}:a);return{layersByPhoto:{...o.layersByPhoto,[n]:l}}}),setLayersOrder:(n,r)=>e(o=>{const s=o.layersByPhoto[n]??[];if(!s.length)return null;const i=new Map(s.map(c=>[c.id,c])),l=[];let a=1;for(const c of r){const u=i.get(c);u&&l.push({...u,z:a++})}for(const c of s)r.includes(c.id)||l.push({...c,z:a++});return{layersByPhoto:{...o.layersByPhoto,[n]:l}}}),reorderPhotos:n=>e(r=>{if(!Array.isArray(n)||!n.length)return null;const o=new Map(r.photos.map(i=>[i.id,i])),s=n.map(i=>o.get(i)).filter(Boolean);for(const i of r.photos)n.includes(i.id)||s.push(i);return{photos:s}})}));function ca(e){const t=e.replace(/^\uFEFF/,"").replace(/\r\n?/g,`
`).split(`
`).filter(Boolean);if(!t.length)return{rows:[],hasRelative:!1};const n=t[0].toLowerCase(),r=n.includes(";")&&!n.includes(",")?";":",",o=[],s=new RegExp(`\\s*(?:"([^"]*)"|([^${r}\\n]*))\\s*(?:${r}|$)`,"g");for(const l of t){const a=[];s.lastIndex=0;let c,u=0;for(;(c=s.exec(l))&&u++<1e3;){const p=(c[1]??c[2]??"").trim();if(a.push(p),c.index+c[0].length>=l.length)break}if(!a.length)continue;const f=(a[0]??"").trim();if(!f)continue;const b=(a[1]??"").trim()||void 0;o.push({url:f,caption:b})}o.length&&o[0].url.trim().toLowerCase()==="url"&&o.shift();const i=o.some(l=>da(l.url));return{rows:o,hasRelative:i}}function Bo(e){return/^https?:\/\//i.test(e)}function _o(e){return/^data:/i.test(e)}function da(e){return!(Bo(e)||_o(e)||/^blob:/.test(e))}function ua(){const e=h.useRef(null),t=ae.useRef(null),n=$(f=>f.photos),r=$(f=>f.max),o=$(f=>f.add),s=$(f=>f.clear),i=Math.max(0,r-n.length),l=h.useCallback(f=>{if(!f?.length)return;const b=Array.from(f).slice(0,i),p=Mi(b,i);o(p)},[o,i]),a=h.useCallback(f=>{l(f.target.files),f.target.value=""},[l]);async function c(f){const b=f.target.files?.[0];if(!b)return;const p=await b.text();f.target.value="";const{rows:S,hasRelative:v}=ca(p);if(S.length){if(v){alert("В этом CSV есть относительные пути. В текущей сборке локальная папка не поддерживается. Пожалуйста, используйте полные URL (http/https) или добавьте изображения кнопкой “Choose images”.");return}await u(S)}}async function u(f,b){const p=$.getState().add,S=[];let v=0,A=0;for(const N of f)try{let k=null,R="image";if(Bo(N.url)){const E=await fetch(N.url,{mode:"cors"});if(!E.ok)throw new Error(`HTTP ${E.status}`);k=await E.blob(),R=N.url.split("/").pop()||R}else if(_o(N.url))k=await(await fetch(N.url)).blob(),R="data.png";else throw new Error("Relative paths are disabled in this build");const w=URL.createObjectURL(k),T=crypto.randomUUID();S.push({id:T,url:w,name:R}),v++}catch(k){console.warn("CSV import skip:",N.url,k),A++}p(S),A&&alert(`CSV import: added ${v}, skipped ${A}`)}return d.jsx("section",{className:"mt-4 space-y-4",children:d.jsxs("div",{className:"flex items-center justify-between gap-2",children:[d.jsxs("div",{className:"text-sm opacity-80",children:["Cards: ",d.jsx("b",{children:n.length})," / ",r]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{ref:e,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:a}),d.jsx("input",{ref:t,type:"file",accept:".csv,text/csv",className:"hidden",onChange:c}),d.jsx("button",{onClick:()=>t.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Import CSV"}),d.jsx("button",{onClick:()=>e.current?.click(),className:"rounded-md bg-background/80 px-3 py-2 text-sm shadow hover:bg-background",children:"Choose images"}),d.jsx(re,{variant:"destructive",onClick:s,disabled:!n.length,children:"Clear"})]})]})})}const zo=h.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:X("rounded-xl border bg-card text-card-foreground shadow",e),...t}));zo.displayName="Card";const fa=h.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:X("flex flex-col space-y-1.5 p-6",e),...t}));fa.displayName="CardHeader";const ha=h.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:X("font-semibold leading-none tracking-tight",e),...t}));ha.displayName="CardTitle";const ga=h.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:X("text-sm text-muted-foreground",e),...t}));ga.displayName="CardDescription";const ma=h.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:X("p-6 pt-0",e),...t}));ma.displayName="CardContent";const pa=h.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:X("flex items-center p-6 pt-0",e),...t}));pa.displayName="CardFooter";const Fo=h.forwardRef(({className:e,value:t,...n},r)=>d.jsx(ro,{ref:r,className:X("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...n,children:d.jsx(Ms,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Fo.displayName=ro.displayName;const Oo=zs,Uo=Fs,Mn=h.forwardRef(({className:e,children:t,...n},r)=>d.jsxs(oo,{ref:r,className:X("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,d.jsx(js,{asChild:!0,children:d.jsx(eo,{className:"h-4 w-4 opacity-50"})})]}));Mn.displayName=oo.displayName;const qo=h.forwardRef(({className:e,...t},n)=>d.jsx(so,{ref:n,className:X("flex cursor-default items-center justify-center py-1",e),...t,children:d.jsx(Rs,{className:"h-4 w-4"})}));qo.displayName=so.displayName;const Yo=h.forwardRef(({className:e,...t},n)=>d.jsx(io,{ref:n,className:X("flex cursor-default items-center justify-center py-1",e),...t,children:d.jsx(eo,{className:"h-4 w-4"})}));Yo.displayName=io.displayName;const jn=h.forwardRef(({className:e,children:t,position:n="popper",...r},o)=>d.jsx(Ls,{children:d.jsxs(ao,{ref:o,className:X("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[d.jsx(qo,{}),d.jsx(Ps,{className:X("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),d.jsx(Yo,{})]})}));jn.displayName=ao.displayName;const ba=h.forwardRef(({className:e,...t},n)=>d.jsx(lo,{ref:n,className:X("px-2 py-1.5 text-sm font-semibold",e),...t}));ba.displayName=lo.displayName;const Xe=h.forwardRef(({className:e,children:t,...n},r)=>d.jsxs(co,{ref:r,className:X("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[d.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsx(Bs,{children:d.jsx(Ss,{className:"h-4 w-4"})})}),d.jsx(_s,{children:t})]}));Xe.displayName=co.displayName;const ya=h.forwardRef(({className:e,...t},n)=>d.jsx(uo,{ref:n,className:X("-mx-1 my-1 h-px bg-muted",e),...t}));ya.displayName=uo.displayName;const xa=[];function Vo(e,t=""){const[n,r]=h.useState(null),[o,s]=h.useState("idle");return h.useEffect(()=>{if(!e){r(null),s("idle");return}let i=!1;const l=new Image;return t&&(l.crossOrigin=t),s("loading"),l.onload=()=>{i||(r(l),s("loaded"))},l.onerror=()=>{i||(r(null),s("failed"))},l.src=e,()=>{i=!0}},[e,t]),[n,o]}function va({layer:e,k:t,onSelect:n,updateLayer:r,selectedId:o}){const[s]=Vo(e.src||"","anonymous"),i=o===e.id,l=h.useRef(null),a=e.x*t,c=e.y*t,u=s?.naturalWidth??0,f=s?.naturalHeight??0,b=Math.max(1,e.w?e.w*t:u*t||1),p=Math.max(1,e.h?e.h*t:f*t||1);return d.jsx(to,{ref:i?l:void 0,draggable:!0,image:s??void 0,x:a,y:c,width:b,height:p,rotation:e.rotation,visible:e.visible,onMouseDown:()=>n(e.id),onTap:()=>n(e.id),onDragEnd:S=>{r(e.photoId,e.id,{x:S.target.x()/t,y:S.target.y()/t})},onTransformEnd:S=>{const v=S.target,A=typeof v.scaleX=="function"?v.scaleX():1,N=typeof v.scaleY=="function"?v.scaleY():1,k=typeof v.width=="function"?v.width():b,R=typeof v.height=="function"?v.height():p,w={x:v.x()/t,y:v.y()/t,rotation:v.rotation(),scaleX:1,scaleY:1,w:Math.max(1,Math.round(k*A/t)),h:Math.max(1,Math.round(R*N/t))};typeof v.scaleX=="function"&&v.scaleX(1),typeof v.scaleY=="function"&&v.scaleY(1),r(e.photoId,e.id,w)}},e.id)}const jt=h.forwardRef(function({photoId:t,size:n,selectedId:r,onSelect:o,transformOverride:s},i){const a=h.useRef(null),c=$(m=>m.photos.find(y=>y.id===t)?.url),u=$(m=>m.transforms[t]??Qe),f=s??u,b=$(m=>m.layersByPhoto[t]??xa,Object.is).map(m=>({...m,photoId:t})),p=$(m=>m.updateLayer),S=$(m=>m.cardBackground?.[t]??Dn,Object.is),[v,A]=Vo(c??"","anonymous"),N=A==="loaded";h.useImperativeHandle(i,()=>({toDataURL:m=>{const y=a.current;if(!y)return null;const D=m&&m>0?m/n:1;return y.toDataURL({pixelRatio:D,mimeType:"image/png"})},isReady:()=>!!a.current&&N}));const k=h.useRef(null),R=h.useRef(null);h.useEffect(()=>{const m=k.current,y=R.current;m&&y&&r&&(m.nodes([y]),m.getLayer()?.batchDraw())},[r]);const w=n/ce,T=h.useMemo(()=>b.find(m=>m.id===r),[b,r]),E=!!(T?.type==="image"&&T?.qrText);function x(m,y,D,I){const M=y/m.width,g=y/m.height,F=(D==="cover"?Math.max(M,g):Math.min(M,g))*(I?.scale??1),_=m.width*F,U=m.height*F,j=(y-_)/2+(I?.tx??0)/100*y,B=(y-U)/2+(I?.ty??0)/100*y;return{x:j*w,y:B*w,width:_*w,height:U*w}}return d.jsx(Ns,{ref:a,width:n,height:n,pixelRatio:1,listening:!0,style:{width:"100%",height:"100%"},onMouseDown:m=>{m.target===m.target.getStage()&&o(null)},onTouchStart:m=>{m.target===m.target.getStage()&&o(null)},children:d.jsxs(As,{children:[d.jsx(nr,{x:0,y:0,width:n,height:n,fill:S.color,opacity:S.alpha,listening:!1}),v?d.jsx(to,{image:v,...x(v,ce,En,f),listening:!1}):null,b.slice().sort((m,y)=>m.z-y.z).map(m=>{if(m.type==="text"){const y=m,I=r===y.id?R:void 0,M=y.x*w,g=y.y*w,C=(y.fontSize??16)*w,F=y.width?y.width*w:void 0,_=(y.padding??0)*w,U=(y.letterSpacing??0)*w;return d.jsx(ks,{ref:I,draggable:!0,x:M,y:g,text:y.text,fontFamily:y.fontFamily||"Georgia, serif",fontSize:C,fontStyle:y.fontStyle,fill:y.fill,width:F,align:y.align,lineHeight:y.lineHeight??1.25,padding:_,letterSpacing:U,rotation:y.rotation,scaleX:1,scaleY:1,visible:y.visible,perfectDrawEnabled:!1,onTransform:j=>{const B=j.target,J=typeof B.scaleX=="function"?B.scaleX():1,Z=typeof B.width=="function"?B.width():void 0;Z!==void 0&&J&&J!==1&&(B.width(Math.max(4,Math.round(Z*J))),typeof B.scaleX=="function"&&B.scaleX(1),typeof B.scaleY=="function"&&B.scaleY(1),B.getLayer()?.batchDraw())},onMouseDown:()=>o(y.id),onTap:()=>o(y.id),onDragEnd:j=>{p(t,y.id,{x:j.target.x()/w,y:j.target.y()/w})},onTransformEnd:j=>{const B=j.target,J=typeof B.scaleX=="function"?B.scaleX():1,Z=typeof B.width=="function"?B.width():void 0,G={x:B.x()/w,y:B.y()/w,rotation:B.rotation(),scaleX:1,scaleY:1,width:Z!==void 0?Math.max(4,Math.round(Z*J/w)):void 0};typeof B.scaleX=="function"&&B.scaleX(1),typeof B.scaleY=="function"&&B.scaleY(1),p(t,y.id,G)}},y.id)}if(m.type==="rect"){const y=m,I=r===y.id?R:void 0,M=y.x*w,g=y.y*w,C=Math.max(1,(y.width??100)*w),F=Math.max(1,(y.height??100)*w),_=Math.max(0,(y.strokeWidth??0)*w),U=Math.max(0,(y.cornerRadius??0)*w);return d.jsx(nr,{ref:I,draggable:!0,x:M,y:g,width:C,height:F,rotation:y.rotation,fill:y.fill??"#ffffff",stroke:y.stroke,strokeWidth:_,cornerRadius:U,visible:y.visible,opacity:Math.max(0,Math.min(1,y.opacity??1)),onMouseDown:()=>o(y.id),onTap:()=>o(y.id),onDragEnd:j=>{p(t,y.id,{x:j.target.x()/w,y:j.target.y()/w})},onTransformEnd:j=>{const B=j.target,J=typeof B.scaleX=="function"?B.scaleX():1,Z=typeof B.scaleY=="function"?B.scaleY():1,G=typeof B.width=="function"?B.width():C,Y=typeof B.height=="function"?B.height():F,H={x:B.x()/w,y:B.y()/w,rotation:B.rotation(),scaleX:1,scaleY:1,width:Math.max(1,Math.round(G*J/w)),height:Math.max(1,Math.round(Y*Z/w))};typeof B.scaleX=="function"&&B.scaleX(1),typeof B.scaleY=="function"&&B.scaleY(1),p(t,y.id,H)}},y.id)}return m.type==="image"?d.jsx(va,{layer:m,k:w,selectedId:r,onSelect:o,updateLayer:p},m.id):null}),r&&d.jsx(Is,{ref:k,rotateEnabled:!0,enabledAnchors:["middle-left","middle-right","top-center","bottom-center","top-left","top-right","bottom-left","bottom-right"],borderStroke:"#fff",anchorStroke:"#fff",anchorFill:"#111",anchorSize:7,keepRatio:E,centeredScaling:!1,boundBoxFunc:(m,y)=>{const I=Math.max(6,y.width),M=Math.max(6,y.height);return{...y,width:I,height:M}}})]})})}),$o=qs,wa=Os,Go=h.forwardRef(({className:e,...t},n)=>d.jsx(fo,{ref:n,className:X("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));Go.displayName=fo.displayName;const Ln=h.forwardRef(({className:e,children:t,...n},r)=>d.jsxs(wa,{children:[d.jsx(Go,{}),d.jsxs(ho,{ref:r,className:X("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,d.jsxs(Us,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[d.jsx(Ts,{className:"h-4 w-4"}),d.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ln.displayName=ho.displayName;const Pn=({className:e,...t})=>d.jsx("div",{className:X("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Pn.displayName="DialogHeader";const Bn=({className:e,...t})=>d.jsx("div",{className:X("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Bn.displayName="DialogFooter";const _n=h.forwardRef(({className:e,...t},n)=>d.jsx(go,{ref:n,className:X("text-lg font-semibold leading-none tracking-tight",e),...t}));_n.displayName=go.displayName;const Ho=h.forwardRef(({className:e,...t},n)=>d.jsx(mo,{ref:n,className:X("text-sm text-muted-foreground",e),...t}));Ho.displayName=mo.displayName;const Ca=vo("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),He=h.forwardRef(({className:e,...t},n)=>d.jsx(po,{ref:n,className:X(Ca(),e),...t}));He.displayName=po.displayName;const Nt=h.forwardRef(({className:e,...t},n)=>d.jsxs(bo,{ref:n,className:X("relative flex w-full touch-none select-none items-center",e),...t,children:[d.jsx(Ys,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:d.jsx(Vs,{className:"absolute h-full bg-primary"})}),d.jsx($s,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Nt.displayName=bo.displayName;const mn=new Map;function kt(e){const t=e.trim();if(t.startsWith('"')){const n=t.indexOf('"',1);return n>1?t.slice(1,n):t.replace(/["']/g,"")}return t.split(",")[0].replace(/["']/g,"").trim()}function Ea(e){const t=kt(e);return Do.find(n=>kt(n.family).toLowerCase()===t.toLowerCase())}function Ra(e,t){if(document.getElementById(t))return;const n=document.createElement("link");n.id=t,n.rel="stylesheet",n.href=e;const r=document.createElement("link");r.rel="preconnect",r.href="https://fonts.googleapis.com";const o=document.createElement("link");o.rel="preconnect",o.href="https://fonts.gstatic.com",o.crossOrigin="anonymous",document.head.appendChild(r),document.head.appendChild(o),document.head.appendChild(n)}function Sa(e){const t=kt(e);if(mn.has(t))return mn.get(t);const n=(async()=>{const r=Ea(e);r&&r.cssHref&&Ra(r.cssHref,`font-css-${r.id}`);try{const o=document;o?.fonts?.ready&&typeof o.fonts.ready.then=="function"&&await o.fonts.ready}catch{}try{document.fonts?.load&&await document.fonts.load(`1em ${kt(e)}`)}catch{}})();return mn.set(t,n),n}const Na=[],Rt="__none__";function Aa({photoId:e,layer:t}){const n=$(l=>l.updateQrLayer),[r,o]=h.useState(t.qrText??""),[s,i]=h.useState(Math.max(1,Math.round(t.w??t.h??512)));return h.useEffect(()=>{o(t.qrText??""),i(Math.max(1,Math.round(t.w??t.h??512)))},[t.id,t.qrText,t.w,t.h]),d.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-foreground/10",children:"QR"}),d.jsx("span",{className:"opacity-70 text-sm",children:"This layer is a QR code"})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d.jsx("label",{className:"text-xs opacity-70",children:"QR text / URL"}),d.jsx("input",{type:"text",value:r,onChange:l=>o(l.target.value),className:"flex-1 min-w-[16rem] rounded border px-2 py-1 text-sm",placeholder:"https://example.com"}),d.jsx("label",{className:"text-xs opacity-70",children:"Size (px)"}),d.jsx("input",{type:"number",min:1,max:ce,step:1,value:s,onChange:l=>i(Math.max(1,Number(l.target.value)||1)),className:"w-28 rounded border px-2 py-1 text-sm",title:"QR side size in card pixels"}),d.jsx(re,{variant:"secondary",onClick:async()=>{await n(e,t.id,{text:r.trim(),size:s})},children:"Update QR"})]})]})}function ka({open:e,onOpenChange:t,photo:n,canvasRef:r}){const o=$(g=>g.addTextLayer),s=$(g=>g.addRectLayer),i=$(g=>g.addQrLayer),l=$(g=>g.transforms[n.id]??Qe),a=$(g=>g.setTransform),[c,u]=h.useState(l),[f,b]=h.useState(null),p=$(g=>g.updateLayer),S=$(g=>g.removeLayer),v=$(g=>g.bringToFront),A=$(g=>g.sendToBack),N=$(g=>g.layersByPhoto[n.id]??Na,Object.is),k=h.useRef(null),R=r??k,w=$(g=>g.cardBackground?.[n.id]??Dn,Object.is),T=$(g=>g.setCardBackground),E=(g,C)=>g.scale===C.scale&&g.tx===C.tx&&g.ty===C.ty,x=h.useRef(l);h.useEffect(()=>{e&&(x.current=l,u(l))},[e,l]);const m=h.useRef(null),[y,D]=h.useState(0),I=h.useCallback(()=>{const g=m.current;if(!g)return;const C=Math.round(g.clientWidth);C&&D(C)},[]);h.useEffect(()=>{const g=m.current;if(!g)return;const C=new ResizeObserver(I);return C.observe(g),I(),()=>C.disconnect()},[I]),h.useEffect(()=>{e&&(requestAnimationFrame(I),setTimeout(I,50))},[e,I]);const M=h.useCallback((g,C)=>{const F=g.id.slice(0,6);let _="Layer";return g.type==="text"?_="Text":g.type==="rect"?_="Rect":g.type==="image"&&g.qrText?_="QR":g.type==="image"&&(_="Image"),`${_} #${C+1} (${F})`},[]);return h.useEffect(()=>{if(!f)return;(N??[]).some(C=>C.id===f)||b(null)},[N,f]),d.jsx($o,{open:e,onOpenChange:t,children:d.jsxs(Ln,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden flex flex-col",children:[d.jsxs(Pn,{className:"shrink-0",children:[d.jsx(_n,{children:"Edit card"}),d.jsx(Ho,{className:"sr-only",children:"Adjust zoom/position and edit layers."})]}),d.jsx("div",{className:"flex-1 overflow-auto",children:d.jsxs("div",{className:"grid gap-4",children:[d.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:d.jsx("div",{className:"relative aspect-square overflow-hidden rounded-xl",ref:m,children:y>0&&d.jsx("div",{className:"absolute inset-0 pointer-events-auto z-0",children:d.jsx(jt,{"data-dnd-ignore":!0,ref:R,photoId:n.id,size:y,selectedId:f,onSelect:b,transformOverride:c})})})}),d.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(He,{className:"whitespace-nowrap",children:"Layers"}),d.jsxs(Oo,{value:f??Rt,onValueChange:g=>b(g===Rt?null:g),children:[d.jsx(Mn,{className:"w-[18rem]",children:d.jsx(Uo,{placeholder:N.length?"Select a layer…":"No layers"})}),d.jsx(jn,{children:N.length===0?d.jsx(Xe,{value:Rt,disabled:!0,children:"No layers"}):d.jsxs(d.Fragment,{children:[d.jsx(Xe,{value:Rt,disabled:!0,children:"Select a layer…"}),N.slice().sort((g,C)=>g.z-C.z).map((g,C)=>d.jsx(Xe,{value:g.id,children:M(g,C)},g.id))]})})]}),d.jsx("div",{className:"ml-auto"})]})}),f&&(()=>{const g=N.find(C=>C.id===f&&C.type==="text");return g?d.jsxs("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:[d.jsx("label",{className:"text-xs opacity-70",children:"Text"}),d.jsx("textarea",{value:g.text,onChange:C=>p(n.id,g.id,{text:C.target.value}),rows:3,className:"resize-y w-full rounded border px-2 py-1 text-sm bg-background"}),d.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[d.jsx("label",{className:"text-xs opacity-70",children:"Size"}),d.jsx("input",{type:"number",min:8,max:240,step:1,value:g.fontSize??36,onChange:C=>p(n.id,g.id,{fontSize:Number(C.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),d.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${g.fontStyle?.includes("bold")?"bg-foreground/10":""}`,onClick:()=>{const C=g.fontStyle?.includes("bold"),_=`${g.fontStyle?.includes("italic")?"italic":""} ${C?"":"bold"}`.trim();p(n.id,g.id,{fontStyle:_})},children:"Bold"}),d.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${g.fontStyle?.includes("italic")?"bg-foreground/10":""}`,onClick:()=>{const C=g.fontStyle?.includes("bold"),_=`${g.fontStyle?.includes("italic")?"":"italic"} ${C?"bold":""}`.trim();p(n.id,g.id,{fontStyle:_})},children:"Italic"}),d.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Color"}),d.jsx("input",{type:"color",value:g.fill??"#111111",onChange:C=>p(n.id,g.id,{fill:C.target.value}),className:"h-8 w-10 cursor-pointer"})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[d.jsx("label",{className:"text-xs opacity-70",children:"Font"}),d.jsx("select",{value:g.fontFamily??"Georgia, serif",onChange:async C=>{const F=C.target.value;await Sa(F),p(n.id,g.id,{fontFamily:F})},className:"rounded border px-2 py-1 text-sm",children:Do.map(C=>d.jsx("option",{value:C.family,children:C.label},C.id))})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[d.jsx("label",{className:"text-xs opacity-70",children:"Align"}),["left","center","right"].map(C=>d.jsx("button",{type:"button",className:`rounded border px-2 py-1 text-sm ${g.align===C?"bg-foreground/10":""}`,onClick:()=>p(n.id,g.id,{align:C}),children:C},C)),d.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Wrap width"}),d.jsx("input",{type:"number",min:0,max:ce,step:10,value:g.width??0,onChange:C=>p(n.id,g.id,{width:Number(C.target.value)||void 0}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0 disables wrapping"}),d.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Padding"}),d.jsx("input",{type:"number",min:0,max:200,step:1,value:g.padding??0,onChange:C=>p(n.id,g.id,{padding:Number(C.target.value)}),className:"w-20 rounded border px-2 py-1 text-sm"}),d.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Line height"}),d.jsx("input",{type:"number",min:.8,max:2,step:.05,value:g.lineHeight??1.25,onChange:C=>p(n.id,g.id,{lineHeight:Number(C.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),d.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Tracking"}),d.jsx("input",{type:"number",min:-5,max:20,step:.5,value:g.letterSpacing??0,onChange:C=>p(n.id,g.id,{letterSpacing:Number(C.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Additional spacing between glyphs (px, card space)"})]})]}):null})(),f&&(()=>{const g=N.find(C=>C.id===f&&C.type==="image"&&C.qrText);return g?d.jsx(Aa,{photoId:n.id,layer:g}):null})(),f&&(()=>{const g=N.find(C=>C.id===f&&C.type==="rect");return g?d.jsx("div",{className:"mt-2 grid gap-2 rounded-md border p-2 bg-background/60",children:d.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d.jsx("label",{className:"text-xs opacity-70",children:"Fill"}),d.jsx("input",{type:"color",value:g.fill??"#ffffff",onChange:C=>p(n.id,g.id,{fill:C.target.value}),className:"h-8 w-10 cursor-pointer"}),d.jsx("label",{className:"text-xs opacity-70",children:"Stroke"}),d.jsx("input",{type:"color",value:g.stroke??"#000000",onChange:C=>p(n.id,g.id,{stroke:C.target.value}),className:"h-8 w-10 cursor-pointer"}),d.jsx("label",{className:"text-xs opacity-70",children:"Stroke width"}),d.jsx("input",{type:"number",min:0,max:100,step:1,value:g.strokeWidth??0,onChange:C=>p(n.id,g.id,{strokeWidth:Number(C.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Width in card pixels"}),d.jsx("label",{className:"text-xs opacity-70",children:"Radius"}),d.jsx("input",{type:"number",min:0,max:500,step:1,value:g.cornerRadius??0,onChange:C=>p(n.id,g.id,{cornerRadius:Number(C.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm",title:"Corner radius in card pixels"}),d.jsx("label",{className:"text-xs opacity-70",children:"Opacity"}),d.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((g.opacity??1)*100),onChange:C=>p(n.id,g.id,{opacity:Math.max(0,Math.min(1,Number(C.target.value)/100))}),className:"w-24 rounded border px-2 py-1 text-sm",title:"0..100 %"}),d.jsx("label",{className:"text-xs opacity-70",children:"Width"}),d.jsx("input",{type:"number",min:1,max:ce,step:1,value:g.width??1,onChange:C=>p(n.id,g.id,{width:Number(C.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"}),d.jsx("label",{className:"text-xs opacity-70",children:"Height"}),d.jsx("input",{type:"number",min:1,max:ce,step:1,value:g.height??1,onChange:C=>p(n.id,g.id,{height:Number(C.target.value)}),className:"w-24 rounded border px-2 py-1 text-sm"})]})}):null})(),d.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:d.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[d.jsx(re,{variant:"secondary",disabled:!f,onClick:()=>{if(!f)return;const C=($.getState().layersByPhoto[n.id]??[]).find(U=>U.id===f);if(!C)return;const _=((C.rotation??0)-90)%360;p(n.id,f,{rotation:_<0?_+360:_})},children:"Rotate −90°"}),d.jsx(re,{variant:"secondary",disabled:!f,onClick:()=>{if(!f)return;const C=($.getState().layersByPhoto[n.id]??[]).find(U=>U.id===f);if(!C)return;const _=((C.rotation??0)+90)%360;p(n.id,f,{rotation:_})},children:"Rotate +90°"}),d.jsx(re,{variant:"secondary",disabled:!f,onClick:()=>f&&v(n.id,f),children:"Bring to front"}),d.jsx(re,{variant:"secondary",disabled:!f,onClick:()=>f&&A(n.id,f),children:"Send to back"}),d.jsx(re,{variant:"destructive",disabled:!f,onClick:()=>{f&&(S(n.id,f),b(null))},children:"Delete layer"})]})}),d.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:d.jsxs("div",{className:"grid gap-3",children:[d.jsxs("div",{className:"grid gap-1.5",children:[d.jsxs("div",{className:"flex items-center justify-between text-sm",children:[d.jsx(He,{children:"Zoom"}),d.jsxs("span",{className:"tabular-nums opacity-70",children:[c.scale.toFixed(2),"×"]})]}),d.jsx(Nt,{value:[c.scale],min:1,max:3,step:.01,onValueChange:([g])=>u(C=>({...C,scale:g}))})]}),d.jsxs("div",{className:"grid gap-1.5",children:[d.jsxs("div",{className:"flex items-center justify-between text-sm",children:[d.jsx(He,{children:"Horizontal"}),d.jsxs("span",{className:"tabular-nums opacity-70",children:[c.tx.toFixed(0),"%"]})]}),d.jsx(Nt,{value:[c.tx],min:-100,max:100,step:.1,onValueChange:([g])=>u(C=>({...C,tx:g}))})]}),d.jsxs("div",{className:"grid gap-1.5",children:[d.jsxs("div",{className:"flex items-center justify-between text-sm",children:[d.jsx(He,{children:"Vertical"}),d.jsxs("span",{className:"tabular-nums opacity-70",children:[c.ty.toFixed(0),"%"]})]}),d.jsx(Nt,{value:[c.ty],min:-100,max:100,step:.1,onValueChange:([g])=>u(C=>({...C,ty:g}))})]})]})}),d.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)]",children:d.jsx("div",{className:"mt-3 grid gap-2 rounded-md border p-2 bg-background/60",children:d.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d.jsx(He,{className:"opacity-70",children:"Background"}),d.jsx("label",{className:"text-xs opacity-70",children:"Color"}),d.jsx("input",{type:"color",value:w.color,onChange:g=>T(n.id,{color:g.target.value}),className:"h-8 w-10 cursor-pointer"}),d.jsx("label",{className:"text-xs opacity-70 ml-2",children:"Opacity"}),d.jsx("input",{type:"number",min:0,max:100,step:1,value:Math.round((w.alpha??1)*100),onChange:g=>T(n.id,{alpha:Math.max(0,Math.min(1,Number(g.target.value)/100))}),className:"w-20 rounded border px-2 py-1 text-sm",title:"0..100 %"}),d.jsx("span",{className:"text-xs opacity-60",children:"(0% = transparent, 100% = solid)"})]})})})]})}),d.jsxs(Bn,{className:"shrink-0 space-y-2",children:[d.jsxs("div",{className:"flex items-center justify-between gap-2",children:[d.jsx(re,{variant:"ghost",onClick:()=>{u(Qe)},children:"Reset image"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(re,{variant:"secondary",onClick:()=>{E(x.current,l)||a(n.id,x.current),t(!1)},children:"Cancel"}),d.jsx(re,{onClick:()=>{E(c,l)||a(n.id,c),t(!1)},children:"Save"})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(re,{variant:"secondary",onClick:async()=>{const g=window.prompt("QR text / URL:","https://example.com")??"";if(!g.trim())return;const C=await i(n.id,g.trim());b(C)},children:"Add QR"}),d.jsx(re,{variant:"secondary",onClick:()=>{const g=o(n.id);b(g)},children:"Add text layer"}),d.jsx(re,{variant:"secondary",onClick:()=>{const g=s(n.id);b(g)},children:"Add rectangle"})]})]})]})})}function Ia(e,t="card"){return(e.replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||t).slice(0,100)}function Ta(e,t){const n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),n.remove()}function Da({open:e,onOpenChange:t,photo:n,transform:r,layers:o,snapshot:s,onEdit:i}){const[l,a]=h.useState(null),[c,u]=h.useState(!1),f=h.useRef(null),[b,p]=h.useState(0);h.useEffect(()=>{const R=f.current;if(!R)return;const w=()=>p(Math.round(R.clientWidth));w();const T=new ResizeObserver(w);return T.observe(R),()=>T.disconnect()},[]);const S=h.useRef(null),[v,A]=h.useState(Yt),N=h.useMemo(()=>e?d.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:v,height:v,overflow:"hidden"},children:d.jsx(jt,{ref:S,photoId:n.id,size:v,selectedId:null,onSelect:()=>{}})}):null,[e,n.id,v]);async function k(R){A(R),await new Promise(T=>setTimeout(T,0));try{const T=document;T?.fonts?.ready&&typeof T.fonts.ready.then=="function"&&await T.fonts.ready}catch{}const w=Date.now()+1e3;for(;!S.current?.isReady?.()&&!(Date.now()>w);)await new Promise(T=>setTimeout(T,30));return S.current?.toDataURL(R)??null}return h.useEffect(()=>{let R=!1;if(!e){a(null);return}return(async()=>{u(!0);const w=Math.max(Yt,b||Yt);let T=null;s&&(T=s(w)),T||(T=await k(w)),!R&&(a(T),u(!1))})(),()=>{R=!0}},[e,b,n.id,r.scale,r.tx,r.ty,o,s]),d.jsxs($o,{"data-dnd-ignore":!0,open:e,onOpenChange:t,children:[N,d.jsxs(Ln,{"data-dnd-ignore":!0,"aria-describedby":void 0,className:"max-w-[min(96vw,52rem)] max-h-[96vh] p-2 overflow-hidden",children:[d.jsx(Pn,{children:d.jsx(Gs,{asChild:!0,children:d.jsx(_n,{children:"Preview"})})}),d.jsx("div",{className:"mx-auto w-full max-w-[min(86vw,70vh)] rounded-xl border border-border bg-muted/20",children:d.jsxs("div",{ref:f,className:"relative aspect-square overflow-hidden rounded-xl",children:[l?d.jsx("img",{src:l,alt:n.name,className:"absolute inset-0 w-full h-full object-contain"}):d.jsx("div",{className:"h-24"}),d.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${c?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!c,children:d.jsx("div",{className:"h-7 w-7 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]})}),d.jsxs(Bn,{className:"mt-2 gap-2",children:[d.jsx(re,{variant:"secondary",onClick:()=>{t(!1),i?.()},children:"Edit"}),d.jsx(re,{variant:"secondary",onClick:()=>t(!1),children:"Close"}),d.jsx(re,{onClick:async()=>{const R=s&&s(ce)||await k(ce);R&&Ta(R,`${Ia(n.name||"card")}.png`)},children:"Save PNG"})]})]})]})}async function Ma(e,t=ce){const n=document.createElement("div");n.style.position="fixed",n.style.left="-10000px",n.style.top="-10000px",n.style.width=`${t}px`,n.style.height=`${t}px`,document.body.appendChild(n);const r=h.createRef(),o=no.createRoot(n);o.render(h.createElement(jt,{ref:r,photoId:e,size:t,selectedId:null,onSelect:()=>{}})),await new Promise(l=>setTimeout(l,0));try{const l=document;l?.fonts?.ready&&typeof l.fonts.ready.then=="function"&&await l.fonts.ready}catch{}const s=Date.now()+1500;for(;!r.current?.isReady?.()&&!(Date.now()>s);)await new Promise(l=>setTimeout(l,25));const i=r.current?.toDataURL(t)??"";return o.unmount(),n.remove(),i}async function ja(e,t=ce){return Ma(e,t)}function La(e,t){const n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),n.remove()}function Pa({photo:e}){const t=$(E=>E.remove),n=$(E=>E.transforms[e.id]??Qe),r=$(E=>E.layersByPhoto),[o,s]=h.useState(!1),[i,l]=h.useState(!1),a=h.useRef(null),c=h.useRef(null),[u,f]=h.useState(0);h.useEffect(()=>{const E=c.current;if(!E)return;const x=()=>f(E.clientWidth);x();const m=new ResizeObserver(x);return m.observe(E),()=>m.disconnect()},[]);const b=h.useRef(null),[p,S]=h.useState(512),v=d.jsx("div",{"aria-hidden":!0,style:{position:"fixed",left:-1e4,top:-1e4,width:p,height:p,overflow:"hidden"},children:d.jsx(jt,{ref:b,photoId:e.id,size:p,selectedId:null,onSelect:()=>{}})}),[A,N]=h.useState(null),[k,R]=h.useState(!0),w=h.useRef(null);h.useEffect(()=>{if(o)return;const E=window.devicePixelRatio||1,x=Math.max(384,Math.min(1024,Math.round((u||300)*E)));return S(x),w.current&&window.clearTimeout(w.current),w.current=window.setTimeout(async()=>{R(!0);try{const D=document;D?.fonts?.ready&&typeof D.fonts.ready.then=="function"&&await D.fonts.ready}catch{}const m=Date.now()+800;for(;!b.current?.isReady?.()&&!(Date.now()>m);)await new Promise(D=>setTimeout(D,25));const y=b.current?.toDataURL(x)??null;N(y),R(!1)},150),()=>{w.current&&(window.clearTimeout(w.current),w.current=null)}},[u,o,e.id,n.scale,n.tx,n.ty,r[e.id]]);const T=h.useCallback(async()=>{const E=await ja(e.id,ce);if(!E)return;const m=(e.name||"card").replace(/\.[^.]+$/,"").replace(/[^a-z0-9_\-]+/gi,"_").replace(/^_+|_+$/g,"")||"card";La(E,`${m}.png`)},[e.id,e.name]);return d.jsxs(d.Fragment,{children:[v,d.jsxs("div",{className:"overflow-hidden rounded-xl border border-foreground/15 bg-foreground/[0.02]",children:[d.jsxs("div",{ref:c,onClick:()=>l(!0),className:"relative aspect-square w-full overflow-hidden cursor-zoom-in",children:[d.jsx("button",{"aria-label":"Remove image",title:"Remove",onClick:E=>{E.stopPropagation(),t(e.id)},className:"absolute right-1 top-1 z-10 rounded-md bg-background/80 px-1.5 py-0.5 text-[11px] shadow hover:bg-background",children:"×"}),A?d.jsx("img",{src:A,alt:e.name,className:"h-full w-full object-cover"}):d.jsx("div",{className:"h-full w-full bg-foreground/[0.06]"}),d.jsx("div",{className:`pointer-events-none absolute inset-0 grid place-items-center transition-opacity ${k?"opacity-100":"opacity-0"} bg-background/80 backdrop-blur-[2px]`,"aria-hidden":!k,children:d.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-foreground/40 border-t-transparent"})})]}),d.jsxs("div",{className:"flex items-center justify-between gap-2 border-t bg-background/70 px-2 py-1.5 supports-[backdrop-filter]:bg-background/60",children:[d.jsx("button",{"aria-label":"Edit card",title:"Edit",onClick:E=>{E.stopPropagation(),s(!0)},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Edit"}),d.jsx("button",{"aria-label":"Save PNG",title:"Save PNG",onClick:E=>{E.stopPropagation(),T()},className:"rounded-md bg-background/80 px-2 py-1 text-[12px] shadow hover:bg-background",children:"Save PNG"})]})]}),d.jsx(Da,{open:i,onOpenChange:l,photo:e,transform:n,layers:r[e.id],snapshot:E=>a.current?.toDataURL(E)??null,onEdit:()=>s(!0)}),d.jsx(ka,{open:o,onOpenChange:s,photo:e,canvasRef:a})]})}function Ba(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const Lt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ze(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function zn(e){return"nodeType"in e}function ue(e){var t,n;return e?Ze(e)?e:zn(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Fn(e){const{Document:t}=ue(e);return e instanceof t}function mt(e){return Ze(e)?!1:e instanceof ue(e).HTMLElement}function Xo(e){return e instanceof ue(e).SVGElement}function et(e){return e?Ze(e)?e.document:zn(e)?Fn(e)?e:mt(e)||Xo(e)?e.ownerDocument:document:document:document}const Ce=Lt?h.useLayoutEffect:h.useEffect;function On(e){const t=h.useRef(e);return Ce(()=>{t.current=e}),h.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function _a(){const e=h.useRef(null),t=h.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=h.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function ft(e,t){t===void 0&&(t=[e]);const n=h.useRef(e);return Ce(()=>{n.current!==e&&(n.current=e)},t),n}function pt(e,t){const n=h.useRef();return h.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function It(e){const t=On(e),n=h.useRef(null),r=h.useCallback(o=>{o!==n.current&&t?.(o,n.current),n.current=o},[]);return[n,r]}function Rn(e){const t=h.useRef();return h.useEffect(()=>{t.current=e},[e]),t.current}let pn={};function bt(e,t){return h.useMemo(()=>{if(t)return t;const n=pn[e]==null?0:pn[e]+1;return pn[e]=n,e+"-"+n},[e,t])}function Wo(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((s,i)=>{const l=Object.entries(i);for(const[a,c]of l){const u=s[a];u!=null&&(s[a]=u+e*c)}return s},{...t})}}const We=Wo(1),Tt=Wo(-1);function za(e){return"clientX"in e&&"clientY"in e}function Un(e){if(!e)return!1;const{KeyboardEvent:t}=ue(e.target);return t&&e instanceof t}function Fa(e){if(!e)return!1;const{TouchEvent:t}=ue(e.target);return t&&e instanceof t}function Sn(e){if(Fa(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return za(e)?{x:e.clientX,y:e.clientY}:null}const ht=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[ht.Translate.toString(e),ht.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Or="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Oa(e){return e.matches(Or)?e:e.querySelector(Or)}const Ua={display:"none"};function qa(e){let{id:t,value:n}=e;return ae.createElement("div",{id:t,style:Ua},n)}function Ya(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ae.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function Va(){const[e,t]=h.useState("");return{announce:h.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Qo=h.createContext(null);function $a(e){const t=h.useContext(Qo);h.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Ga(){const[e]=h.useState(()=>new Set),t=h.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[h.useCallback(r=>{let{type:o,event:s}=r;e.forEach(i=>{var l;return(l=i[o])==null?void 0:l.call(i,s)})},[e]),t]}const Ha={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Xa={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Wa(e){let{announcements:t=Xa,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=Ha}=e;const{announce:s,announcement:i}=Va(),l=bt("DndLiveRegion"),[a,c]=h.useState(!1);if(h.useEffect(()=>{c(!0)},[]),$a(h.useMemo(()=>({onDragStart(f){let{active:b}=f;s(t.onDragStart({active:b}))},onDragMove(f){let{active:b,over:p}=f;t.onDragMove&&s(t.onDragMove({active:b,over:p}))},onDragOver(f){let{active:b,over:p}=f;s(t.onDragOver({active:b,over:p}))},onDragEnd(f){let{active:b,over:p}=f;s(t.onDragEnd({active:b,over:p}))},onDragCancel(f){let{active:b,over:p}=f;s(t.onDragCancel({active:b,over:p}))}}),[s,t])),!a)return null;const u=ae.createElement(ae.Fragment,null,ae.createElement(qa,{id:r,value:o.draggable}),ae.createElement(Ya,{id:l,announcement:i}));return n?lt.createPortal(u,n):u}var te;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(te||(te={}));function Dt(){}function Ur(e,t){return h.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Qa(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const be=Object.freeze({x:0,y:0});function Ka(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Ja(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Za(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function el(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function qr(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const tl=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=qr(t,t.left,t.top),s=[];for(const i of r){const{id:l}=i,a=n.get(l);if(a){const c=Ka(qr(a),o);s.push({id:l,data:{droppableContainer:i,value:c}})}}return s.sort(Ja)};function nl(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),i=o-r,l=s-n;if(r<o&&n<s){const a=t.width*t.height,c=e.width*e.height,u=i*l,f=u/(a+c-u);return Number(f.toFixed(4))}return 0}const rl=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const s of r){const{id:i}=s,l=n.get(i);if(l){const a=nl(l,t);a>0&&o.push({id:i,data:{droppableContainer:s,value:a}})}}return o.sort(Za)};function ol(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Ko(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:be}function sl(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o.reduce((i,l)=>({...i,top:i.top+e*l.y,bottom:i.bottom+e*l.y,left:i.left+e*l.x,right:i.right+e*l.x}),{...n})}}const il=sl(1);function al(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function ll(e,t,n){const r=al(t);if(!r)return e;const{scaleX:o,scaleY:s,x:i,y:l}=r,a=e.left-i-(1-o)*parseFloat(n),c=e.top-l-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),u=o?e.width/o:e.width,f=s?e.height/s:e.height;return{width:u,height:f,top:c,right:a+u,bottom:c+f,left:a}}const cl={ignoreTransform:!1};function tt(e,t){t===void 0&&(t=cl);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:c,transformOrigin:u}=ue(e).getComputedStyle(e);c&&(n=ll(n,c,u))}const{top:r,left:o,width:s,height:i,bottom:l,right:a}=n;return{top:r,left:o,width:s,height:i,bottom:l,right:a}}function Yr(e){return tt(e,{ignoreTransform:!0})}function dl(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function ul(e,t){return t===void 0&&(t=ue(e).getComputedStyle(e)),t.position==="fixed"}function fl(e,t){t===void 0&&(t=ue(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const s=t[o];return typeof s=="string"?n.test(s):!1})}function qn(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(Fn(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!mt(o)||Xo(o)||n.includes(o))return n;const s=ue(e).getComputedStyle(o);return o!==e&&fl(o,s)&&n.push(o),ul(o,s)?n:r(o.parentNode)}return e?r(e):n}function Jo(e){const[t]=qn(e,1);return t??null}function bn(e){return!Lt||!e?null:Ze(e)?e:zn(e)?Fn(e)||e===et(e).scrollingElement?window:mt(e)?e:null:null}function Zo(e){return Ze(e)?e.scrollX:e.scrollLeft}function es(e){return Ze(e)?e.scrollY:e.scrollTop}function Nn(e){return{x:Zo(e),y:es(e)}}var oe;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(oe||(oe={}));function ts(e){return!Lt||!e?!1:e===document.scrollingElement}function ns(e){const t={x:0,y:0},n=ts(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,i=e.scrollTop>=r.y,l=e.scrollLeft>=r.x;return{isTop:o,isLeft:s,isBottom:i,isRight:l,maxScroll:r,minScroll:t}}const hl={x:.2,y:.2};function gl(e,t,n,r,o){let{top:s,left:i,right:l,bottom:a}=n;r===void 0&&(r=10),o===void 0&&(o=hl);const{isTop:c,isBottom:u,isLeft:f,isRight:b}=ns(e),p={x:0,y:0},S={x:0,y:0},v={height:t.height*o.y,width:t.width*o.x};return!c&&s<=t.top+v.height?(p.y=oe.Backward,S.y=r*Math.abs((t.top+v.height-s)/v.height)):!u&&a>=t.bottom-v.height&&(p.y=oe.Forward,S.y=r*Math.abs((t.bottom-v.height-a)/v.height)),!b&&l>=t.right-v.width?(p.x=oe.Forward,S.x=r*Math.abs((t.right-v.width-l)/v.width)):!f&&i<=t.left+v.width&&(p.x=oe.Backward,S.x=r*Math.abs((t.left+v.width-i)/v.width)),{direction:p,speed:S}}function ml(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:i}=window;return{top:0,left:0,right:s,bottom:i,width:s,height:i}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function rs(e){return e.reduce((t,n)=>We(t,Nn(n)),be)}function pl(e){return e.reduce((t,n)=>t+Zo(n),0)}function bl(e){return e.reduce((t,n)=>t+es(n),0)}function yl(e,t){if(t===void 0&&(t=tt),!e)return;const{top:n,left:r,bottom:o,right:s}=t(e);Jo(e)&&(o<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const xl=[["x",["left","right"],pl],["y",["top","bottom"],bl]];class Yn{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=qn(n),o=rs(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,i,l]of xl)for(const a of i)Object.defineProperty(this,a,{get:()=>{const c=l(r),u=o[s]-c;return this.rect[a]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ct{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function vl(e){const{EventTarget:t}=ue(e);return e instanceof t?e:et(e)}function yn(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var pe;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(pe||(pe={}));function Vr(e){e.preventDefault()}function wl(e){e.stopPropagation()}var V;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(V||(V={}));const os={start:[V.Space,V.Enter],cancel:[V.Esc],end:[V.Space,V.Enter,V.Tab]},Cl=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case V.Right:return{...n,x:n.x+25};case V.Left:return{...n,x:n.x-25};case V.Down:return{...n,y:n.y+25};case V.Up:return{...n,y:n.y-25}}};class ss{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new ct(et(n)),this.windowListeners=new ct(ue(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(pe.Resize,this.handleCancel),this.windowListeners.add(pe.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(pe.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&yl(r),n(be)}handleKeyDown(t){if(Un(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:s=os,coordinateGetter:i=Cl,scrollBehavior:l="smooth"}=o,{code:a}=t;if(s.end.includes(a)){this.handleEnd(t);return}if(s.cancel.includes(a)){this.handleCancel(t);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:be;this.referenceCoordinates||(this.referenceCoordinates=u);const f=i(t,{active:n,context:r.current,currentCoordinates:u});if(f){const b=Tt(f,u),p={x:0,y:0},{scrollableAncestors:S}=r.current;for(const v of S){const A=t.code,{isTop:N,isRight:k,isLeft:R,isBottom:w,maxScroll:T,minScroll:E}=ns(v),x=ml(v),m={x:Math.min(A===V.Right?x.right-x.width/2:x.right,Math.max(A===V.Right?x.left:x.left+x.width/2,f.x)),y:Math.min(A===V.Down?x.bottom-x.height/2:x.bottom,Math.max(A===V.Down?x.top:x.top+x.height/2,f.y))},y=A===V.Right&&!k||A===V.Left&&!R,D=A===V.Down&&!w||A===V.Up&&!N;if(y&&m.x!==f.x){const I=v.scrollLeft+b.x,M=A===V.Right&&I<=T.x||A===V.Left&&I>=E.x;if(M&&!b.y){v.scrollTo({left:I,behavior:l});return}M?p.x=v.scrollLeft-I:p.x=A===V.Right?v.scrollLeft-T.x:v.scrollLeft-E.x,p.x&&v.scrollBy({left:-p.x,behavior:l});break}else if(D&&m.y!==f.y){const I=v.scrollTop+b.y,M=A===V.Down&&I<=T.y||A===V.Up&&I>=E.y;if(M&&!b.x){v.scrollTo({top:I,behavior:l});return}M?p.y=v.scrollTop-I:p.y=A===V.Down?v.scrollTop-T.y:v.scrollTop-E.y,p.y&&v.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(t,We(Tt(f,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ss.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=os,onActivation:o}=t,{active:s}=n;const{code:i}=e.nativeEvent;if(r.start.includes(i)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),o?.({event:e.nativeEvent}),!0)}return!1}}];function $r(e){return!!(e&&"distance"in e)}function Gr(e){return!!(e&&"delay"in e)}class Vn{constructor(t,n,r){var o;r===void 0&&(r=vl(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:i}=s;this.props=t,this.events=n,this.document=et(i),this.documentListeners=new ct(this.document),this.listeners=new ct(r),this.windowListeners=new ct(ue(i)),this.initialCoordinates=(o=Sn(s))!=null?o:be,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(pe.Resize,this.handleCancel),this.windowListeners.add(pe.DragStart,Vr),this.windowListeners.add(pe.VisibilityChange,this.handleCancel),this.windowListeners.add(pe.ContextMenu,Vr),this.documentListeners.add(pe.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Gr(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if($r(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(pe.Click,wl,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(pe.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:s}=this,{onMove:i,options:{activationConstraint:l}}=s;if(!o)return;const a=(n=Sn(t))!=null?n:be,c=Tt(o,a);if(!r&&l){if($r(l)){if(l.tolerance!=null&&yn(c,l.tolerance))return this.handleCancel();if(yn(c,l.distance))return this.handleStart()}if(Gr(l)&&yn(c,l.tolerance))return this.handleCancel();this.handlePending(l,c);return}t.cancelable&&t.preventDefault(),i(a)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===V.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const El={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class $n extends Vn{constructor(t){const{event:n}=t,r=et(n.target);super(t,El,r)}}$n.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const Rl={move:{name:"mousemove"},end:{name:"mouseup"}};var An;(function(e){e[e.RightClick=2]="RightClick"})(An||(An={}));class Sl extends Vn{constructor(t){super(t,Rl,et(t.event.target))}}Sl.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===An.RightClick?!1:(r?.({event:n}),!0)}}];const xn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class is extends Vn{constructor(t){super(t,xn)}static setup(){return window.addEventListener(xn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(xn.move.name,t)};function t(){}}}is.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r?.({event:n}),!0)}}];var dt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(dt||(dt={}));var Mt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Mt||(Mt={}));function Nl(e){let{acceleration:t,activator:n=dt.Pointer,canScroll:r,draggingRect:o,enabled:s,interval:i=5,order:l=Mt.TreeOrder,pointerCoordinates:a,scrollableAncestors:c,scrollableAncestorRects:u,delta:f,threshold:b}=e;const p=kl({delta:f,disabled:!s}),[S,v]=_a(),A=h.useRef({x:0,y:0}),N=h.useRef({x:0,y:0}),k=h.useMemo(()=>{switch(n){case dt.Pointer:return a?{top:a.y,bottom:a.y,left:a.x,right:a.x}:null;case dt.DraggableRect:return o}},[n,o,a]),R=h.useRef(null),w=h.useCallback(()=>{const E=R.current;if(!E)return;const x=A.current.x*N.current.x,m=A.current.y*N.current.y;E.scrollBy(x,m)},[]),T=h.useMemo(()=>l===Mt.TreeOrder?[...c].reverse():c,[l,c]);h.useEffect(()=>{if(!s||!c.length||!k){v();return}for(const E of T){if(r?.(E)===!1)continue;const x=c.indexOf(E),m=u[x];if(!m)continue;const{direction:y,speed:D}=gl(E,m,k,t,b);for(const I of["x","y"])p[I][y[I]]||(D[I]=0,y[I]=0);if(D.x>0||D.y>0){v(),R.current=E,S(w,i),A.current=D,N.current=y;return}}A.current={x:0,y:0},N.current={x:0,y:0},v()},[t,w,r,v,s,i,JSON.stringify(k),JSON.stringify(p),S,c,T,u,JSON.stringify(b)])}const Al={x:{[oe.Backward]:!1,[oe.Forward]:!1},y:{[oe.Backward]:!1,[oe.Forward]:!1}};function kl(e){let{delta:t,disabled:n}=e;const r=Rn(t);return pt(o=>{if(n||!r||!o)return Al;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[oe.Backward]:o.x[oe.Backward]||s.x===-1,[oe.Forward]:o.x[oe.Forward]||s.x===1},y:{[oe.Backward]:o.y[oe.Backward]||s.y===-1,[oe.Forward]:o.y[oe.Forward]||s.y===1}}},[n,t,r])}function Il(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return pt(o=>{var s;return t==null?null:(s=r??o)!=null?s:null},[r,t])}function Tl(e,t){return h.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,s=o.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,r)}));return[...n,...s]},[]),[e,t])}var gt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(gt||(gt={}));var kn;(function(e){e.Optimized="optimized"})(kn||(kn={}));const Hr=new Map;function Dl(e,t){let{dragging:n,dependencies:r,config:o}=t;const[s,i]=h.useState(null),{frequency:l,measure:a,strategy:c}=o,u=h.useRef(e),f=A(),b=ft(f),p=h.useCallback(function(N){N===void 0&&(N=[]),!b.current&&i(k=>k===null?N:k.concat(N.filter(R=>!k.includes(R))))},[b]),S=h.useRef(null),v=pt(N=>{if(f&&!n)return Hr;if(!N||N===Hr||u.current!==e||s!=null){const k=new Map;for(let R of e){if(!R)continue;if(s&&s.length>0&&!s.includes(R.id)&&R.rect.current){k.set(R.id,R.rect.current);continue}const w=R.node.current,T=w?new Yn(a(w),w):null;R.rect.current=T,T&&k.set(R.id,T)}return k}return N},[e,s,n,f,a]);return h.useEffect(()=>{u.current=e},[e]),h.useEffect(()=>{f||p()},[n,f]),h.useEffect(()=>{s&&s.length>0&&i(null)},[JSON.stringify(s)]),h.useEffect(()=>{f||typeof l!="number"||S.current!==null||(S.current=setTimeout(()=>{p(),S.current=null},l))},[l,f,p,...r]),{droppableRects:v,measureDroppableContainers:p,measuringScheduled:s!=null};function A(){switch(c){case gt.Always:return!1;case gt.BeforeDragging:return n;default:return!n}}}function as(e,t){return pt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Ml(e,t){return as(e,t)}function jl(e){let{callback:t,disabled:n}=e;const r=On(t),o=h.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return h.useEffect(()=>()=>o?.disconnect(),[o]),o}function Pt(e){let{callback:t,disabled:n}=e;const r=On(t),o=h.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return h.useEffect(()=>()=>o?.disconnect(),[o]),o}function Ll(e){return new Yn(tt(e),e)}function Xr(e,t,n){t===void 0&&(t=Ll);const[r,o]=h.useState(null);function s(){o(a=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=a??n)!=null?c:null}const u=t(e);return JSON.stringify(a)===JSON.stringify(u)?a:u})}const i=jl({callback(a){if(e)for(const c of a){const{type:u,target:f}=c;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),l=Pt({callback:s});return Ce(()=>{s(),e?(l?.observe(e),i?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),i?.disconnect())},[e]),r}function Pl(e){const t=as(e);return Ko(e,t)}const Wr=[];function Bl(e){const t=h.useRef(e),n=pt(r=>e?r&&r!==Wr&&e&&t.current&&e.parentNode===t.current.parentNode?r:qn(e):Wr,[e]);return h.useEffect(()=>{t.current=e},[e]),n}function _l(e){const[t,n]=h.useState(null),r=h.useRef(e),o=h.useCallback(s=>{const i=bn(s.target);i&&n(l=>l?(l.set(i,Nn(i)),new Map(l)):null)},[]);return h.useEffect(()=>{const s=r.current;if(e!==s){i(s);const l=e.map(a=>{const c=bn(a);return c?(c.addEventListener("scroll",o,{passive:!0}),[c,Nn(c)]):null}).filter(a=>a!=null);n(l.length?new Map(l):null),r.current=e}return()=>{i(e),i(s)};function i(l){l.forEach(a=>{const c=bn(a);c?.removeEventListener("scroll",o)})}},[o,e]),h.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,i)=>We(s,i),be):rs(e):be,[e,t])}function Qr(e,t){t===void 0&&(t=[]);const n=h.useRef(null);return h.useEffect(()=>{n.current=null},t),h.useEffect(()=>{const r=e!==be;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Tt(e,n.current):be}function zl(e){h.useEffect(()=>{if(!Lt)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function Fl(e,t){return h.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:s}=r;return n[o]=i=>{s(i,t)},n},{}),[e,t])}function ls(e){return h.useMemo(()=>e?dl(e):null,[e])}const Kr=[];function Ol(e,t){t===void 0&&(t=tt);const[n]=e,r=ls(n?ue(n):null),[o,s]=h.useState(Kr);function i(){s(()=>e.length?e.map(a=>ts(a)?r:new Yn(t(a),a)):Kr)}const l=Pt({callback:i});return Ce(()=>{l?.disconnect(),i(),e.forEach(a=>l?.observe(a))},[e]),o}function Ul(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return mt(t)?t:e}function ql(e){let{measure:t}=e;const[n,r]=h.useState(null),o=h.useCallback(c=>{for(const{target:u}of c)if(mt(u)){r(f=>{const b=t(u);return f?{...f,width:b.width,height:b.height}:b});break}},[t]),s=Pt({callback:o}),i=h.useCallback(c=>{const u=Ul(c);s?.disconnect(),u&&s?.observe(u),r(u?t(u):null)},[t,s]),[l,a]=It(i);return h.useMemo(()=>({nodeRef:l,rect:n,setRef:a}),[n,l,a])}const Yl=[{sensor:$n,options:{}},{sensor:ss,options:{}}],Vl={current:{}},At={draggable:{measure:Yr},droppable:{measure:Yr,strategy:gt.WhileDragging,frequency:kn.Optimized},dragOverlay:{measure:tt}};class ut extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const $l={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ut,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Dt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:At,measureDroppableContainers:Dt,windowRect:null,measuringScheduled:!1},Gl={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Dt,draggableNodes:new Map,over:null,measureDroppableContainers:Dt},Bt=h.createContext(Gl),cs=h.createContext($l);function Hl(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ut}}}function Xl(e,t){switch(t.type){case te.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case te.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case te.DragEnd:case te.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case te.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new ut(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case te.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new ut(e.droppable.containers);return i.set(n,{...s,disabled:o}),{...e,droppable:{...e.droppable,containers:i}}}case te.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const s=new ut(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function Wl(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=h.useContext(Bt),s=Rn(r),i=Rn(n?.id);return h.useEffect(()=>{if(!t&&!r&&s&&i!=null){if(!Un(s)||document.activeElement===s.target)return;const l=o.get(i);if(!l)return;const{activatorNode:a,node:c}=l;if(!a.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[a.current,c.current]){if(!u)continue;const f=Oa(u);if(f){f.focus();break}}})}},[r,t,o,i,s]),null}function Ql(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,s)=>s({transform:o,...r}),n):n}function Kl(e){return h.useMemo(()=>({draggable:{...At.draggable,...e?.draggable},droppable:{...At.droppable,...e?.droppable},dragOverlay:{...At.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Jl(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const s=h.useRef(!1),{x:i,y:l}=typeof o=="boolean"?{x:o,y:o}:o;Ce(()=>{if(!i&&!l||!t){s.current=!1;return}if(s.current||!r)return;const c=t?.node.current;if(!c||c.isConnected===!1)return;const u=n(c),f=Ko(u,r);if(i||(f.x=0),l||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const b=Jo(c);b&&b.scrollBy({top:f.y,left:f.x})}},[t,i,l,r,n])}const ds=h.createContext({...be,scaleX:1,scaleY:1});var Pe;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Pe||(Pe={}));const Zl=h.memo(function(t){var n,r,o,s;let{id:i,accessibility:l,autoScroll:a=!0,children:c,sensors:u=Yl,collisionDetection:f=rl,measuring:b,modifiers:p,...S}=t;const v=h.useReducer(Xl,void 0,Hl),[A,N]=v,[k,R]=Ga(),[w,T]=h.useState(Pe.Uninitialized),E=w===Pe.Initialized,{draggable:{active:x,nodes:m,translate:y},droppable:{containers:D}}=A,I=x!=null?m.get(x):null,M=h.useRef({initial:null,translated:null}),g=h.useMemo(()=>{var ie;return x!=null?{id:x,data:(ie=I?.data)!=null?ie:Vl,rect:M}:null},[x,I]),C=h.useRef(null),[F,_]=h.useState(null),[U,j]=h.useState(null),B=ft(S,Object.values(S)),J=bt("DndDescribedBy",i),Z=h.useMemo(()=>D.getEnabled(),[D]),G=Kl(b),{droppableRects:Y,measureDroppableContainers:H,measuringScheduled:de}=Dl(Z,{dragging:E,dependencies:[y.x,y.y],config:G.droppable}),ne=Il(m,x),q=h.useMemo(()=>U?Sn(U):null,[U]),Q=ws(),K=Ml(ne,G.draggable.measure);Jl({activeNode:x!=null?m.get(x):null,config:Q.layoutShiftCompensation,initialRect:K,measure:G.draggable.measure});const O=Xr(ne,G.draggable.measure,K),Ee=Xr(ne?ne.parentElement:null),le=h.useRef({activatorEvent:null,active:null,activeNode:ne,collisionRect:null,collisions:null,droppableRects:Y,draggableNodes:m,draggingNode:null,draggingNodeRect:null,droppableContainers:D,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Fe=D.getNodeFor((n=le.current.over)==null?void 0:n.id),Re=ql({measure:G.dragOverlay.measure}),Oe=(r=Re.nodeRef.current)!=null?r:ne,Ue=E?(o=Re.rect)!=null?o:O:null,Xn=!!(Re.nodeRef.current&&Re.rect),Wn=Pl(Xn?null:O),_t=ls(Oe?ue(Oe):null),ke=Bl(E?Fe??ne:null),yt=Ol(ke),xt=Ql(p,{transform:{x:y.x-Wn.x,y:y.y-Wn.y,scaleX:1,scaleY:1},activatorEvent:U,active:g,activeNodeRect:O,containerNodeRect:Ee,draggingNodeRect:Ue,over:le.current.over,overlayNodeRect:Re.rect,scrollableAncestors:ke,scrollableAncestorRects:yt,windowRect:_t}),Qn=q?We(q,y):null,Kn=_l(ke),gs=Qr(Kn),ms=Qr(Kn,[O]),qe=We(xt,gs),Ye=Ue?il(Ue,xt):null,nt=g&&Ye?f({active:g,collisionRect:Ye,droppableRects:Y,droppableContainers:Z,pointerCoordinates:Qn}):null,Jn=el(nt,"id"),[Ie,Zn]=h.useState(null),ps=Xn?xt:We(xt,ms),bs=ol(ps,(s=Ie?.rect)!=null?s:null,O),zt=h.useRef(null),er=h.useCallback((ie,fe)=>{let{sensor:he,options:Te}=fe;if(C.current==null)return;const me=m.get(C.current);if(!me)return;const ge=ie.nativeEvent,ye=new he({active:C.current,activeNode:me,event:ge,options:Te,context:le,onAbort(se){if(!m.get(se))return;const{onDragAbort:xe}=B.current,Se={id:se};xe?.(Se),k({type:"onDragAbort",event:Se})},onPending(se,De,xe,Se){if(!m.get(se))return;const{onDragPending:ot}=B.current,Me={id:se,constraint:De,initialCoordinates:xe,offset:Se};ot?.(Me),k({type:"onDragPending",event:Me})},onStart(se){const De=C.current;if(De==null)return;const xe=m.get(De);if(!xe)return;const{onDragStart:Se}=B.current,rt={activatorEvent:ge,active:{id:De,data:xe.data,rect:M}};lt.unstable_batchedUpdates(()=>{Se?.(rt),T(Pe.Initializing),N({type:te.DragStart,initialCoordinates:se,active:De}),k({type:"onDragStart",event:rt}),_(zt.current),j(ge)})},onMove(se){N({type:te.DragMove,coordinates:se})},onEnd:Ve(te.DragEnd),onCancel:Ve(te.DragCancel)});zt.current=ye;function Ve(se){return async function(){const{active:xe,collisions:Se,over:rt,scrollAdjustedTranslate:ot}=le.current;let Me=null;if(xe&&ot){const{cancelDrop:st}=B.current;Me={activatorEvent:ge,active:xe,collisions:Se,delta:ot,over:rt},se===te.DragEnd&&typeof st=="function"&&await Promise.resolve(st(Me))&&(se=te.DragCancel)}C.current=null,lt.unstable_batchedUpdates(()=>{N({type:se}),T(Pe.Uninitialized),Zn(null),_(null),j(null),zt.current=null;const st=se===te.DragEnd?"onDragEnd":"onDragCancel";if(Me){const Ft=B.current[st];Ft?.(Me),k({type:st,event:Me})}})}}},[m]),ys=h.useCallback((ie,fe)=>(he,Te)=>{const me=he.nativeEvent,ge=m.get(Te);if(C.current!==null||!ge||me.dndKit||me.defaultPrevented)return;const ye={active:ge};ie(he,fe.options,ye)===!0&&(me.dndKit={capturedBy:fe.sensor},C.current=Te,er(he,fe))},[m,er]),tr=Tl(u,ys);zl(u),Ce(()=>{O&&w===Pe.Initializing&&T(Pe.Initialized)},[O,w]),h.useEffect(()=>{const{onDragMove:ie}=B.current,{active:fe,activatorEvent:he,collisions:Te,over:me}=le.current;if(!fe||!he)return;const ge={active:fe,activatorEvent:he,collisions:Te,delta:{x:qe.x,y:qe.y},over:me};lt.unstable_batchedUpdates(()=>{ie?.(ge),k({type:"onDragMove",event:ge})})},[qe.x,qe.y]),h.useEffect(()=>{const{active:ie,activatorEvent:fe,collisions:he,droppableContainers:Te,scrollAdjustedTranslate:me}=le.current;if(!ie||C.current==null||!fe||!me)return;const{onDragOver:ge}=B.current,ye=Te.get(Jn),Ve=ye&&ye.rect.current?{id:ye.id,rect:ye.rect.current,data:ye.data,disabled:ye.disabled}:null,se={active:ie,activatorEvent:fe,collisions:he,delta:{x:me.x,y:me.y},over:Ve};lt.unstable_batchedUpdates(()=>{Zn(Ve),ge?.(se),k({type:"onDragOver",event:se})})},[Jn]),Ce(()=>{le.current={activatorEvent:U,active:g,activeNode:ne,collisionRect:Ye,collisions:nt,droppableRects:Y,draggableNodes:m,draggingNode:Oe,draggingNodeRect:Ue,droppableContainers:D,over:Ie,scrollableAncestors:ke,scrollAdjustedTranslate:qe},M.current={initial:Ue,translated:Ye}},[g,ne,nt,Ye,m,Oe,Ue,Y,D,Ie,ke,qe]),Nl({...Q,delta:y,draggingRect:Ye,pointerCoordinates:Qn,scrollableAncestors:ke,scrollableAncestorRects:yt});const xs=h.useMemo(()=>({active:g,activeNode:ne,activeNodeRect:O,activatorEvent:U,collisions:nt,containerNodeRect:Ee,dragOverlay:Re,draggableNodes:m,droppableContainers:D,droppableRects:Y,over:Ie,measureDroppableContainers:H,scrollableAncestors:ke,scrollableAncestorRects:yt,measuringConfiguration:G,measuringScheduled:de,windowRect:_t}),[g,ne,O,U,nt,Ee,Re,m,D,Y,Ie,H,ke,yt,G,de,_t]),vs=h.useMemo(()=>({activatorEvent:U,activators:tr,active:g,activeNodeRect:O,ariaDescribedById:{draggable:J},dispatch:N,draggableNodes:m,over:Ie,measureDroppableContainers:H}),[U,tr,g,O,N,J,m,Ie,H]);return ae.createElement(Qo.Provider,{value:R},ae.createElement(Bt.Provider,{value:vs},ae.createElement(cs.Provider,{value:xs},ae.createElement(ds.Provider,{value:bs},c)),ae.createElement(Wl,{disabled:l?.restoreFocus===!1})),ae.createElement(Wa,{...l,hiddenTextDescribedById:J}));function ws(){const ie=F?.autoScrollEnabled===!1,fe=typeof a=="object"?a.enabled===!1:a===!1,he=E&&!ie&&!fe;return typeof a=="object"?{...a,enabled:he}:{enabled:he}}}),ec=h.createContext(null),Jr="button",tc="Draggable";function nc(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const s=bt(tc),{activators:i,activatorEvent:l,active:a,activeNodeRect:c,ariaDescribedById:u,draggableNodes:f,over:b}=h.useContext(Bt),{role:p=Jr,roleDescription:S="draggable",tabIndex:v=0}=o??{},A=a?.id===t,N=h.useContext(A?ds:ec),[k,R]=It(),[w,T]=It(),E=Fl(i,t),x=ft(n);Ce(()=>(f.set(t,{id:t,key:s,node:k,activatorNode:w,data:x}),()=>{const y=f.get(t);y&&y.key===s&&f.delete(t)}),[f,t]);const m=h.useMemo(()=>({role:p,tabIndex:v,"aria-disabled":r,"aria-pressed":A&&p===Jr?!0:void 0,"aria-roledescription":S,"aria-describedby":u.draggable}),[r,p,v,A,S,u.draggable]);return{active:a,activatorEvent:l,activeNodeRect:c,attributes:m,isDragging:A,listeners:r?void 0:E,node:k,over:b,setNodeRef:R,setActivatorNodeRef:T,transform:N}}function rc(){return h.useContext(cs)}const oc="Droppable",sc={timeout:25};function ic(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const s=bt(oc),{active:i,dispatch:l,over:a,measureDroppableContainers:c}=h.useContext(Bt),u=h.useRef({disabled:n}),f=h.useRef(!1),b=h.useRef(null),p=h.useRef(null),{disabled:S,updateMeasurementsFor:v,timeout:A}={...sc,...o},N=ft(v??r),k=h.useCallback(()=>{if(!f.current){f.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{c(Array.isArray(N.current)?N.current:[N.current]),p.current=null},A)},[A]),R=Pt({callback:k,disabled:S||!i}),w=h.useCallback((m,y)=>{R&&(y&&(R.unobserve(y),f.current=!1),m&&R.observe(m))},[R]),[T,E]=It(w),x=ft(t);return h.useEffect(()=>{!R||!T.current||(R.disconnect(),f.current=!1,R.observe(T.current))},[T,R]),h.useEffect(()=>(l({type:te.RegisterDroppable,element:{id:r,key:s,disabled:n,node:T,rect:b,data:x}}),()=>l({type:te.UnregisterDroppable,key:s,id:r})),[r]),h.useEffect(()=>{n!==u.current.disabled&&(l({type:te.SetDroppableDisabled,id:r,key:s,disabled:n}),u.current.disabled=n)},[r,s,n,l]),{active:i,rect:b,isOver:a?.id===r,node:T,over:a,setNodeRef:E}}function Gn(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function ac(e,t){return e.reduce((n,r,o)=>{const s=t.get(r);return s&&(n[o]=s),n},Array(e.length))}function St(e){return e!==null&&e>=0}function lc(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function cc(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Hn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const s=Gn(t,r,n),i=t[o],l=s[o];return!l||!i?null:{x:l.left-i.left,y:l.top-i.top,scaleX:l.width/i.width,scaleY:l.height/i.height}},us="Sortable",fs=ae.createContext({activeIndex:-1,containerId:us,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Hn,disabled:{draggable:!1,droppable:!1}});function dc(e){let{children:t,id:n,items:r,strategy:o=Hn,disabled:s=!1}=e;const{active:i,dragOverlay:l,droppableRects:a,over:c,measureDroppableContainers:u}=rc(),f=bt(us,n),b=l.rect!==null,p=h.useMemo(()=>r.map(E=>typeof E=="object"&&"id"in E?E.id:E),[r]),S=i!=null,v=i?p.indexOf(i.id):-1,A=c?p.indexOf(c.id):-1,N=h.useRef(p),k=!lc(p,N.current),R=A!==-1&&v===-1||k,w=cc(s);Ce(()=>{k&&S&&u(p)},[k,p,S,u]),h.useEffect(()=>{N.current=p},[p]);const T=h.useMemo(()=>({activeIndex:v,containerId:f,disabled:w,disableTransforms:R,items:p,overIndex:A,useDragOverlay:b,sortedRects:ac(p,a),strategy:o}),[v,f,w.draggable,w.droppable,R,p,A,a,b,o]);return ae.createElement(fs.Provider,{value:T},t)}const uc=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return Gn(n,r,o).indexOf(t)},fc=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:s,newIndex:i,previousItems:l,previousContainerId:a,transition:c}=e;return!c||!r||l!==s&&o===i?!1:n?!0:i!==o&&t===a},hc={duration:200,easing:"ease"},hs="transform",gc=ht.Transition.toString({property:hs,duration:0,easing:"linear"}),mc={roleDescription:"sortable"};function pc(e){let{disabled:t,index:n,node:r,rect:o}=e;const[s,i]=h.useState(null),l=h.useRef(n);return Ce(()=>{if(!t&&n!==l.current&&r.current){const a=o.current;if(a){const c=tt(r.current,{ignoreTransform:!0}),u={x:a.left-c.left,y:a.top-c.top,scaleX:a.width/c.width,scaleY:a.height/c.height};(u.x||u.y)&&i(u)}}n!==l.current&&(l.current=n)},[t,n,r,o]),h.useEffect(()=>{s&&i(null)},[s]),s}function bc(e){let{animateLayoutChanges:t=fc,attributes:n,disabled:r,data:o,getNewIndex:s=uc,id:i,strategy:l,resizeObserverConfig:a,transition:c=hc}=e;const{items:u,containerId:f,activeIndex:b,disabled:p,disableTransforms:S,sortedRects:v,overIndex:A,useDragOverlay:N,strategy:k}=h.useContext(fs),R=yc(r,p),w=u.indexOf(i),T=h.useMemo(()=>({sortable:{containerId:f,index:w,items:u},...o}),[f,o,w,u]),E=h.useMemo(()=>u.slice(u.indexOf(i)),[u,i]),{rect:x,node:m,isOver:y,setNodeRef:D}=ic({id:i,data:T,disabled:R.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...a}}),{active:I,activatorEvent:M,activeNodeRect:g,attributes:C,setNodeRef:F,listeners:_,isDragging:U,over:j,setActivatorNodeRef:B,transform:J}=nc({id:i,data:T,attributes:{...mc,...n},disabled:R.draggable}),Z=Ba(D,F),G=!!I,Y=G&&!S&&St(b)&&St(A),H=!N&&U,de=H&&Y?J:null,q=Y?de??(l??k)({rects:v,activeNodeRect:g,activeIndex:b,overIndex:A,index:w}):null,Q=St(b)&&St(A)?s({id:i,items:u,activeIndex:b,overIndex:A}):w,K=I?.id,O=h.useRef({activeId:K,items:u,newIndex:Q,containerId:f}),Ee=u!==O.current.items,le=t({active:I,containerId:f,isDragging:U,isSorting:G,id:i,index:w,items:u,newIndex:O.current.newIndex,previousItems:O.current.items,previousContainerId:O.current.containerId,transition:c,wasDragging:O.current.activeId!=null}),Fe=pc({disabled:!le,index:w,node:m,rect:x});return h.useEffect(()=>{G&&O.current.newIndex!==Q&&(O.current.newIndex=Q),f!==O.current.containerId&&(O.current.containerId=f),u!==O.current.items&&(O.current.items=u)},[G,Q,f,u]),h.useEffect(()=>{if(K===O.current.activeId)return;if(K!=null&&O.current.activeId==null){O.current.activeId=K;return}const Oe=setTimeout(()=>{O.current.activeId=K},50);return()=>clearTimeout(Oe)},[K]),{active:I,activeIndex:b,attributes:C,data:T,rect:x,index:w,newIndex:Q,items:u,isOver:y,isSorting:G,isDragging:U,listeners:_,node:m,overIndex:A,over:j,setNodeRef:Z,setActivatorNodeRef:B,setDroppableNodeRef:D,setDraggableNodeRef:F,transform:Fe??q,transition:Re()};function Re(){if(Fe||Ee&&O.current.newIndex===w)return gc;if(!(H&&!Un(M)||!c)&&(G||le))return ht.Transition.toString({...c,property:hs})}}function yc(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(r=e?.droppable)!=null?r:t.droppable}}V.Down,V.Right,V.Up,V.Left;function xc({id:e,children:t}){const{attributes:n,listeners:r,setNodeRef:o,transform:s,transition:i,isDragging:l,isSorting:a}=bc({id:e}),c={transform:ht.Translate.toString(s),transition:i,position:"relative",zIndex:l?9999:a?2:1,cursor:l?"grabbing":"grab",touchAction:"none"};return d.jsx("div",{ref:o,style:c,...n,...r,children:t})}function Zr(e){const t=e/1e3;return t<60?`${t.toFixed(1)}s`:`${Math.floor(t/60)}m ${(t%60).toFixed(0)}s`}class vc extends $n{static activators=[{eventName:"onPointerDown",handler:({nativeEvent:t})=>!t.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}class wc extends is{static activators=[{eventName:"onTouchStart",handler:({nativeEvent:t})=>!t.target?.closest?.('[data-dnd-ignore], [role="dialog"], [aria-modal="true"]')}]}function Cc(){const e=$(A=>A.photos),t=$(A=>A.reorderPhotos),[n,r]=h.useState(!1),[o,s]=h.useState(null),i=h.useRef(!1),[l,a]=h.useState("jpeg"),[c,u]=h.useState(Pi*100),f=o?.pct??0,b=h.useMemo(()=>{if(!o)return"";const A=o.etaMs??0;return`Rendering ${o.done}/${o.total} • ${f}% • elapsed ${Zr(o.elapsedMs)}${o.done<o.total?` • ETA ${Zr(A)}`:""}`},[o,f]);h.useEffect(()=>{o&&o.done>=o.total&&s(null)},[o]);const p=h.useCallback(async()=>{if(!(!e.length||i.current)){i.current=!0;try{r(!0);const{exportCardsToPdf:A}=await Hs(async()=>{const{exportCardsToPdf:T}=await import("./pdf-DFNxJSZd.js");return{exportCardsToPdf:T}},__vite__mapDeps([0,1,2,3])),N=await A(e),k=new Blob([N],{type:"application/pdf"}),R=URL.createObjectURL(k),w=document.createElement("a");w.href=R,w.download="story-squares.pdf",document.body.appendChild(w),w.click(),w.remove(),URL.revokeObjectURL(R)}finally{r(!1),i.current=!1}}},[e]),S=Qa(Ur(vc,{activationConstraint:{distance:6}}),Ur(wc,{activationConstraint:{delay:120,tolerance:6}})),v=e.map(A=>A.id);return d.jsxs("section",{className:"space-y-3",children:[d.jsx(Zl,{sensors:S,collisionDetection:tl,onDragEnd:({active:A,over:N})=>{if(!N||A.id===N.id)return;const k=v.indexOf(String(A.id)),R=v.indexOf(String(N.id));if(k===-1||R===-1)return;const w=Gn(v,k,R);t(w)},children:d.jsx(dc,{items:v,strategy:Hn,children:d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:e.map(A=>d.jsx(xc,{id:A.id,children:d.jsx(Pa,{photo:A})},A.id))})})}),e.length>0&&d.jsxs(zo,{className:"p-4",children:[d.jsx("div",{className:"mb-3 text-sm font-medium",children:"Export the collection to PDF"}),o&&d.jsxs(d.Fragment,{children:[d.jsx(Fo,{value:f,className:"mb-1 h-2"}),d.jsx("div",{className:"mb-3 text-xs opacity-70",children:b})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"opacity-70",children:"Format"}),d.jsxs(Oo,{value:l,onValueChange:A=>a(A),children:[d.jsx(Mn,{className:"w-28 h-8",children:d.jsx(Uo,{placeholder:"Format"})}),d.jsxs(jn,{children:[d.jsx(Xe,{value:"jpeg",children:"JPEG (small)"}),d.jsx(Xe,{value:"png",children:"PNG (lossless)"})]})]})]}),l==="jpeg"&&d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"opacity-70",children:"Quality"}),d.jsx("input",{type:"range",min:50,max:95,step:5,value:c,onChange:A=>u(Number(A.target.value))}),d.jsxs("span",{className:"tabular-nums",children:[c,"%"]})]}),d.jsx("div",{className:"grow"}),d.jsx(re,{type:"button",size:"sm",onClick:p,disabled:!e.length||n,children:n?"Exporting…":"Export PDF"})]})]})]})}function Ec(){return Xs(),d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"sticky top-0 z-10 w-full py-3 text-center text-3xl font-bold bg-background border-b border-gray-300",children:"Story Squares v1.1"}),d.jsxs("main",{className:"mx-auto max-w-screen-md px-4 space-y-5",children:[d.jsx(ua,{}),d.jsx(Cc,{})]})]})}no.createRoot(document.getElementById("root")).render(d.jsx(ae.StrictMode,{children:d.jsx(Ec,{})}));export{ce as C,ja as e};
